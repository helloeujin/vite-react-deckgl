function t1(t,e){for(var n=0;n<e.length;n++){const r=e[n];if(typeof r!="string"&&!Array.isArray(r)){for(const i in r)if(i!=="default"&&!(i in t)){const s=Object.getOwnPropertyDescriptor(r,i);s&&Object.defineProperty(t,i,s.get?s:{enumerable:!0,get:()=>r[i]})}}}return Object.freeze(Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}))}(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))r(i);new MutationObserver(i=>{for(const s of i)if(s.type==="childList")for(const o of s.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&r(o)}).observe(document,{childList:!0,subtree:!0});function n(i){const s={};return i.integrity&&(s.integrity=i.integrity),i.referrerpolicy&&(s.referrerPolicy=i.referrerpolicy),i.crossorigin==="use-credentials"?s.credentials="include":i.crossorigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function r(i){if(i.ep)return;i.ep=!0;const s=n(i);fetch(i.href,s)}})();function n1(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var Du={},r1={get exports(){return Du},set exports(t){Du=t}},Za={},re={},i1={get exports(){return re},set exports(t){re=t}},q={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Bs=Symbol.for("react.element"),s1=Symbol.for("react.portal"),o1=Symbol.for("react.fragment"),a1=Symbol.for("react.strict_mode"),l1=Symbol.for("react.profiler"),u1=Symbol.for("react.provider"),c1=Symbol.for("react.context"),h1=Symbol.for("react.forward_ref"),f1=Symbol.for("react.suspense"),d1=Symbol.for("react.memo"),g1=Symbol.for("react.lazy"),Qf=Symbol.iterator;function p1(t){return t===null||typeof t!="object"?null:(t=Qf&&t[Qf]||t["@@iterator"],typeof t=="function"?t:null)}var am={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},lm=Object.assign,um={};function Ei(t,e,n){this.props=t,this.context=e,this.refs=um,this.updater=n||am}Ei.prototype.isReactComponent={};Ei.prototype.setState=function(t,e){if(typeof t!="object"&&typeof t!="function"&&t!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,t,e,"setState")};Ei.prototype.forceUpdate=function(t){this.updater.enqueueForceUpdate(this,t,"forceUpdate")};function cm(){}cm.prototype=Ei.prototype;function oh(t,e,n){this.props=t,this.context=e,this.refs=um,this.updater=n||am}var ah=oh.prototype=new cm;ah.constructor=oh;lm(ah,Ei.prototype);ah.isPureReactComponent=!0;var Kf=Array.isArray,hm=Object.prototype.hasOwnProperty,lh={current:null},fm={key:!0,ref:!0,__self:!0,__source:!0};function dm(t,e,n){var r,i={},s=null,o=null;if(e!=null)for(r in e.ref!==void 0&&(o=e.ref),e.key!==void 0&&(s=""+e.key),e)hm.call(e,r)&&!fm.hasOwnProperty(r)&&(i[r]=e[r]);var a=arguments.length-2;if(a===1)i.children=n;else if(1<a){for(var l=Array(a),u=0;u<a;u++)l[u]=arguments[u+2];i.children=l}if(t&&t.defaultProps)for(r in a=t.defaultProps,a)i[r]===void 0&&(i[r]=a[r]);return{$$typeof:Bs,type:t,key:s,ref:o,props:i,_owner:lh.current}}function m1(t,e){return{$$typeof:Bs,type:t.type,key:e,ref:t.ref,props:t.props,_owner:t._owner}}function uh(t){return typeof t=="object"&&t!==null&&t.$$typeof===Bs}function y1(t){var e={"=":"=0",":":"=2"};return"$"+t.replace(/[=:]/g,function(n){return e[n]})}var Jf=/\/+/g;function Ol(t,e){return typeof t=="object"&&t!==null&&t.key!=null?y1(""+t.key):e.toString(36)}function Bo(t,e,n,r,i){var s=typeof t;(s==="undefined"||s==="boolean")&&(t=null);var o=!1;if(t===null)o=!0;else switch(s){case"string":case"number":o=!0;break;case"object":switch(t.$$typeof){case Bs:case s1:o=!0}}if(o)return o=t,i=i(o),t=r===""?"."+Ol(o,0):r,Kf(i)?(n="",t!=null&&(n=t.replace(Jf,"$&/")+"/"),Bo(i,e,n,"",function(u){return u})):i!=null&&(uh(i)&&(i=m1(i,n+(!i.key||o&&o.key===i.key?"":(""+i.key).replace(Jf,"$&/")+"/")+t)),e.push(i)),1;if(o=0,r=r===""?".":r+":",Kf(t))for(var a=0;a<t.length;a++){s=t[a];var l=r+Ol(s,a);o+=Bo(s,e,n,l,i)}else if(l=p1(t),typeof l=="function")for(t=l.call(t),a=0;!(s=t.next()).done;)s=s.value,l=r+Ol(s,a++),o+=Bo(s,e,n,l,i);else if(s==="object")throw e=String(t),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return o}function co(t,e,n){if(t==null)return t;var r=[],i=0;return Bo(t,r,"","",function(s){return e.call(n,s,i++)}),r}function _1(t){if(t._status===-1){var e=t._result;e=e(),e.then(function(n){(t._status===0||t._status===-1)&&(t._status=1,t._result=n)},function(n){(t._status===0||t._status===-1)&&(t._status=2,t._result=n)}),t._status===-1&&(t._status=0,t._result=e)}if(t._status===1)return t._result.default;throw t._result}var Ye={current:null},Vo={transition:null},v1={ReactCurrentDispatcher:Ye,ReactCurrentBatchConfig:Vo,ReactCurrentOwner:lh};q.Children={map:co,forEach:function(t,e,n){co(t,function(){e.apply(this,arguments)},n)},count:function(t){var e=0;return co(t,function(){e++}),e},toArray:function(t){return co(t,function(e){return e})||[]},only:function(t){if(!uh(t))throw Error("React.Children.only expected to receive a single React element child.");return t}};q.Component=Ei;q.Fragment=o1;q.Profiler=l1;q.PureComponent=oh;q.StrictMode=a1;q.Suspense=f1;q.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=v1;q.cloneElement=function(t,e,n){if(t==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+t+".");var r=lm({},t.props),i=t.key,s=t.ref,o=t._owner;if(e!=null){if(e.ref!==void 0&&(s=e.ref,o=lh.current),e.key!==void 0&&(i=""+e.key),t.type&&t.type.defaultProps)var a=t.type.defaultProps;for(l in e)hm.call(e,l)&&!fm.hasOwnProperty(l)&&(r[l]=e[l]===void 0&&a!==void 0?a[l]:e[l])}var l=arguments.length-2;if(l===1)r.children=n;else if(1<l){a=Array(l);for(var u=0;u<l;u++)a[u]=arguments[u+2];r.children=a}return{$$typeof:Bs,type:t.type,key:i,ref:s,props:r,_owner:o}};q.createContext=function(t){return t={$$typeof:c1,_currentValue:t,_currentValue2:t,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},t.Provider={$$typeof:u1,_context:t},t.Consumer=t};q.createElement=dm;q.createFactory=function(t){var e=dm.bind(null,t);return e.type=t,e};q.createRef=function(){return{current:null}};q.forwardRef=function(t){return{$$typeof:h1,render:t}};q.isValidElement=uh;q.lazy=function(t){return{$$typeof:g1,_payload:{_status:-1,_result:t},_init:_1}};q.memo=function(t,e){return{$$typeof:d1,type:t,compare:e===void 0?null:e}};q.startTransition=function(t){var e=Vo.transition;Vo.transition={};try{t()}finally{Vo.transition=e}};q.unstable_act=function(){throw Error("act(...) is not supported in production builds of React.")};q.useCallback=function(t,e){return Ye.current.useCallback(t,e)};q.useContext=function(t){return Ye.current.useContext(t)};q.useDebugValue=function(){};q.useDeferredValue=function(t){return Ye.current.useDeferredValue(t)};q.useEffect=function(t,e){return Ye.current.useEffect(t,e)};q.useId=function(){return Ye.current.useId()};q.useImperativeHandle=function(t,e,n){return Ye.current.useImperativeHandle(t,e,n)};q.useInsertionEffect=function(t,e){return Ye.current.useInsertionEffect(t,e)};q.useLayoutEffect=function(t,e){return Ye.current.useLayoutEffect(t,e)};q.useMemo=function(t,e){return Ye.current.useMemo(t,e)};q.useReducer=function(t,e,n){return Ye.current.useReducer(t,e,n)};q.useRef=function(t){return Ye.current.useRef(t)};q.useState=function(t){return Ye.current.useState(t)};q.useSyncExternalStore=function(t,e,n){return Ye.current.useSyncExternalStore(t,e,n)};q.useTransition=function(){return Ye.current.useTransition()};q.version="18.2.0";(function(t){t.exports=q})(i1);const w1=n1(re);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var E1=re,T1=Symbol.for("react.element"),b1=Symbol.for("react.fragment"),S1=Object.prototype.hasOwnProperty,A1=E1.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,x1={key:!0,ref:!0,__self:!0,__source:!0};function gm(t,e,n){var r,i={},s=null,o=null;n!==void 0&&(s=""+n),e.key!==void 0&&(s=""+e.key),e.ref!==void 0&&(o=e.ref);for(r in e)S1.call(e,r)&&!x1.hasOwnProperty(r)&&(i[r]=e[r]);if(t&&t.defaultProps)for(r in e=t.defaultProps,e)i[r]===void 0&&(i[r]=e[r]);return{$$typeof:T1,type:t,key:s,ref:o,props:i,_owner:A1.current}}Za.Fragment=b1;Za.jsx=gm;Za.jsxs=gm;(function(t){t.exports=Za})(r1);const sa=Du.jsx;var Fu={},Uu={},P1={get exports(){return Uu},set exports(t){Uu=t}},gt={},Bu={},C1={get exports(){return Bu},set exports(t){Bu=t}},pm={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(t){function e(N,j){var W=N.length;N.push(j);e:for(;0<W;){var H=W-1>>>1,$=N[H];if(0<i($,j))N[H]=j,N[W]=$,W=H;else break e}}function n(N){return N.length===0?null:N[0]}function r(N){if(N.length===0)return null;var j=N[0],W=N.pop();if(W!==j){N[0]=W;e:for(var H=0,$=N.length,ue=$>>>1;H<ue;){var Oe=2*(H+1)-1,Ct=N[Oe],en=Oe+1,ye=N[en];if(0>i(Ct,W))en<$&&0>i(ye,Ct)?(N[H]=ye,N[en]=W,H=en):(N[H]=Ct,N[Oe]=W,H=Oe);else if(en<$&&0>i(ye,W))N[H]=ye,N[en]=W,H=en;else break e}}return j}function i(N,j){var W=N.sortIndex-j.sortIndex;return W!==0?W:N.id-j.id}if(typeof performance=="object"&&typeof performance.now=="function"){var s=performance;t.unstable_now=function(){return s.now()}}else{var o=Date,a=o.now();t.unstable_now=function(){return o.now()-a}}var l=[],u=[],c=1,h=null,f=3,g=!1,w=!1,E=!1,T=typeof setTimeout=="function"?setTimeout:null,y=typeof clearTimeout=="function"?clearTimeout:null,m=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function _(N){for(var j=n(u);j!==null;){if(j.callback===null)r(u);else if(j.startTime<=N)r(u),j.sortIndex=j.expirationTime,e(l,j);else break;j=n(u)}}function S(N){if(E=!1,_(N),!w)if(n(l)!==null)w=!0,mt(A);else{var j=n(u);j!==null&&qe(S,j.startTime-N)}}function A(N,j){w=!1,E&&(E=!1,y(C),C=-1),g=!0;var W=f;try{for(_(j),h=n(l);h!==null&&(!(h.expirationTime>j)||N&&!O());){var H=h.callback;if(typeof H=="function"){h.callback=null,f=h.priorityLevel;var $=H(h.expirationTime<=j);j=t.unstable_now(),typeof $=="function"?h.callback=$:h===n(l)&&r(l),_(j)}else r(l);h=n(l)}if(h!==null)var ue=!0;else{var Oe=n(u);Oe!==null&&qe(S,Oe.startTime-j),ue=!1}return ue}finally{h=null,f=W,g=!1}}var P=!1,L=null,C=-1,R=5,M=-1;function O(){return!(t.unstable_now()-M<R)}function D(){if(L!==null){var N=t.unstable_now();M=N;var j=!0;try{j=L(!0,N)}finally{j?G():(P=!1,L=null)}}else P=!1}var G;if(typeof m=="function")G=function(){m(D)};else if(typeof MessageChannel<"u"){var V=new MessageChannel,K=V.port2;V.port1.onmessage=D,G=function(){K.postMessage(null)}}else G=function(){T(D,0)};function mt(N){L=N,P||(P=!0,G())}function qe(N,j){C=T(function(){N(t.unstable_now())},j)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(N){N.callback=null},t.unstable_continueExecution=function(){w||g||(w=!0,mt(A))},t.unstable_forceFrameRate=function(N){0>N||125<N?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):R=0<N?Math.floor(1e3/N):5},t.unstable_getCurrentPriorityLevel=function(){return f},t.unstable_getFirstCallbackNode=function(){return n(l)},t.unstable_next=function(N){switch(f){case 1:case 2:case 3:var j=3;break;default:j=f}var W=f;f=j;try{return N()}finally{f=W}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(N,j){switch(N){case 1:case 2:case 3:case 4:case 5:break;default:N=3}var W=f;f=N;try{return j()}finally{f=W}},t.unstable_scheduleCallback=function(N,j,W){var H=t.unstable_now();switch(typeof W=="object"&&W!==null?(W=W.delay,W=typeof W=="number"&&0<W?H+W:H):W=H,N){case 1:var $=-1;break;case 2:$=250;break;case 5:$=1073741823;break;case 4:$=1e4;break;default:$=5e3}return $=W+$,N={id:c++,callback:j,priorityLevel:N,startTime:W,expirationTime:$,sortIndex:-1},W>H?(N.sortIndex=W,e(u,N),n(l)===null&&N===n(u)&&(E?(y(C),C=-1):E=!0,qe(S,W-H))):(N.sortIndex=$,e(l,N),w||g||(w=!0,mt(A))),N},t.unstable_shouldYield=O,t.unstable_wrapCallback=function(N){var j=f;return function(){var W=f;f=j;try{return N.apply(this,arguments)}finally{f=W}}}})(pm);(function(t){t.exports=pm})(C1);/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var mm=re,ft=Bu;function I(t){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+t,n=1;n<arguments.length;n++)e+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+t+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var ym=new Set,ds={};function br(t,e){oi(t,e),oi(t+"Capture",e)}function oi(t,e){for(ds[t]=e,t=0;t<e.length;t++)ym.add(e[t])}var fn=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Vu=Object.prototype.hasOwnProperty,L1=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,ed={},td={};function R1(t){return Vu.call(td,t)?!0:Vu.call(ed,t)?!1:L1.test(t)?td[t]=!0:(ed[t]=!0,!1)}function M1(t,e,n,r){if(n!==null&&n.type===0)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return r?!1:n!==null?!n.acceptsBooleans:(t=t.toLowerCase().slice(0,5),t!=="data-"&&t!=="aria-");default:return!1}}function k1(t,e,n,r){if(e===null||typeof e>"u"||M1(t,e,n,r))return!0;if(r)return!1;if(n!==null)switch(n.type){case 3:return!e;case 4:return e===!1;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}function $e(t,e,n,r,i,s,o){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=r,this.attributeNamespace=i,this.mustUseProperty=n,this.propertyName=t,this.type=e,this.sanitizeURL=s,this.removeEmptyString=o}var Ie={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(t){Ie[t]=new $e(t,0,!1,t,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(t){var e=t[0];Ie[e]=new $e(e,1,!1,t[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(t){Ie[t]=new $e(t,2,!1,t.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(t){Ie[t]=new $e(t,2,!1,t,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(t){Ie[t]=new $e(t,3,!1,t.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(t){Ie[t]=new $e(t,3,!0,t,null,!1,!1)});["capture","download"].forEach(function(t){Ie[t]=new $e(t,4,!1,t,null,!1,!1)});["cols","rows","size","span"].forEach(function(t){Ie[t]=new $e(t,6,!1,t,null,!1,!1)});["rowSpan","start"].forEach(function(t){Ie[t]=new $e(t,5,!1,t.toLowerCase(),null,!1,!1)});var ch=/[\-:]([a-z])/g;function hh(t){return t[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(t){var e=t.replace(ch,hh);Ie[e]=new $e(e,1,!1,t,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(t){var e=t.replace(ch,hh);Ie[e]=new $e(e,1,!1,t,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(t){var e=t.replace(ch,hh);Ie[e]=new $e(e,1,!1,t,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(t){Ie[t]=new $e(t,1,!1,t.toLowerCase(),null,!1,!1)});Ie.xlinkHref=new $e("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(t){Ie[t]=new $e(t,1,!1,t.toLowerCase(),null,!0,!0)});function fh(t,e,n,r){var i=Ie.hasOwnProperty(e)?Ie[e]:null;(i!==null?i.type!==0:r||!(2<e.length)||e[0]!=="o"&&e[0]!=="O"||e[1]!=="n"&&e[1]!=="N")&&(k1(e,n,i,r)&&(n=null),r||i===null?R1(e)&&(n===null?t.removeAttribute(e):t.setAttribute(e,""+n)):i.mustUseProperty?t[i.propertyName]=n===null?i.type===3?!1:"":n:(e=i.attributeName,r=i.attributeNamespace,n===null?t.removeAttribute(e):(i=i.type,n=i===3||i===4&&n===!0?"":""+n,r?t.setAttributeNS(r,e,n):t.setAttribute(e,n))))}var wn=mm.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,ho=Symbol.for("react.element"),Ur=Symbol.for("react.portal"),Br=Symbol.for("react.fragment"),dh=Symbol.for("react.strict_mode"),zu=Symbol.for("react.profiler"),_m=Symbol.for("react.provider"),vm=Symbol.for("react.context"),gh=Symbol.for("react.forward_ref"),ju=Symbol.for("react.suspense"),Gu=Symbol.for("react.suspense_list"),ph=Symbol.for("react.memo"),Rn=Symbol.for("react.lazy"),wm=Symbol.for("react.offscreen"),nd=Symbol.iterator;function Oi(t){return t===null||typeof t!="object"?null:(t=nd&&t[nd]||t["@@iterator"],typeof t=="function"?t:null)}var de=Object.assign,Nl;function $i(t){if(Nl===void 0)try{throw Error()}catch(n){var e=n.stack.trim().match(/\n( *(at )?)/);Nl=e&&e[1]||""}return`
`+Nl+t}var Dl=!1;function Fl(t,e){if(!t||Dl)return"";Dl=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(e,[])}catch(u){var r=u}Reflect.construct(t,[],e)}else{try{e.call()}catch(u){r=u}t.call(e.prototype)}else{try{throw Error()}catch(u){r=u}t()}}catch(u){if(u&&r&&typeof u.stack=="string"){for(var i=u.stack.split(`
`),s=r.stack.split(`
`),o=i.length-1,a=s.length-1;1<=o&&0<=a&&i[o]!==s[a];)a--;for(;1<=o&&0<=a;o--,a--)if(i[o]!==s[a]){if(o!==1||a!==1)do if(o--,a--,0>a||i[o]!==s[a]){var l=`
`+i[o].replace(" at new "," at ");return t.displayName&&l.includes("<anonymous>")&&(l=l.replace("<anonymous>",t.displayName)),l}while(1<=o&&0<=a);break}}}finally{Dl=!1,Error.prepareStackTrace=n}return(t=t?t.displayName||t.name:"")?$i(t):""}function I1(t){switch(t.tag){case 5:return $i(t.type);case 16:return $i("Lazy");case 13:return $i("Suspense");case 19:return $i("SuspenseList");case 0:case 2:case 15:return t=Fl(t.type,!1),t;case 11:return t=Fl(t.type.render,!1),t;case 1:return t=Fl(t.type,!0),t;default:return""}}function Hu(t){if(t==null)return null;if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t;switch(t){case Br:return"Fragment";case Ur:return"Portal";case zu:return"Profiler";case dh:return"StrictMode";case ju:return"Suspense";case Gu:return"SuspenseList"}if(typeof t=="object")switch(t.$$typeof){case vm:return(t.displayName||"Context")+".Consumer";case _m:return(t._context.displayName||"Context")+".Provider";case gh:var e=t.render;return t=t.displayName,t||(t=e.displayName||e.name||"",t=t!==""?"ForwardRef("+t+")":"ForwardRef"),t;case ph:return e=t.displayName||null,e!==null?e:Hu(t.type)||"Memo";case Rn:e=t._payload,t=t._init;try{return Hu(t(e))}catch{}}return null}function O1(t){var e=t.type;switch(t.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return t=e.render,t=t.displayName||t.name||"",e.displayName||(t!==""?"ForwardRef("+t+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return Hu(e);case 8:return e===dh?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e}return null}function Xn(t){switch(typeof t){case"boolean":case"number":case"string":case"undefined":return t;case"object":return t;default:return""}}function Em(t){var e=t.type;return(t=t.nodeName)&&t.toLowerCase()==="input"&&(e==="checkbox"||e==="radio")}function N1(t){var e=Em(t)?"checked":"value",n=Object.getOwnPropertyDescriptor(t.constructor.prototype,e),r=""+t[e];if(!t.hasOwnProperty(e)&&typeof n<"u"&&typeof n.get=="function"&&typeof n.set=="function"){var i=n.get,s=n.set;return Object.defineProperty(t,e,{configurable:!0,get:function(){return i.call(this)},set:function(o){r=""+o,s.call(this,o)}}),Object.defineProperty(t,e,{enumerable:n.enumerable}),{getValue:function(){return r},setValue:function(o){r=""+o},stopTracking:function(){t._valueTracker=null,delete t[e]}}}}function fo(t){t._valueTracker||(t._valueTracker=N1(t))}function Tm(t){if(!t)return!1;var e=t._valueTracker;if(!e)return!0;var n=e.getValue(),r="";return t&&(r=Em(t)?t.checked?"true":"false":t.value),t=r,t!==n?(e.setValue(t),!0):!1}function oa(t){if(t=t||(typeof document<"u"?document:void 0),typeof t>"u")return null;try{return t.activeElement||t.body}catch{return t.body}}function Wu(t,e){var n=e.checked;return de({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:n??t._wrapperState.initialChecked})}function rd(t,e){var n=e.defaultValue==null?"":e.defaultValue,r=e.checked!=null?e.checked:e.defaultChecked;n=Xn(e.value!=null?e.value:n),t._wrapperState={initialChecked:r,initialValue:n,controlled:e.type==="checkbox"||e.type==="radio"?e.checked!=null:e.value!=null}}function bm(t,e){e=e.checked,e!=null&&fh(t,"checked",e,!1)}function Xu(t,e){bm(t,e);var n=Xn(e.value),r=e.type;if(n!=null)r==="number"?(n===0&&t.value===""||t.value!=n)&&(t.value=""+n):t.value!==""+n&&(t.value=""+n);else if(r==="submit"||r==="reset"){t.removeAttribute("value");return}e.hasOwnProperty("value")?Yu(t,e.type,n):e.hasOwnProperty("defaultValue")&&Yu(t,e.type,Xn(e.defaultValue)),e.checked==null&&e.defaultChecked!=null&&(t.defaultChecked=!!e.defaultChecked)}function id(t,e,n){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var r=e.type;if(!(r!=="submit"&&r!=="reset"||e.value!==void 0&&e.value!==null))return;e=""+t._wrapperState.initialValue,n||e===t.value||(t.value=e),t.defaultValue=e}n=t.name,n!==""&&(t.name=""),t.defaultChecked=!!t._wrapperState.initialChecked,n!==""&&(t.name=n)}function Yu(t,e,n){(e!=="number"||oa(t.ownerDocument)!==t)&&(n==null?t.defaultValue=""+t._wrapperState.initialValue:t.defaultValue!==""+n&&(t.defaultValue=""+n))}var qi=Array.isArray;function Kr(t,e,n,r){if(t=t.options,e){e={};for(var i=0;i<n.length;i++)e["$"+n[i]]=!0;for(n=0;n<t.length;n++)i=e.hasOwnProperty("$"+t[n].value),t[n].selected!==i&&(t[n].selected=i),i&&r&&(t[n].defaultSelected=!0)}else{for(n=""+Xn(n),e=null,i=0;i<t.length;i++){if(t[i].value===n){t[i].selected=!0,r&&(t[i].defaultSelected=!0);return}e!==null||t[i].disabled||(e=t[i])}e!==null&&(e.selected=!0)}}function $u(t,e){if(e.dangerouslySetInnerHTML!=null)throw Error(I(91));return de({},e,{value:void 0,defaultValue:void 0,children:""+t._wrapperState.initialValue})}function sd(t,e){var n=e.value;if(n==null){if(n=e.children,e=e.defaultValue,n!=null){if(e!=null)throw Error(I(92));if(qi(n)){if(1<n.length)throw Error(I(93));n=n[0]}e=n}e==null&&(e=""),n=e}t._wrapperState={initialValue:Xn(n)}}function Sm(t,e){var n=Xn(e.value),r=Xn(e.defaultValue);n!=null&&(n=""+n,n!==t.value&&(t.value=n),e.defaultValue==null&&t.defaultValue!==n&&(t.defaultValue=n)),r!=null&&(t.defaultValue=""+r)}function od(t){var e=t.textContent;e===t._wrapperState.initialValue&&e!==""&&e!==null&&(t.value=e)}function Am(t){switch(t){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function qu(t,e){return t==null||t==="http://www.w3.org/1999/xhtml"?Am(e):t==="http://www.w3.org/2000/svg"&&e==="foreignObject"?"http://www.w3.org/1999/xhtml":t}var go,xm=function(t){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(e,n,r,i){MSApp.execUnsafeLocalFunction(function(){return t(e,n,r,i)})}:t}(function(t,e){if(t.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in t)t.innerHTML=e;else{for(go=go||document.createElement("div"),go.innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=go.firstChild;t.firstChild;)t.removeChild(t.firstChild);for(;e.firstChild;)t.appendChild(e.firstChild)}});function gs(t,e){if(e){var n=t.firstChild;if(n&&n===t.lastChild&&n.nodeType===3){n.nodeValue=e;return}}t.textContent=e}var es={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},D1=["Webkit","ms","Moz","O"];Object.keys(es).forEach(function(t){D1.forEach(function(e){e=e+t.charAt(0).toUpperCase()+t.substring(1),es[e]=es[t]})});function Pm(t,e,n){return e==null||typeof e=="boolean"||e===""?"":n||typeof e!="number"||e===0||es.hasOwnProperty(t)&&es[t]?(""+e).trim():e+"px"}function Cm(t,e){t=t.style;for(var n in e)if(e.hasOwnProperty(n)){var r=n.indexOf("--")===0,i=Pm(n,e[n],r);n==="float"&&(n="cssFloat"),r?t.setProperty(n,i):t[n]=i}}var F1=de({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function Zu(t,e){if(e){if(F1[t]&&(e.children!=null||e.dangerouslySetInnerHTML!=null))throw Error(I(137,t));if(e.dangerouslySetInnerHTML!=null){if(e.children!=null)throw Error(I(60));if(typeof e.dangerouslySetInnerHTML!="object"||!("__html"in e.dangerouslySetInnerHTML))throw Error(I(61))}if(e.style!=null&&typeof e.style!="object")throw Error(I(62))}}function Qu(t,e){if(t.indexOf("-")===-1)return typeof e.is=="string";switch(t){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Ku=null;function mh(t){return t=t.target||t.srcElement||window,t.correspondingUseElement&&(t=t.correspondingUseElement),t.nodeType===3?t.parentNode:t}var Ju=null,Jr=null,ei=null;function ad(t){if(t=js(t)){if(typeof Ju!="function")throw Error(I(280));var e=t.stateNode;e&&(e=tl(e),Ju(t.stateNode,t.type,e))}}function Lm(t){Jr?ei?ei.push(t):ei=[t]:Jr=t}function Rm(){if(Jr){var t=Jr,e=ei;if(ei=Jr=null,ad(t),e)for(t=0;t<e.length;t++)ad(e[t])}}function Mm(t,e){return t(e)}function km(){}var Ul=!1;function Im(t,e,n){if(Ul)return t(e,n);Ul=!0;try{return Mm(t,e,n)}finally{Ul=!1,(Jr!==null||ei!==null)&&(km(),Rm())}}function ps(t,e){var n=t.stateNode;if(n===null)return null;var r=tl(n);if(r===null)return null;n=r[e];e:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(t=t.type,r=!(t==="button"||t==="input"||t==="select"||t==="textarea")),t=!r;break e;default:t=!1}if(t)return null;if(n&&typeof n!="function")throw Error(I(231,e,typeof n));return n}var ec=!1;if(fn)try{var Ni={};Object.defineProperty(Ni,"passive",{get:function(){ec=!0}}),window.addEventListener("test",Ni,Ni),window.removeEventListener("test",Ni,Ni)}catch{ec=!1}function U1(t,e,n,r,i,s,o,a,l){var u=Array.prototype.slice.call(arguments,3);try{e.apply(n,u)}catch(c){this.onError(c)}}var ts=!1,aa=null,la=!1,tc=null,B1={onError:function(t){ts=!0,aa=t}};function V1(t,e,n,r,i,s,o,a,l){ts=!1,aa=null,U1.apply(B1,arguments)}function z1(t,e,n,r,i,s,o,a,l){if(V1.apply(this,arguments),ts){if(ts){var u=aa;ts=!1,aa=null}else throw Error(I(198));la||(la=!0,tc=u)}}function Sr(t){var e=t,n=t;if(t.alternate)for(;e.return;)e=e.return;else{t=e;do e=t,e.flags&4098&&(n=e.return),t=e.return;while(t)}return e.tag===3?n:null}function Om(t){if(t.tag===13){var e=t.memoizedState;if(e===null&&(t=t.alternate,t!==null&&(e=t.memoizedState)),e!==null)return e.dehydrated}return null}function ld(t){if(Sr(t)!==t)throw Error(I(188))}function j1(t){var e=t.alternate;if(!e){if(e=Sr(t),e===null)throw Error(I(188));return e!==t?null:t}for(var n=t,r=e;;){var i=n.return;if(i===null)break;var s=i.alternate;if(s===null){if(r=i.return,r!==null){n=r;continue}break}if(i.child===s.child){for(s=i.child;s;){if(s===n)return ld(i),t;if(s===r)return ld(i),e;s=s.sibling}throw Error(I(188))}if(n.return!==r.return)n=i,r=s;else{for(var o=!1,a=i.child;a;){if(a===n){o=!0,n=i,r=s;break}if(a===r){o=!0,r=i,n=s;break}a=a.sibling}if(!o){for(a=s.child;a;){if(a===n){o=!0,n=s,r=i;break}if(a===r){o=!0,r=s,n=i;break}a=a.sibling}if(!o)throw Error(I(189))}}if(n.alternate!==r)throw Error(I(190))}if(n.tag!==3)throw Error(I(188));return n.stateNode.current===n?t:e}function Nm(t){return t=j1(t),t!==null?Dm(t):null}function Dm(t){if(t.tag===5||t.tag===6)return t;for(t=t.child;t!==null;){var e=Dm(t);if(e!==null)return e;t=t.sibling}return null}var Fm=ft.unstable_scheduleCallback,ud=ft.unstable_cancelCallback,G1=ft.unstable_shouldYield,H1=ft.unstable_requestPaint,me=ft.unstable_now,W1=ft.unstable_getCurrentPriorityLevel,yh=ft.unstable_ImmediatePriority,Um=ft.unstable_UserBlockingPriority,ua=ft.unstable_NormalPriority,X1=ft.unstable_LowPriority,Bm=ft.unstable_IdlePriority,Qa=null,Qt=null;function Y1(t){if(Qt&&typeof Qt.onCommitFiberRoot=="function")try{Qt.onCommitFiberRoot(Qa,t,void 0,(t.current.flags&128)===128)}catch{}}var Nt=Math.clz32?Math.clz32:Z1,$1=Math.log,q1=Math.LN2;function Z1(t){return t>>>=0,t===0?32:31-($1(t)/q1|0)|0}var po=64,mo=4194304;function Zi(t){switch(t&-t){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return t&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return t}}function ca(t,e){var n=t.pendingLanes;if(n===0)return 0;var r=0,i=t.suspendedLanes,s=t.pingedLanes,o=n&268435455;if(o!==0){var a=o&~i;a!==0?r=Zi(a):(s&=o,s!==0&&(r=Zi(s)))}else o=n&~i,o!==0?r=Zi(o):s!==0&&(r=Zi(s));if(r===0)return 0;if(e!==0&&e!==r&&!(e&i)&&(i=r&-r,s=e&-e,i>=s||i===16&&(s&4194240)!==0))return e;if(r&4&&(r|=n&16),e=t.entangledLanes,e!==0)for(t=t.entanglements,e&=r;0<e;)n=31-Nt(e),i=1<<n,r|=t[n],e&=~i;return r}function Q1(t,e){switch(t){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function K1(t,e){for(var n=t.suspendedLanes,r=t.pingedLanes,i=t.expirationTimes,s=t.pendingLanes;0<s;){var o=31-Nt(s),a=1<<o,l=i[o];l===-1?(!(a&n)||a&r)&&(i[o]=Q1(a,e)):l<=e&&(t.expiredLanes|=a),s&=~a}}function nc(t){return t=t.pendingLanes&-1073741825,t!==0?t:t&1073741824?1073741824:0}function Vm(){var t=po;return po<<=1,!(po&4194240)&&(po=64),t}function Bl(t){for(var e=[],n=0;31>n;n++)e.push(t);return e}function Vs(t,e,n){t.pendingLanes|=e,e!==536870912&&(t.suspendedLanes=0,t.pingedLanes=0),t=t.eventTimes,e=31-Nt(e),t[e]=n}function J1(t,e){var n=t.pendingLanes&~e;t.pendingLanes=e,t.suspendedLanes=0,t.pingedLanes=0,t.expiredLanes&=e,t.mutableReadLanes&=e,t.entangledLanes&=e,e=t.entanglements;var r=t.eventTimes;for(t=t.expirationTimes;0<n;){var i=31-Nt(n),s=1<<i;e[i]=0,r[i]=-1,t[i]=-1,n&=~s}}function _h(t,e){var n=t.entangledLanes|=e;for(t=t.entanglements;n;){var r=31-Nt(n),i=1<<r;i&e|t[r]&e&&(t[r]|=e),n&=~i}}var ee=0;function zm(t){return t&=-t,1<t?4<t?t&268435455?16:536870912:4:1}var jm,vh,Gm,Hm,Wm,rc=!1,yo=[],Fn=null,Un=null,Bn=null,ms=new Map,ys=new Map,kn=[],ew="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function cd(t,e){switch(t){case"focusin":case"focusout":Fn=null;break;case"dragenter":case"dragleave":Un=null;break;case"mouseover":case"mouseout":Bn=null;break;case"pointerover":case"pointerout":ms.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":ys.delete(e.pointerId)}}function Di(t,e,n,r,i,s){return t===null||t.nativeEvent!==s?(t={blockedOn:e,domEventName:n,eventSystemFlags:r,nativeEvent:s,targetContainers:[i]},e!==null&&(e=js(e),e!==null&&vh(e)),t):(t.eventSystemFlags|=r,e=t.targetContainers,i!==null&&e.indexOf(i)===-1&&e.push(i),t)}function tw(t,e,n,r,i){switch(e){case"focusin":return Fn=Di(Fn,t,e,n,r,i),!0;case"dragenter":return Un=Di(Un,t,e,n,r,i),!0;case"mouseover":return Bn=Di(Bn,t,e,n,r,i),!0;case"pointerover":var s=i.pointerId;return ms.set(s,Di(ms.get(s)||null,t,e,n,r,i)),!0;case"gotpointercapture":return s=i.pointerId,ys.set(s,Di(ys.get(s)||null,t,e,n,r,i)),!0}return!1}function Xm(t){var e=ar(t.target);if(e!==null){var n=Sr(e);if(n!==null){if(e=n.tag,e===13){if(e=Om(n),e!==null){t.blockedOn=e,Wm(t.priority,function(){Gm(n)});return}}else if(e===3&&n.stateNode.current.memoizedState.isDehydrated){t.blockedOn=n.tag===3?n.stateNode.containerInfo:null;return}}}t.blockedOn=null}function zo(t){if(t.blockedOn!==null)return!1;for(var e=t.targetContainers;0<e.length;){var n=ic(t.domEventName,t.eventSystemFlags,e[0],t.nativeEvent);if(n===null){n=t.nativeEvent;var r=new n.constructor(n.type,n);Ku=r,n.target.dispatchEvent(r),Ku=null}else return e=js(n),e!==null&&vh(e),t.blockedOn=n,!1;e.shift()}return!0}function hd(t,e,n){zo(t)&&n.delete(e)}function nw(){rc=!1,Fn!==null&&zo(Fn)&&(Fn=null),Un!==null&&zo(Un)&&(Un=null),Bn!==null&&zo(Bn)&&(Bn=null),ms.forEach(hd),ys.forEach(hd)}function Fi(t,e){t.blockedOn===e&&(t.blockedOn=null,rc||(rc=!0,ft.unstable_scheduleCallback(ft.unstable_NormalPriority,nw)))}function _s(t){function e(i){return Fi(i,t)}if(0<yo.length){Fi(yo[0],t);for(var n=1;n<yo.length;n++){var r=yo[n];r.blockedOn===t&&(r.blockedOn=null)}}for(Fn!==null&&Fi(Fn,t),Un!==null&&Fi(Un,t),Bn!==null&&Fi(Bn,t),ms.forEach(e),ys.forEach(e),n=0;n<kn.length;n++)r=kn[n],r.blockedOn===t&&(r.blockedOn=null);for(;0<kn.length&&(n=kn[0],n.blockedOn===null);)Xm(n),n.blockedOn===null&&kn.shift()}var ti=wn.ReactCurrentBatchConfig,ha=!0;function rw(t,e,n,r){var i=ee,s=ti.transition;ti.transition=null;try{ee=1,wh(t,e,n,r)}finally{ee=i,ti.transition=s}}function iw(t,e,n,r){var i=ee,s=ti.transition;ti.transition=null;try{ee=4,wh(t,e,n,r)}finally{ee=i,ti.transition=s}}function wh(t,e,n,r){if(ha){var i=ic(t,e,n,r);if(i===null)ql(t,e,r,fa,n),cd(t,r);else if(tw(i,t,e,n,r))r.stopPropagation();else if(cd(t,r),e&4&&-1<ew.indexOf(t)){for(;i!==null;){var s=js(i);if(s!==null&&jm(s),s=ic(t,e,n,r),s===null&&ql(t,e,r,fa,n),s===i)break;i=s}i!==null&&r.stopPropagation()}else ql(t,e,r,null,n)}}var fa=null;function ic(t,e,n,r){if(fa=null,t=mh(r),t=ar(t),t!==null)if(e=Sr(t),e===null)t=null;else if(n=e.tag,n===13){if(t=Om(e),t!==null)return t;t=null}else if(n===3){if(e.stateNode.current.memoizedState.isDehydrated)return e.tag===3?e.stateNode.containerInfo:null;t=null}else e!==t&&(t=null);return fa=t,null}function Ym(t){switch(t){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(W1()){case yh:return 1;case Um:return 4;case ua:case X1:return 16;case Bm:return 536870912;default:return 16}default:return 16}}var On=null,Eh=null,jo=null;function $m(){if(jo)return jo;var t,e=Eh,n=e.length,r,i="value"in On?On.value:On.textContent,s=i.length;for(t=0;t<n&&e[t]===i[t];t++);var o=n-t;for(r=1;r<=o&&e[n-r]===i[s-r];r++);return jo=i.slice(t,1<r?1-r:void 0)}function Go(t){var e=t.keyCode;return"charCode"in t?(t=t.charCode,t===0&&e===13&&(t=13)):t=e,t===10&&(t=13),32<=t||t===13?t:0}function _o(){return!0}function fd(){return!1}function pt(t){function e(n,r,i,s,o){this._reactName=n,this._targetInst=i,this.type=r,this.nativeEvent=s,this.target=o,this.currentTarget=null;for(var a in t)t.hasOwnProperty(a)&&(n=t[a],this[a]=n?n(s):s[a]);return this.isDefaultPrevented=(s.defaultPrevented!=null?s.defaultPrevented:s.returnValue===!1)?_o:fd,this.isPropagationStopped=fd,this}return de(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var n=this.nativeEvent;n&&(n.preventDefault?n.preventDefault():typeof n.returnValue!="unknown"&&(n.returnValue=!1),this.isDefaultPrevented=_o)},stopPropagation:function(){var n=this.nativeEvent;n&&(n.stopPropagation?n.stopPropagation():typeof n.cancelBubble!="unknown"&&(n.cancelBubble=!0),this.isPropagationStopped=_o)},persist:function(){},isPersistent:_o}),e}var Ti={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(t){return t.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Th=pt(Ti),zs=de({},Ti,{view:0,detail:0}),sw=pt(zs),Vl,zl,Ui,Ka=de({},zs,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:bh,button:0,buttons:0,relatedTarget:function(t){return t.relatedTarget===void 0?t.fromElement===t.srcElement?t.toElement:t.fromElement:t.relatedTarget},movementX:function(t){return"movementX"in t?t.movementX:(t!==Ui&&(Ui&&t.type==="mousemove"?(Vl=t.screenX-Ui.screenX,zl=t.screenY-Ui.screenY):zl=Vl=0,Ui=t),Vl)},movementY:function(t){return"movementY"in t?t.movementY:zl}}),dd=pt(Ka),ow=de({},Ka,{dataTransfer:0}),aw=pt(ow),lw=de({},zs,{relatedTarget:0}),jl=pt(lw),uw=de({},Ti,{animationName:0,elapsedTime:0,pseudoElement:0}),cw=pt(uw),hw=de({},Ti,{clipboardData:function(t){return"clipboardData"in t?t.clipboardData:window.clipboardData}}),fw=pt(hw),dw=de({},Ti,{data:0}),gd=pt(dw),gw={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},pw={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},mw={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function yw(t){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(t):(t=mw[t])?!!e[t]:!1}function bh(){return yw}var _w=de({},zs,{key:function(t){if(t.key){var e=gw[t.key]||t.key;if(e!=="Unidentified")return e}return t.type==="keypress"?(t=Go(t),t===13?"Enter":String.fromCharCode(t)):t.type==="keydown"||t.type==="keyup"?pw[t.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:bh,charCode:function(t){return t.type==="keypress"?Go(t):0},keyCode:function(t){return t.type==="keydown"||t.type==="keyup"?t.keyCode:0},which:function(t){return t.type==="keypress"?Go(t):t.type==="keydown"||t.type==="keyup"?t.keyCode:0}}),vw=pt(_w),ww=de({},Ka,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),pd=pt(ww),Ew=de({},zs,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:bh}),Tw=pt(Ew),bw=de({},Ti,{propertyName:0,elapsedTime:0,pseudoElement:0}),Sw=pt(bw),Aw=de({},Ka,{deltaX:function(t){return"deltaX"in t?t.deltaX:"wheelDeltaX"in t?-t.wheelDeltaX:0},deltaY:function(t){return"deltaY"in t?t.deltaY:"wheelDeltaY"in t?-t.wheelDeltaY:"wheelDelta"in t?-t.wheelDelta:0},deltaZ:0,deltaMode:0}),xw=pt(Aw),Pw=[9,13,27,32],Sh=fn&&"CompositionEvent"in window,ns=null;fn&&"documentMode"in document&&(ns=document.documentMode);var Cw=fn&&"TextEvent"in window&&!ns,qm=fn&&(!Sh||ns&&8<ns&&11>=ns),md=String.fromCharCode(32),yd=!1;function Zm(t,e){switch(t){case"keyup":return Pw.indexOf(e.keyCode)!==-1;case"keydown":return e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Qm(t){return t=t.detail,typeof t=="object"&&"data"in t?t.data:null}var Vr=!1;function Lw(t,e){switch(t){case"compositionend":return Qm(e);case"keypress":return e.which!==32?null:(yd=!0,md);case"textInput":return t=e.data,t===md&&yd?null:t;default:return null}}function Rw(t,e){if(Vr)return t==="compositionend"||!Sh&&Zm(t,e)?(t=$m(),jo=Eh=On=null,Vr=!1,t):null;switch(t){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return qm&&e.locale!=="ko"?null:e.data;default:return null}}var Mw={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function _d(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e==="input"?!!Mw[t.type]:e==="textarea"}function Km(t,e,n,r){Lm(r),e=da(e,"onChange"),0<e.length&&(n=new Th("onChange","change",null,n,r),t.push({event:n,listeners:e}))}var rs=null,vs=null;function kw(t){u0(t,0)}function Ja(t){var e=Gr(t);if(Tm(e))return t}function Iw(t,e){if(t==="change")return e}var Jm=!1;if(fn){var Gl;if(fn){var Hl="oninput"in document;if(!Hl){var vd=document.createElement("div");vd.setAttribute("oninput","return;"),Hl=typeof vd.oninput=="function"}Gl=Hl}else Gl=!1;Jm=Gl&&(!document.documentMode||9<document.documentMode)}function wd(){rs&&(rs.detachEvent("onpropertychange",e0),vs=rs=null)}function e0(t){if(t.propertyName==="value"&&Ja(vs)){var e=[];Km(e,vs,t,mh(t)),Im(kw,e)}}function Ow(t,e,n){t==="focusin"?(wd(),rs=e,vs=n,rs.attachEvent("onpropertychange",e0)):t==="focusout"&&wd()}function Nw(t){if(t==="selectionchange"||t==="keyup"||t==="keydown")return Ja(vs)}function Dw(t,e){if(t==="click")return Ja(e)}function Fw(t,e){if(t==="input"||t==="change")return Ja(e)}function Uw(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var Ut=typeof Object.is=="function"?Object.is:Uw;function ws(t,e){if(Ut(t,e))return!0;if(typeof t!="object"||t===null||typeof e!="object"||e===null)return!1;var n=Object.keys(t),r=Object.keys(e);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++){var i=n[r];if(!Vu.call(e,i)||!Ut(t[i],e[i]))return!1}return!0}function Ed(t){for(;t&&t.firstChild;)t=t.firstChild;return t}function Td(t,e){var n=Ed(t);t=0;for(var r;n;){if(n.nodeType===3){if(r=t+n.textContent.length,t<=e&&r>=e)return{node:n,offset:e-t};t=r}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=Ed(n)}}function t0(t,e){return t&&e?t===e?!0:t&&t.nodeType===3?!1:e&&e.nodeType===3?t0(t,e.parentNode):"contains"in t?t.contains(e):t.compareDocumentPosition?!!(t.compareDocumentPosition(e)&16):!1:!1}function n0(){for(var t=window,e=oa();e instanceof t.HTMLIFrameElement;){try{var n=typeof e.contentWindow.location.href=="string"}catch{n=!1}if(n)t=e.contentWindow;else break;e=oa(t.document)}return e}function Ah(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e&&(e==="input"&&(t.type==="text"||t.type==="search"||t.type==="tel"||t.type==="url"||t.type==="password")||e==="textarea"||t.contentEditable==="true")}function Bw(t){var e=n0(),n=t.focusedElem,r=t.selectionRange;if(e!==n&&n&&n.ownerDocument&&t0(n.ownerDocument.documentElement,n)){if(r!==null&&Ah(n)){if(e=r.start,t=r.end,t===void 0&&(t=e),"selectionStart"in n)n.selectionStart=e,n.selectionEnd=Math.min(t,n.value.length);else if(t=(e=n.ownerDocument||document)&&e.defaultView||window,t.getSelection){t=t.getSelection();var i=n.textContent.length,s=Math.min(r.start,i);r=r.end===void 0?s:Math.min(r.end,i),!t.extend&&s>r&&(i=r,r=s,s=i),i=Td(n,s);var o=Td(n,r);i&&o&&(t.rangeCount!==1||t.anchorNode!==i.node||t.anchorOffset!==i.offset||t.focusNode!==o.node||t.focusOffset!==o.offset)&&(e=e.createRange(),e.setStart(i.node,i.offset),t.removeAllRanges(),s>r?(t.addRange(e),t.extend(o.node,o.offset)):(e.setEnd(o.node,o.offset),t.addRange(e)))}}for(e=[],t=n;t=t.parentNode;)t.nodeType===1&&e.push({element:t,left:t.scrollLeft,top:t.scrollTop});for(typeof n.focus=="function"&&n.focus(),n=0;n<e.length;n++)t=e[n],t.element.scrollLeft=t.left,t.element.scrollTop=t.top}}var Vw=fn&&"documentMode"in document&&11>=document.documentMode,zr=null,sc=null,is=null,oc=!1;function bd(t,e,n){var r=n.window===n?n.document:n.nodeType===9?n:n.ownerDocument;oc||zr==null||zr!==oa(r)||(r=zr,"selectionStart"in r&&Ah(r)?r={start:r.selectionStart,end:r.selectionEnd}:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection(),r={anchorNode:r.anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset}),is&&ws(is,r)||(is=r,r=da(sc,"onSelect"),0<r.length&&(e=new Th("onSelect","select",null,e,n),t.push({event:e,listeners:r}),e.target=zr)))}function vo(t,e){var n={};return n[t.toLowerCase()]=e.toLowerCase(),n["Webkit"+t]="webkit"+e,n["Moz"+t]="moz"+e,n}var jr={animationend:vo("Animation","AnimationEnd"),animationiteration:vo("Animation","AnimationIteration"),animationstart:vo("Animation","AnimationStart"),transitionend:vo("Transition","TransitionEnd")},Wl={},r0={};fn&&(r0=document.createElement("div").style,"AnimationEvent"in window||(delete jr.animationend.animation,delete jr.animationiteration.animation,delete jr.animationstart.animation),"TransitionEvent"in window||delete jr.transitionend.transition);function el(t){if(Wl[t])return Wl[t];if(!jr[t])return t;var e=jr[t],n;for(n in e)if(e.hasOwnProperty(n)&&n in r0)return Wl[t]=e[n];return t}var i0=el("animationend"),s0=el("animationiteration"),o0=el("animationstart"),a0=el("transitionend"),l0=new Map,Sd="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function qn(t,e){l0.set(t,e),br(e,[t])}for(var Xl=0;Xl<Sd.length;Xl++){var Yl=Sd[Xl],zw=Yl.toLowerCase(),jw=Yl[0].toUpperCase()+Yl.slice(1);qn(zw,"on"+jw)}qn(i0,"onAnimationEnd");qn(s0,"onAnimationIteration");qn(o0,"onAnimationStart");qn("dblclick","onDoubleClick");qn("focusin","onFocus");qn("focusout","onBlur");qn(a0,"onTransitionEnd");oi("onMouseEnter",["mouseout","mouseover"]);oi("onMouseLeave",["mouseout","mouseover"]);oi("onPointerEnter",["pointerout","pointerover"]);oi("onPointerLeave",["pointerout","pointerover"]);br("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));br("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));br("onBeforeInput",["compositionend","keypress","textInput","paste"]);br("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));br("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));br("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Qi="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Gw=new Set("cancel close invalid load scroll toggle".split(" ").concat(Qi));function Ad(t,e,n){var r=t.type||"unknown-event";t.currentTarget=n,z1(r,e,void 0,t),t.currentTarget=null}function u0(t,e){e=(e&4)!==0;for(var n=0;n<t.length;n++){var r=t[n],i=r.event;r=r.listeners;e:{var s=void 0;if(e)for(var o=r.length-1;0<=o;o--){var a=r[o],l=a.instance,u=a.currentTarget;if(a=a.listener,l!==s&&i.isPropagationStopped())break e;Ad(i,a,u),s=l}else for(o=0;o<r.length;o++){if(a=r[o],l=a.instance,u=a.currentTarget,a=a.listener,l!==s&&i.isPropagationStopped())break e;Ad(i,a,u),s=l}}}if(la)throw t=tc,la=!1,tc=null,t}function oe(t,e){var n=e[hc];n===void 0&&(n=e[hc]=new Set);var r=t+"__bubble";n.has(r)||(c0(e,t,2,!1),n.add(r))}function $l(t,e,n){var r=0;e&&(r|=4),c0(n,t,r,e)}var wo="_reactListening"+Math.random().toString(36).slice(2);function Es(t){if(!t[wo]){t[wo]=!0,ym.forEach(function(n){n!=="selectionchange"&&(Gw.has(n)||$l(n,!1,t),$l(n,!0,t))});var e=t.nodeType===9?t:t.ownerDocument;e===null||e[wo]||(e[wo]=!0,$l("selectionchange",!1,e))}}function c0(t,e,n,r){switch(Ym(e)){case 1:var i=rw;break;case 4:i=iw;break;default:i=wh}n=i.bind(null,e,n,t),i=void 0,!ec||e!=="touchstart"&&e!=="touchmove"&&e!=="wheel"||(i=!0),r?i!==void 0?t.addEventListener(e,n,{capture:!0,passive:i}):t.addEventListener(e,n,!0):i!==void 0?t.addEventListener(e,n,{passive:i}):t.addEventListener(e,n,!1)}function ql(t,e,n,r,i){var s=r;if(!(e&1)&&!(e&2)&&r!==null)e:for(;;){if(r===null)return;var o=r.tag;if(o===3||o===4){var a=r.stateNode.containerInfo;if(a===i||a.nodeType===8&&a.parentNode===i)break;if(o===4)for(o=r.return;o!==null;){var l=o.tag;if((l===3||l===4)&&(l=o.stateNode.containerInfo,l===i||l.nodeType===8&&l.parentNode===i))return;o=o.return}for(;a!==null;){if(o=ar(a),o===null)return;if(l=o.tag,l===5||l===6){r=s=o;continue e}a=a.parentNode}}r=r.return}Im(function(){var u=s,c=mh(n),h=[];e:{var f=l0.get(t);if(f!==void 0){var g=Th,w=t;switch(t){case"keypress":if(Go(n)===0)break e;case"keydown":case"keyup":g=vw;break;case"focusin":w="focus",g=jl;break;case"focusout":w="blur",g=jl;break;case"beforeblur":case"afterblur":g=jl;break;case"click":if(n.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":g=dd;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":g=aw;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":g=Tw;break;case i0:case s0:case o0:g=cw;break;case a0:g=Sw;break;case"scroll":g=sw;break;case"wheel":g=xw;break;case"copy":case"cut":case"paste":g=fw;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":g=pd}var E=(e&4)!==0,T=!E&&t==="scroll",y=E?f!==null?f+"Capture":null:f;E=[];for(var m=u,_;m!==null;){_=m;var S=_.stateNode;if(_.tag===5&&S!==null&&(_=S,y!==null&&(S=ps(m,y),S!=null&&E.push(Ts(m,S,_)))),T)break;m=m.return}0<E.length&&(f=new g(f,w,null,n,c),h.push({event:f,listeners:E}))}}if(!(e&7)){e:{if(f=t==="mouseover"||t==="pointerover",g=t==="mouseout"||t==="pointerout",f&&n!==Ku&&(w=n.relatedTarget||n.fromElement)&&(ar(w)||w[dn]))break e;if((g||f)&&(f=c.window===c?c:(f=c.ownerDocument)?f.defaultView||f.parentWindow:window,g?(w=n.relatedTarget||n.toElement,g=u,w=w?ar(w):null,w!==null&&(T=Sr(w),w!==T||w.tag!==5&&w.tag!==6)&&(w=null)):(g=null,w=u),g!==w)){if(E=dd,S="onMouseLeave",y="onMouseEnter",m="mouse",(t==="pointerout"||t==="pointerover")&&(E=pd,S="onPointerLeave",y="onPointerEnter",m="pointer"),T=g==null?f:Gr(g),_=w==null?f:Gr(w),f=new E(S,m+"leave",g,n,c),f.target=T,f.relatedTarget=_,S=null,ar(c)===u&&(E=new E(y,m+"enter",w,n,c),E.target=_,E.relatedTarget=T,S=E),T=S,g&&w)t:{for(E=g,y=w,m=0,_=E;_;_=Cr(_))m++;for(_=0,S=y;S;S=Cr(S))_++;for(;0<m-_;)E=Cr(E),m--;for(;0<_-m;)y=Cr(y),_--;for(;m--;){if(E===y||y!==null&&E===y.alternate)break t;E=Cr(E),y=Cr(y)}E=null}else E=null;g!==null&&xd(h,f,g,E,!1),w!==null&&T!==null&&xd(h,T,w,E,!0)}}e:{if(f=u?Gr(u):window,g=f.nodeName&&f.nodeName.toLowerCase(),g==="select"||g==="input"&&f.type==="file")var A=Iw;else if(_d(f))if(Jm)A=Fw;else{A=Nw;var P=Ow}else(g=f.nodeName)&&g.toLowerCase()==="input"&&(f.type==="checkbox"||f.type==="radio")&&(A=Dw);if(A&&(A=A(t,u))){Km(h,A,n,c);break e}P&&P(t,f,u),t==="focusout"&&(P=f._wrapperState)&&P.controlled&&f.type==="number"&&Yu(f,"number",f.value)}switch(P=u?Gr(u):window,t){case"focusin":(_d(P)||P.contentEditable==="true")&&(zr=P,sc=u,is=null);break;case"focusout":is=sc=zr=null;break;case"mousedown":oc=!0;break;case"contextmenu":case"mouseup":case"dragend":oc=!1,bd(h,n,c);break;case"selectionchange":if(Vw)break;case"keydown":case"keyup":bd(h,n,c)}var L;if(Sh)e:{switch(t){case"compositionstart":var C="onCompositionStart";break e;case"compositionend":C="onCompositionEnd";break e;case"compositionupdate":C="onCompositionUpdate";break e}C=void 0}else Vr?Zm(t,n)&&(C="onCompositionEnd"):t==="keydown"&&n.keyCode===229&&(C="onCompositionStart");C&&(qm&&n.locale!=="ko"&&(Vr||C!=="onCompositionStart"?C==="onCompositionEnd"&&Vr&&(L=$m()):(On=c,Eh="value"in On?On.value:On.textContent,Vr=!0)),P=da(u,C),0<P.length&&(C=new gd(C,t,null,n,c),h.push({event:C,listeners:P}),L?C.data=L:(L=Qm(n),L!==null&&(C.data=L)))),(L=Cw?Lw(t,n):Rw(t,n))&&(u=da(u,"onBeforeInput"),0<u.length&&(c=new gd("onBeforeInput","beforeinput",null,n,c),h.push({event:c,listeners:u}),c.data=L))}u0(h,e)})}function Ts(t,e,n){return{instance:t,listener:e,currentTarget:n}}function da(t,e){for(var n=e+"Capture",r=[];t!==null;){var i=t,s=i.stateNode;i.tag===5&&s!==null&&(i=s,s=ps(t,n),s!=null&&r.unshift(Ts(t,s,i)),s=ps(t,e),s!=null&&r.push(Ts(t,s,i))),t=t.return}return r}function Cr(t){if(t===null)return null;do t=t.return;while(t&&t.tag!==5);return t||null}function xd(t,e,n,r,i){for(var s=e._reactName,o=[];n!==null&&n!==r;){var a=n,l=a.alternate,u=a.stateNode;if(l!==null&&l===r)break;a.tag===5&&u!==null&&(a=u,i?(l=ps(n,s),l!=null&&o.unshift(Ts(n,l,a))):i||(l=ps(n,s),l!=null&&o.push(Ts(n,l,a)))),n=n.return}o.length!==0&&t.push({event:e,listeners:o})}var Hw=/\r\n?/g,Ww=/\u0000|\uFFFD/g;function Pd(t){return(typeof t=="string"?t:""+t).replace(Hw,`
`).replace(Ww,"")}function Eo(t,e,n){if(e=Pd(e),Pd(t)!==e&&n)throw Error(I(425))}function ga(){}var ac=null,lc=null;function uc(t,e){return t==="textarea"||t==="noscript"||typeof e.children=="string"||typeof e.children=="number"||typeof e.dangerouslySetInnerHTML=="object"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var cc=typeof setTimeout=="function"?setTimeout:void 0,Xw=typeof clearTimeout=="function"?clearTimeout:void 0,Cd=typeof Promise=="function"?Promise:void 0,Yw=typeof queueMicrotask=="function"?queueMicrotask:typeof Cd<"u"?function(t){return Cd.resolve(null).then(t).catch($w)}:cc;function $w(t){setTimeout(function(){throw t})}function Zl(t,e){var n=e,r=0;do{var i=n.nextSibling;if(t.removeChild(n),i&&i.nodeType===8)if(n=i.data,n==="/$"){if(r===0){t.removeChild(i),_s(e);return}r--}else n!=="$"&&n!=="$?"&&n!=="$!"||r++;n=i}while(n);_s(e)}function Vn(t){for(;t!=null;t=t.nextSibling){var e=t.nodeType;if(e===1||e===3)break;if(e===8){if(e=t.data,e==="$"||e==="$!"||e==="$?")break;if(e==="/$")return null}}return t}function Ld(t){t=t.previousSibling;for(var e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="$"||n==="$!"||n==="$?"){if(e===0)return t;e--}else n==="/$"&&e++}t=t.previousSibling}return null}var bi=Math.random().toString(36).slice(2),Yt="__reactFiber$"+bi,bs="__reactProps$"+bi,dn="__reactContainer$"+bi,hc="__reactEvents$"+bi,qw="__reactListeners$"+bi,Zw="__reactHandles$"+bi;function ar(t){var e=t[Yt];if(e)return e;for(var n=t.parentNode;n;){if(e=n[dn]||n[Yt]){if(n=e.alternate,e.child!==null||n!==null&&n.child!==null)for(t=Ld(t);t!==null;){if(n=t[Yt])return n;t=Ld(t)}return e}t=n,n=t.parentNode}return null}function js(t){return t=t[Yt]||t[dn],!t||t.tag!==5&&t.tag!==6&&t.tag!==13&&t.tag!==3?null:t}function Gr(t){if(t.tag===5||t.tag===6)return t.stateNode;throw Error(I(33))}function tl(t){return t[bs]||null}var fc=[],Hr=-1;function Zn(t){return{current:t}}function le(t){0>Hr||(t.current=fc[Hr],fc[Hr]=null,Hr--)}function ie(t,e){Hr++,fc[Hr]=t.current,t.current=e}var Yn={},Ve=Zn(Yn),Je=Zn(!1),gr=Yn;function ai(t,e){var n=t.type.contextTypes;if(!n)return Yn;var r=t.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===e)return r.__reactInternalMemoizedMaskedChildContext;var i={},s;for(s in n)i[s]=e[s];return r&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=e,t.__reactInternalMemoizedMaskedChildContext=i),i}function et(t){return t=t.childContextTypes,t!=null}function pa(){le(Je),le(Ve)}function Rd(t,e,n){if(Ve.current!==Yn)throw Error(I(168));ie(Ve,e),ie(Je,n)}function h0(t,e,n){var r=t.stateNode;if(e=e.childContextTypes,typeof r.getChildContext!="function")return n;r=r.getChildContext();for(var i in r)if(!(i in e))throw Error(I(108,O1(t)||"Unknown",i));return de({},n,r)}function ma(t){return t=(t=t.stateNode)&&t.__reactInternalMemoizedMergedChildContext||Yn,gr=Ve.current,ie(Ve,t),ie(Je,Je.current),!0}function Md(t,e,n){var r=t.stateNode;if(!r)throw Error(I(169));n?(t=h0(t,e,gr),r.__reactInternalMemoizedMergedChildContext=t,le(Je),le(Ve),ie(Ve,t)):le(Je),ie(Je,n)}var an=null,nl=!1,Ql=!1;function f0(t){an===null?an=[t]:an.push(t)}function Qw(t){nl=!0,f0(t)}function Qn(){if(!Ql&&an!==null){Ql=!0;var t=0,e=ee;try{var n=an;for(ee=1;t<n.length;t++){var r=n[t];do r=r(!0);while(r!==null)}an=null,nl=!1}catch(i){throw an!==null&&(an=an.slice(t+1)),Fm(yh,Qn),i}finally{ee=e,Ql=!1}}return null}var Wr=[],Xr=0,ya=null,_a=0,wt=[],Et=0,pr=null,un=1,cn="";function ir(t,e){Wr[Xr++]=_a,Wr[Xr++]=ya,ya=t,_a=e}function d0(t,e,n){wt[Et++]=un,wt[Et++]=cn,wt[Et++]=pr,pr=t;var r=un;t=cn;var i=32-Nt(r)-1;r&=~(1<<i),n+=1;var s=32-Nt(e)+i;if(30<s){var o=i-i%5;s=(r&(1<<o)-1).toString(32),r>>=o,i-=o,un=1<<32-Nt(e)+i|n<<i|r,cn=s+t}else un=1<<s|n<<i|r,cn=t}function xh(t){t.return!==null&&(ir(t,1),d0(t,1,0))}function Ph(t){for(;t===ya;)ya=Wr[--Xr],Wr[Xr]=null,_a=Wr[--Xr],Wr[Xr]=null;for(;t===pr;)pr=wt[--Et],wt[Et]=null,cn=wt[--Et],wt[Et]=null,un=wt[--Et],wt[Et]=null}var ct=null,lt=null,ce=!1,It=null;function g0(t,e){var n=Tt(5,null,null,0);n.elementType="DELETED",n.stateNode=e,n.return=t,e=t.deletions,e===null?(t.deletions=[n],t.flags|=16):e.push(n)}function kd(t,e){switch(t.tag){case 5:var n=t.type;return e=e.nodeType!==1||n.toLowerCase()!==e.nodeName.toLowerCase()?null:e,e!==null?(t.stateNode=e,ct=t,lt=Vn(e.firstChild),!0):!1;case 6:return e=t.pendingProps===""||e.nodeType!==3?null:e,e!==null?(t.stateNode=e,ct=t,lt=null,!0):!1;case 13:return e=e.nodeType!==8?null:e,e!==null?(n=pr!==null?{id:un,overflow:cn}:null,t.memoizedState={dehydrated:e,treeContext:n,retryLane:1073741824},n=Tt(18,null,null,0),n.stateNode=e,n.return=t,t.child=n,ct=t,lt=null,!0):!1;default:return!1}}function dc(t){return(t.mode&1)!==0&&(t.flags&128)===0}function gc(t){if(ce){var e=lt;if(e){var n=e;if(!kd(t,e)){if(dc(t))throw Error(I(418));e=Vn(n.nextSibling);var r=ct;e&&kd(t,e)?g0(r,n):(t.flags=t.flags&-4097|2,ce=!1,ct=t)}}else{if(dc(t))throw Error(I(418));t.flags=t.flags&-4097|2,ce=!1,ct=t}}}function Id(t){for(t=t.return;t!==null&&t.tag!==5&&t.tag!==3&&t.tag!==13;)t=t.return;ct=t}function To(t){if(t!==ct)return!1;if(!ce)return Id(t),ce=!0,!1;var e;if((e=t.tag!==3)&&!(e=t.tag!==5)&&(e=t.type,e=e!=="head"&&e!=="body"&&!uc(t.type,t.memoizedProps)),e&&(e=lt)){if(dc(t))throw p0(),Error(I(418));for(;e;)g0(t,e),e=Vn(e.nextSibling)}if(Id(t),t.tag===13){if(t=t.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(I(317));e:{for(t=t.nextSibling,e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="/$"){if(e===0){lt=Vn(t.nextSibling);break e}e--}else n!=="$"&&n!=="$!"&&n!=="$?"||e++}t=t.nextSibling}lt=null}}else lt=ct?Vn(t.stateNode.nextSibling):null;return!0}function p0(){for(var t=lt;t;)t=Vn(t.nextSibling)}function li(){lt=ct=null,ce=!1}function Ch(t){It===null?It=[t]:It.push(t)}var Kw=wn.ReactCurrentBatchConfig;function Mt(t,e){if(t&&t.defaultProps){e=de({},e),t=t.defaultProps;for(var n in t)e[n]===void 0&&(e[n]=t[n]);return e}return e}var va=Zn(null),wa=null,Yr=null,Lh=null;function Rh(){Lh=Yr=wa=null}function Mh(t){var e=va.current;le(va),t._currentValue=e}function pc(t,e,n){for(;t!==null;){var r=t.alternate;if((t.childLanes&e)!==e?(t.childLanes|=e,r!==null&&(r.childLanes|=e)):r!==null&&(r.childLanes&e)!==e&&(r.childLanes|=e),t===n)break;t=t.return}}function ni(t,e){wa=t,Lh=Yr=null,t=t.dependencies,t!==null&&t.firstContext!==null&&(t.lanes&e&&(Ke=!0),t.firstContext=null)}function At(t){var e=t._currentValue;if(Lh!==t)if(t={context:t,memoizedValue:e,next:null},Yr===null){if(wa===null)throw Error(I(308));Yr=t,wa.dependencies={lanes:0,firstContext:t}}else Yr=Yr.next=t;return e}var lr=null;function kh(t){lr===null?lr=[t]:lr.push(t)}function m0(t,e,n,r){var i=e.interleaved;return i===null?(n.next=n,kh(e)):(n.next=i.next,i.next=n),e.interleaved=n,gn(t,r)}function gn(t,e){t.lanes|=e;var n=t.alternate;for(n!==null&&(n.lanes|=e),n=t,t=t.return;t!==null;)t.childLanes|=e,n=t.alternate,n!==null&&(n.childLanes|=e),n=t,t=t.return;return n.tag===3?n.stateNode:null}var Mn=!1;function Ih(t){t.updateQueue={baseState:t.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function y0(t,e){t=t.updateQueue,e.updateQueue===t&&(e.updateQueue={baseState:t.baseState,firstBaseUpdate:t.firstBaseUpdate,lastBaseUpdate:t.lastBaseUpdate,shared:t.shared,effects:t.effects})}function hn(t,e){return{eventTime:t,lane:e,tag:0,payload:null,callback:null,next:null}}function zn(t,e,n){var r=t.updateQueue;if(r===null)return null;if(r=r.shared,Z&2){var i=r.pending;return i===null?e.next=e:(e.next=i.next,i.next=e),r.pending=e,gn(t,n)}return i=r.interleaved,i===null?(e.next=e,kh(r)):(e.next=i.next,i.next=e),r.interleaved=e,gn(t,n)}function Ho(t,e,n){if(e=e.updateQueue,e!==null&&(e=e.shared,(n&4194240)!==0)){var r=e.lanes;r&=t.pendingLanes,n|=r,e.lanes=n,_h(t,n)}}function Od(t,e){var n=t.updateQueue,r=t.alternate;if(r!==null&&(r=r.updateQueue,n===r)){var i=null,s=null;if(n=n.firstBaseUpdate,n!==null){do{var o={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};s===null?i=s=o:s=s.next=o,n=n.next}while(n!==null);s===null?i=s=e:s=s.next=e}else i=s=e;n={baseState:r.baseState,firstBaseUpdate:i,lastBaseUpdate:s,shared:r.shared,effects:r.effects},t.updateQueue=n;return}t=n.lastBaseUpdate,t===null?n.firstBaseUpdate=e:t.next=e,n.lastBaseUpdate=e}function Ea(t,e,n,r){var i=t.updateQueue;Mn=!1;var s=i.firstBaseUpdate,o=i.lastBaseUpdate,a=i.shared.pending;if(a!==null){i.shared.pending=null;var l=a,u=l.next;l.next=null,o===null?s=u:o.next=u,o=l;var c=t.alternate;c!==null&&(c=c.updateQueue,a=c.lastBaseUpdate,a!==o&&(a===null?c.firstBaseUpdate=u:a.next=u,c.lastBaseUpdate=l))}if(s!==null){var h=i.baseState;o=0,c=u=l=null,a=s;do{var f=a.lane,g=a.eventTime;if((r&f)===f){c!==null&&(c=c.next={eventTime:g,lane:0,tag:a.tag,payload:a.payload,callback:a.callback,next:null});e:{var w=t,E=a;switch(f=e,g=n,E.tag){case 1:if(w=E.payload,typeof w=="function"){h=w.call(g,h,f);break e}h=w;break e;case 3:w.flags=w.flags&-65537|128;case 0:if(w=E.payload,f=typeof w=="function"?w.call(g,h,f):w,f==null)break e;h=de({},h,f);break e;case 2:Mn=!0}}a.callback!==null&&a.lane!==0&&(t.flags|=64,f=i.effects,f===null?i.effects=[a]:f.push(a))}else g={eventTime:g,lane:f,tag:a.tag,payload:a.payload,callback:a.callback,next:null},c===null?(u=c=g,l=h):c=c.next=g,o|=f;if(a=a.next,a===null){if(a=i.shared.pending,a===null)break;f=a,a=f.next,f.next=null,i.lastBaseUpdate=f,i.shared.pending=null}}while(1);if(c===null&&(l=h),i.baseState=l,i.firstBaseUpdate=u,i.lastBaseUpdate=c,e=i.shared.interleaved,e!==null){i=e;do o|=i.lane,i=i.next;while(i!==e)}else s===null&&(i.shared.lanes=0);yr|=o,t.lanes=o,t.memoizedState=h}}function Nd(t,e,n){if(t=e.effects,e.effects=null,t!==null)for(e=0;e<t.length;e++){var r=t[e],i=r.callback;if(i!==null){if(r.callback=null,r=n,typeof i!="function")throw Error(I(191,i));i.call(r)}}}var _0=new mm.Component().refs;function mc(t,e,n,r){e=t.memoizedState,n=n(r,e),n=n==null?e:de({},e,n),t.memoizedState=n,t.lanes===0&&(t.updateQueue.baseState=n)}var rl={isMounted:function(t){return(t=t._reactInternals)?Sr(t)===t:!1},enqueueSetState:function(t,e,n){t=t._reactInternals;var r=Xe(),i=Gn(t),s=hn(r,i);s.payload=e,n!=null&&(s.callback=n),e=zn(t,s,i),e!==null&&(Dt(e,t,i,r),Ho(e,t,i))},enqueueReplaceState:function(t,e,n){t=t._reactInternals;var r=Xe(),i=Gn(t),s=hn(r,i);s.tag=1,s.payload=e,n!=null&&(s.callback=n),e=zn(t,s,i),e!==null&&(Dt(e,t,i,r),Ho(e,t,i))},enqueueForceUpdate:function(t,e){t=t._reactInternals;var n=Xe(),r=Gn(t),i=hn(n,r);i.tag=2,e!=null&&(i.callback=e),e=zn(t,i,r),e!==null&&(Dt(e,t,r,n),Ho(e,t,r))}};function Dd(t,e,n,r,i,s,o){return t=t.stateNode,typeof t.shouldComponentUpdate=="function"?t.shouldComponentUpdate(r,s,o):e.prototype&&e.prototype.isPureReactComponent?!ws(n,r)||!ws(i,s):!0}function v0(t,e,n){var r=!1,i=Yn,s=e.contextType;return typeof s=="object"&&s!==null?s=At(s):(i=et(e)?gr:Ve.current,r=e.contextTypes,s=(r=r!=null)?ai(t,i):Yn),e=new e(n,s),t.memoizedState=e.state!==null&&e.state!==void 0?e.state:null,e.updater=rl,t.stateNode=e,e._reactInternals=t,r&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=i,t.__reactInternalMemoizedMaskedChildContext=s),e}function Fd(t,e,n,r){t=e.state,typeof e.componentWillReceiveProps=="function"&&e.componentWillReceiveProps(n,r),typeof e.UNSAFE_componentWillReceiveProps=="function"&&e.UNSAFE_componentWillReceiveProps(n,r),e.state!==t&&rl.enqueueReplaceState(e,e.state,null)}function yc(t,e,n,r){var i=t.stateNode;i.props=n,i.state=t.memoizedState,i.refs=_0,Ih(t);var s=e.contextType;typeof s=="object"&&s!==null?i.context=At(s):(s=et(e)?gr:Ve.current,i.context=ai(t,s)),i.state=t.memoizedState,s=e.getDerivedStateFromProps,typeof s=="function"&&(mc(t,e,s,n),i.state=t.memoizedState),typeof e.getDerivedStateFromProps=="function"||typeof i.getSnapshotBeforeUpdate=="function"||typeof i.UNSAFE_componentWillMount!="function"&&typeof i.componentWillMount!="function"||(e=i.state,typeof i.componentWillMount=="function"&&i.componentWillMount(),typeof i.UNSAFE_componentWillMount=="function"&&i.UNSAFE_componentWillMount(),e!==i.state&&rl.enqueueReplaceState(i,i.state,null),Ea(t,n,i,r),i.state=t.memoizedState),typeof i.componentDidMount=="function"&&(t.flags|=4194308)}function Bi(t,e,n){if(t=n.ref,t!==null&&typeof t!="function"&&typeof t!="object"){if(n._owner){if(n=n._owner,n){if(n.tag!==1)throw Error(I(309));var r=n.stateNode}if(!r)throw Error(I(147,t));var i=r,s=""+t;return e!==null&&e.ref!==null&&typeof e.ref=="function"&&e.ref._stringRef===s?e.ref:(e=function(o){var a=i.refs;a===_0&&(a=i.refs={}),o===null?delete a[s]:a[s]=o},e._stringRef=s,e)}if(typeof t!="string")throw Error(I(284));if(!n._owner)throw Error(I(290,t))}return t}function bo(t,e){throw t=Object.prototype.toString.call(e),Error(I(31,t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t))}function Ud(t){var e=t._init;return e(t._payload)}function w0(t){function e(y,m){if(t){var _=y.deletions;_===null?(y.deletions=[m],y.flags|=16):_.push(m)}}function n(y,m){if(!t)return null;for(;m!==null;)e(y,m),m=m.sibling;return null}function r(y,m){for(y=new Map;m!==null;)m.key!==null?y.set(m.key,m):y.set(m.index,m),m=m.sibling;return y}function i(y,m){return y=Hn(y,m),y.index=0,y.sibling=null,y}function s(y,m,_){return y.index=_,t?(_=y.alternate,_!==null?(_=_.index,_<m?(y.flags|=2,m):_):(y.flags|=2,m)):(y.flags|=1048576,m)}function o(y){return t&&y.alternate===null&&(y.flags|=2),y}function a(y,m,_,S){return m===null||m.tag!==6?(m=iu(_,y.mode,S),m.return=y,m):(m=i(m,_),m.return=y,m)}function l(y,m,_,S){var A=_.type;return A===Br?c(y,m,_.props.children,S,_.key):m!==null&&(m.elementType===A||typeof A=="object"&&A!==null&&A.$$typeof===Rn&&Ud(A)===m.type)?(S=i(m,_.props),S.ref=Bi(y,m,_),S.return=y,S):(S=Zo(_.type,_.key,_.props,null,y.mode,S),S.ref=Bi(y,m,_),S.return=y,S)}function u(y,m,_,S){return m===null||m.tag!==4||m.stateNode.containerInfo!==_.containerInfo||m.stateNode.implementation!==_.implementation?(m=su(_,y.mode,S),m.return=y,m):(m=i(m,_.children||[]),m.return=y,m)}function c(y,m,_,S,A){return m===null||m.tag!==7?(m=fr(_,y.mode,S,A),m.return=y,m):(m=i(m,_),m.return=y,m)}function h(y,m,_){if(typeof m=="string"&&m!==""||typeof m=="number")return m=iu(""+m,y.mode,_),m.return=y,m;if(typeof m=="object"&&m!==null){switch(m.$$typeof){case ho:return _=Zo(m.type,m.key,m.props,null,y.mode,_),_.ref=Bi(y,null,m),_.return=y,_;case Ur:return m=su(m,y.mode,_),m.return=y,m;case Rn:var S=m._init;return h(y,S(m._payload),_)}if(qi(m)||Oi(m))return m=fr(m,y.mode,_,null),m.return=y,m;bo(y,m)}return null}function f(y,m,_,S){var A=m!==null?m.key:null;if(typeof _=="string"&&_!==""||typeof _=="number")return A!==null?null:a(y,m,""+_,S);if(typeof _=="object"&&_!==null){switch(_.$$typeof){case ho:return _.key===A?l(y,m,_,S):null;case Ur:return _.key===A?u(y,m,_,S):null;case Rn:return A=_._init,f(y,m,A(_._payload),S)}if(qi(_)||Oi(_))return A!==null?null:c(y,m,_,S,null);bo(y,_)}return null}function g(y,m,_,S,A){if(typeof S=="string"&&S!==""||typeof S=="number")return y=y.get(_)||null,a(m,y,""+S,A);if(typeof S=="object"&&S!==null){switch(S.$$typeof){case ho:return y=y.get(S.key===null?_:S.key)||null,l(m,y,S,A);case Ur:return y=y.get(S.key===null?_:S.key)||null,u(m,y,S,A);case Rn:var P=S._init;return g(y,m,_,P(S._payload),A)}if(qi(S)||Oi(S))return y=y.get(_)||null,c(m,y,S,A,null);bo(m,S)}return null}function w(y,m,_,S){for(var A=null,P=null,L=m,C=m=0,R=null;L!==null&&C<_.length;C++){L.index>C?(R=L,L=null):R=L.sibling;var M=f(y,L,_[C],S);if(M===null){L===null&&(L=R);break}t&&L&&M.alternate===null&&e(y,L),m=s(M,m,C),P===null?A=M:P.sibling=M,P=M,L=R}if(C===_.length)return n(y,L),ce&&ir(y,C),A;if(L===null){for(;C<_.length;C++)L=h(y,_[C],S),L!==null&&(m=s(L,m,C),P===null?A=L:P.sibling=L,P=L);return ce&&ir(y,C),A}for(L=r(y,L);C<_.length;C++)R=g(L,y,C,_[C],S),R!==null&&(t&&R.alternate!==null&&L.delete(R.key===null?C:R.key),m=s(R,m,C),P===null?A=R:P.sibling=R,P=R);return t&&L.forEach(function(O){return e(y,O)}),ce&&ir(y,C),A}function E(y,m,_,S){var A=Oi(_);if(typeof A!="function")throw Error(I(150));if(_=A.call(_),_==null)throw Error(I(151));for(var P=A=null,L=m,C=m=0,R=null,M=_.next();L!==null&&!M.done;C++,M=_.next()){L.index>C?(R=L,L=null):R=L.sibling;var O=f(y,L,M.value,S);if(O===null){L===null&&(L=R);break}t&&L&&O.alternate===null&&e(y,L),m=s(O,m,C),P===null?A=O:P.sibling=O,P=O,L=R}if(M.done)return n(y,L),ce&&ir(y,C),A;if(L===null){for(;!M.done;C++,M=_.next())M=h(y,M.value,S),M!==null&&(m=s(M,m,C),P===null?A=M:P.sibling=M,P=M);return ce&&ir(y,C),A}for(L=r(y,L);!M.done;C++,M=_.next())M=g(L,y,C,M.value,S),M!==null&&(t&&M.alternate!==null&&L.delete(M.key===null?C:M.key),m=s(M,m,C),P===null?A=M:P.sibling=M,P=M);return t&&L.forEach(function(D){return e(y,D)}),ce&&ir(y,C),A}function T(y,m,_,S){if(typeof _=="object"&&_!==null&&_.type===Br&&_.key===null&&(_=_.props.children),typeof _=="object"&&_!==null){switch(_.$$typeof){case ho:e:{for(var A=_.key,P=m;P!==null;){if(P.key===A){if(A=_.type,A===Br){if(P.tag===7){n(y,P.sibling),m=i(P,_.props.children),m.return=y,y=m;break e}}else if(P.elementType===A||typeof A=="object"&&A!==null&&A.$$typeof===Rn&&Ud(A)===P.type){n(y,P.sibling),m=i(P,_.props),m.ref=Bi(y,P,_),m.return=y,y=m;break e}n(y,P);break}else e(y,P);P=P.sibling}_.type===Br?(m=fr(_.props.children,y.mode,S,_.key),m.return=y,y=m):(S=Zo(_.type,_.key,_.props,null,y.mode,S),S.ref=Bi(y,m,_),S.return=y,y=S)}return o(y);case Ur:e:{for(P=_.key;m!==null;){if(m.key===P)if(m.tag===4&&m.stateNode.containerInfo===_.containerInfo&&m.stateNode.implementation===_.implementation){n(y,m.sibling),m=i(m,_.children||[]),m.return=y,y=m;break e}else{n(y,m);break}else e(y,m);m=m.sibling}m=su(_,y.mode,S),m.return=y,y=m}return o(y);case Rn:return P=_._init,T(y,m,P(_._payload),S)}if(qi(_))return w(y,m,_,S);if(Oi(_))return E(y,m,_,S);bo(y,_)}return typeof _=="string"&&_!==""||typeof _=="number"?(_=""+_,m!==null&&m.tag===6?(n(y,m.sibling),m=i(m,_),m.return=y,y=m):(n(y,m),m=iu(_,y.mode,S),m.return=y,y=m),o(y)):n(y,m)}return T}var ui=w0(!0),E0=w0(!1),Gs={},Kt=Zn(Gs),Ss=Zn(Gs),As=Zn(Gs);function ur(t){if(t===Gs)throw Error(I(174));return t}function Oh(t,e){switch(ie(As,e),ie(Ss,t),ie(Kt,Gs),t=e.nodeType,t){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:qu(null,"");break;default:t=t===8?e.parentNode:e,e=t.namespaceURI||null,t=t.tagName,e=qu(e,t)}le(Kt),ie(Kt,e)}function ci(){le(Kt),le(Ss),le(As)}function T0(t){ur(As.current);var e=ur(Kt.current),n=qu(e,t.type);e!==n&&(ie(Ss,t),ie(Kt,n))}function Nh(t){Ss.current===t&&(le(Kt),le(Ss))}var he=Zn(0);function Ta(t){for(var e=t;e!==null;){if(e.tag===13){var n=e.memoizedState;if(n!==null&&(n=n.dehydrated,n===null||n.data==="$?"||n.data==="$!"))return e}else if(e.tag===19&&e.memoizedProps.revealOrder!==void 0){if(e.flags&128)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var Kl=[];function Dh(){for(var t=0;t<Kl.length;t++)Kl[t]._workInProgressVersionPrimary=null;Kl.length=0}var Wo=wn.ReactCurrentDispatcher,Jl=wn.ReactCurrentBatchConfig,mr=0,fe=null,Te=null,Ae=null,ba=!1,ss=!1,xs=0,Jw=0;function Ne(){throw Error(I(321))}function Fh(t,e){if(e===null)return!1;for(var n=0;n<e.length&&n<t.length;n++)if(!Ut(t[n],e[n]))return!1;return!0}function Uh(t,e,n,r,i,s){if(mr=s,fe=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,Wo.current=t===null||t.memoizedState===null?rE:iE,t=n(r,i),ss){s=0;do{if(ss=!1,xs=0,25<=s)throw Error(I(301));s+=1,Ae=Te=null,e.updateQueue=null,Wo.current=sE,t=n(r,i)}while(ss)}if(Wo.current=Sa,e=Te!==null&&Te.next!==null,mr=0,Ae=Te=fe=null,ba=!1,e)throw Error(I(300));return t}function Bh(){var t=xs!==0;return xs=0,t}function Xt(){var t={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Ae===null?fe.memoizedState=Ae=t:Ae=Ae.next=t,Ae}function xt(){if(Te===null){var t=fe.alternate;t=t!==null?t.memoizedState:null}else t=Te.next;var e=Ae===null?fe.memoizedState:Ae.next;if(e!==null)Ae=e,Te=t;else{if(t===null)throw Error(I(310));Te=t,t={memoizedState:Te.memoizedState,baseState:Te.baseState,baseQueue:Te.baseQueue,queue:Te.queue,next:null},Ae===null?fe.memoizedState=Ae=t:Ae=Ae.next=t}return Ae}function Ps(t,e){return typeof e=="function"?e(t):e}function eu(t){var e=xt(),n=e.queue;if(n===null)throw Error(I(311));n.lastRenderedReducer=t;var r=Te,i=r.baseQueue,s=n.pending;if(s!==null){if(i!==null){var o=i.next;i.next=s.next,s.next=o}r.baseQueue=i=s,n.pending=null}if(i!==null){s=i.next,r=r.baseState;var a=o=null,l=null,u=s;do{var c=u.lane;if((mr&c)===c)l!==null&&(l=l.next={lane:0,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null}),r=u.hasEagerState?u.eagerState:t(r,u.action);else{var h={lane:c,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null};l===null?(a=l=h,o=r):l=l.next=h,fe.lanes|=c,yr|=c}u=u.next}while(u!==null&&u!==s);l===null?o=r:l.next=a,Ut(r,e.memoizedState)||(Ke=!0),e.memoizedState=r,e.baseState=o,e.baseQueue=l,n.lastRenderedState=r}if(t=n.interleaved,t!==null){i=t;do s=i.lane,fe.lanes|=s,yr|=s,i=i.next;while(i!==t)}else i===null&&(n.lanes=0);return[e.memoizedState,n.dispatch]}function tu(t){var e=xt(),n=e.queue;if(n===null)throw Error(I(311));n.lastRenderedReducer=t;var r=n.dispatch,i=n.pending,s=e.memoizedState;if(i!==null){n.pending=null;var o=i=i.next;do s=t(s,o.action),o=o.next;while(o!==i);Ut(s,e.memoizedState)||(Ke=!0),e.memoizedState=s,e.baseQueue===null&&(e.baseState=s),n.lastRenderedState=s}return[s,r]}function b0(){}function S0(t,e){var n=fe,r=xt(),i=e(),s=!Ut(r.memoizedState,i);if(s&&(r.memoizedState=i,Ke=!0),r=r.queue,Vh(P0.bind(null,n,r,t),[t]),r.getSnapshot!==e||s||Ae!==null&&Ae.memoizedState.tag&1){if(n.flags|=2048,Cs(9,x0.bind(null,n,r,i,e),void 0,null),xe===null)throw Error(I(349));mr&30||A0(n,e,i)}return i}function A0(t,e,n){t.flags|=16384,t={getSnapshot:e,value:n},e=fe.updateQueue,e===null?(e={lastEffect:null,stores:null},fe.updateQueue=e,e.stores=[t]):(n=e.stores,n===null?e.stores=[t]:n.push(t))}function x0(t,e,n,r){e.value=n,e.getSnapshot=r,C0(e)&&L0(t)}function P0(t,e,n){return n(function(){C0(e)&&L0(t)})}function C0(t){var e=t.getSnapshot;t=t.value;try{var n=e();return!Ut(t,n)}catch{return!0}}function L0(t){var e=gn(t,1);e!==null&&Dt(e,t,1,-1)}function Bd(t){var e=Xt();return typeof t=="function"&&(t=t()),e.memoizedState=e.baseState=t,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Ps,lastRenderedState:t},e.queue=t,t=t.dispatch=nE.bind(null,fe,t),[e.memoizedState,t]}function Cs(t,e,n,r){return t={tag:t,create:e,destroy:n,deps:r,next:null},e=fe.updateQueue,e===null?(e={lastEffect:null,stores:null},fe.updateQueue=e,e.lastEffect=t.next=t):(n=e.lastEffect,n===null?e.lastEffect=t.next=t:(r=n.next,n.next=t,t.next=r,e.lastEffect=t)),t}function R0(){return xt().memoizedState}function Xo(t,e,n,r){var i=Xt();fe.flags|=t,i.memoizedState=Cs(1|e,n,void 0,r===void 0?null:r)}function il(t,e,n,r){var i=xt();r=r===void 0?null:r;var s=void 0;if(Te!==null){var o=Te.memoizedState;if(s=o.destroy,r!==null&&Fh(r,o.deps)){i.memoizedState=Cs(e,n,s,r);return}}fe.flags|=t,i.memoizedState=Cs(1|e,n,s,r)}function Vd(t,e){return Xo(8390656,8,t,e)}function Vh(t,e){return il(2048,8,t,e)}function M0(t,e){return il(4,2,t,e)}function k0(t,e){return il(4,4,t,e)}function I0(t,e){if(typeof e=="function")return t=t(),e(t),function(){e(null)};if(e!=null)return t=t(),e.current=t,function(){e.current=null}}function O0(t,e,n){return n=n!=null?n.concat([t]):null,il(4,4,I0.bind(null,e,t),n)}function zh(){}function N0(t,e){var n=xt();e=e===void 0?null:e;var r=n.memoizedState;return r!==null&&e!==null&&Fh(e,r[1])?r[0]:(n.memoizedState=[t,e],t)}function D0(t,e){var n=xt();e=e===void 0?null:e;var r=n.memoizedState;return r!==null&&e!==null&&Fh(e,r[1])?r[0]:(t=t(),n.memoizedState=[t,e],t)}function F0(t,e,n){return mr&21?(Ut(n,e)||(n=Vm(),fe.lanes|=n,yr|=n,t.baseState=!0),e):(t.baseState&&(t.baseState=!1,Ke=!0),t.memoizedState=n)}function eE(t,e){var n=ee;ee=n!==0&&4>n?n:4,t(!0);var r=Jl.transition;Jl.transition={};try{t(!1),e()}finally{ee=n,Jl.transition=r}}function U0(){return xt().memoizedState}function tE(t,e,n){var r=Gn(t);if(n={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null},B0(t))V0(e,n);else if(n=m0(t,e,n,r),n!==null){var i=Xe();Dt(n,t,r,i),z0(n,e,r)}}function nE(t,e,n){var r=Gn(t),i={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null};if(B0(t))V0(e,i);else{var s=t.alternate;if(t.lanes===0&&(s===null||s.lanes===0)&&(s=e.lastRenderedReducer,s!==null))try{var o=e.lastRenderedState,a=s(o,n);if(i.hasEagerState=!0,i.eagerState=a,Ut(a,o)){var l=e.interleaved;l===null?(i.next=i,kh(e)):(i.next=l.next,l.next=i),e.interleaved=i;return}}catch{}finally{}n=m0(t,e,i,r),n!==null&&(i=Xe(),Dt(n,t,r,i),z0(n,e,r))}}function B0(t){var e=t.alternate;return t===fe||e!==null&&e===fe}function V0(t,e){ss=ba=!0;var n=t.pending;n===null?e.next=e:(e.next=n.next,n.next=e),t.pending=e}function z0(t,e,n){if(n&4194240){var r=e.lanes;r&=t.pendingLanes,n|=r,e.lanes=n,_h(t,n)}}var Sa={readContext:At,useCallback:Ne,useContext:Ne,useEffect:Ne,useImperativeHandle:Ne,useInsertionEffect:Ne,useLayoutEffect:Ne,useMemo:Ne,useReducer:Ne,useRef:Ne,useState:Ne,useDebugValue:Ne,useDeferredValue:Ne,useTransition:Ne,useMutableSource:Ne,useSyncExternalStore:Ne,useId:Ne,unstable_isNewReconciler:!1},rE={readContext:At,useCallback:function(t,e){return Xt().memoizedState=[t,e===void 0?null:e],t},useContext:At,useEffect:Vd,useImperativeHandle:function(t,e,n){return n=n!=null?n.concat([t]):null,Xo(4194308,4,I0.bind(null,e,t),n)},useLayoutEffect:function(t,e){return Xo(4194308,4,t,e)},useInsertionEffect:function(t,e){return Xo(4,2,t,e)},useMemo:function(t,e){var n=Xt();return e=e===void 0?null:e,t=t(),n.memoizedState=[t,e],t},useReducer:function(t,e,n){var r=Xt();return e=n!==void 0?n(e):e,r.memoizedState=r.baseState=e,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:t,lastRenderedState:e},r.queue=t,t=t.dispatch=tE.bind(null,fe,t),[r.memoizedState,t]},useRef:function(t){var e=Xt();return t={current:t},e.memoizedState=t},useState:Bd,useDebugValue:zh,useDeferredValue:function(t){return Xt().memoizedState=t},useTransition:function(){var t=Bd(!1),e=t[0];return t=eE.bind(null,t[1]),Xt().memoizedState=t,[e,t]},useMutableSource:function(){},useSyncExternalStore:function(t,e,n){var r=fe,i=Xt();if(ce){if(n===void 0)throw Error(I(407));n=n()}else{if(n=e(),xe===null)throw Error(I(349));mr&30||A0(r,e,n)}i.memoizedState=n;var s={value:n,getSnapshot:e};return i.queue=s,Vd(P0.bind(null,r,s,t),[t]),r.flags|=2048,Cs(9,x0.bind(null,r,s,n,e),void 0,null),n},useId:function(){var t=Xt(),e=xe.identifierPrefix;if(ce){var n=cn,r=un;n=(r&~(1<<32-Nt(r)-1)).toString(32)+n,e=":"+e+"R"+n,n=xs++,0<n&&(e+="H"+n.toString(32)),e+=":"}else n=Jw++,e=":"+e+"r"+n.toString(32)+":";return t.memoizedState=e},unstable_isNewReconciler:!1},iE={readContext:At,useCallback:N0,useContext:At,useEffect:Vh,useImperativeHandle:O0,useInsertionEffect:M0,useLayoutEffect:k0,useMemo:D0,useReducer:eu,useRef:R0,useState:function(){return eu(Ps)},useDebugValue:zh,useDeferredValue:function(t){var e=xt();return F0(e,Te.memoizedState,t)},useTransition:function(){var t=eu(Ps)[0],e=xt().memoizedState;return[t,e]},useMutableSource:b0,useSyncExternalStore:S0,useId:U0,unstable_isNewReconciler:!1},sE={readContext:At,useCallback:N0,useContext:At,useEffect:Vh,useImperativeHandle:O0,useInsertionEffect:M0,useLayoutEffect:k0,useMemo:D0,useReducer:tu,useRef:R0,useState:function(){return tu(Ps)},useDebugValue:zh,useDeferredValue:function(t){var e=xt();return Te===null?e.memoizedState=t:F0(e,Te.memoizedState,t)},useTransition:function(){var t=tu(Ps)[0],e=xt().memoizedState;return[t,e]},useMutableSource:b0,useSyncExternalStore:S0,useId:U0,unstable_isNewReconciler:!1};function hi(t,e){try{var n="",r=e;do n+=I1(r),r=r.return;while(r);var i=n}catch(s){i=`
Error generating stack: `+s.message+`
`+s.stack}return{value:t,source:e,stack:i,digest:null}}function nu(t,e,n){return{value:t,source:null,stack:n??null,digest:e??null}}function _c(t,e){try{console.error(e.value)}catch(n){setTimeout(function(){throw n})}}var oE=typeof WeakMap=="function"?WeakMap:Map;function j0(t,e,n){n=hn(-1,n),n.tag=3,n.payload={element:null};var r=e.value;return n.callback=function(){xa||(xa=!0,Cc=r),_c(t,e)},n}function G0(t,e,n){n=hn(-1,n),n.tag=3;var r=t.type.getDerivedStateFromError;if(typeof r=="function"){var i=e.value;n.payload=function(){return r(i)},n.callback=function(){_c(t,e)}}var s=t.stateNode;return s!==null&&typeof s.componentDidCatch=="function"&&(n.callback=function(){_c(t,e),typeof r!="function"&&(jn===null?jn=new Set([this]):jn.add(this));var o=e.stack;this.componentDidCatch(e.value,{componentStack:o!==null?o:""})}),n}function zd(t,e,n){var r=t.pingCache;if(r===null){r=t.pingCache=new oE;var i=new Set;r.set(e,i)}else i=r.get(e),i===void 0&&(i=new Set,r.set(e,i));i.has(n)||(i.add(n),t=wE.bind(null,t,e,n),e.then(t,t))}function jd(t){do{var e;if((e=t.tag===13)&&(e=t.memoizedState,e=e!==null?e.dehydrated!==null:!0),e)return t;t=t.return}while(t!==null);return null}function Gd(t,e,n,r,i){return t.mode&1?(t.flags|=65536,t.lanes=i,t):(t===e?t.flags|=65536:(t.flags|=128,n.flags|=131072,n.flags&=-52805,n.tag===1&&(n.alternate===null?n.tag=17:(e=hn(-1,1),e.tag=2,zn(n,e,1))),n.lanes|=1),t)}var aE=wn.ReactCurrentOwner,Ke=!1;function je(t,e,n,r){e.child=t===null?E0(e,null,n,r):ui(e,t.child,n,r)}function Hd(t,e,n,r,i){n=n.render;var s=e.ref;return ni(e,i),r=Uh(t,e,n,r,s,i),n=Bh(),t!==null&&!Ke?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~i,pn(t,e,i)):(ce&&n&&xh(e),e.flags|=1,je(t,e,r,i),e.child)}function Wd(t,e,n,r,i){if(t===null){var s=n.type;return typeof s=="function"&&!qh(s)&&s.defaultProps===void 0&&n.compare===null&&n.defaultProps===void 0?(e.tag=15,e.type=s,H0(t,e,s,r,i)):(t=Zo(n.type,null,r,e,e.mode,i),t.ref=e.ref,t.return=e,e.child=t)}if(s=t.child,!(t.lanes&i)){var o=s.memoizedProps;if(n=n.compare,n=n!==null?n:ws,n(o,r)&&t.ref===e.ref)return pn(t,e,i)}return e.flags|=1,t=Hn(s,r),t.ref=e.ref,t.return=e,e.child=t}function H0(t,e,n,r,i){if(t!==null){var s=t.memoizedProps;if(ws(s,r)&&t.ref===e.ref)if(Ke=!1,e.pendingProps=r=s,(t.lanes&i)!==0)t.flags&131072&&(Ke=!0);else return e.lanes=t.lanes,pn(t,e,i)}return vc(t,e,n,r,i)}function W0(t,e,n){var r=e.pendingProps,i=r.children,s=t!==null?t.memoizedState:null;if(r.mode==="hidden")if(!(e.mode&1))e.memoizedState={baseLanes:0,cachePool:null,transitions:null},ie(qr,st),st|=n;else{if(!(n&1073741824))return t=s!==null?s.baseLanes|n:n,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:t,cachePool:null,transitions:null},e.updateQueue=null,ie(qr,st),st|=t,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},r=s!==null?s.baseLanes:n,ie(qr,st),st|=r}else s!==null?(r=s.baseLanes|n,e.memoizedState=null):r=n,ie(qr,st),st|=r;return je(t,e,i,n),e.child}function X0(t,e){var n=e.ref;(t===null&&n!==null||t!==null&&t.ref!==n)&&(e.flags|=512,e.flags|=2097152)}function vc(t,e,n,r,i){var s=et(n)?gr:Ve.current;return s=ai(e,s),ni(e,i),n=Uh(t,e,n,r,s,i),r=Bh(),t!==null&&!Ke?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~i,pn(t,e,i)):(ce&&r&&xh(e),e.flags|=1,je(t,e,n,i),e.child)}function Xd(t,e,n,r,i){if(et(n)){var s=!0;ma(e)}else s=!1;if(ni(e,i),e.stateNode===null)Yo(t,e),v0(e,n,r),yc(e,n,r,i),r=!0;else if(t===null){var o=e.stateNode,a=e.memoizedProps;o.props=a;var l=o.context,u=n.contextType;typeof u=="object"&&u!==null?u=At(u):(u=et(n)?gr:Ve.current,u=ai(e,u));var c=n.getDerivedStateFromProps,h=typeof c=="function"||typeof o.getSnapshotBeforeUpdate=="function";h||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(a!==r||l!==u)&&Fd(e,o,r,u),Mn=!1;var f=e.memoizedState;o.state=f,Ea(e,r,o,i),l=e.memoizedState,a!==r||f!==l||Je.current||Mn?(typeof c=="function"&&(mc(e,n,c,r),l=e.memoizedState),(a=Mn||Dd(e,n,a,r,f,l,u))?(h||typeof o.UNSAFE_componentWillMount!="function"&&typeof o.componentWillMount!="function"||(typeof o.componentWillMount=="function"&&o.componentWillMount(),typeof o.UNSAFE_componentWillMount=="function"&&o.UNSAFE_componentWillMount()),typeof o.componentDidMount=="function"&&(e.flags|=4194308)):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),e.memoizedProps=r,e.memoizedState=l),o.props=r,o.state=l,o.context=u,r=a):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),r=!1)}else{o=e.stateNode,y0(t,e),a=e.memoizedProps,u=e.type===e.elementType?a:Mt(e.type,a),o.props=u,h=e.pendingProps,f=o.context,l=n.contextType,typeof l=="object"&&l!==null?l=At(l):(l=et(n)?gr:Ve.current,l=ai(e,l));var g=n.getDerivedStateFromProps;(c=typeof g=="function"||typeof o.getSnapshotBeforeUpdate=="function")||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(a!==h||f!==l)&&Fd(e,o,r,l),Mn=!1,f=e.memoizedState,o.state=f,Ea(e,r,o,i);var w=e.memoizedState;a!==h||f!==w||Je.current||Mn?(typeof g=="function"&&(mc(e,n,g,r),w=e.memoizedState),(u=Mn||Dd(e,n,u,r,f,w,l)||!1)?(c||typeof o.UNSAFE_componentWillUpdate!="function"&&typeof o.componentWillUpdate!="function"||(typeof o.componentWillUpdate=="function"&&o.componentWillUpdate(r,w,l),typeof o.UNSAFE_componentWillUpdate=="function"&&o.UNSAFE_componentWillUpdate(r,w,l)),typeof o.componentDidUpdate=="function"&&(e.flags|=4),typeof o.getSnapshotBeforeUpdate=="function"&&(e.flags|=1024)):(typeof o.componentDidUpdate!="function"||a===t.memoizedProps&&f===t.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||a===t.memoizedProps&&f===t.memoizedState||(e.flags|=1024),e.memoizedProps=r,e.memoizedState=w),o.props=r,o.state=w,o.context=l,r=u):(typeof o.componentDidUpdate!="function"||a===t.memoizedProps&&f===t.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||a===t.memoizedProps&&f===t.memoizedState||(e.flags|=1024),r=!1)}return wc(t,e,n,r,s,i)}function wc(t,e,n,r,i,s){X0(t,e);var o=(e.flags&128)!==0;if(!r&&!o)return i&&Md(e,n,!1),pn(t,e,s);r=e.stateNode,aE.current=e;var a=o&&typeof n.getDerivedStateFromError!="function"?null:r.render();return e.flags|=1,t!==null&&o?(e.child=ui(e,t.child,null,s),e.child=ui(e,null,a,s)):je(t,e,a,s),e.memoizedState=r.state,i&&Md(e,n,!0),e.child}function Y0(t){var e=t.stateNode;e.pendingContext?Rd(t,e.pendingContext,e.pendingContext!==e.context):e.context&&Rd(t,e.context,!1),Oh(t,e.containerInfo)}function Yd(t,e,n,r,i){return li(),Ch(i),e.flags|=256,je(t,e,n,r),e.child}var Ec={dehydrated:null,treeContext:null,retryLane:0};function Tc(t){return{baseLanes:t,cachePool:null,transitions:null}}function $0(t,e,n){var r=e.pendingProps,i=he.current,s=!1,o=(e.flags&128)!==0,a;if((a=o)||(a=t!==null&&t.memoizedState===null?!1:(i&2)!==0),a?(s=!0,e.flags&=-129):(t===null||t.memoizedState!==null)&&(i|=1),ie(he,i&1),t===null)return gc(e),t=e.memoizedState,t!==null&&(t=t.dehydrated,t!==null)?(e.mode&1?t.data==="$!"?e.lanes=8:e.lanes=1073741824:e.lanes=1,null):(o=r.children,t=r.fallback,s?(r=e.mode,s=e.child,o={mode:"hidden",children:o},!(r&1)&&s!==null?(s.childLanes=0,s.pendingProps=o):s=al(o,r,0,null),t=fr(t,r,n,null),s.return=e,t.return=e,s.sibling=t,e.child=s,e.child.memoizedState=Tc(n),e.memoizedState=Ec,t):jh(e,o));if(i=t.memoizedState,i!==null&&(a=i.dehydrated,a!==null))return lE(t,e,o,r,a,i,n);if(s){s=r.fallback,o=e.mode,i=t.child,a=i.sibling;var l={mode:"hidden",children:r.children};return!(o&1)&&e.child!==i?(r=e.child,r.childLanes=0,r.pendingProps=l,e.deletions=null):(r=Hn(i,l),r.subtreeFlags=i.subtreeFlags&14680064),a!==null?s=Hn(a,s):(s=fr(s,o,n,null),s.flags|=2),s.return=e,r.return=e,r.sibling=s,e.child=r,r=s,s=e.child,o=t.child.memoizedState,o=o===null?Tc(n):{baseLanes:o.baseLanes|n,cachePool:null,transitions:o.transitions},s.memoizedState=o,s.childLanes=t.childLanes&~n,e.memoizedState=Ec,r}return s=t.child,t=s.sibling,r=Hn(s,{mode:"visible",children:r.children}),!(e.mode&1)&&(r.lanes=n),r.return=e,r.sibling=null,t!==null&&(n=e.deletions,n===null?(e.deletions=[t],e.flags|=16):n.push(t)),e.child=r,e.memoizedState=null,r}function jh(t,e){return e=al({mode:"visible",children:e},t.mode,0,null),e.return=t,t.child=e}function So(t,e,n,r){return r!==null&&Ch(r),ui(e,t.child,null,n),t=jh(e,e.pendingProps.children),t.flags|=2,e.memoizedState=null,t}function lE(t,e,n,r,i,s,o){if(n)return e.flags&256?(e.flags&=-257,r=nu(Error(I(422))),So(t,e,o,r)):e.memoizedState!==null?(e.child=t.child,e.flags|=128,null):(s=r.fallback,i=e.mode,r=al({mode:"visible",children:r.children},i,0,null),s=fr(s,i,o,null),s.flags|=2,r.return=e,s.return=e,r.sibling=s,e.child=r,e.mode&1&&ui(e,t.child,null,o),e.child.memoizedState=Tc(o),e.memoizedState=Ec,s);if(!(e.mode&1))return So(t,e,o,null);if(i.data==="$!"){if(r=i.nextSibling&&i.nextSibling.dataset,r)var a=r.dgst;return r=a,s=Error(I(419)),r=nu(s,r,void 0),So(t,e,o,r)}if(a=(o&t.childLanes)!==0,Ke||a){if(r=xe,r!==null){switch(o&-o){case 4:i=2;break;case 16:i=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:i=32;break;case 536870912:i=268435456;break;default:i=0}i=i&(r.suspendedLanes|o)?0:i,i!==0&&i!==s.retryLane&&(s.retryLane=i,gn(t,i),Dt(r,t,i,-1))}return $h(),r=nu(Error(I(421))),So(t,e,o,r)}return i.data==="$?"?(e.flags|=128,e.child=t.child,e=EE.bind(null,t),i._reactRetry=e,null):(t=s.treeContext,lt=Vn(i.nextSibling),ct=e,ce=!0,It=null,t!==null&&(wt[Et++]=un,wt[Et++]=cn,wt[Et++]=pr,un=t.id,cn=t.overflow,pr=e),e=jh(e,r.children),e.flags|=4096,e)}function $d(t,e,n){t.lanes|=e;var r=t.alternate;r!==null&&(r.lanes|=e),pc(t.return,e,n)}function ru(t,e,n,r,i){var s=t.memoizedState;s===null?t.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:r,tail:n,tailMode:i}:(s.isBackwards=e,s.rendering=null,s.renderingStartTime=0,s.last=r,s.tail=n,s.tailMode=i)}function q0(t,e,n){var r=e.pendingProps,i=r.revealOrder,s=r.tail;if(je(t,e,r.children,n),r=he.current,r&2)r=r&1|2,e.flags|=128;else{if(t!==null&&t.flags&128)e:for(t=e.child;t!==null;){if(t.tag===13)t.memoizedState!==null&&$d(t,n,e);else if(t.tag===19)$d(t,n,e);else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break e;for(;t.sibling===null;){if(t.return===null||t.return===e)break e;t=t.return}t.sibling.return=t.return,t=t.sibling}r&=1}if(ie(he,r),!(e.mode&1))e.memoizedState=null;else switch(i){case"forwards":for(n=e.child,i=null;n!==null;)t=n.alternate,t!==null&&Ta(t)===null&&(i=n),n=n.sibling;n=i,n===null?(i=e.child,e.child=null):(i=n.sibling,n.sibling=null),ru(e,!1,i,n,s);break;case"backwards":for(n=null,i=e.child,e.child=null;i!==null;){if(t=i.alternate,t!==null&&Ta(t)===null){e.child=i;break}t=i.sibling,i.sibling=n,n=i,i=t}ru(e,!0,n,null,s);break;case"together":ru(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function Yo(t,e){!(e.mode&1)&&t!==null&&(t.alternate=null,e.alternate=null,e.flags|=2)}function pn(t,e,n){if(t!==null&&(e.dependencies=t.dependencies),yr|=e.lanes,!(n&e.childLanes))return null;if(t!==null&&e.child!==t.child)throw Error(I(153));if(e.child!==null){for(t=e.child,n=Hn(t,t.pendingProps),e.child=n,n.return=e;t.sibling!==null;)t=t.sibling,n=n.sibling=Hn(t,t.pendingProps),n.return=e;n.sibling=null}return e.child}function uE(t,e,n){switch(e.tag){case 3:Y0(e),li();break;case 5:T0(e);break;case 1:et(e.type)&&ma(e);break;case 4:Oh(e,e.stateNode.containerInfo);break;case 10:var r=e.type._context,i=e.memoizedProps.value;ie(va,r._currentValue),r._currentValue=i;break;case 13:if(r=e.memoizedState,r!==null)return r.dehydrated!==null?(ie(he,he.current&1),e.flags|=128,null):n&e.child.childLanes?$0(t,e,n):(ie(he,he.current&1),t=pn(t,e,n),t!==null?t.sibling:null);ie(he,he.current&1);break;case 19:if(r=(n&e.childLanes)!==0,t.flags&128){if(r)return q0(t,e,n);e.flags|=128}if(i=e.memoizedState,i!==null&&(i.rendering=null,i.tail=null,i.lastEffect=null),ie(he,he.current),r)break;return null;case 22:case 23:return e.lanes=0,W0(t,e,n)}return pn(t,e,n)}var Z0,bc,Q0,K0;Z0=function(t,e){for(var n=e.child;n!==null;){if(n.tag===5||n.tag===6)t.appendChild(n.stateNode);else if(n.tag!==4&&n.child!==null){n.child.return=n,n=n.child;continue}if(n===e)break;for(;n.sibling===null;){if(n.return===null||n.return===e)return;n=n.return}n.sibling.return=n.return,n=n.sibling}};bc=function(){};Q0=function(t,e,n,r){var i=t.memoizedProps;if(i!==r){t=e.stateNode,ur(Kt.current);var s=null;switch(n){case"input":i=Wu(t,i),r=Wu(t,r),s=[];break;case"select":i=de({},i,{value:void 0}),r=de({},r,{value:void 0}),s=[];break;case"textarea":i=$u(t,i),r=$u(t,r),s=[];break;default:typeof i.onClick!="function"&&typeof r.onClick=="function"&&(t.onclick=ga)}Zu(n,r);var o;n=null;for(u in i)if(!r.hasOwnProperty(u)&&i.hasOwnProperty(u)&&i[u]!=null)if(u==="style"){var a=i[u];for(o in a)a.hasOwnProperty(o)&&(n||(n={}),n[o]="")}else u!=="dangerouslySetInnerHTML"&&u!=="children"&&u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&u!=="autoFocus"&&(ds.hasOwnProperty(u)?s||(s=[]):(s=s||[]).push(u,null));for(u in r){var l=r[u];if(a=i?.[u],r.hasOwnProperty(u)&&l!==a&&(l!=null||a!=null))if(u==="style")if(a){for(o in a)!a.hasOwnProperty(o)||l&&l.hasOwnProperty(o)||(n||(n={}),n[o]="");for(o in l)l.hasOwnProperty(o)&&a[o]!==l[o]&&(n||(n={}),n[o]=l[o])}else n||(s||(s=[]),s.push(u,n)),n=l;else u==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,a=a?a.__html:void 0,l!=null&&a!==l&&(s=s||[]).push(u,l)):u==="children"?typeof l!="string"&&typeof l!="number"||(s=s||[]).push(u,""+l):u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&(ds.hasOwnProperty(u)?(l!=null&&u==="onScroll"&&oe("scroll",t),s||a===l||(s=[])):(s=s||[]).push(u,l))}n&&(s=s||[]).push("style",n);var u=s;(e.updateQueue=u)&&(e.flags|=4)}};K0=function(t,e,n,r){n!==r&&(e.flags|=4)};function Vi(t,e){if(!ce)switch(t.tailMode){case"hidden":e=t.tail;for(var n=null;e!==null;)e.alternate!==null&&(n=e),e=e.sibling;n===null?t.tail=null:n.sibling=null;break;case"collapsed":n=t.tail;for(var r=null;n!==null;)n.alternate!==null&&(r=n),n=n.sibling;r===null?e||t.tail===null?t.tail=null:t.tail.sibling=null:r.sibling=null}}function De(t){var e=t.alternate!==null&&t.alternate.child===t.child,n=0,r=0;if(e)for(var i=t.child;i!==null;)n|=i.lanes|i.childLanes,r|=i.subtreeFlags&14680064,r|=i.flags&14680064,i.return=t,i=i.sibling;else for(i=t.child;i!==null;)n|=i.lanes|i.childLanes,r|=i.subtreeFlags,r|=i.flags,i.return=t,i=i.sibling;return t.subtreeFlags|=r,t.childLanes=n,e}function cE(t,e,n){var r=e.pendingProps;switch(Ph(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return De(e),null;case 1:return et(e.type)&&pa(),De(e),null;case 3:return r=e.stateNode,ci(),le(Je),le(Ve),Dh(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),(t===null||t.child===null)&&(To(e)?e.flags|=4:t===null||t.memoizedState.isDehydrated&&!(e.flags&256)||(e.flags|=1024,It!==null&&(Mc(It),It=null))),bc(t,e),De(e),null;case 5:Nh(e);var i=ur(As.current);if(n=e.type,t!==null&&e.stateNode!=null)Q0(t,e,n,r,i),t.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!r){if(e.stateNode===null)throw Error(I(166));return De(e),null}if(t=ur(Kt.current),To(e)){r=e.stateNode,n=e.type;var s=e.memoizedProps;switch(r[Yt]=e,r[bs]=s,t=(e.mode&1)!==0,n){case"dialog":oe("cancel",r),oe("close",r);break;case"iframe":case"object":case"embed":oe("load",r);break;case"video":case"audio":for(i=0;i<Qi.length;i++)oe(Qi[i],r);break;case"source":oe("error",r);break;case"img":case"image":case"link":oe("error",r),oe("load",r);break;case"details":oe("toggle",r);break;case"input":rd(r,s),oe("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!s.multiple},oe("invalid",r);break;case"textarea":sd(r,s),oe("invalid",r)}Zu(n,s),i=null;for(var o in s)if(s.hasOwnProperty(o)){var a=s[o];o==="children"?typeof a=="string"?r.textContent!==a&&(s.suppressHydrationWarning!==!0&&Eo(r.textContent,a,t),i=["children",a]):typeof a=="number"&&r.textContent!==""+a&&(s.suppressHydrationWarning!==!0&&Eo(r.textContent,a,t),i=["children",""+a]):ds.hasOwnProperty(o)&&a!=null&&o==="onScroll"&&oe("scroll",r)}switch(n){case"input":fo(r),id(r,s,!0);break;case"textarea":fo(r),od(r);break;case"select":case"option":break;default:typeof s.onClick=="function"&&(r.onclick=ga)}r=i,e.updateQueue=r,r!==null&&(e.flags|=4)}else{o=i.nodeType===9?i:i.ownerDocument,t==="http://www.w3.org/1999/xhtml"&&(t=Am(n)),t==="http://www.w3.org/1999/xhtml"?n==="script"?(t=o.createElement("div"),t.innerHTML="<script><\/script>",t=t.removeChild(t.firstChild)):typeof r.is=="string"?t=o.createElement(n,{is:r.is}):(t=o.createElement(n),n==="select"&&(o=t,r.multiple?o.multiple=!0:r.size&&(o.size=r.size))):t=o.createElementNS(t,n),t[Yt]=e,t[bs]=r,Z0(t,e,!1,!1),e.stateNode=t;e:{switch(o=Qu(n,r),n){case"dialog":oe("cancel",t),oe("close",t),i=r;break;case"iframe":case"object":case"embed":oe("load",t),i=r;break;case"video":case"audio":for(i=0;i<Qi.length;i++)oe(Qi[i],t);i=r;break;case"source":oe("error",t),i=r;break;case"img":case"image":case"link":oe("error",t),oe("load",t),i=r;break;case"details":oe("toggle",t),i=r;break;case"input":rd(t,r),i=Wu(t,r),oe("invalid",t);break;case"option":i=r;break;case"select":t._wrapperState={wasMultiple:!!r.multiple},i=de({},r,{value:void 0}),oe("invalid",t);break;case"textarea":sd(t,r),i=$u(t,r),oe("invalid",t);break;default:i=r}Zu(n,i),a=i;for(s in a)if(a.hasOwnProperty(s)){var l=a[s];s==="style"?Cm(t,l):s==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,l!=null&&xm(t,l)):s==="children"?typeof l=="string"?(n!=="textarea"||l!=="")&&gs(t,l):typeof l=="number"&&gs(t,""+l):s!=="suppressContentEditableWarning"&&s!=="suppressHydrationWarning"&&s!=="autoFocus"&&(ds.hasOwnProperty(s)?l!=null&&s==="onScroll"&&oe("scroll",t):l!=null&&fh(t,s,l,o))}switch(n){case"input":fo(t),id(t,r,!1);break;case"textarea":fo(t),od(t);break;case"option":r.value!=null&&t.setAttribute("value",""+Xn(r.value));break;case"select":t.multiple=!!r.multiple,s=r.value,s!=null?Kr(t,!!r.multiple,s,!1):r.defaultValue!=null&&Kr(t,!!r.multiple,r.defaultValue,!0);break;default:typeof i.onClick=="function"&&(t.onclick=ga)}switch(n){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break e;case"img":r=!0;break e;default:r=!1}}r&&(e.flags|=4)}e.ref!==null&&(e.flags|=512,e.flags|=2097152)}return De(e),null;case 6:if(t&&e.stateNode!=null)K0(t,e,t.memoizedProps,r);else{if(typeof r!="string"&&e.stateNode===null)throw Error(I(166));if(n=ur(As.current),ur(Kt.current),To(e)){if(r=e.stateNode,n=e.memoizedProps,r[Yt]=e,(s=r.nodeValue!==n)&&(t=ct,t!==null))switch(t.tag){case 3:Eo(r.nodeValue,n,(t.mode&1)!==0);break;case 5:t.memoizedProps.suppressHydrationWarning!==!0&&Eo(r.nodeValue,n,(t.mode&1)!==0)}s&&(e.flags|=4)}else r=(n.nodeType===9?n:n.ownerDocument).createTextNode(r),r[Yt]=e,e.stateNode=r}return De(e),null;case 13:if(le(he),r=e.memoizedState,t===null||t.memoizedState!==null&&t.memoizedState.dehydrated!==null){if(ce&&lt!==null&&e.mode&1&&!(e.flags&128))p0(),li(),e.flags|=98560,s=!1;else if(s=To(e),r!==null&&r.dehydrated!==null){if(t===null){if(!s)throw Error(I(318));if(s=e.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(I(317));s[Yt]=e}else li(),!(e.flags&128)&&(e.memoizedState=null),e.flags|=4;De(e),s=!1}else It!==null&&(Mc(It),It=null),s=!0;if(!s)return e.flags&65536?e:null}return e.flags&128?(e.lanes=n,e):(r=r!==null,r!==(t!==null&&t.memoizedState!==null)&&r&&(e.child.flags|=8192,e.mode&1&&(t===null||he.current&1?be===0&&(be=3):$h())),e.updateQueue!==null&&(e.flags|=4),De(e),null);case 4:return ci(),bc(t,e),t===null&&Es(e.stateNode.containerInfo),De(e),null;case 10:return Mh(e.type._context),De(e),null;case 17:return et(e.type)&&pa(),De(e),null;case 19:if(le(he),s=e.memoizedState,s===null)return De(e),null;if(r=(e.flags&128)!==0,o=s.rendering,o===null)if(r)Vi(s,!1);else{if(be!==0||t!==null&&t.flags&128)for(t=e.child;t!==null;){if(o=Ta(t),o!==null){for(e.flags|=128,Vi(s,!1),r=o.updateQueue,r!==null&&(e.updateQueue=r,e.flags|=4),e.subtreeFlags=0,r=n,n=e.child;n!==null;)s=n,t=r,s.flags&=14680066,o=s.alternate,o===null?(s.childLanes=0,s.lanes=t,s.child=null,s.subtreeFlags=0,s.memoizedProps=null,s.memoizedState=null,s.updateQueue=null,s.dependencies=null,s.stateNode=null):(s.childLanes=o.childLanes,s.lanes=o.lanes,s.child=o.child,s.subtreeFlags=0,s.deletions=null,s.memoizedProps=o.memoizedProps,s.memoizedState=o.memoizedState,s.updateQueue=o.updateQueue,s.type=o.type,t=o.dependencies,s.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext}),n=n.sibling;return ie(he,he.current&1|2),e.child}t=t.sibling}s.tail!==null&&me()>fi&&(e.flags|=128,r=!0,Vi(s,!1),e.lanes=4194304)}else{if(!r)if(t=Ta(o),t!==null){if(e.flags|=128,r=!0,n=t.updateQueue,n!==null&&(e.updateQueue=n,e.flags|=4),Vi(s,!0),s.tail===null&&s.tailMode==="hidden"&&!o.alternate&&!ce)return De(e),null}else 2*me()-s.renderingStartTime>fi&&n!==1073741824&&(e.flags|=128,r=!0,Vi(s,!1),e.lanes=4194304);s.isBackwards?(o.sibling=e.child,e.child=o):(n=s.last,n!==null?n.sibling=o:e.child=o,s.last=o)}return s.tail!==null?(e=s.tail,s.rendering=e,s.tail=e.sibling,s.renderingStartTime=me(),e.sibling=null,n=he.current,ie(he,r?n&1|2:n&1),e):(De(e),null);case 22:case 23:return Yh(),r=e.memoizedState!==null,t!==null&&t.memoizedState!==null!==r&&(e.flags|=8192),r&&e.mode&1?st&1073741824&&(De(e),e.subtreeFlags&6&&(e.flags|=8192)):De(e),null;case 24:return null;case 25:return null}throw Error(I(156,e.tag))}function hE(t,e){switch(Ph(e),e.tag){case 1:return et(e.type)&&pa(),t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 3:return ci(),le(Je),le(Ve),Dh(),t=e.flags,t&65536&&!(t&128)?(e.flags=t&-65537|128,e):null;case 5:return Nh(e),null;case 13:if(le(he),t=e.memoizedState,t!==null&&t.dehydrated!==null){if(e.alternate===null)throw Error(I(340));li()}return t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 19:return le(he),null;case 4:return ci(),null;case 10:return Mh(e.type._context),null;case 22:case 23:return Yh(),null;case 24:return null;default:return null}}var Ao=!1,Be=!1,fE=typeof WeakSet=="function"?WeakSet:Set,B=null;function $r(t,e){var n=t.ref;if(n!==null)if(typeof n=="function")try{n(null)}catch(r){pe(t,e,r)}else n.current=null}function Sc(t,e,n){try{n()}catch(r){pe(t,e,r)}}var qd=!1;function dE(t,e){if(ac=ha,t=n0(),Ah(t)){if("selectionStart"in t)var n={start:t.selectionStart,end:t.selectionEnd};else e:{n=(n=t.ownerDocument)&&n.defaultView||window;var r=n.getSelection&&n.getSelection();if(r&&r.rangeCount!==0){n=r.anchorNode;var i=r.anchorOffset,s=r.focusNode;r=r.focusOffset;try{n.nodeType,s.nodeType}catch{n=null;break e}var o=0,a=-1,l=-1,u=0,c=0,h=t,f=null;t:for(;;){for(var g;h!==n||i!==0&&h.nodeType!==3||(a=o+i),h!==s||r!==0&&h.nodeType!==3||(l=o+r),h.nodeType===3&&(o+=h.nodeValue.length),(g=h.firstChild)!==null;)f=h,h=g;for(;;){if(h===t)break t;if(f===n&&++u===i&&(a=o),f===s&&++c===r&&(l=o),(g=h.nextSibling)!==null)break;h=f,f=h.parentNode}h=g}n=a===-1||l===-1?null:{start:a,end:l}}else n=null}n=n||{start:0,end:0}}else n=null;for(lc={focusedElem:t,selectionRange:n},ha=!1,B=e;B!==null;)if(e=B,t=e.child,(e.subtreeFlags&1028)!==0&&t!==null)t.return=e,B=t;else for(;B!==null;){e=B;try{var w=e.alternate;if(e.flags&1024)switch(e.tag){case 0:case 11:case 15:break;case 1:if(w!==null){var E=w.memoizedProps,T=w.memoizedState,y=e.stateNode,m=y.getSnapshotBeforeUpdate(e.elementType===e.type?E:Mt(e.type,E),T);y.__reactInternalSnapshotBeforeUpdate=m}break;case 3:var _=e.stateNode.containerInfo;_.nodeType===1?_.textContent="":_.nodeType===9&&_.documentElement&&_.removeChild(_.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(I(163))}}catch(S){pe(e,e.return,S)}if(t=e.sibling,t!==null){t.return=e.return,B=t;break}B=e.return}return w=qd,qd=!1,w}function os(t,e,n){var r=e.updateQueue;if(r=r!==null?r.lastEffect:null,r!==null){var i=r=r.next;do{if((i.tag&t)===t){var s=i.destroy;i.destroy=void 0,s!==void 0&&Sc(e,n,s)}i=i.next}while(i!==r)}}function sl(t,e){if(e=e.updateQueue,e=e!==null?e.lastEffect:null,e!==null){var n=e=e.next;do{if((n.tag&t)===t){var r=n.create;n.destroy=r()}n=n.next}while(n!==e)}}function Ac(t){var e=t.ref;if(e!==null){var n=t.stateNode;switch(t.tag){case 5:t=n;break;default:t=n}typeof e=="function"?e(t):e.current=t}}function J0(t){var e=t.alternate;e!==null&&(t.alternate=null,J0(e)),t.child=null,t.deletions=null,t.sibling=null,t.tag===5&&(e=t.stateNode,e!==null&&(delete e[Yt],delete e[bs],delete e[hc],delete e[qw],delete e[Zw])),t.stateNode=null,t.return=null,t.dependencies=null,t.memoizedProps=null,t.memoizedState=null,t.pendingProps=null,t.stateNode=null,t.updateQueue=null}function ey(t){return t.tag===5||t.tag===3||t.tag===4}function Zd(t){e:for(;;){for(;t.sibling===null;){if(t.return===null||ey(t.return))return null;t=t.return}for(t.sibling.return=t.return,t=t.sibling;t.tag!==5&&t.tag!==6&&t.tag!==18;){if(t.flags&2||t.child===null||t.tag===4)continue e;t.child.return=t,t=t.child}if(!(t.flags&2))return t.stateNode}}function xc(t,e,n){var r=t.tag;if(r===5||r===6)t=t.stateNode,e?n.nodeType===8?n.parentNode.insertBefore(t,e):n.insertBefore(t,e):(n.nodeType===8?(e=n.parentNode,e.insertBefore(t,n)):(e=n,e.appendChild(t)),n=n._reactRootContainer,n!=null||e.onclick!==null||(e.onclick=ga));else if(r!==4&&(t=t.child,t!==null))for(xc(t,e,n),t=t.sibling;t!==null;)xc(t,e,n),t=t.sibling}function Pc(t,e,n){var r=t.tag;if(r===5||r===6)t=t.stateNode,e?n.insertBefore(t,e):n.appendChild(t);else if(r!==4&&(t=t.child,t!==null))for(Pc(t,e,n),t=t.sibling;t!==null;)Pc(t,e,n),t=t.sibling}var Le=null,kt=!1;function Sn(t,e,n){for(n=n.child;n!==null;)ty(t,e,n),n=n.sibling}function ty(t,e,n){if(Qt&&typeof Qt.onCommitFiberUnmount=="function")try{Qt.onCommitFiberUnmount(Qa,n)}catch{}switch(n.tag){case 5:Be||$r(n,e);case 6:var r=Le,i=kt;Le=null,Sn(t,e,n),Le=r,kt=i,Le!==null&&(kt?(t=Le,n=n.stateNode,t.nodeType===8?t.parentNode.removeChild(n):t.removeChild(n)):Le.removeChild(n.stateNode));break;case 18:Le!==null&&(kt?(t=Le,n=n.stateNode,t.nodeType===8?Zl(t.parentNode,n):t.nodeType===1&&Zl(t,n),_s(t)):Zl(Le,n.stateNode));break;case 4:r=Le,i=kt,Le=n.stateNode.containerInfo,kt=!0,Sn(t,e,n),Le=r,kt=i;break;case 0:case 11:case 14:case 15:if(!Be&&(r=n.updateQueue,r!==null&&(r=r.lastEffect,r!==null))){i=r=r.next;do{var s=i,o=s.destroy;s=s.tag,o!==void 0&&(s&2||s&4)&&Sc(n,e,o),i=i.next}while(i!==r)}Sn(t,e,n);break;case 1:if(!Be&&($r(n,e),r=n.stateNode,typeof r.componentWillUnmount=="function"))try{r.props=n.memoizedProps,r.state=n.memoizedState,r.componentWillUnmount()}catch(a){pe(n,e,a)}Sn(t,e,n);break;case 21:Sn(t,e,n);break;case 22:n.mode&1?(Be=(r=Be)||n.memoizedState!==null,Sn(t,e,n),Be=r):Sn(t,e,n);break;default:Sn(t,e,n)}}function Qd(t){var e=t.updateQueue;if(e!==null){t.updateQueue=null;var n=t.stateNode;n===null&&(n=t.stateNode=new fE),e.forEach(function(r){var i=TE.bind(null,t,r);n.has(r)||(n.add(r),r.then(i,i))})}}function Rt(t,e){var n=e.deletions;if(n!==null)for(var r=0;r<n.length;r++){var i=n[r];try{var s=t,o=e,a=o;e:for(;a!==null;){switch(a.tag){case 5:Le=a.stateNode,kt=!1;break e;case 3:Le=a.stateNode.containerInfo,kt=!0;break e;case 4:Le=a.stateNode.containerInfo,kt=!0;break e}a=a.return}if(Le===null)throw Error(I(160));ty(s,o,i),Le=null,kt=!1;var l=i.alternate;l!==null&&(l.return=null),i.return=null}catch(u){pe(i,e,u)}}if(e.subtreeFlags&12854)for(e=e.child;e!==null;)ny(e,t),e=e.sibling}function ny(t,e){var n=t.alternate,r=t.flags;switch(t.tag){case 0:case 11:case 14:case 15:if(Rt(e,t),jt(t),r&4){try{os(3,t,t.return),sl(3,t)}catch(E){pe(t,t.return,E)}try{os(5,t,t.return)}catch(E){pe(t,t.return,E)}}break;case 1:Rt(e,t),jt(t),r&512&&n!==null&&$r(n,n.return);break;case 5:if(Rt(e,t),jt(t),r&512&&n!==null&&$r(n,n.return),t.flags&32){var i=t.stateNode;try{gs(i,"")}catch(E){pe(t,t.return,E)}}if(r&4&&(i=t.stateNode,i!=null)){var s=t.memoizedProps,o=n!==null?n.memoizedProps:s,a=t.type,l=t.updateQueue;if(t.updateQueue=null,l!==null)try{a==="input"&&s.type==="radio"&&s.name!=null&&bm(i,s),Qu(a,o);var u=Qu(a,s);for(o=0;o<l.length;o+=2){var c=l[o],h=l[o+1];c==="style"?Cm(i,h):c==="dangerouslySetInnerHTML"?xm(i,h):c==="children"?gs(i,h):fh(i,c,h,u)}switch(a){case"input":Xu(i,s);break;case"textarea":Sm(i,s);break;case"select":var f=i._wrapperState.wasMultiple;i._wrapperState.wasMultiple=!!s.multiple;var g=s.value;g!=null?Kr(i,!!s.multiple,g,!1):f!==!!s.multiple&&(s.defaultValue!=null?Kr(i,!!s.multiple,s.defaultValue,!0):Kr(i,!!s.multiple,s.multiple?[]:"",!1))}i[bs]=s}catch(E){pe(t,t.return,E)}}break;case 6:if(Rt(e,t),jt(t),r&4){if(t.stateNode===null)throw Error(I(162));i=t.stateNode,s=t.memoizedProps;try{i.nodeValue=s}catch(E){pe(t,t.return,E)}}break;case 3:if(Rt(e,t),jt(t),r&4&&n!==null&&n.memoizedState.isDehydrated)try{_s(e.containerInfo)}catch(E){pe(t,t.return,E)}break;case 4:Rt(e,t),jt(t);break;case 13:Rt(e,t),jt(t),i=t.child,i.flags&8192&&(s=i.memoizedState!==null,i.stateNode.isHidden=s,!s||i.alternate!==null&&i.alternate.memoizedState!==null||(Wh=me())),r&4&&Qd(t);break;case 22:if(c=n!==null&&n.memoizedState!==null,t.mode&1?(Be=(u=Be)||c,Rt(e,t),Be=u):Rt(e,t),jt(t),r&8192){if(u=t.memoizedState!==null,(t.stateNode.isHidden=u)&&!c&&t.mode&1)for(B=t,c=t.child;c!==null;){for(h=B=c;B!==null;){switch(f=B,g=f.child,f.tag){case 0:case 11:case 14:case 15:os(4,f,f.return);break;case 1:$r(f,f.return);var w=f.stateNode;if(typeof w.componentWillUnmount=="function"){r=f,n=f.return;try{e=r,w.props=e.memoizedProps,w.state=e.memoizedState,w.componentWillUnmount()}catch(E){pe(r,n,E)}}break;case 5:$r(f,f.return);break;case 22:if(f.memoizedState!==null){Jd(h);continue}}g!==null?(g.return=f,B=g):Jd(h)}c=c.sibling}e:for(c=null,h=t;;){if(h.tag===5){if(c===null){c=h;try{i=h.stateNode,u?(s=i.style,typeof s.setProperty=="function"?s.setProperty("display","none","important"):s.display="none"):(a=h.stateNode,l=h.memoizedProps.style,o=l!=null&&l.hasOwnProperty("display")?l.display:null,a.style.display=Pm("display",o))}catch(E){pe(t,t.return,E)}}}else if(h.tag===6){if(c===null)try{h.stateNode.nodeValue=u?"":h.memoizedProps}catch(E){pe(t,t.return,E)}}else if((h.tag!==22&&h.tag!==23||h.memoizedState===null||h===t)&&h.child!==null){h.child.return=h,h=h.child;continue}if(h===t)break e;for(;h.sibling===null;){if(h.return===null||h.return===t)break e;c===h&&(c=null),h=h.return}c===h&&(c=null),h.sibling.return=h.return,h=h.sibling}}break;case 19:Rt(e,t),jt(t),r&4&&Qd(t);break;case 21:break;default:Rt(e,t),jt(t)}}function jt(t){var e=t.flags;if(e&2){try{e:{for(var n=t.return;n!==null;){if(ey(n)){var r=n;break e}n=n.return}throw Error(I(160))}switch(r.tag){case 5:var i=r.stateNode;r.flags&32&&(gs(i,""),r.flags&=-33);var s=Zd(t);Pc(t,s,i);break;case 3:case 4:var o=r.stateNode.containerInfo,a=Zd(t);xc(t,a,o);break;default:throw Error(I(161))}}catch(l){pe(t,t.return,l)}t.flags&=-3}e&4096&&(t.flags&=-4097)}function gE(t,e,n){B=t,ry(t)}function ry(t,e,n){for(var r=(t.mode&1)!==0;B!==null;){var i=B,s=i.child;if(i.tag===22&&r){var o=i.memoizedState!==null||Ao;if(!o){var a=i.alternate,l=a!==null&&a.memoizedState!==null||Be;a=Ao;var u=Be;if(Ao=o,(Be=l)&&!u)for(B=i;B!==null;)o=B,l=o.child,o.tag===22&&o.memoizedState!==null?eg(i):l!==null?(l.return=o,B=l):eg(i);for(;s!==null;)B=s,ry(s),s=s.sibling;B=i,Ao=a,Be=u}Kd(t)}else i.subtreeFlags&8772&&s!==null?(s.return=i,B=s):Kd(t)}}function Kd(t){for(;B!==null;){var e=B;if(e.flags&8772){var n=e.alternate;try{if(e.flags&8772)switch(e.tag){case 0:case 11:case 15:Be||sl(5,e);break;case 1:var r=e.stateNode;if(e.flags&4&&!Be)if(n===null)r.componentDidMount();else{var i=e.elementType===e.type?n.memoizedProps:Mt(e.type,n.memoizedProps);r.componentDidUpdate(i,n.memoizedState,r.__reactInternalSnapshotBeforeUpdate)}var s=e.updateQueue;s!==null&&Nd(e,s,r);break;case 3:var o=e.updateQueue;if(o!==null){if(n=null,e.child!==null)switch(e.child.tag){case 5:n=e.child.stateNode;break;case 1:n=e.child.stateNode}Nd(e,o,n)}break;case 5:var a=e.stateNode;if(n===null&&e.flags&4){n=a;var l=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":l.autoFocus&&n.focus();break;case"img":l.src&&(n.src=l.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(e.memoizedState===null){var u=e.alternate;if(u!==null){var c=u.memoizedState;if(c!==null){var h=c.dehydrated;h!==null&&_s(h)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(I(163))}Be||e.flags&512&&Ac(e)}catch(f){pe(e,e.return,f)}}if(e===t){B=null;break}if(n=e.sibling,n!==null){n.return=e.return,B=n;break}B=e.return}}function Jd(t){for(;B!==null;){var e=B;if(e===t){B=null;break}var n=e.sibling;if(n!==null){n.return=e.return,B=n;break}B=e.return}}function eg(t){for(;B!==null;){var e=B;try{switch(e.tag){case 0:case 11:case 15:var n=e.return;try{sl(4,e)}catch(l){pe(e,n,l)}break;case 1:var r=e.stateNode;if(typeof r.componentDidMount=="function"){var i=e.return;try{r.componentDidMount()}catch(l){pe(e,i,l)}}var s=e.return;try{Ac(e)}catch(l){pe(e,s,l)}break;case 5:var o=e.return;try{Ac(e)}catch(l){pe(e,o,l)}}}catch(l){pe(e,e.return,l)}if(e===t){B=null;break}var a=e.sibling;if(a!==null){a.return=e.return,B=a;break}B=e.return}}var pE=Math.ceil,Aa=wn.ReactCurrentDispatcher,Gh=wn.ReactCurrentOwner,bt=wn.ReactCurrentBatchConfig,Z=0,xe=null,ve=null,ke=0,st=0,qr=Zn(0),be=0,Ls=null,yr=0,ol=0,Hh=0,as=null,Qe=null,Wh=0,fi=1/0,on=null,xa=!1,Cc=null,jn=null,xo=!1,Nn=null,Pa=0,ls=0,Lc=null,$o=-1,qo=0;function Xe(){return Z&6?me():$o!==-1?$o:$o=me()}function Gn(t){return t.mode&1?Z&2&&ke!==0?ke&-ke:Kw.transition!==null?(qo===0&&(qo=Vm()),qo):(t=ee,t!==0||(t=window.event,t=t===void 0?16:Ym(t.type)),t):1}function Dt(t,e,n,r){if(50<ls)throw ls=0,Lc=null,Error(I(185));Vs(t,n,r),(!(Z&2)||t!==xe)&&(t===xe&&(!(Z&2)&&(ol|=n),be===4&&In(t,ke)),tt(t,r),n===1&&Z===0&&!(e.mode&1)&&(fi=me()+500,nl&&Qn()))}function tt(t,e){var n=t.callbackNode;K1(t,e);var r=ca(t,t===xe?ke:0);if(r===0)n!==null&&ud(n),t.callbackNode=null,t.callbackPriority=0;else if(e=r&-r,t.callbackPriority!==e){if(n!=null&&ud(n),e===1)t.tag===0?Qw(tg.bind(null,t)):f0(tg.bind(null,t)),Yw(function(){!(Z&6)&&Qn()}),n=null;else{switch(zm(r)){case 1:n=yh;break;case 4:n=Um;break;case 16:n=ua;break;case 536870912:n=Bm;break;default:n=ua}n=hy(n,iy.bind(null,t))}t.callbackPriority=e,t.callbackNode=n}}function iy(t,e){if($o=-1,qo=0,Z&6)throw Error(I(327));var n=t.callbackNode;if(ri()&&t.callbackNode!==n)return null;var r=ca(t,t===xe?ke:0);if(r===0)return null;if(r&30||r&t.expiredLanes||e)e=Ca(t,r);else{e=r;var i=Z;Z|=2;var s=oy();(xe!==t||ke!==e)&&(on=null,fi=me()+500,hr(t,e));do try{_E();break}catch(a){sy(t,a)}while(1);Rh(),Aa.current=s,Z=i,ve!==null?e=0:(xe=null,ke=0,e=be)}if(e!==0){if(e===2&&(i=nc(t),i!==0&&(r=i,e=Rc(t,i))),e===1)throw n=Ls,hr(t,0),In(t,r),tt(t,me()),n;if(e===6)In(t,r);else{if(i=t.current.alternate,!(r&30)&&!mE(i)&&(e=Ca(t,r),e===2&&(s=nc(t),s!==0&&(r=s,e=Rc(t,s))),e===1))throw n=Ls,hr(t,0),In(t,r),tt(t,me()),n;switch(t.finishedWork=i,t.finishedLanes=r,e){case 0:case 1:throw Error(I(345));case 2:sr(t,Qe,on);break;case 3:if(In(t,r),(r&130023424)===r&&(e=Wh+500-me(),10<e)){if(ca(t,0)!==0)break;if(i=t.suspendedLanes,(i&r)!==r){Xe(),t.pingedLanes|=t.suspendedLanes&i;break}t.timeoutHandle=cc(sr.bind(null,t,Qe,on),e);break}sr(t,Qe,on);break;case 4:if(In(t,r),(r&4194240)===r)break;for(e=t.eventTimes,i=-1;0<r;){var o=31-Nt(r);s=1<<o,o=e[o],o>i&&(i=o),r&=~s}if(r=i,r=me()-r,r=(120>r?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*pE(r/1960))-r,10<r){t.timeoutHandle=cc(sr.bind(null,t,Qe,on),r);break}sr(t,Qe,on);break;case 5:sr(t,Qe,on);break;default:throw Error(I(329))}}}return tt(t,me()),t.callbackNode===n?iy.bind(null,t):null}function Rc(t,e){var n=as;return t.current.memoizedState.isDehydrated&&(hr(t,e).flags|=256),t=Ca(t,e),t!==2&&(e=Qe,Qe=n,e!==null&&Mc(e)),t}function Mc(t){Qe===null?Qe=t:Qe.push.apply(Qe,t)}function mE(t){for(var e=t;;){if(e.flags&16384){var n=e.updateQueue;if(n!==null&&(n=n.stores,n!==null))for(var r=0;r<n.length;r++){var i=n[r],s=i.getSnapshot;i=i.value;try{if(!Ut(s(),i))return!1}catch{return!1}}}if(n=e.child,e.subtreeFlags&16384&&n!==null)n.return=e,e=n;else{if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function In(t,e){for(e&=~Hh,e&=~ol,t.suspendedLanes|=e,t.pingedLanes&=~e,t=t.expirationTimes;0<e;){var n=31-Nt(e),r=1<<n;t[n]=-1,e&=~r}}function tg(t){if(Z&6)throw Error(I(327));ri();var e=ca(t,0);if(!(e&1))return tt(t,me()),null;var n=Ca(t,e);if(t.tag!==0&&n===2){var r=nc(t);r!==0&&(e=r,n=Rc(t,r))}if(n===1)throw n=Ls,hr(t,0),In(t,e),tt(t,me()),n;if(n===6)throw Error(I(345));return t.finishedWork=t.current.alternate,t.finishedLanes=e,sr(t,Qe,on),tt(t,me()),null}function Xh(t,e){var n=Z;Z|=1;try{return t(e)}finally{Z=n,Z===0&&(fi=me()+500,nl&&Qn())}}function _r(t){Nn!==null&&Nn.tag===0&&!(Z&6)&&ri();var e=Z;Z|=1;var n=bt.transition,r=ee;try{if(bt.transition=null,ee=1,t)return t()}finally{ee=r,bt.transition=n,Z=e,!(Z&6)&&Qn()}}function Yh(){st=qr.current,le(qr)}function hr(t,e){t.finishedWork=null,t.finishedLanes=0;var n=t.timeoutHandle;if(n!==-1&&(t.timeoutHandle=-1,Xw(n)),ve!==null)for(n=ve.return;n!==null;){var r=n;switch(Ph(r),r.tag){case 1:r=r.type.childContextTypes,r!=null&&pa();break;case 3:ci(),le(Je),le(Ve),Dh();break;case 5:Nh(r);break;case 4:ci();break;case 13:le(he);break;case 19:le(he);break;case 10:Mh(r.type._context);break;case 22:case 23:Yh()}n=n.return}if(xe=t,ve=t=Hn(t.current,null),ke=st=e,be=0,Ls=null,Hh=ol=yr=0,Qe=as=null,lr!==null){for(e=0;e<lr.length;e++)if(n=lr[e],r=n.interleaved,r!==null){n.interleaved=null;var i=r.next,s=n.pending;if(s!==null){var o=s.next;s.next=i,r.next=o}n.pending=r}lr=null}return t}function sy(t,e){do{var n=ve;try{if(Rh(),Wo.current=Sa,ba){for(var r=fe.memoizedState;r!==null;){var i=r.queue;i!==null&&(i.pending=null),r=r.next}ba=!1}if(mr=0,Ae=Te=fe=null,ss=!1,xs=0,Gh.current=null,n===null||n.return===null){be=1,Ls=e,ve=null;break}e:{var s=t,o=n.return,a=n,l=e;if(e=ke,a.flags|=32768,l!==null&&typeof l=="object"&&typeof l.then=="function"){var u=l,c=a,h=c.tag;if(!(c.mode&1)&&(h===0||h===11||h===15)){var f=c.alternate;f?(c.updateQueue=f.updateQueue,c.memoizedState=f.memoizedState,c.lanes=f.lanes):(c.updateQueue=null,c.memoizedState=null)}var g=jd(o);if(g!==null){g.flags&=-257,Gd(g,o,a,s,e),g.mode&1&&zd(s,u,e),e=g,l=u;var w=e.updateQueue;if(w===null){var E=new Set;E.add(l),e.updateQueue=E}else w.add(l);break e}else{if(!(e&1)){zd(s,u,e),$h();break e}l=Error(I(426))}}else if(ce&&a.mode&1){var T=jd(o);if(T!==null){!(T.flags&65536)&&(T.flags|=256),Gd(T,o,a,s,e),Ch(hi(l,a));break e}}s=l=hi(l,a),be!==4&&(be=2),as===null?as=[s]:as.push(s),s=o;do{switch(s.tag){case 3:s.flags|=65536,e&=-e,s.lanes|=e;var y=j0(s,l,e);Od(s,y);break e;case 1:a=l;var m=s.type,_=s.stateNode;if(!(s.flags&128)&&(typeof m.getDerivedStateFromError=="function"||_!==null&&typeof _.componentDidCatch=="function"&&(jn===null||!jn.has(_)))){s.flags|=65536,e&=-e,s.lanes|=e;var S=G0(s,a,e);Od(s,S);break e}}s=s.return}while(s!==null)}ly(n)}catch(A){e=A,ve===n&&n!==null&&(ve=n=n.return);continue}break}while(1)}function oy(){var t=Aa.current;return Aa.current=Sa,t===null?Sa:t}function $h(){(be===0||be===3||be===2)&&(be=4),xe===null||!(yr&268435455)&&!(ol&268435455)||In(xe,ke)}function Ca(t,e){var n=Z;Z|=2;var r=oy();(xe!==t||ke!==e)&&(on=null,hr(t,e));do try{yE();break}catch(i){sy(t,i)}while(1);if(Rh(),Z=n,Aa.current=r,ve!==null)throw Error(I(261));return xe=null,ke=0,be}function yE(){for(;ve!==null;)ay(ve)}function _E(){for(;ve!==null&&!G1();)ay(ve)}function ay(t){var e=cy(t.alternate,t,st);t.memoizedProps=t.pendingProps,e===null?ly(t):ve=e,Gh.current=null}function ly(t){var e=t;do{var n=e.alternate;if(t=e.return,e.flags&32768){if(n=hE(n,e),n!==null){n.flags&=32767,ve=n;return}if(t!==null)t.flags|=32768,t.subtreeFlags=0,t.deletions=null;else{be=6,ve=null;return}}else if(n=cE(n,e,st),n!==null){ve=n;return}if(e=e.sibling,e!==null){ve=e;return}ve=e=t}while(e!==null);be===0&&(be=5)}function sr(t,e,n){var r=ee,i=bt.transition;try{bt.transition=null,ee=1,vE(t,e,n,r)}finally{bt.transition=i,ee=r}return null}function vE(t,e,n,r){do ri();while(Nn!==null);if(Z&6)throw Error(I(327));n=t.finishedWork;var i=t.finishedLanes;if(n===null)return null;if(t.finishedWork=null,t.finishedLanes=0,n===t.current)throw Error(I(177));t.callbackNode=null,t.callbackPriority=0;var s=n.lanes|n.childLanes;if(J1(t,s),t===xe&&(ve=xe=null,ke=0),!(n.subtreeFlags&2064)&&!(n.flags&2064)||xo||(xo=!0,hy(ua,function(){return ri(),null})),s=(n.flags&15990)!==0,n.subtreeFlags&15990||s){s=bt.transition,bt.transition=null;var o=ee;ee=1;var a=Z;Z|=4,Gh.current=null,dE(t,n),ny(n,t),Bw(lc),ha=!!ac,lc=ac=null,t.current=n,gE(n),H1(),Z=a,ee=o,bt.transition=s}else t.current=n;if(xo&&(xo=!1,Nn=t,Pa=i),s=t.pendingLanes,s===0&&(jn=null),Y1(n.stateNode),tt(t,me()),e!==null)for(r=t.onRecoverableError,n=0;n<e.length;n++)i=e[n],r(i.value,{componentStack:i.stack,digest:i.digest});if(xa)throw xa=!1,t=Cc,Cc=null,t;return Pa&1&&t.tag!==0&&ri(),s=t.pendingLanes,s&1?t===Lc?ls++:(ls=0,Lc=t):ls=0,Qn(),null}function ri(){if(Nn!==null){var t=zm(Pa),e=bt.transition,n=ee;try{if(bt.transition=null,ee=16>t?16:t,Nn===null)var r=!1;else{if(t=Nn,Nn=null,Pa=0,Z&6)throw Error(I(331));var i=Z;for(Z|=4,B=t.current;B!==null;){var s=B,o=s.child;if(B.flags&16){var a=s.deletions;if(a!==null){for(var l=0;l<a.length;l++){var u=a[l];for(B=u;B!==null;){var c=B;switch(c.tag){case 0:case 11:case 15:os(8,c,s)}var h=c.child;if(h!==null)h.return=c,B=h;else for(;B!==null;){c=B;var f=c.sibling,g=c.return;if(J0(c),c===u){B=null;break}if(f!==null){f.return=g,B=f;break}B=g}}}var w=s.alternate;if(w!==null){var E=w.child;if(E!==null){w.child=null;do{var T=E.sibling;E.sibling=null,E=T}while(E!==null)}}B=s}}if(s.subtreeFlags&2064&&o!==null)o.return=s,B=o;else e:for(;B!==null;){if(s=B,s.flags&2048)switch(s.tag){case 0:case 11:case 15:os(9,s,s.return)}var y=s.sibling;if(y!==null){y.return=s.return,B=y;break e}B=s.return}}var m=t.current;for(B=m;B!==null;){o=B;var _=o.child;if(o.subtreeFlags&2064&&_!==null)_.return=o,B=_;else e:for(o=m;B!==null;){if(a=B,a.flags&2048)try{switch(a.tag){case 0:case 11:case 15:sl(9,a)}}catch(A){pe(a,a.return,A)}if(a===o){B=null;break e}var S=a.sibling;if(S!==null){S.return=a.return,B=S;break e}B=a.return}}if(Z=i,Qn(),Qt&&typeof Qt.onPostCommitFiberRoot=="function")try{Qt.onPostCommitFiberRoot(Qa,t)}catch{}r=!0}return r}finally{ee=n,bt.transition=e}}return!1}function ng(t,e,n){e=hi(n,e),e=j0(t,e,1),t=zn(t,e,1),e=Xe(),t!==null&&(Vs(t,1,e),tt(t,e))}function pe(t,e,n){if(t.tag===3)ng(t,t,n);else for(;e!==null;){if(e.tag===3){ng(e,t,n);break}else if(e.tag===1){var r=e.stateNode;if(typeof e.type.getDerivedStateFromError=="function"||typeof r.componentDidCatch=="function"&&(jn===null||!jn.has(r))){t=hi(n,t),t=G0(e,t,1),e=zn(e,t,1),t=Xe(),e!==null&&(Vs(e,1,t),tt(e,t));break}}e=e.return}}function wE(t,e,n){var r=t.pingCache;r!==null&&r.delete(e),e=Xe(),t.pingedLanes|=t.suspendedLanes&n,xe===t&&(ke&n)===n&&(be===4||be===3&&(ke&130023424)===ke&&500>me()-Wh?hr(t,0):Hh|=n),tt(t,e)}function uy(t,e){e===0&&(t.mode&1?(e=mo,mo<<=1,!(mo&130023424)&&(mo=4194304)):e=1);var n=Xe();t=gn(t,e),t!==null&&(Vs(t,e,n),tt(t,n))}function EE(t){var e=t.memoizedState,n=0;e!==null&&(n=e.retryLane),uy(t,n)}function TE(t,e){var n=0;switch(t.tag){case 13:var r=t.stateNode,i=t.memoizedState;i!==null&&(n=i.retryLane);break;case 19:r=t.stateNode;break;default:throw Error(I(314))}r!==null&&r.delete(e),uy(t,n)}var cy;cy=function(t,e,n){if(t!==null)if(t.memoizedProps!==e.pendingProps||Je.current)Ke=!0;else{if(!(t.lanes&n)&&!(e.flags&128))return Ke=!1,uE(t,e,n);Ke=!!(t.flags&131072)}else Ke=!1,ce&&e.flags&1048576&&d0(e,_a,e.index);switch(e.lanes=0,e.tag){case 2:var r=e.type;Yo(t,e),t=e.pendingProps;var i=ai(e,Ve.current);ni(e,n),i=Uh(null,e,r,t,i,n);var s=Bh();return e.flags|=1,typeof i=="object"&&i!==null&&typeof i.render=="function"&&i.$$typeof===void 0?(e.tag=1,e.memoizedState=null,e.updateQueue=null,et(r)?(s=!0,ma(e)):s=!1,e.memoizedState=i.state!==null&&i.state!==void 0?i.state:null,Ih(e),i.updater=rl,e.stateNode=i,i._reactInternals=e,yc(e,r,t,n),e=wc(null,e,r,!0,s,n)):(e.tag=0,ce&&s&&xh(e),je(null,e,i,n),e=e.child),e;case 16:r=e.elementType;e:{switch(Yo(t,e),t=e.pendingProps,i=r._init,r=i(r._payload),e.type=r,i=e.tag=SE(r),t=Mt(r,t),i){case 0:e=vc(null,e,r,t,n);break e;case 1:e=Xd(null,e,r,t,n);break e;case 11:e=Hd(null,e,r,t,n);break e;case 14:e=Wd(null,e,r,Mt(r.type,t),n);break e}throw Error(I(306,r,""))}return e;case 0:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:Mt(r,i),vc(t,e,r,i,n);case 1:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:Mt(r,i),Xd(t,e,r,i,n);case 3:e:{if(Y0(e),t===null)throw Error(I(387));r=e.pendingProps,s=e.memoizedState,i=s.element,y0(t,e),Ea(e,r,null,n);var o=e.memoizedState;if(r=o.element,s.isDehydrated)if(s={element:r,isDehydrated:!1,cache:o.cache,pendingSuspenseBoundaries:o.pendingSuspenseBoundaries,transitions:o.transitions},e.updateQueue.baseState=s,e.memoizedState=s,e.flags&256){i=hi(Error(I(423)),e),e=Yd(t,e,r,n,i);break e}else if(r!==i){i=hi(Error(I(424)),e),e=Yd(t,e,r,n,i);break e}else for(lt=Vn(e.stateNode.containerInfo.firstChild),ct=e,ce=!0,It=null,n=E0(e,null,r,n),e.child=n;n;)n.flags=n.flags&-3|4096,n=n.sibling;else{if(li(),r===i){e=pn(t,e,n);break e}je(t,e,r,n)}e=e.child}return e;case 5:return T0(e),t===null&&gc(e),r=e.type,i=e.pendingProps,s=t!==null?t.memoizedProps:null,o=i.children,uc(r,i)?o=null:s!==null&&uc(r,s)&&(e.flags|=32),X0(t,e),je(t,e,o,n),e.child;case 6:return t===null&&gc(e),null;case 13:return $0(t,e,n);case 4:return Oh(e,e.stateNode.containerInfo),r=e.pendingProps,t===null?e.child=ui(e,null,r,n):je(t,e,r,n),e.child;case 11:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:Mt(r,i),Hd(t,e,r,i,n);case 7:return je(t,e,e.pendingProps,n),e.child;case 8:return je(t,e,e.pendingProps.children,n),e.child;case 12:return je(t,e,e.pendingProps.children,n),e.child;case 10:e:{if(r=e.type._context,i=e.pendingProps,s=e.memoizedProps,o=i.value,ie(va,r._currentValue),r._currentValue=o,s!==null)if(Ut(s.value,o)){if(s.children===i.children&&!Je.current){e=pn(t,e,n);break e}}else for(s=e.child,s!==null&&(s.return=e);s!==null;){var a=s.dependencies;if(a!==null){o=s.child;for(var l=a.firstContext;l!==null;){if(l.context===r){if(s.tag===1){l=hn(-1,n&-n),l.tag=2;var u=s.updateQueue;if(u!==null){u=u.shared;var c=u.pending;c===null?l.next=l:(l.next=c.next,c.next=l),u.pending=l}}s.lanes|=n,l=s.alternate,l!==null&&(l.lanes|=n),pc(s.return,n,e),a.lanes|=n;break}l=l.next}}else if(s.tag===10)o=s.type===e.type?null:s.child;else if(s.tag===18){if(o=s.return,o===null)throw Error(I(341));o.lanes|=n,a=o.alternate,a!==null&&(a.lanes|=n),pc(o,n,e),o=s.sibling}else o=s.child;if(o!==null)o.return=s;else for(o=s;o!==null;){if(o===e){o=null;break}if(s=o.sibling,s!==null){s.return=o.return,o=s;break}o=o.return}s=o}je(t,e,i.children,n),e=e.child}return e;case 9:return i=e.type,r=e.pendingProps.children,ni(e,n),i=At(i),r=r(i),e.flags|=1,je(t,e,r,n),e.child;case 14:return r=e.type,i=Mt(r,e.pendingProps),i=Mt(r.type,i),Wd(t,e,r,i,n);case 15:return H0(t,e,e.type,e.pendingProps,n);case 17:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:Mt(r,i),Yo(t,e),e.tag=1,et(r)?(t=!0,ma(e)):t=!1,ni(e,n),v0(e,r,i),yc(e,r,i,n),wc(null,e,r,!0,t,n);case 19:return q0(t,e,n);case 22:return W0(t,e,n)}throw Error(I(156,e.tag))};function hy(t,e){return Fm(t,e)}function bE(t,e,n,r){this.tag=t,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Tt(t,e,n,r){return new bE(t,e,n,r)}function qh(t){return t=t.prototype,!(!t||!t.isReactComponent)}function SE(t){if(typeof t=="function")return qh(t)?1:0;if(t!=null){if(t=t.$$typeof,t===gh)return 11;if(t===ph)return 14}return 2}function Hn(t,e){var n=t.alternate;return n===null?(n=Tt(t.tag,e,t.key,t.mode),n.elementType=t.elementType,n.type=t.type,n.stateNode=t.stateNode,n.alternate=t,t.alternate=n):(n.pendingProps=e,n.type=t.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=t.flags&14680064,n.childLanes=t.childLanes,n.lanes=t.lanes,n.child=t.child,n.memoizedProps=t.memoizedProps,n.memoizedState=t.memoizedState,n.updateQueue=t.updateQueue,e=t.dependencies,n.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext},n.sibling=t.sibling,n.index=t.index,n.ref=t.ref,n}function Zo(t,e,n,r,i,s){var o=2;if(r=t,typeof t=="function")qh(t)&&(o=1);else if(typeof t=="string")o=5;else e:switch(t){case Br:return fr(n.children,i,s,e);case dh:o=8,i|=8;break;case zu:return t=Tt(12,n,e,i|2),t.elementType=zu,t.lanes=s,t;case ju:return t=Tt(13,n,e,i),t.elementType=ju,t.lanes=s,t;case Gu:return t=Tt(19,n,e,i),t.elementType=Gu,t.lanes=s,t;case wm:return al(n,i,s,e);default:if(typeof t=="object"&&t!==null)switch(t.$$typeof){case _m:o=10;break e;case vm:o=9;break e;case gh:o=11;break e;case ph:o=14;break e;case Rn:o=16,r=null;break e}throw Error(I(130,t==null?t:typeof t,""))}return e=Tt(o,n,e,i),e.elementType=t,e.type=r,e.lanes=s,e}function fr(t,e,n,r){return t=Tt(7,t,r,e),t.lanes=n,t}function al(t,e,n,r){return t=Tt(22,t,r,e),t.elementType=wm,t.lanes=n,t.stateNode={isHidden:!1},t}function iu(t,e,n){return t=Tt(6,t,null,e),t.lanes=n,t}function su(t,e,n){return e=Tt(4,t.children!==null?t.children:[],t.key,e),e.lanes=n,e.stateNode={containerInfo:t.containerInfo,pendingChildren:null,implementation:t.implementation},e}function AE(t,e,n,r,i){this.tag=e,this.containerInfo=t,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Bl(0),this.expirationTimes=Bl(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Bl(0),this.identifierPrefix=r,this.onRecoverableError=i,this.mutableSourceEagerHydrationData=null}function Zh(t,e,n,r,i,s,o,a,l){return t=new AE(t,e,n,a,l),e===1?(e=1,s===!0&&(e|=8)):e=0,s=Tt(3,null,null,e),t.current=s,s.stateNode=t,s.memoizedState={element:r,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},Ih(s),t}function xE(t,e,n){var r=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:Ur,key:r==null?null:""+r,children:t,containerInfo:e,implementation:n}}function fy(t){if(!t)return Yn;t=t._reactInternals;e:{if(Sr(t)!==t||t.tag!==1)throw Error(I(170));var e=t;do{switch(e.tag){case 3:e=e.stateNode.context;break e;case 1:if(et(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break e}}e=e.return}while(e!==null);throw Error(I(171))}if(t.tag===1){var n=t.type;if(et(n))return h0(t,n,e)}return e}function dy(t,e,n,r,i,s,o,a,l){return t=Zh(n,r,!0,t,i,s,o,a,l),t.context=fy(null),n=t.current,r=Xe(),i=Gn(n),s=hn(r,i),s.callback=e??null,zn(n,s,i),t.current.lanes=i,Vs(t,i,r),tt(t,r),t}function ll(t,e,n,r){var i=e.current,s=Xe(),o=Gn(i);return n=fy(n),e.context===null?e.context=n:e.pendingContext=n,e=hn(s,o),e.payload={element:t},r=r===void 0?null:r,r!==null&&(e.callback=r),t=zn(i,e,o),t!==null&&(Dt(t,i,o,s),Ho(t,i,o)),o}function La(t){if(t=t.current,!t.child)return null;switch(t.child.tag){case 5:return t.child.stateNode;default:return t.child.stateNode}}function rg(t,e){if(t=t.memoizedState,t!==null&&t.dehydrated!==null){var n=t.retryLane;t.retryLane=n!==0&&n<e?n:e}}function Qh(t,e){rg(t,e),(t=t.alternate)&&rg(t,e)}function PE(){return null}var gy=typeof reportError=="function"?reportError:function(t){console.error(t)};function Kh(t){this._internalRoot=t}ul.prototype.render=Kh.prototype.render=function(t){var e=this._internalRoot;if(e===null)throw Error(I(409));ll(t,e,null,null)};ul.prototype.unmount=Kh.prototype.unmount=function(){var t=this._internalRoot;if(t!==null){this._internalRoot=null;var e=t.containerInfo;_r(function(){ll(null,t,null,null)}),e[dn]=null}};function ul(t){this._internalRoot=t}ul.prototype.unstable_scheduleHydration=function(t){if(t){var e=Hm();t={blockedOn:null,target:t,priority:e};for(var n=0;n<kn.length&&e!==0&&e<kn[n].priority;n++);kn.splice(n,0,t),n===0&&Xm(t)}};function Jh(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11)}function cl(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11&&(t.nodeType!==8||t.nodeValue!==" react-mount-point-unstable "))}function ig(){}function CE(t,e,n,r,i){if(i){if(typeof r=="function"){var s=r;r=function(){var u=La(o);s.call(u)}}var o=dy(e,r,t,0,null,!1,!1,"",ig);return t._reactRootContainer=o,t[dn]=o.current,Es(t.nodeType===8?t.parentNode:t),_r(),o}for(;i=t.lastChild;)t.removeChild(i);if(typeof r=="function"){var a=r;r=function(){var u=La(l);a.call(u)}}var l=Zh(t,0,!1,null,null,!1,!1,"",ig);return t._reactRootContainer=l,t[dn]=l.current,Es(t.nodeType===8?t.parentNode:t),_r(function(){ll(e,l,n,r)}),l}function hl(t,e,n,r,i){var s=n._reactRootContainer;if(s){var o=s;if(typeof i=="function"){var a=i;i=function(){var l=La(o);a.call(l)}}ll(e,o,t,i)}else o=CE(n,e,t,i,r);return La(o)}jm=function(t){switch(t.tag){case 3:var e=t.stateNode;if(e.current.memoizedState.isDehydrated){var n=Zi(e.pendingLanes);n!==0&&(_h(e,n|1),tt(e,me()),!(Z&6)&&(fi=me()+500,Qn()))}break;case 13:_r(function(){var r=gn(t,1);if(r!==null){var i=Xe();Dt(r,t,1,i)}}),Qh(t,1)}};vh=function(t){if(t.tag===13){var e=gn(t,134217728);if(e!==null){var n=Xe();Dt(e,t,134217728,n)}Qh(t,134217728)}};Gm=function(t){if(t.tag===13){var e=Gn(t),n=gn(t,e);if(n!==null){var r=Xe();Dt(n,t,e,r)}Qh(t,e)}};Hm=function(){return ee};Wm=function(t,e){var n=ee;try{return ee=t,e()}finally{ee=n}};Ju=function(t,e,n){switch(e){case"input":if(Xu(t,n),e=n.name,n.type==="radio"&&e!=null){for(n=t;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<n.length;e++){var r=n[e];if(r!==t&&r.form===t.form){var i=tl(r);if(!i)throw Error(I(90));Tm(r),Xu(r,i)}}}break;case"textarea":Sm(t,n);break;case"select":e=n.value,e!=null&&Kr(t,!!n.multiple,e,!1)}};Mm=Xh;km=_r;var LE={usingClientEntryPoint:!1,Events:[js,Gr,tl,Lm,Rm,Xh]},zi={findFiberByHostInstance:ar,bundleType:0,version:"18.2.0",rendererPackageName:"react-dom"},RE={bundleType:zi.bundleType,version:zi.version,rendererPackageName:zi.rendererPackageName,rendererConfig:zi.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:wn.ReactCurrentDispatcher,findHostInstanceByFiber:function(t){return t=Nm(t),t===null?null:t.stateNode},findFiberByHostInstance:zi.findFiberByHostInstance||PE,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.2.0-next-9e3b772b8-20220608"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Po=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Po.isDisabled&&Po.supportsFiber)try{Qa=Po.inject(RE),Qt=Po}catch{}}gt.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=LE;gt.createPortal=function(t,e){var n=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!Jh(e))throw Error(I(200));return xE(t,e,null,n)};gt.createRoot=function(t,e){if(!Jh(t))throw Error(I(299));var n=!1,r="",i=gy;return e!=null&&(e.unstable_strictMode===!0&&(n=!0),e.identifierPrefix!==void 0&&(r=e.identifierPrefix),e.onRecoverableError!==void 0&&(i=e.onRecoverableError)),e=Zh(t,1,!1,null,null,n,!1,r,i),t[dn]=e.current,Es(t.nodeType===8?t.parentNode:t),new Kh(e)};gt.findDOMNode=function(t){if(t==null)return null;if(t.nodeType===1)return t;var e=t._reactInternals;if(e===void 0)throw typeof t.render=="function"?Error(I(188)):(t=Object.keys(t).join(","),Error(I(268,t)));return t=Nm(e),t=t===null?null:t.stateNode,t};gt.flushSync=function(t){return _r(t)};gt.hydrate=function(t,e,n){if(!cl(e))throw Error(I(200));return hl(null,t,e,!0,n)};gt.hydrateRoot=function(t,e,n){if(!Jh(t))throw Error(I(405));var r=n!=null&&n.hydratedSources||null,i=!1,s="",o=gy;if(n!=null&&(n.unstable_strictMode===!0&&(i=!0),n.identifierPrefix!==void 0&&(s=n.identifierPrefix),n.onRecoverableError!==void 0&&(o=n.onRecoverableError)),e=dy(e,null,t,1,n??null,i,!1,s,o),t[dn]=e.current,Es(t),r)for(t=0;t<r.length;t++)n=r[t],i=n._getVersion,i=i(n._source),e.mutableSourceEagerHydrationData==null?e.mutableSourceEagerHydrationData=[n,i]:e.mutableSourceEagerHydrationData.push(n,i);return new ul(e)};gt.render=function(t,e,n){if(!cl(e))throw Error(I(200));return hl(null,t,e,!1,n)};gt.unmountComponentAtNode=function(t){if(!cl(t))throw Error(I(40));return t._reactRootContainer?(_r(function(){hl(null,null,t,!1,function(){t._reactRootContainer=null,t[dn]=null})}),!0):!1};gt.unstable_batchedUpdates=Xh;gt.unstable_renderSubtreeIntoContainer=function(t,e,n,r){if(!cl(n))throw Error(I(200));if(t==null||t._reactInternals===void 0)throw Error(I(38));return hl(t,e,n,!1,r)};gt.version="18.2.0-next-9e3b772b8-20220608";(function(t){function e(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(n){console.error(n)}}e(),t.exports=gt})(P1);var sg=Uu;Fu.createRoot=sg.createRoot,Fu.hydrateRoot=sg.hydrateRoot;function Ra(t,e){if(!t)throw new Error(e||"loader assertion failed.")}const ef=Boolean(typeof process!="object"||String(process)!=="[object process]"||process.browser),og=typeof process<"u"&&process.version&&/v([0-9]*)/.exec(process.version);og&&parseFloat(og[1]);const ME="3.2.13";function mn(t,e){if(!t)throw new Error(e||"loaders.gl assertion failed.")}const Qo=typeof process!="object"||String(process)!=="[object process]"||process.browser,kE=typeof window<"u"&&typeof window.orientation<"u",ag=typeof process<"u"&&process.version&&/v([0-9]*)/.exec(process.version);ag&&parseFloat(ag[1]);function Rs(t){return Rs=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Rs(t)}function IE(t,e){if(Rs(t)!=="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(Rs(r)!=="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function OE(t){var e=IE(t,"string");return Rs(e)==="symbol"?e:String(e)}function d(t,e,n){return e=OE(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}class NE{constructor(e,n){d(this,"name",void 0),d(this,"workerThread",void 0),d(this,"isRunning",!0),d(this,"result",void 0),d(this,"_resolve",()=>{}),d(this,"_reject",()=>{}),this.name=e,this.workerThread=n,this.result=new Promise((r,i)=>{this._resolve=r,this._reject=i})}postMessage(e,n){this.workerThread.postMessage({source:"loaders.gl",type:e,payload:n})}done(e){mn(this.isRunning),this.isRunning=!1,this._resolve(e)}error(e){mn(this.isRunning),this.isRunning=!1,this._reject(e)}}let ou=class{};const au=new Map;function DE(t){mn(t.source&&!t.url||!t.source&&t.url);let e=au.get(t.source||t.url);return e||(t.url&&(e=FE(t.url),au.set(t.url,e)),t.source&&(e=py(t.source),au.set(t.source,e))),mn(e),e}function FE(t){if(!t.startsWith("http"))return t;const e=UE(t);return py(e)}function py(t){const e=new Blob([t],{type:"application/javascript"});return URL.createObjectURL(e)}function UE(t){return`try {
  importScripts('`.concat(t,`');
} catch (error) {
  console.error(error);
  throw error;
}`)}function my(t,e=!0,n){const r=n||new Set;if(t){if(lg(t))r.add(t);else if(lg(t.buffer))r.add(t.buffer);else if(!ArrayBuffer.isView(t)){if(e&&typeof t=="object")for(const i in t)my(t[i],e,r)}}return n===void 0?Array.from(r):[]}function lg(t){return t?t instanceof ArrayBuffer||typeof MessagePort<"u"&&t instanceof MessagePort||typeof ImageBitmap<"u"&&t instanceof ImageBitmap||typeof OffscreenCanvas<"u"&&t instanceof OffscreenCanvas:!1}const lu=()=>{};class kc{static isSupported(){return typeof Worker<"u"&&Qo||typeof ou<"u"&&!Qo}constructor(e){d(this,"name",void 0),d(this,"source",void 0),d(this,"url",void 0),d(this,"terminated",!1),d(this,"worker",void 0),d(this,"onMessage",void 0),d(this,"onError",void 0),d(this,"_loadableURL","");const{name:n,source:r,url:i}=e;mn(r||i),this.name=n,this.source=r,this.url=i,this.onMessage=lu,this.onError=s=>console.log(s),this.worker=Qo?this._createBrowserWorker():this._createNodeWorker()}destroy(){this.onMessage=lu,this.onError=lu,this.worker.terminate(),this.terminated=!0}get isRunning(){return Boolean(this.onMessage)}postMessage(e,n){n=n||my(e),this.worker.postMessage(e,n)}_getErrorFromErrorEvent(e){let n="Failed to load ";return n+="worker ".concat(this.name," from ").concat(this.url,". "),e.message&&(n+="".concat(e.message," in ")),e.lineno&&(n+=":".concat(e.lineno,":").concat(e.colno)),new Error(n)}_createBrowserWorker(){this._loadableURL=DE({source:this.source,url:this.url});const e=new Worker(this._loadableURL,{name:this.name});return e.onmessage=n=>{n.data?this.onMessage(n.data):this.onError(new Error("No data received"))},e.onerror=n=>{this.onError(this._getErrorFromErrorEvent(n)),this.terminated=!0},e.onmessageerror=n=>console.error(n),e}_createNodeWorker(){let e;if(this.url){const r=this.url.includes(":/")||this.url.startsWith("/")?this.url:"./".concat(this.url);e=new ou(r,{eval:!1})}else if(this.source)e=new ou(this.source,{eval:!0});else throw new Error("no worker");return e.on("message",n=>{this.onMessage(n)}),e.on("error",n=>{this.onError(n)}),e.on("exit",n=>{}),e}}class BE{static isSupported(){return kc.isSupported()}constructor(e){d(this,"name","unnamed"),d(this,"source",void 0),d(this,"url",void 0),d(this,"maxConcurrency",1),d(this,"maxMobileConcurrency",1),d(this,"onDebug",()=>{}),d(this,"reuseWorkers",!0),d(this,"props",{}),d(this,"jobQueue",[]),d(this,"idleQueue",[]),d(this,"count",0),d(this,"isDestroyed",!1),this.source=e.source,this.url=e.url,this.setProps(e)}destroy(){this.idleQueue.forEach(e=>e.destroy()),this.isDestroyed=!0}setProps(e){this.props={...this.props,...e},e.name!==void 0&&(this.name=e.name),e.maxConcurrency!==void 0&&(this.maxConcurrency=e.maxConcurrency),e.maxMobileConcurrency!==void 0&&(this.maxMobileConcurrency=e.maxMobileConcurrency),e.reuseWorkers!==void 0&&(this.reuseWorkers=e.reuseWorkers),e.onDebug!==void 0&&(this.onDebug=e.onDebug)}async startJob(e,n=(i,s,o)=>i.done(o),r=(i,s)=>i.error(s)){const i=new Promise(s=>(this.jobQueue.push({name:e,onMessage:n,onError:r,onStart:s}),this));return this._startQueuedJob(),await i}async _startQueuedJob(){if(!this.jobQueue.length)return;const e=this._getAvailableWorker();if(!e)return;const n=this.jobQueue.shift();if(n){this.onDebug({message:"Starting job",name:n.name,workerThread:e,backlog:this.jobQueue.length});const r=new NE(n.name,e);e.onMessage=i=>n.onMessage(r,i.type,i.payload),e.onError=i=>n.onError(r,i),n.onStart(r);try{await r.result}finally{this.returnWorkerToQueue(e)}}}returnWorkerToQueue(e){this.isDestroyed||!this.reuseWorkers||this.count>this._getMaxConcurrency()?(e.destroy(),this.count--):this.idleQueue.push(e),this.isDestroyed||this._startQueuedJob()}_getAvailableWorker(){if(this.idleQueue.length>0)return this.idleQueue.shift()||null;if(this.count<this._getMaxConcurrency()){this.count++;const e="".concat(this.name.toLowerCase()," (#").concat(this.count," of ").concat(this.maxConcurrency,")");return new kc({name:e,source:this.source,url:this.url})}return null}_getMaxConcurrency(){return kE?this.maxMobileConcurrency:this.maxConcurrency}}const VE={maxConcurrency:3,maxMobileConcurrency:1,reuseWorkers:!0,onDebug:()=>{}};class ln{static isSupported(){return kc.isSupported()}static getWorkerFarm(e={}){return ln._workerFarm=ln._workerFarm||new ln({}),ln._workerFarm.setProps(e),ln._workerFarm}constructor(e){d(this,"props",void 0),d(this,"workerPools",new Map),this.props={...VE},this.setProps(e),this.workerPools=new Map}destroy(){for(const e of this.workerPools.values())e.destroy();this.workerPools=new Map}setProps(e){this.props={...this.props,...e};for(const n of this.workerPools.values())n.setProps(this._getWorkerPoolProps())}getWorkerPool(e){const{name:n,source:r,url:i}=e;let s=this.workerPools.get(n);return s||(s=new BE({name:n,source:r,url:i}),s.setProps(this._getWorkerPoolProps()),this.workerPools.set(n,s)),s}_getWorkerPoolProps(){return{maxConcurrency:this.props.maxConcurrency,maxMobileConcurrency:this.props.maxMobileConcurrency,reuseWorkers:this.props.reuseWorkers,onDebug:this.props.onDebug}}}d(ln,"_workerFarm",void 0);const zE="latest";function jE(t,e={}){const n=e[t.id]||{},r="".concat(t.id,"-worker.js");let i=n.workerUrl;if(!i&&t.id==="compression"&&(i=e.workerUrl),e._workerType==="test"&&(i="modules/".concat(t.module,"/dist/").concat(r)),!i){let s=t.version;s==="latest"&&(s=zE);const o=s?"@".concat(s):"";i="https://unpkg.com/@loaders.gl/".concat(t.module).concat(o,"/dist/").concat(r)}return mn(i),i}function GE(t,e=ME){mn(t,"no worker provided");const n=t.version;return!(!e||!n)}function HE(t,e){return!ln.isSupported()||!Qo&&!(e!=null&&e._nodeWorkers)?!1:t.worker&&e?.worker}async function WE(t,e,n,r,i){const s=t.id,o=jE(t,n),l=ln.getWorkerFarm(n).getWorkerPool({name:s,url:o});n=JSON.parse(JSON.stringify(n)),r=JSON.parse(JSON.stringify(r||{}));const u=await l.startJob("process-on-worker",XE.bind(null,i));return u.postMessage("process",{input:e,options:n,context:r}),await(await u.result).result}async function XE(t,e,n,r){switch(n){case"done":e.done(r);break;case"error":e.error(new Error(r.error));break;case"process":const{id:i,input:s,options:o}=r;try{const a=await t(s,o);e.postMessage("done",{id:i,result:a})}catch(a){const l=a instanceof Error?a.message:"unknown error";e.postMessage("error",{id:i,error:l})}break;default:console.warn("parse-with-worker unknown message ".concat(n))}}function yy(t){return t&&typeof t=="object"&&t.isBuffer}function YE(t){return yy(t)?new Uint8Array(t.buffer,t.byteOffset,t.length).slice().buffer:t}function _y(t){if(yy(t))return YE(t);if(t instanceof ArrayBuffer)return t;if(ArrayBuffer.isView(t))return t.byteOffset===0&&t.byteLength===t.buffer.byteLength?t.buffer:t.buffer.slice(t.byteOffset,t.byteOffset+t.byteLength);if(typeof t=="string"){const e=t;return new TextEncoder().encode(e).buffer}if(t&&typeof t=="object"&&t._toArrayBuffer)return t._toArrayBuffer();throw new Error("toArrayBuffer")}function $E(t,e,n){if(n=n||t.byteLength,t.byteLength<n||e.byteLength<n)return!1;const r=new Uint8Array(t),i=new Uint8Array(e);for(let s=0;s<r.length;++s)if(r[s]!==i[s])return!1;return!0}function qE(...t){const e=t.map(s=>s instanceof ArrayBuffer?new Uint8Array(s):s),n=e.reduce((s,o)=>s+o.byteLength,0),r=new Uint8Array(n);let i=0;for(const s of e)r.set(s,i),i+=s.byteLength;return r.buffer}async function ZE(t){const e=[];for await(const n of t)e.push(n);return qE(...e)}function ug(){let t;if(typeof window<"u"&&window.performance)t=window.performance.now();else if(typeof process<"u"&&process.hrtime){const e=process.hrtime();t=e[0]*1e3+e[1]/1e6}else t=Date.now();return t}class cg{constructor(e,n){d(this,"name",void 0),d(this,"type",void 0),d(this,"sampleSize",1),d(this,"time",void 0),d(this,"count",void 0),d(this,"samples",void 0),d(this,"lastTiming",void 0),d(this,"lastSampleTime",void 0),d(this,"lastSampleCount",void 0),d(this,"_count",0),d(this,"_time",0),d(this,"_samples",0),d(this,"_startTime",0),d(this,"_timerPending",!1),this.name=e,this.type=n,this.reset()}setSampleSize(e){return this.sampleSize=e,this}incrementCount(){return this.addCount(1),this}decrementCount(){return this.subtractCount(1),this}addCount(e){return this._count+=e,this._samples++,this._checkSampling(),this}subtractCount(e){return this._count-=e,this._samples++,this._checkSampling(),this}addTime(e){return this._time+=e,this.lastTiming=e,this._samples++,this._checkSampling(),this}timeStart(){return this._startTime=ug(),this._timerPending=!0,this}timeEnd(){return this._timerPending?(this.addTime(ug()-this._startTime),this._timerPending=!1,this._checkSampling(),this):this}getSampleAverageCount(){return this.sampleSize>0?this.lastSampleCount/this.sampleSize:0}getSampleAverageTime(){return this.sampleSize>0?this.lastSampleTime/this.sampleSize:0}getSampleHz(){return this.lastSampleTime>0?this.sampleSize/(this.lastSampleTime/1e3):0}getAverageCount(){return this.samples>0?this.count/this.samples:0}getAverageTime(){return this.samples>0?this.time/this.samples:0}getHz(){return this.time>0?this.samples/(this.time/1e3):0}reset(){return this.time=0,this.count=0,this.samples=0,this.lastTiming=0,this.lastSampleTime=0,this.lastSampleCount=0,this._count=0,this._time=0,this._samples=0,this._startTime=0,this._timerPending=!1,this}_checkSampling(){this._samples===this.sampleSize&&(this.lastSampleTime=this._time,this.lastSampleCount=this._count,this.count+=this._count,this.time+=this._time,this.samples+=this._samples,this._time=0,this._count=0,this._samples=0)}}class tf{constructor(e){d(this,"id",void 0),d(this,"stats",{}),this.id=e.id,this.stats={},this._initializeStats(e.stats),Object.seal(this)}get(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"count";return this._getOrCreate({name:e,type:n})}get size(){return Object.keys(this.stats).length}reset(){for(const e in this.stats)this.stats[e].reset();return this}forEach(e){for(const n in this.stats)e(this.stats[n])}getTable(){const e={};return this.forEach(n=>{e[n.name]={time:n.time||0,count:n.count||0,average:n.getAverageTime()||0,hz:n.getHz()||0}}),e}_initializeStats(){(arguments.length>0&&arguments[0]!==void 0?arguments[0]:[]).forEach(n=>this._getOrCreate(n))}_getOrCreate(e){if(!e||!e.name)return null;const{name:n,type:r}=e;return this.stats[n]||(e instanceof cg?this.stats[n]=e:this.stats[n]=new cg(n,r)),this.stats[n]}}let QE="";const hg={};function KE(t){for(const e in hg)if(t.startsWith(e)){const n=hg[e];t=t.replace(e,n)}return!t.startsWith("http://")&&!t.startsWith("https://")&&(t="".concat(QE).concat(t)),t}function JE(t){const e=t&&t.lastIndexOf("/");return e>=0?t.substr(e+1):""}const eT=t=>typeof t=="boolean",us=t=>typeof t=="function",Hs=t=>t!==null&&typeof t=="object",fg=t=>Hs(t)&&t.constructor==={}.constructor,tT=t=>t&&typeof t[Symbol.iterator]=="function",nT=t=>t&&typeof t[Symbol.asyncIterator]=="function",Si=t=>typeof Response<"u"&&t instanceof Response||t&&t.arrayBuffer&&t.text&&t.json,Ai=t=>typeof Blob<"u"&&t instanceof Blob,rT=t=>t&&typeof t=="object"&&t.isBuffer,iT=t=>typeof ReadableStream<"u"&&t instanceof ReadableStream||Hs(t)&&us(t.tee)&&us(t.cancel)&&us(t.getReader),sT=t=>Hs(t)&&us(t.read)&&us(t.pipe)&&eT(t.readable),vy=t=>iT(t)||sT(t),oT=/^data:([-\w.]+\/[-\w.+]+)(;|,)/,aT=/^([-\w.]+\/[-\w.+]+)/;function lT(t){const e=aT.exec(t);return e?e[1]:t}function dg(t){const e=oT.exec(t);return e?e[1]:""}const uT=/\?.*/;function fl(t){if(Si(t)){const e=uu(t.url||""),n=t.headers.get("content-type")||"";return{url:e,type:lT(n)||dg(e)}}return Ai(t)?{url:uu(t.name||""),type:t.type||""}:typeof t=="string"?{url:uu(t),type:dg(t)}:{url:"",type:""}}function cT(t){return Si(t)?t.headers["content-length"]||-1:Ai(t)?t.size:typeof t=="string"?t.length:t instanceof ArrayBuffer||ArrayBuffer.isView(t)?t.byteLength:-1}function uu(t){return t.replace(uT,"")}async function wy(t){if(Si(t))return t;const e={},n=cT(t);n>=0&&(e["content-length"]=String(n));const{url:r,type:i}=fl(t);i&&(e["content-type"]=i);const s=await dT(t);s&&(e["x-first-bytes"]=s),typeof t=="string"&&(t=new TextEncoder().encode(t));const o=new Response(t,{headers:e});return Object.defineProperty(o,"url",{value:r}),o}async function hT(t){if(!t.ok){const e=await fT(t);throw new Error(e)}}async function fT(t){let e="Failed to fetch resource ".concat(t.url," (").concat(t.status,"): ");try{const n=t.headers.get("Content-Type");let r=t.statusText;n.includes("application/json")&&(r+=" ".concat(await t.text())),e+=r,e=e.length>60?"".concat(e.slice(0,60),"..."):e}catch{}return e}async function dT(t){if(typeof t=="string")return"data:,".concat(t.slice(0,5));if(t instanceof Blob){const n=t.slice(0,5);return await new Promise(r=>{const i=new FileReader;i.onload=s=>{var o;return r(s==null||(o=s.target)===null||o===void 0?void 0:o.result)},i.readAsDataURL(n)})}if(t instanceof ArrayBuffer){const n=t.slice(0,5),r=gT(n);return"data:base64,".concat(r)}return null}function gT(t){let e="";const n=new Uint8Array(t);for(let r=0;r<n.byteLength;r++)e+=String.fromCharCode(n[r]);return btoa(e)}async function gg(t,e){if(typeof t=="string"){t=KE(t);let n=e;return e!=null&&e.fetch&&typeof e?.fetch!="function"&&(n=e.fetch),await fetch(t,n)}return await wy(t)}function Ey(t){if(typeof window<"u"&&typeof window.process=="object"&&window.process.type==="renderer"||typeof process<"u"&&typeof process.versions=="object"&&Boolean(process.versions.electron))return!0;const e=typeof navigator=="object"&&typeof navigator.userAgent=="string"&&navigator.userAgent,n=t||e;return!!(n&&n.indexOf("Electron")>=0)}function En(){return!(typeof process=="object"&&String(process)==="[object process]"&&!process.browser)||Ey()}const Ko={self:typeof self<"u"&&self,window:typeof window<"u"&&window,global:typeof global<"u"&&global,document:typeof document<"u"&&document,process:typeof process=="object"&&process},Co=Ko.window||Ko.self||Ko.global,ji=Ko.process||{},Ty=typeof __VERSION__<"u"?__VERSION__:"untranspiled source";En();const cu=globalThis;function by(t){if(!t&&!En())return"Node";if(Ey(t))return"Electron";const n=t||(typeof navigator<"u"?navigator:{}).userAgent||"";if(n.indexOf("Edge")>-1)return"Edge";const r=n.indexOf("MSIE ")!==-1,i=n.indexOf("Trident/")!==-1;return r||i?"IE":cu.chrome?"Chrome":cu.safari?"Safari":cu.mozInnerScreenX?"Firefox":"Unknown"}function pT(t){try{const e=window[t],n="__storage_test__";return e.setItem(n,n),e.removeItem(n),e}catch{return null}}class mT{constructor(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:"sessionStorage";d(this,"storage",void 0),d(this,"id",void 0),d(this,"config",void 0),this.storage=pT(r),this.id=e,this.config=n,this._loadConfiguration()}getConfiguration(){return this.config}setConfiguration(e){if(Object.assign(this.config,e),this.storage){const n=JSON.stringify(this.config);this.storage.setItem(this.id,n)}}_loadConfiguration(){let e={};if(this.storage){const n=this.storage.getItem(this.id);e=n?JSON.parse(n):{}}return Object.assign(this.config,e),this}}function yT(t){let e;return t<10?e="".concat(t.toFixed(2),"ms"):t<100?e="".concat(t.toFixed(1),"ms"):t<1e3?e="".concat(t.toFixed(0),"ms"):e="".concat((t/1e3).toFixed(2),"s"),e}function _T(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:8;const n=Math.max(e-t.length,0);return"".concat(" ".repeat(n)).concat(t)}function hu(t,e,n){let r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:600;const i=t.src.replace(/\(/g,"%28").replace(/\)/g,"%29");t.width>r&&(n=Math.min(n,r/t.width));const s=t.width*n,o=t.height*n,a=["font-size:1px;","padding:".concat(Math.floor(o/2),"px ").concat(Math.floor(s/2),"px;"),"line-height:".concat(o,"px;"),"background:url(".concat(i,");"),"background-size:".concat(s,"px ").concat(o,"px;"),"color:transparent;"].join("");return["".concat(e," %c+"),a]}let Ma;(function(t){t[t.BLACK=30]="BLACK",t[t.RED=31]="RED",t[t.GREEN=32]="GREEN",t[t.YELLOW=33]="YELLOW",t[t.BLUE=34]="BLUE",t[t.MAGENTA=35]="MAGENTA",t[t.CYAN=36]="CYAN",t[t.WHITE=37]="WHITE",t[t.BRIGHT_BLACK=90]="BRIGHT_BLACK",t[t.BRIGHT_RED=91]="BRIGHT_RED",t[t.BRIGHT_GREEN=92]="BRIGHT_GREEN",t[t.BRIGHT_YELLOW=93]="BRIGHT_YELLOW",t[t.BRIGHT_BLUE=94]="BRIGHT_BLUE",t[t.BRIGHT_MAGENTA=95]="BRIGHT_MAGENTA",t[t.BRIGHT_CYAN=96]="BRIGHT_CYAN",t[t.BRIGHT_WHITE=97]="BRIGHT_WHITE"})(Ma||(Ma={}));function pg(t){return typeof t=="string"?Ma[t.toUpperCase()]||Ma.WHITE:t}function vT(t,e,n){return!En&&typeof t=="string"&&(e&&(e=pg(e),t="\x1B[".concat(e,"m").concat(t,"\x1B[39m")),n&&(e=pg(n),t="\x1B[".concat(n+10,"m").concat(t,"\x1B[49m"))),t}function wT(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:["constructor"];const n=Object.getPrototypeOf(t),r=Object.getOwnPropertyNames(n);for(const i of r)typeof t[i]=="function"&&(e.find(s=>i===s)||(t[i]=t[i].bind(t)))}function ka(t,e){if(!t)throw new Error(e||"Assertion failed")}function Lr(){let t;if(En&&"performance"in Co){var e,n;t=Co==null||(e=Co.performance)===null||e===void 0||(n=e.now)===null||n===void 0?void 0:n.call(e)}else if("hrtime"in ji){var r;const i=ji==null||(r=ji.hrtime)===null||r===void 0?void 0:r.call(ji);t=i[0]*1e3+i[1]/1e6}else t=Date.now();return t}const Rr={debug:En&&console.debug||console.log,log:console.log,info:console.info,warn:console.warn,error:console.error},ET={enabled:!0,level:0};function vt(){}const mg={},yg={once:!0};class Ws{constructor(){let{id:e}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{id:""};d(this,"id",void 0),d(this,"VERSION",Ty),d(this,"_startTs",Lr()),d(this,"_deltaTs",Lr()),d(this,"_storage",void 0),d(this,"userData",{}),d(this,"LOG_THROTTLE_TIMEOUT",0),this.id=e,this.userData={},this._storage=new mT("__probe-".concat(this.id,"__"),ET),this.timeStamp("".concat(this.id," started")),wT(this),Object.seal(this)}set level(e){this.setLevel(e)}get level(){return this.getLevel()}isEnabled(){return this._storage.config.enabled}getLevel(){return this._storage.config.level}getTotal(){return Number((Lr()-this._startTs).toPrecision(10))}getDelta(){return Number((Lr()-this._deltaTs).toPrecision(10))}set priority(e){this.level=e}get priority(){return this.level}getPriority(){return this.level}enable(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;return this._storage.setConfiguration({enabled:e}),this}setLevel(e){return this._storage.setConfiguration({level:e}),this}get(e){return this._storage.config[e]}set(e,n){this._storage.setConfiguration({[e]:n})}settings(){console.table?console.table(this._storage.config):console.log(this._storage.config)}assert(e,n){ka(e,n)}warn(e){return this._getLogFunction(0,e,Rr.warn,arguments,yg)}error(e){return this._getLogFunction(0,e,Rr.error,arguments)}deprecated(e,n){return this.warn("`".concat(e,"` is deprecated and will be removed in a later version. Use `").concat(n,"` instead"))}removed(e,n){return this.error("`".concat(e,"` has been removed. Use `").concat(n,"` instead"))}probe(e,n){return this._getLogFunction(e,n,Rr.log,arguments,{time:!0,once:!0})}log(e,n){return this._getLogFunction(e,n,Rr.debug,arguments)}info(e,n){return this._getLogFunction(e,n,console.info,arguments)}once(e,n){for(var r=arguments.length,i=new Array(r>2?r-2:0),s=2;s<r;s++)i[s-2]=arguments[s];return this._getLogFunction(e,n,Rr.debug||Rr.info,arguments,yg)}table(e,n,r){return n?this._getLogFunction(e,n,console.table||vt,r&&[r],{tag:AT(n)}):vt}image(e){let{logLevel:n,priority:r,image:i,message:s="",scale:o=1}=e;return this._shouldLog(n||r)?En?ST({image:i,message:s,scale:o}):bT():vt}time(e,n){return this._getLogFunction(e,n,console.time?console.time:console.info)}timeEnd(e,n){return this._getLogFunction(e,n,console.timeEnd?console.timeEnd:console.info)}timeStamp(e,n){return this._getLogFunction(e,n,console.timeStamp||vt)}group(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{collapsed:!1};const i=_g({logLevel:e,message:n,opts:r}),{collapsed:s}=r;return i.method=(s?console.groupCollapsed:console.group)||console.info,this._getLogFunction(i)}groupCollapsed(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};return this.group(e,n,Object.assign({},r,{collapsed:!0}))}groupEnd(e){return this._getLogFunction(e,"",console.groupEnd||vt)}withGroup(e,n,r){this.group(e,n)();try{r()}finally{this.groupEnd(e)()}}trace(){console.trace&&console.trace()}_shouldLog(e){return this.isEnabled()&&this.getLevel()>=Sy(e)}_getLogFunction(e,n,r,i,s){if(this._shouldLog(e)){s=_g({logLevel:e,message:n,args:i,opts:s}),r=r||s.method,ka(r),s.total=this.getTotal(),s.delta=this.getDelta(),this._deltaTs=Lr();const o=s.tag||s.message;if(s.once)if(!mg[o])mg[o]=Lr();else return vt;return n=TT(this.id,s.message,s),r.bind(console,n,...s.args)}return vt}}d(Ws,"VERSION",Ty);function Sy(t){if(!t)return 0;let e;switch(typeof t){case"number":e=t;break;case"object":e=t.logLevel||t.priority||0;break;default:return 0}return ka(Number.isFinite(e)&&e>=0),e}function _g(t){const{logLevel:e,message:n}=t;t.logLevel=Sy(e);const r=t.args?Array.from(t.args):[];for(;r.length&&r.shift()!==n;);switch(typeof e){case"string":case"function":n!==void 0&&r.unshift(n),t.message=e;break;case"object":Object.assign(t,e);break}typeof t.message=="function"&&(t.message=t.message());const i=typeof t.message;return ka(i==="string"||i==="object"),Object.assign(t,{args:r},t.opts)}function TT(t,e,n){if(typeof e=="string"){const r=n.time?_T(yT(n.total)):"";e=n.time?"".concat(t,": ").concat(r,"  ").concat(e):"".concat(t,": ").concat(e),e=vT(e,n.color,n.background)}return e}function bT(t){return console.warn("removed"),vt}function ST(t){let{image:e,message:n="",scale:r=1}=t;if(typeof e=="string"){const s=new Image;return s.onload=()=>{const o=hu(s,n,r);console.log(...o)},s.src=e,vt}const i=e.nodeName||"";if(i.toLowerCase()==="img")return console.log(...hu(e,n,r)),vt;if(i.toLowerCase()==="canvas"){const s=new Image;return s.onload=()=>console.log(...hu(s,n,r)),s.src=e.toDataURL(),vt}return vt}function AT(t){for(const e in t)for(const n in t[e])return n||"untitled";return"empty"}const vg=new Ws({id:"loaders.gl"});class xT{log(){return()=>{}}info(){return()=>{}}warn(){return()=>{}}error(){return()=>{}}}class PT{constructor(){d(this,"console",void 0),this.console=console}log(...e){return this.console.log.bind(this.console,...e)}info(...e){return this.console.info.bind(this.console,...e)}warn(...e){return this.console.warn.bind(this.console,...e)}error(...e){return this.console.error.bind(this.console,...e)}}const Ay={fetch:null,mimeType:void 0,nothrow:!1,log:new PT,CDN:"https://unpkg.com/@loaders.gl",worker:!0,maxConcurrency:3,maxMobileConcurrency:1,reuseWorkers:ef,_nodeWorkers:!1,_workerType:"",limit:0,_limitMB:0,batchSize:"auto",batchDebounceMs:0,metadata:!1,transforms:[]},CT={throws:"nothrow",dataType:"(no longer used)",uri:"baseUri",method:"fetch.method",headers:"fetch.headers",body:"fetch.body",mode:"fetch.mode",credentials:"fetch.credentials",cache:"fetch.cache",redirect:"fetch.redirect",referrer:"fetch.referrer",referrerPolicy:"fetch.referrerPolicy",integrity:"fetch.integrity",keepalive:"fetch.keepalive",signal:"fetch.signal"};function xy(){globalThis.loaders=globalThis.loaders||{};const{loaders:t}=globalThis;return t._state=t._state||{},t._state}const Py=()=>{const t=xy();return t.globalOptions=t.globalOptions||{...Ay},t.globalOptions};function LT(t,e,n,r){return n=n||[],n=Array.isArray(n)?n:[n],RT(t,n),kT(e,t,r)}function Cy(t,e){const n=Py(),r=t||n;return typeof r.fetch=="function"?r.fetch:Hs(r.fetch)?i=>gg(i,r):e!=null&&e.fetch?e?.fetch:gg}function RT(t,e){wg(t,null,Ay,CT,e);for(const n of e){const r=t&&t[n.id]||{},i=n.options&&n.options[n.id]||{},s=n.deprecatedOptions&&n.deprecatedOptions[n.id]||{};wg(r,n.id,i,s,e)}}function wg(t,e,n,r,i){const s=e||"Top level",o=e?"".concat(e,"."):"";for(const a in t){const l=!e&&Hs(t[a]),u=a==="baseUri"&&!e,c=a==="workerUrl"&&e;if(!(a in n)&&!u&&!c){if(a in r)vg.warn("".concat(s," loader option '").concat(o).concat(a,"' no longer supported, use '").concat(r[a],"'"))();else if(!l){const h=MT(a,i);vg.warn("".concat(s," loader option '").concat(o).concat(a,"' not recognized. ").concat(h))()}}}}function MT(t,e){const n=t.toLowerCase();let r="";for(const i of e)for(const s in i.options){if(t===s)return"Did you mean '".concat(i.id,".").concat(s,"'?");const o=s.toLowerCase();(n.startsWith(o)||o.startsWith(n))&&(r=r||"Did you mean '".concat(i.id,".").concat(s,"'?"))}return r}function kT(t,e,n){const i={...t.options||{}};return IT(i,n),i.log===null&&(i.log=new xT),Eg(i,Py()),Eg(i,e),i}function Eg(t,e){for(const n in e)if(n in e){const r=e[n];fg(r)&&fg(t[n])?t[n]={...t[n],...e[n]}:t[n]=e[n]}}function IT(t,e){e&&!("baseUri"in t)&&(t.baseUri=e)}function nf(t){var e;return t?(Array.isArray(t)&&(t=t[0]),Array.isArray((e=t)===null||e===void 0?void 0:e.extensions)):!1}function rf(t){var e,n;Ra(t,"null loader"),Ra(nf(t),"invalid loader");let r;return Array.isArray(t)&&(r=t[1],t=t[0],t={...t,options:{...t.options,...r}}),((e=t)!==null&&e!==void 0&&e.parseTextSync||(n=t)!==null&&n!==void 0&&n.parseText)&&(t.text=!0),t.text||(t.binary=!0),t}const Ly=()=>{const t=xy();return t.loaderRegistry=t.loaderRegistry||[],t.loaderRegistry};function OT(t){const e=Ly();t=Array.isArray(t)?t:[t];for(const n of t){const r=rf(n);e.find(i=>r===i)||e.unshift(r)}}function NT(){return Ly()}const DT=new Ws({id:"loaders.gl"}),FT=/\.([^.]+)$/;async function UT(t,e=[],n,r){if(!Ry(t))return null;let i=Tg(t,e,{...n,nothrow:!0},r);if(i)return i;if(Ai(t)&&(t=await t.slice(0,10).arrayBuffer(),i=Tg(t,e,n,r)),!i&&!(n!=null&&n.nothrow))throw new Error(My(t));return i}function Tg(t,e=[],n,r){if(!Ry(t))return null;if(e&&!Array.isArray(e))return rf(e);let i=[];e&&(i=i.concat(e)),n!=null&&n.ignoreRegisteredLoaders||i.push(...NT()),VT(i);const s=BT(t,i,n,r);if(!s&&!(n!=null&&n.nothrow))throw new Error(My(t));return s}function BT(t,e,n,r){const{url:i,type:s}=fl(t),o=i||r?.url;let a=null,l="";if(n!=null&&n.mimeType&&(a=fu(e,n?.mimeType),l="match forced by supplied MIME type ".concat(n?.mimeType)),a=a||zT(e,o),l=l||(a?"matched url ".concat(o):""),a=a||fu(e,s),l=l||(a?"matched MIME type ".concat(s):""),a=a||GT(e,t),l=l||(a?"matched initial data ".concat(ky(t)):""),a=a||fu(e,n?.fallbackMimeType),l=l||(a?"matched fallback MIME type ".concat(s):""),l){var u;DT.log(1,"selectLoader selected ".concat((u=a)===null||u===void 0?void 0:u.name,": ").concat(l,"."))}return a}function Ry(t){return!(t instanceof Response&&t.status===204)}function My(t){const{url:e,type:n}=fl(t);let r="No valid loader found (";r+=e?"".concat(JE(e),", "):"no url provided, ",r+="MIME type: ".concat(n?'"'.concat(n,'"'):"not provided",", ");const i=t?ky(t):"";return r+=i?' first bytes: "'.concat(i,'"'):"first bytes: not available",r+=")",r}function VT(t){for(const e of t)rf(e)}function zT(t,e){const n=e&&FT.exec(e),r=n&&n[1];return r?jT(t,r):null}function jT(t,e){e=e.toLowerCase();for(const n of t)for(const r of n.extensions)if(r.toLowerCase()===e)return n;return null}function fu(t,e){for(const n of t)if(n.mimeTypes&&n.mimeTypes.includes(e)||e==="application/x.".concat(n.id))return n;return null}function GT(t,e){if(!e)return null;for(const n of t)if(typeof e=="string"){if(HT(e,n))return n}else if(ArrayBuffer.isView(e)){if(bg(e.buffer,e.byteOffset,n))return n}else if(e instanceof ArrayBuffer&&bg(e,0,n))return n;return null}function HT(t,e){return e.testText?e.testText(t):(Array.isArray(e.tests)?e.tests:[e.tests]).some(r=>t.startsWith(r))}function bg(t,e,n){return(Array.isArray(n.tests)?n.tests:[n.tests]).some(i=>WT(t,e,n,i))}function WT(t,e,n,r){if(r instanceof ArrayBuffer)return $E(r,t,r.byteLength);switch(typeof r){case"function":return r(t,n);case"string":const i=Ic(t,e,r.length);return r===i;default:return!1}}function ky(t,e=5){return typeof t=="string"?t.slice(0,e):ArrayBuffer.isView(t)?Ic(t.buffer,t.byteOffset,e):t instanceof ArrayBuffer?Ic(t,0,e):""}function Ic(t,e,n){if(t.byteLength<e+n)return"";const r=new DataView(t);let i="";for(let s=0;s<n;s++)i+=String.fromCharCode(r.getUint8(e+s));return i}const XT=256*1024;function*YT(t,e){const n=e?.chunkSize||XT;let r=0;const i=new TextEncoder;for(;r<t.length;){const s=Math.min(t.length-r,n),o=t.slice(r,r+s);r+=s,yield i.encode(o)}}const $T=256*1024;function*qT(t,e={}){const{chunkSize:n=$T}=e;let r=0;for(;r<t.byteLength;){const i=Math.min(t.byteLength-r,n),s=new ArrayBuffer(i),o=new Uint8Array(t,r,i);new Uint8Array(s).set(o),r+=i,yield s}}const ZT=1024*1024;async function*QT(t,e){const n=e?.chunkSize||ZT;let r=0;for(;r<t.size;){const i=r+n,s=await t.slice(r,i).arrayBuffer();r=i,yield s}}function Sg(t,e){return ef?KT(t,e):JT(t)}async function*KT(t,e){const n=t.getReader();let r;try{for(;;){const i=r||n.read();e!=null&&e._streamReadAhead&&(r=n.read());const{done:s,value:o}=await i;if(s)return;yield _y(o)}}catch{n.releaseLock()}}async function*JT(t,e){for await(const n of t)yield _y(n)}function eb(t,e){if(typeof t=="string")return YT(t,e);if(t instanceof ArrayBuffer)return qT(t,e);if(Ai(t))return QT(t,e);if(vy(t))return Sg(t,e);if(Si(t))return Sg(t.body,e);throw new Error("makeIterator")}const Iy="Cannot convert supplied data type";function tb(t,e,n){if(e.text&&typeof t=="string")return t;if(rT(t)&&(t=t.buffer),t instanceof ArrayBuffer){const r=t;return e.text&&!e.binary?new TextDecoder("utf8").decode(r):r}if(ArrayBuffer.isView(t)){if(e.text&&!e.binary)return new TextDecoder("utf8").decode(t);let r=t.buffer;const i=t.byteLength||t.length;return(t.byteOffset!==0||i!==r.byteLength)&&(r=r.slice(t.byteOffset,t.byteOffset+i)),r}throw new Error(Iy)}async function nb(t,e,n){const r=t instanceof ArrayBuffer||ArrayBuffer.isView(t);if(typeof t=="string"||r)return tb(t,e);if(Ai(t)&&(t=await wy(t)),Si(t)){const i=t;return await hT(i),e.binary?await i.arrayBuffer():await i.text()}if(vy(t)&&(t=eb(t,n)),tT(t)||nT(t))return ZE(t);throw new Error(Iy)}function rb(t,e,n=null){if(n)return n;const r={fetch:Cy(e,t),...t};return Array.isArray(r.loaders)||(r.loaders=null),r}function ib(t,e){if(!e&&t&&!Array.isArray(t))return t;let n;if(t&&(n=Array.isArray(t)?t:[t]),e&&e.loaders){const r=Array.isArray(e.loaders)?e.loaders:[e.loaders];n=n?[...n,...r]:r}return n&&n.length?n:null}async function sf(t,e,n,r){mn(!r||typeof r=="object"),e&&!Array.isArray(e)&&!nf(e)&&(r=void 0,n=e,e=void 0),t=await t,n=n||{};const{url:i}=fl(t),o=ib(e,r),a=await UT(t,o,n);return a?(n=LT(n,a,o,i),r=rb({url:i,parse:sf,loaders:o},n,r),await sb(a,t,n,r)):null}async function sb(t,e,n,r){if(GE(t),Si(e)){const i=e,{ok:s,redirected:o,status:a,statusText:l,type:u,url:c}=i,h=Object.fromEntries(i.headers.entries());r.response={headers:h,ok:s,redirected:o,status:a,statusText:l,type:u,url:c}}if(e=await nb(e,t,n),t.parseTextSync&&typeof e=="string")return n.dataType="text",t.parseTextSync(e,n,r,t);if(HE(t,n))return await WE(t,e,n,r,sf);if(t.parseText&&typeof e=="string")return await t.parseText(e,n,r,t);if(t.parse)return await t.parse(e,n,r,t);throw mn(!t.parseSync),new Error("".concat(t.id," loader - no parser found and worker is disabled"))}async function Ia(t,e,n,r){!Array.isArray(e)&&!nf(e)&&(n=e,e=void 0);const i=Cy(n);let s=t;return typeof t=="string"&&(s=await i(t)),Ai(t)&&(s=await i(t)),await sf(s,e,n)}const ob="3.2.13",{_parseImageNode:ab}=globalThis,Oc=typeof Image<"u",Nc=typeof ImageBitmap<"u",lb=Boolean(ab),Dc=ef?!0:lb;function ub(t){switch(t){case"auto":return Nc||Oc||Dc;case"imagebitmap":return Nc;case"image":return Oc;case"data":return Dc;default:throw new Error("@loaders.gl/images: image ".concat(t," not supported in this environment"))}}function cb(){if(Nc)return"imagebitmap";if(Oc)return"image";if(Dc)return"data";throw new Error("Install '@loaders.gl/polyfills' to parse images under Node.js")}function hb(t){const e=db(t);if(!e)throw new Error("Not an image");return e}function fb(t){switch(hb(t)){case"data":return t;case"image":case"imagebitmap":const e=document.createElement("canvas"),n=e.getContext("2d");if(!n)throw new Error("getImageData");return e.width=t.width,e.height=t.height,n.drawImage(t,0,0),n.getImageData(0,0,t.width,t.height);default:throw new Error("getImageData")}}function db(t){return typeof ImageBitmap<"u"&&t instanceof ImageBitmap?"imagebitmap":typeof Image<"u"&&t instanceof Image?"image":t&&typeof t=="object"&&t.data&&t.width&&t.height?"data":null}const gb=/^data:image\/svg\+xml/,pb=/\.svg((\?|#).*)?$/;function of(t){return t&&(gb.test(t)||pb.test(t))}function mb(t,e){if(of(e)){let r=new TextDecoder().decode(t);try{typeof unescape=="function"&&typeof encodeURIComponent=="function"&&(r=unescape(encodeURIComponent(r)))}catch(s){throw new Error(s.message)}return"data:image/svg+xml;base64,".concat(btoa(r))}return Oy(t,e)}function Oy(t,e){if(of(e))throw new Error("SVG cannot be parsed directly to imagebitmap");return new Blob([new Uint8Array(t)])}async function Ny(t,e,n){const r=mb(t,n),i=self.URL||self.webkitURL,s=typeof r!="string"&&i.createObjectURL(r);try{return await yb(s||r,e)}finally{s&&i.revokeObjectURL(s)}}async function yb(t,e){const n=new Image;return n.src=t,e.image&&e.image.decode&&n.decode?(await n.decode(),n):await new Promise((r,i)=>{try{n.onload=()=>r(n),n.onerror=s=>i(new Error("Could not load image ".concat(t,": ").concat(s)))}catch(s){i(s)}})}const _b={};let Ag=!0;async function vb(t,e,n){let r;of(n)?r=await Ny(t,e,n):r=Oy(t,n);const i=e&&e.imagebitmap;return await wb(r,i)}async function wb(t,e=null){if((Eb(e)||!Ag)&&(e=null),e)try{return await createImageBitmap(t,e)}catch(n){console.warn(n),Ag=!1}return await createImageBitmap(t)}function Eb(t){for(const e in t||_b)return!1;return!0}const $t=!1,cs=!0;function Dy(t){const e=Xs(t);return Tb(e)||Ab(e)||bb(e)||Sb(e)}function Tb(t){const e=Xs(t);return e.byteLength>=24&&e.getUint32(0,$t)===2303741511?{mimeType:"image/png",width:e.getUint32(16,$t),height:e.getUint32(20,$t)}:null}function bb(t){const e=Xs(t);return e.byteLength>=10&&e.getUint32(0,$t)===1195984440?{mimeType:"image/gif",width:e.getUint16(6,cs),height:e.getUint16(8,cs)}:null}function Sb(t){const e=Xs(t);return e.byteLength>=14&&e.getUint16(0,$t)===16973&&e.getUint32(2,cs)===e.byteLength?{mimeType:"image/bmp",width:e.getUint32(18,cs),height:e.getUint32(22,cs)}:null}function Ab(t){const e=Xs(t);if(!(e.byteLength>=3&&e.getUint16(0,$t)===65496&&e.getUint8(2)===255))return null;const{tableMarkers:r,sofMarkers:i}=xb();let s=2;for(;s+9<e.byteLength;){const o=e.getUint16(s,$t);if(i.has(o))return{mimeType:"image/jpeg",height:e.getUint16(s+5,$t),width:e.getUint16(s+7,$t)};if(!r.has(o))return null;s+=2,s+=e.getUint16(s,$t)}return null}function xb(){const t=new Set([65499,65476,65484,65501,65534]);for(let n=65504;n<65520;++n)t.add(n);return{tableMarkers:t,sofMarkers:new Set([65472,65473,65474,65475,65477,65478,65479,65481,65482,65483,65485,65486,65487,65502])}}function Xs(t){if(t instanceof DataView)return t;if(ArrayBuffer.isView(t))return new DataView(t.buffer);if(t instanceof ArrayBuffer)return new DataView(t);throw new Error("toDataView")}async function Pb(t,e){const{mimeType:n}=Dy(t)||{},r=globalThis._parseImageNode;return Ra(r),await r(t,n)}async function Cb(t,e,n){e=e||{};const i=(e.image||{}).type||"auto",{url:s}=n||{},o=Lb(i);let a;switch(o){case"imagebitmap":a=await vb(t,e,s);break;case"image":a=await Ny(t,e,s);break;case"data":a=await Pb(t);break;default:Ra(!1)}return i==="data"&&(a=fb(a)),a}function Lb(t){switch(t){case"auto":case"data":return cb();default:return ub(t),t}}const Rb=["png","jpg","jpeg","gif","webp","bmp","ico","svg"],Mb=["image/png","image/jpeg","image/gif","image/webp","image/bmp","image/vnd.microsoft.icon","image/svg+xml"],kb={image:{type:"auto",decode:!0}},Ib={id:"image",module:"images",name:"Images",version:ob,mimeTypes:Mb,extensions:Rb,parse:Cb,tests:[t=>Boolean(Dy(new DataView(t)))],options:kb},Q=new Ws({id:"deck"});let Fc={};function Ob(t){Fc=t}function Ue(t,e,n,r){Q.level>0&&Fc[t]&&Fc[t].call(null,e,n,r)}function Nb(t){const e=t[0],n=t[t.length-1];return e==="{"&&n==="}"||e==="["&&n==="]"}const Db={id:"JSON",name:"JSON",module:"",version:"",options:{},extensions:["json","geojson"],mimeTypes:["application/json","application/geo+json"],testText:Nb,parseTextSync:JSON.parse},hs="8.8.24",Jo=globalThis.deck&&globalThis.deck.VERSION;if(Jo&&Jo!==hs)throw new Error("deck.gl - multiple versions detected: ".concat(Jo," vs ").concat(hs));Jo||(Q.log(1,"deck.gl ".concat(hs))(),globalThis.deck={...globalThis.deck,VERSION:hs,version:hs,log:Q,_registerLoggers:Ob},OT([Db,[Ib,{imagebitmap:{premultiplyAlpha:"none"}}]]));const Fb=globalThis.deck,z=new Ws({id:"luma.gl"});function Ge(t,e){if(!t)throw new Error(e||"luma.gl: assertion failed.")}const Ub="Invalid WebGLRenderingContext",Bb="Requires WebGL2";function dl(t){return typeof WebGLRenderingContext<"u"&&t instanceof WebGLRenderingContext||typeof WebGL2RenderingContext<"u"&&t instanceof WebGL2RenderingContext?!0:Boolean(t&&Number.isFinite(t._version))}function Y(t){return typeof WebGL2RenderingContext<"u"&&t instanceof WebGL2RenderingContext?!0:Boolean(t&&t._version===2)}function Vb(t){return Y(t)?t:null}function gl(t){return Ge(dl(t),Ub),t}function We(t){return Ge(Y(t),Bb),t}const Ki={};function zb(t){globalThis.console&&globalThis.console.error&&globalThis.console.error(t)}function jb(t){globalThis.console&&globalThis.console.log&&globalThis.console.log(t)}function Gb(t,e){Ki[t]=!0,e!==void 0&&zb(e)}function Hb(t){const e=t.getError;t.getError=function(){let r;do r=e.apply(t),r!==0&&(Ki[r]=!0);while(r!==0);for(r in Ki)if(Ki[r])return delete Ki[r],parseInt(r,10);return 0}}const Ys=function t(e){const n=e.gl;this.ext=e,this.isAlive=!0,this.hasBeenBound=!1,this.elementArrayBuffer=null,this.attribs=new Array(e.maxVertexAttribs);for(let r=0;r<this.attribs.length;r++){const i=new t.VertexAttrib(n);this.attribs[r]=i}this.maxAttrib=0};Ys.VertexAttrib=function(e){this.enabled=!1,this.buffer=null,this.size=4,this.type=5126,this.normalized=!1,this.stride=16,this.offset=0,this.cached="",this.recache()};Ys.VertexAttrib.prototype.recache=function(){this.cached=[this.size,this.type,this.normalized,this.stride,this.offset].join(":")};const Ar=function(e){const n=this;this.gl=e,Hb(e);const r=this.original={getParameter:e.getParameter,enableVertexAttribArray:e.enableVertexAttribArray,disableVertexAttribArray:e.disableVertexAttribArray,bindBuffer:e.bindBuffer,getVertexAttrib:e.getVertexAttrib,vertexAttribPointer:e.vertexAttribPointer};e.getParameter=function(s){return s===n.VERTEX_ARRAY_BINDING_OES?n.currentVertexArrayObject===n.defaultVertexArrayObject?null:n.currentVertexArrayObject:r.getParameter.apply(this,arguments)},e.enableVertexAttribArray=function(s){const o=n.currentVertexArrayObject;o.maxAttrib=Math.max(o.maxAttrib,s);const a=o.attribs[s];return a.enabled=!0,r.enableVertexAttribArray.apply(this,arguments)},e.disableVertexAttribArray=function(s){const o=n.currentVertexArrayObject;o.maxAttrib=Math.max(o.maxAttrib,s);const a=o.attribs[s];return a.enabled=!1,r.disableVertexAttribArray.apply(this,arguments)},e.bindBuffer=function(s,o){switch(s){case 34962:n.currentArrayBuffer=o;break;case 34963:n.currentVertexArrayObject.elementArrayBuffer=o;break}return r.bindBuffer.apply(this,arguments)},e.getVertexAttrib=function(s,o){const l=n.currentVertexArrayObject.attribs[s];switch(o){case 34975:return l.buffer;case 34338:return l.enabled;case 34339:return l.size;case 34340:return l.stride;case 34341:return l.type;case 34922:return l.normalized;default:return r.getVertexAttrib.apply(this,arguments)}},e.vertexAttribPointer=function(s,o,a,l,u,c){const h=n.currentVertexArrayObject;h.maxAttrib=Math.max(h.maxAttrib,s);const f=h.attribs[s];return f.buffer=n.currentArrayBuffer,f.size=o,f.type=a,f.normalized=l,f.stride=u,f.offset=c,f.recache(),r.vertexAttribPointer.apply(this,arguments)},e.instrumentExtension&&e.instrumentExtension(this,"OES_vertex_array_object"),e.canvas&&e.canvas.addEventListener("webglcontextrestored",()=>{jb("OESVertexArrayObject emulation library context restored"),n.reset_()},!0),this.reset_()};Ar.prototype.VERTEX_ARRAY_BINDING_OES=34229;Ar.prototype.reset_=function(){if(this.vertexArrayObjects!==void 0)for(let r=0;r<this.vertexArrayObjects.length;++r)this.vertexArrayObjects.isAlive=!1;const n=this.gl;this.maxVertexAttribs=n.getParameter(34921),this.defaultVertexArrayObject=new Ys(this),this.currentVertexArrayObject=null,this.currentArrayBuffer=null,this.vertexArrayObjects=[this.defaultVertexArrayObject],this.bindVertexArrayOES(null)};Ar.prototype.createVertexArrayOES=function(){const e=new Ys(this);return this.vertexArrayObjects.push(e),e};Ar.prototype.deleteVertexArrayOES=function(e){e.isAlive=!1,this.vertexArrayObjects.splice(this.vertexArrayObjects.indexOf(e),1),this.currentVertexArrayObject===e&&this.bindVertexArrayOES(null)};Ar.prototype.isVertexArrayOES=function(e){return!!(e&&e instanceof Ys&&e.hasBeenBound&&e.ext===this)};Ar.prototype.bindVertexArrayOES=function(e){const n=this.gl;if(e&&!e.isAlive){Gb(1282,"bindVertexArrayOES: attempt to bind deleted arrayObject");return}const r=this.original,i=this.currentVertexArrayObject;this.currentVertexArrayObject=e||this.defaultVertexArrayObject,this.currentVertexArrayObject.hasBeenBound=!0;const s=this.currentVertexArrayObject;if(i===s)return;(!i||s.elementArrayBuffer!==i.elementArrayBuffer)&&r.bindBuffer.call(n,34963,s.elementArrayBuffer);let o=this.currentArrayBuffer;const a=Math.max(i?i.maxAttrib:0,s.maxAttrib);for(let l=0;l<=a;l++){const u=s.attribs[l],c=i?i.attribs[l]:null;if((!i||u.enabled!==c.enabled)&&(u.enabled?r.enableVertexAttribArray.call(n,l):r.disableVertexAttribArray.call(n,l)),u.enabled){let h=!1;(!i||u.buffer!==c.buffer)&&(o!==u.buffer&&(r.bindBuffer.call(n,34962,u.buffer),o=u.buffer),h=!0),(h||u.cached!==c.cached)&&r.vertexAttribPointer.call(n,l,u.size,u.type,u.normalized,u.stride,u.offset)}}this.currentArrayBuffer!==o&&r.bindBuffer.call(n,34962,this.currentArrayBuffer)};function Wb(t){if(typeof t.createVertexArray=="function")return;const e=t.getSupportedExtensions;t.getSupportedExtensions=function(){const i=e.call(this)||[];return i.indexOf("OES_vertex_array_object")<0&&i.push("OES_vertex_array_object"),i};const n=t.getExtension;t.getExtension=function(i){const s=n.call(this,i);return s||(i!=="OES_vertex_array_object"?null:(t.__OESVertexArrayObject||(this.__OESVertexArrayObject=new Ar(this)),this.__OESVertexArrayObject))}}const xg="OES_element_index",Pg="WEBGL_draw_buffers",Xb="EXT_disjoint_timer_query",Yb="EXT_disjoint_timer_query_webgl2",$b="EXT_texture_filter_anisotropic",Cg="WEBGL_debug_renderer_info",qb=35723,Zb=4352,Qb=36795,Kb=34047,Jb=37445,eS=37446,ne=t=>Y(t)?void 0:0,tS={[3074]:t=>Y(t)?void 0:36064,[qb]:t=>Y(t)?void 0:Zb,[35977]:ne,[32937]:ne,[Qb]:(t,e)=>{const n=Y(t)?t.getExtension(Yb):t.getExtension(Xb);return n&&n.GPU_DISJOINT_EXT?e(n.GPU_DISJOINT_EXT):0},[Jb]:(t,e)=>{const n=t.getExtension(Cg);return e(n&&n.UNMASKED_VENDOR_WEBGL||7936)},[eS]:(t,e)=>{const n=t.getExtension(Cg);return e(n&&n.UNMASKED_RENDERER_WEBGL||7937)},[Kb]:(t,e)=>{const n=t.luma.extensions[$b];return n?e(n.MAX_TEXTURE_MAX_ANISOTROPY_EXT):1},[32883]:ne,[35071]:ne,[37447]:ne,[36063]:(t,e)=>{if(!Y(t)){const n=t.getExtension(Pg);return n?e(n.MAX_COLOR_ATTACHMENTS_WEBGL):0}},[35379]:ne,[35374]:ne,[35377]:ne,[34852]:t=>{if(!Y(t)){const e=t.getExtension(Pg);return e?e.MAX_DRAW_BUFFERS_WEBGL:0}},[36203]:t=>t.getExtension(xg)?2147483647:65535,[33001]:t=>t.getExtension(xg)?16777216:65535,[33e3]:t=>16777216,[37157]:ne,[35373]:ne,[35657]:ne,[36183]:ne,[37137]:ne,[34045]:ne,[35978]:ne,[35979]:ne,[35968]:ne,[35376]:ne,[35375]:ne,[35659]:ne,[37154]:ne,[35371]:ne,[35658]:ne,[35076]:ne,[35077]:ne,[35380]:ne};function nS(t,e,n){const r=tS[n],i=typeof r=="function"?r(t,e,n):r;return i!==void 0?i:e(n)}const rS="OES_vertex_array_object",Fy="ANGLE_instanced_arrays",iS="WEBGL_draw_buffers",sS="EXT_disjoint_timer_query",oS="EXT_texture_filter_anisotropic",aS="VertexArray requires WebGL2 or OES_vertex_array_object extension";function lS(t,e){return{webgl2:Y(t),ext:t.getExtension(e)}}const Uy={[rS]:{meta:{suffix:"OES"},createVertexArray:()=>{Ge(!1,aS)},deleteVertexArray:()=>{},bindVertexArray:()=>{},isVertexArray:()=>!1},[Fy]:{meta:{suffix:"ANGLE"},vertexAttribDivisor(t,e){Ge(e===0,"WebGL instanced rendering not supported")},drawElementsInstanced:()=>{},drawArraysInstanced:()=>{}},[iS]:{meta:{suffix:"WEBGL"},drawBuffers:()=>{Ge(!1)}},[sS]:{meta:{suffix:"EXT"},createQuery:()=>{Ge(!1)},deleteQuery:()=>{Ge(!1)},beginQuery:()=>{Ge(!1)},endQuery:()=>{},getQuery(t,e){return this.getQueryObject(t,e)},getQueryParameter(t,e){return this.getQueryObject(t,e)},getQueryObject:()=>{}}},du={readBuffer:(t,e,n)=>{Y(t)&&e(n)},getVertexAttrib:(t,e,n,r)=>{const{webgl2:i,ext:s}=lS(t,Fy);let o;switch(r){case 35069:o=i?void 0:!1;break;case 35070:o=!i&&!s?0:void 0;break}return o!==void 0?o:e(n,r)},getProgramParameter:(t,e,n,r)=>{if(!Y(t))switch(r){case 35967:return 35981;case 35971:return 0;case 35382:return 0}return e(n,r)},getInternalformatParameter:(t,e,n,r,i)=>{if(!Y(t))switch(i){case 32937:return new Int32Array([0])}return t.getInternalformatParameter(n,r,i)},getTexParameter(t,e,n,r){switch(r){case 34046:const{extensions:i}=t.luma,s=i[oS];r=s&&s.TEXTURE_MAX_ANISOTROPY_EXT||34046;break}return e(n,r)},getParameter:nS,hint(t,e,n,r){return e(n,r)}};function uS(t){t.luma=t.luma||{};const{luma:e}=t;return e.polyfilled||(Wb(t),cS(t),fS(t,Uy),hS(t,{target:e,target2:t}),e.polyfilled=!0),t}globalThis.polyfillContext=uS;function cS(t){t.luma.extensions={};const e=t.getSupportedExtensions()||[];for(const n of e)t.luma[n]=t.getExtension(n)}function hS(t,e){let{target:n,target2:r}=e;Object.keys(du).forEach(i=>{if(typeof du[i]=="function"){const s=t[i]?t[i].bind(t):()=>{},o=du[i].bind(null,t,s);n[i]=o,r[i]=o}})}function fS(t,e){for(const n of Object.getOwnPropertyNames(e))n!=="overrides"&&dS(t,{extension:n,target:t.luma,target2:t})}function dS(t,e){let{extension:n,target:r,target2:i}=e;const s=Uy[n];Ge(s);const{meta:o={}}=s,{suffix:a=""}=o,l=t.getExtension(n);for(const u of Object.keys(s)){const c="".concat(u).concat(a);let h=null;u==="meta"||typeof t[u]=="function"||(l&&typeof l[c]=="function"?h=function(){return l[c](...arguments)}:typeof s[u]=="function"&&(h=s[u].bind(r))),h&&(r[u]=h,i[u]=h)}}const af={[3042]:!1,[32773]:new Float32Array([0,0,0,0]),[32777]:32774,[34877]:32774,[32969]:1,[32968]:0,[32971]:1,[32970]:0,[3106]:new Float32Array([0,0,0,0]),[3107]:[!0,!0,!0,!0],[2884]:!1,[2885]:1029,[2929]:!1,[2931]:1,[2932]:513,[2928]:new Float32Array([0,1]),[2930]:!0,[3024]:!0,[36006]:null,[2886]:2305,[33170]:4352,[2849]:1,[32823]:!1,[32824]:0,[10752]:0,[32938]:1,[32939]:!1,[3089]:!1,[3088]:new Int32Array([0,0,1024,1024]),[2960]:!1,[2961]:0,[2968]:4294967295,[36005]:4294967295,[2962]:519,[2967]:0,[2963]:4294967295,[34816]:519,[36003]:0,[36004]:4294967295,[2964]:7680,[2965]:7680,[2966]:7680,[34817]:7680,[34818]:7680,[34819]:7680,[2978]:[0,0,1024,1024],[3333]:4,[3317]:4,[37440]:!1,[37441]:!1,[37443]:37444,[35723]:4352,[36010]:null,[35977]:!1,[3330]:0,[3332]:0,[3331]:0,[3314]:0,[32878]:0,[3316]:0,[3315]:0,[32877]:0},An=(t,e,n)=>e?t.enable(n):t.disable(n),Lg=(t,e,n)=>t.hint(n,e),nt=(t,e,n)=>t.pixelStorei(n,e),gS=(t,e)=>{const n=Y(t)?36009:36160;return t.bindFramebuffer(n,e)},pS=(t,e)=>t.bindFramebuffer(36008,e);function Gi(t){return Array.isArray(t)||ArrayBuffer.isView(t)}const mS={[3042]:An,[32773]:(t,e)=>t.blendColor(...e),[32777]:"blendEquation",[34877]:"blendEquation",[32969]:"blendFunc",[32968]:"blendFunc",[32971]:"blendFunc",[32970]:"blendFunc",[3106]:(t,e)=>t.clearColor(...e),[3107]:(t,e)=>t.colorMask(...e),[2884]:An,[2885]:(t,e)=>t.cullFace(e),[2929]:An,[2931]:(t,e)=>t.clearDepth(e),[2932]:(t,e)=>t.depthFunc(e),[2928]:(t,e)=>t.depthRange(...e),[2930]:(t,e)=>t.depthMask(e),[3024]:An,[35723]:Lg,[36006]:gS,[2886]:(t,e)=>t.frontFace(e),[33170]:Lg,[2849]:(t,e)=>t.lineWidth(e),[32823]:An,[32824]:"polygonOffset",[10752]:"polygonOffset",[35977]:An,[32938]:"sampleCoverage",[32939]:"sampleCoverage",[3089]:An,[3088]:(t,e)=>t.scissor(...e),[2960]:An,[2961]:(t,e)=>t.clearStencil(e),[2968]:(t,e)=>t.stencilMaskSeparate(1028,e),[36005]:(t,e)=>t.stencilMaskSeparate(1029,e),[2962]:"stencilFuncFront",[2967]:"stencilFuncFront",[2963]:"stencilFuncFront",[34816]:"stencilFuncBack",[36003]:"stencilFuncBack",[36004]:"stencilFuncBack",[2964]:"stencilOpFront",[2965]:"stencilOpFront",[2966]:"stencilOpFront",[34817]:"stencilOpBack",[34818]:"stencilOpBack",[34819]:"stencilOpBack",[2978]:(t,e)=>t.viewport(...e),[3333]:nt,[3317]:nt,[37440]:nt,[37441]:nt,[37443]:nt,[3330]:nt,[3332]:nt,[3331]:nt,[36010]:pS,[3314]:nt,[32878]:nt,[3316]:nt,[3315]:nt,[32877]:nt,framebuffer:(t,e)=>{const n=e&&"handle"in e?e.handle:e;return t.bindFramebuffer(36160,n)},blend:(t,e)=>e?t.enable(3042):t.disable(3042),blendColor:(t,e)=>t.blendColor(...e),blendEquation:(t,e)=>{e=Gi(e)?e:[e,e],t.blendEquationSeparate(...e)},blendFunc:(t,e)=>{e=Gi(e)&&e.length===2?[...e,...e]:e,t.blendFuncSeparate(...e)},clearColor:(t,e)=>t.clearColor(...e),clearDepth:(t,e)=>t.clearDepth(e),clearStencil:(t,e)=>t.clearStencil(e),colorMask:(t,e)=>t.colorMask(...e),cull:(t,e)=>e?t.enable(2884):t.disable(2884),cullFace:(t,e)=>t.cullFace(e),depthTest:(t,e)=>e?t.enable(2929):t.disable(2929),depthFunc:(t,e)=>t.depthFunc(e),depthMask:(t,e)=>t.depthMask(e),depthRange:(t,e)=>t.depthRange(...e),dither:(t,e)=>e?t.enable(3024):t.disable(3024),derivativeHint:(t,e)=>{t.hint(35723,e)},frontFace:(t,e)=>t.frontFace(e),mipmapHint:(t,e)=>t.hint(33170,e),lineWidth:(t,e)=>t.lineWidth(e),polygonOffsetFill:(t,e)=>e?t.enable(32823):t.disable(32823),polygonOffset:(t,e)=>t.polygonOffset(...e),sampleCoverage:(t,e)=>t.sampleCoverage(...e),scissorTest:(t,e)=>e?t.enable(3089):t.disable(3089),scissor:(t,e)=>t.scissor(...e),stencilTest:(t,e)=>e?t.enable(2960):t.disable(2960),stencilMask:(t,e)=>{e=Gi(e)?e:[e,e];const[n,r]=e;t.stencilMaskSeparate(1028,n),t.stencilMaskSeparate(1029,r)},stencilFunc:(t,e)=>{e=Gi(e)&&e.length===3?[...e,...e]:e;const[n,r,i,s,o,a]=e;t.stencilFuncSeparate(1028,n,r,i),t.stencilFuncSeparate(1029,s,o,a)},stencilOp:(t,e)=>{e=Gi(e)&&e.length===3?[...e,...e]:e;const[n,r,i,s,o,a]=e;t.stencilOpSeparate(1028,n,r,i),t.stencilOpSeparate(1029,s,o,a)},viewport:(t,e)=>t.viewport(...e)};function ge(t,e,n){return e[t]!==void 0?e[t]:n[t]}const yS={blendEquation:(t,e,n)=>t.blendEquationSeparate(ge(32777,e,n),ge(34877,e,n)),blendFunc:(t,e,n)=>t.blendFuncSeparate(ge(32969,e,n),ge(32968,e,n),ge(32971,e,n),ge(32970,e,n)),polygonOffset:(t,e,n)=>t.polygonOffset(ge(32824,e,n),ge(10752,e,n)),sampleCoverage:(t,e,n)=>t.sampleCoverage(ge(32938,e,n),ge(32939,e,n)),stencilFuncFront:(t,e,n)=>t.stencilFuncSeparate(1028,ge(2962,e,n),ge(2967,e,n),ge(2963,e,n)),stencilFuncBack:(t,e,n)=>t.stencilFuncSeparate(1029,ge(34816,e,n),ge(36003,e,n),ge(36004,e,n)),stencilOpFront:(t,e,n)=>t.stencilOpSeparate(1028,ge(2964,e,n),ge(2965,e,n),ge(2966,e,n)),stencilOpBack:(t,e,n)=>t.stencilOpSeparate(1029,ge(34817,e,n),ge(34818,e,n),ge(34819,e,n))},Rg={enable:(t,e)=>t({[e]:!0}),disable:(t,e)=>t({[e]:!1}),pixelStorei:(t,e,n)=>t({[e]:n}),hint:(t,e,n)=>t({[e]:n}),bindFramebuffer:(t,e,n)=>{switch(e){case 36160:return t({[36006]:n,[36010]:n});case 36009:return t({[36006]:n});case 36008:return t({[36010]:n});default:return null}},blendColor:(t,e,n,r,i)=>t({[32773]:new Float32Array([e,n,r,i])}),blendEquation:(t,e)=>t({[32777]:e,[34877]:e}),blendEquationSeparate:(t,e,n)=>t({[32777]:e,[34877]:n}),blendFunc:(t,e,n)=>t({[32969]:e,[32968]:n,[32971]:e,[32970]:n}),blendFuncSeparate:(t,e,n,r,i)=>t({[32969]:e,[32968]:n,[32971]:r,[32970]:i}),clearColor:(t,e,n,r,i)=>t({[3106]:new Float32Array([e,n,r,i])}),clearDepth:(t,e)=>t({[2931]:e}),clearStencil:(t,e)=>t({[2961]:e}),colorMask:(t,e,n,r,i)=>t({[3107]:[e,n,r,i]}),cullFace:(t,e)=>t({[2885]:e}),depthFunc:(t,e)=>t({[2932]:e}),depthRange:(t,e,n)=>t({[2928]:new Float32Array([e,n])}),depthMask:(t,e)=>t({[2930]:e}),frontFace:(t,e)=>t({[2886]:e}),lineWidth:(t,e)=>t({[2849]:e}),polygonOffset:(t,e,n)=>t({[32824]:e,[10752]:n}),sampleCoverage:(t,e,n)=>t({[32938]:e,[32939]:n}),scissor:(t,e,n,r,i)=>t({[3088]:new Int32Array([e,n,r,i])}),stencilMask:(t,e)=>t({[2968]:e,[36005]:e}),stencilMaskSeparate:(t,e,n)=>t({[e===1028?2968:36005]:n}),stencilFunc:(t,e,n,r)=>t({[2962]:e,[2967]:n,[2963]:r,[34816]:e,[36003]:n,[36004]:r}),stencilFuncSeparate:(t,e,n,r,i)=>t({[e===1028?2962:34816]:n,[e===1028?2967:36003]:r,[e===1028?2963:36004]:i}),stencilOp:(t,e,n,r)=>t({[2964]:e,[2965]:n,[2966]:r,[34817]:e,[34818]:n,[34819]:r}),stencilOpSeparate:(t,e,n,r,i)=>t({[e===1028?2964:34817]:n,[e===1028?2965:34818]:r,[e===1028?2966:34819]:i}),viewport:(t,e,n,r,i)=>t({[2978]:[e,n,r,i]})},Gt=(t,e)=>t.isEnabled(e),Mg={[3042]:Gt,[2884]:Gt,[2929]:Gt,[3024]:Gt,[32823]:Gt,[32926]:Gt,[32928]:Gt,[3089]:Gt,[2960]:Gt,[35977]:Gt};function By(t){for(const e in t)return!1;return!0}function _S(t,e){if(t===e)return!0;const n=Array.isArray(t)||ArrayBuffer.isView(t),r=Array.isArray(e)||ArrayBuffer.isView(e);if(n&&r&&t.length===e.length){for(let i=0;i<t.length;++i)if(t[i]!==e[i])return!1;return!0}return!1}function kg(t,e){const n=t[e].bind(t);t[e]=function(){const i=arguments.length<=0?void 0:arguments[0];return i in t.state.cache?t.state.enable?t.state.cache[i]:n(...arguments):n(...arguments)},Object.defineProperty(t[e],"name",{value:"".concat(e,"-from-cache"),configurable:!1})}function vS(t,e,n){const r=t[e].bind(t);t[e]=function(){for(var s=arguments.length,o=new Array(s),a=0;a<s;a++)o[a]=arguments[a];const{valueChanged:l,oldValue:u}=n(t.state._updateCache,...o);return l&&r(...o),u},Object.defineProperty(t[e],"name",{value:"".concat(e,"-to-cache"),configurable:!1})}function wS(t){const e=t.useProgram.bind(t);t.useProgram=function(r){t.state.program!==r&&(e(r),t.state.program=r)}}class ES{constructor(e){let{copyState:n=!1,log:r=()=>{}}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};this.gl=e,this.program=null,this.stateStack=[],this.enable=!0,this.cache=n?bS(e):Object.assign({},af),this.log=r,this._updateCache=this._updateCache.bind(this),Object.seal(this)}push(){this.stateStack.push({})}pop(){Ge(this.stateStack.length>0);const e=this.stateStack[this.stateStack.length-1];yn(this.gl,e),this.stateStack.pop()}_updateCache(e){let n=!1,r;const i=this.stateStack.length>0&&this.stateStack[this.stateStack.length-1];for(const s in e){Ge(s!==void 0);const o=e[s],a=this.cache[s];_S(o,a)||(n=!0,r=a,i&&!(s in i)&&(i[s]=a),this.cache[s]=o)}return{valueChanged:n,oldValue:r}}}function Vy(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const{enable:n=!0,copyState:r}=e;if(Ge(r!==void 0),!t.state){const{polyfillContext:i}=globalThis;i&&i(t),t.state=new ES(t,{copyState:r}),wS(t);for(const s in Rg){const o=Rg[s];vS(t,s,o)}kg(t,"getParameter"),kg(t,"isEnabled")}return t.state.enable=n,t}function TS(t){t.state||Vy(t,{copyState:!1}),t.state.push()}function Ig(t){Ge(t.state),t.state.pop()}function yn(t,e){if(Ge(dl(t),"setParameters requires a WebGL context"),By(e))return;const n={};for(const i in e){const s=Number(i),o=mS[i];o&&(typeof o=="string"?n[o]=!0:o(t,e[i],s))}const r=t.state&&t.state.cache;if(r)for(const i in n){const s=yS[i];s(t,e,r)}}function bS(t,e){if(e=e||af,typeof e=="number"){const i=e,s=Mg[i];return s?s(t,i):t.getParameter(i)}const n=Array.isArray(e)?e:Object.keys(e),r={};for(const i of n){const s=Mg[i];r[i]=s?s(t,Number(i)):t.getParameter(Number(i))}return r}function SS(t){yn(t,af)}function St(t,e,n){if(By(e))return n(t);const{nocatch:r=!0}=e;TS(t),yn(t,e);let i;if(r)i=n(t),Ig(t);else try{i=n(t)}finally{Ig(t)}return i}function vr(t){const{luma:e}=t;if(t.canvas&&e){const{clientWidth:n}=e.canvasSizeInfo;return n?t.drawingBufferWidth/n:1}return 1}function gu(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;const r=vr(t),i=t.drawingBufferWidth,s=t.drawingBufferHeight;return xS(e,r,i,s,n)}function AS(t){const e=typeof window>"u"?1:window.devicePixelRatio||1;return Number.isFinite(t)?t<=0?1:t:t?e:1}function xS(t,e,n,r,i){const s=Og(t[0],e,n);let o=Ng(t[1],e,r,i),a=Og(t[0]+1,e,n);const l=a===n-1?a:a-1;a=Ng(t[1]+1,e,r,i);let u;return i?(a=a===0?a:a+1,u=o,o=a):u=a===r-1?a:a-1,{x:s,y:o,width:Math.max(l-s+1,1),height:Math.max(u-o+1,1)}}function Og(t,e,n){return Math.min(Math.round(t*e),n-1)}function Ng(t,e,n,r){return r?Math.max(0,n-1-Math.round(t*e)):Math.min(Math.round(t*e),n-1)}const lf=En(),PS=lf&&typeof document<"u",zy={webgl2:!0,webgl1:!0,throwOnError:!0,manageState:!0,canvas:null,debug:!1,width:800,height:600};function jy(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};Ge(lf,`createGLContext only available in the browser.
Create your own headless context or use 'createHeadlessContext' from @luma.gl/test-utils`),t=Object.assign({},zy,t);const{width:e,height:n}=t;function r(a){if(t.throwOnError)throw new Error(a);return console.error(a),null}t.onError=r;let i;const{canvas:s}=t,o=MS({canvas:s,width:e,height:n,onError:r});return i=RS(o,t),i?(i=uf(i,t),kS(i),i):null}function uf(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(!t||t._instrumented)return t;t._version=t._version||IS(t),t.luma=t.luma||{},t.luma.canvasSizeInfo=t.luma.canvasSizeInfo||{},e=Object.assign({},zy,e);const{manageState:n,debug:r}=e;return n&&Vy(t,{copyState:!1,log:function(){for(var i=arguments.length,s=new Array(i),o=0;o<i;o++)s[o]=arguments[o];return z.log(1,...s)()}}),lf&&r&&(globalThis.makeDebugContext?(t=globalThis.makeDebugContext(t,e),z.level=Math.max(z.level,1)):z.warn('WebGL debug mode not activated. import "@luma.gl/debug" to enable.')()),t._instrumented=!0,t}function CS(t){const e=t.getParameter(7936),n=t.getParameter(7937),r=t.getExtension("WEBGL_debug_renderer_info"),i=r&&t.getParameter(r.UNMASKED_VENDOR_WEBGL||7936),s=r&&t.getParameter(r.UNMASKED_RENDERER_WEBGL||7937);return{vendor:i||e,renderer:s||n,vendorMasked:e,rendererMasked:n,version:t.getParameter(7938),shadingLanguageVersion:t.getParameter(35724)}}function LS(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(t.canvas){const r=AS(e.useDevicePixels);OS(t,r,e);return}const n=t.getExtension("STACKGL_resize_drawingbuffer");n&&"width"in e&&"height"in e&&n.resize(e.width,e.height)}function RS(t,e){const{onError:n}=e;let r=null;const i=l=>r=l.statusMessage||r;t.addEventListener("webglcontextcreationerror",i,!1);const{webgl1:s=!0,webgl2:o=!0}=e;let a=null;return o&&(a=a||t.getContext("webgl2",e),a=a||t.getContext("experimental-webgl2",e)),s&&(a=a||t.getContext("webgl",e),a=a||t.getContext("experimental-webgl",e)),t.removeEventListener("webglcontextcreationerror",i,!1),a?(e.onContextLost&&t.addEventListener("webglcontextlost",e.onContextLost,!1),e.onContextRestored&&t.addEventListener("webglcontextrestored",e.onContextRestored,!1),a):n("Failed to create ".concat(o&&!s?"WebGL2":"WebGL"," context: ").concat(r||"Unknown error"))}function MS(t){let{canvas:e,width:n=800,height:r=600,onError:i}=t,s;return typeof e=="string"?(PS&&document.readyState==="complete"||i("createGLContext called on canvas '".concat(e,"' before page was loaded")),s=document.getElementById(e)):e?s=e:(s=document.createElement("canvas"),s.id="lumagl-canvas",s.style.width=Number.isFinite(n)?"".concat(n,"px"):"100%",s.style.height=Number.isFinite(r)?"".concat(r,"px"):"100%",document.body.insertBefore(s,document.body.firstChild)),s}function kS(t){const e=Y(t)?"WebGL2":"WebGL1",n=CS(t),r=n?"(".concat(n.vendor,",").concat(n.renderer,")"):"",i=t.debug?" debug":"";z.info(1,"".concat(e).concat(i," context ").concat(r))()}function IS(t){return typeof WebGL2RenderingContext<"u"&&t instanceof WebGL2RenderingContext?2:1}function OS(t,e,n){let r="width"in n?n.width:t.canvas.clientWidth,i="height"in n?n.height:t.canvas.clientHeight;(!r||!i)&&(z.log(1,"Canvas clientWidth/clientHeight is 0")(),e=1,r=t.canvas.width||1,i=t.canvas.height||1),t.luma=t.luma||{},t.luma.canvasSizeInfo=t.luma.canvasSizeInfo||{};const s=t.luma.canvasSizeInfo;if(s.clientWidth!==r||s.clientHeight!==i||s.devicePixelRatio!==e){let o=e;const a=Math.floor(r*o),l=Math.floor(i*o);t.canvas.width=a,t.canvas.height=l,(t.drawingBufferWidth!==a||t.drawingBufferHeight!==l)&&(z.warn("Device pixel ratio clamped")(),o=Math.min(t.drawingBufferWidth/r,t.drawingBufferHeight/i),t.canvas.width=Math.floor(r*o),t.canvas.height=Math.floor(i*o)),Object.assign(t.luma.canvasSizeInfo,{clientWidth:r,clientHeight:i,devicePixelRatio:e})}}const fs="8.5.18",NS="set luma.log.level=1 (or higher) to trace rendering";class DS{constructor(){this.stats=new Map}get(e){return this.stats.has(e)||this.stats.set(e,new tf({id:e})),this.stats.get(e)}}const cr=new DS;if(globalThis.luma&&globalThis.luma.VERSION!==fs)throw new Error("luma.gl - multiple VERSIONs detected: ".concat(globalThis.luma.VERSION," vs ").concat(fs));globalThis.luma||(En()&&z.log(1,"luma.gl ".concat(fs," - ").concat(NS))(),globalThis.luma=globalThis.luma||{VERSION:fs,version:fs,log:z,stats:cr,globals:{modules:{},nodeIO:{}}});function FS(t){return typeof window<"u"&&window.requestAnimationFrame?window.requestAnimationFrame(t):setTimeout(t,1e3/60)}function US(t){return typeof window<"u"&&window.cancelAnimationFrame?window.cancelAnimationFrame(t):clearTimeout(t)}function F(t,e){if(!t)throw new Error(e||"luma.gl: assertion failed.")}function pu(t,e){if(typeof e!="string")return e;const n=Number(e);if(!isNaN(n))return n;e=e.replace(/^.*\./,"");const r=t[e];return F(r!==void 0,"Accessing undefined constant GL.".concat(e)),r}function Wn(t,e){e=Number(e);for(const n in t)if(t[n]===e)return"GL.".concat(n);return String(e)}const mu={};function _n(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"id";mu[t]=mu[t]||1;const e=mu[t]++;return"".concat(t,"-").concat(e)}function Dg(t){return F(typeof t=="number","Input must be a number"),t&&(t&t-1)===0}function di(t){let e=!0;for(const n in t){e=!1;break}return e}function Gy(t,e,n,r){const i="See luma.gl ".concat(n," Upgrade Guide at https://luma.gl/docs/upgrade-guide"),s=Object.getPrototypeOf(t);r.forEach(o=>{s.methodName||(s[o]=()=>{throw z.removed("Calling removed method ".concat(e,".").concat(o,": "),i)(),new Error(o)})})}const Mr="Resource subclass must define virtual methods";let Tn=class{get[Symbol.toStringTag](){return"Resource"}constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};gl(e);const{id:r,userData:i={}}=n;this.gl=e,this.gl2=e,this.id=r||_n(this[Symbol.toStringTag]),this.userData=i,this._bound=!1,this._handle=n.handle,this._handle===void 0&&(this._handle=this._createHandle()),this.byteLength=0,this._addStats()}toString(){return"".concat(this[Symbol.toStringTag]||this.constructor.name,"(").concat(this.id,")")}get handle(){return this._handle}delete(){let{deleteChildren:e=!1}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const n=this._handle&&this._deleteHandle(this._handle);return this._handle&&this._removeStats(),this._handle=null,n&&e&&n.filter(Boolean).forEach(r=>r.delete()),this}bind(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.handle;if(typeof e!="function")return this._bindHandle(e),this;let n;return this._bound?n=e():(this._bindHandle(this.handle),this._bound=!0,n=e(),this._bound=!1,this._bindHandle(null)),n}unbind(){this.bind(null)}getParameter(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};e=pu(this.gl,e),F(e);const i=(this.constructor.PARAMETERS||{})[e];if(i){const s=Y(this.gl);if(!((!("webgl2"in i)||s)&&(!("extension"in i)||this.gl.getExtension(i.extension)))){const a=i.webgl1,l="webgl2"in i?i.webgl2:i.webgl1;return s?l:a}}return this._getParameter(e,n)}getParameters(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{parameters:n,keys:r}=e,i=this.constructor.PARAMETERS||{},s=Y(this.gl),o={},a=n||Object.keys(i);for(const l of a){const u=i[l];if(u&&(!("webgl2"in u)||s)&&(!("extension"in u)||this.gl.getExtension(u.extension))){const h=r?Wn(this.gl,l):l;o[h]=this.getParameter(l,e),r&&u.type==="GLenum"&&(o[h]=Wn(this.gl,o[h]))}}return o}setParameter(e,n){e=pu(this.gl,e),F(e);const i=(this.constructor.PARAMETERS||{})[e];if(i){const s=Y(this.gl);if(!((!("webgl2"in i)||s)&&(!("extension"in i)||this.gl.getExtension(i.extension))))throw new Error("Parameter not available on this platform");i.type==="GLenum"&&(n=pu(n))}return this._setParameter(e,n),this}setParameters(e){for(const n in e)this.setParameter(n,e[n]);return this}stubRemovedMethods(e,n,r){return Gy(this,e,n,r)}initialize(e){}_createHandle(){throw new Error(Mr)}_deleteHandle(){throw new Error(Mr)}_bindHandle(e){throw new Error(Mr)}_getOptsFromHandle(){throw new Error(Mr)}_getParameter(e,n){throw new Error(Mr)}_setParameter(e,n){throw new Error(Mr)}_context(){return this.gl.luma=this.gl.luma||{},this.gl.luma}_addStats(){const e=this[Symbol.toStringTag],n=cr.get("Resource Counts");n.get("Resources Created").incrementCount(),n.get("".concat(e,"s Created")).incrementCount(),n.get("".concat(e,"s Active")).incrementCount()}_removeStats(){const e=this[Symbol.toStringTag];cr.get("Resource Counts").get("".concat(e,"s Active")).decrementCount()}_trackAllocatedMemory(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this[Symbol.toStringTag];this._trackAllocatedMemoryForContext(e,n),this._trackAllocatedMemoryForContext(e,n,this.gl.canvas&&this.gl.canvas.id),this.byteLength=e}_trackAllocatedMemoryForContext(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this[Symbol.toStringTag],r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:"";const i=cr.get("Memory Usage".concat(r));i.get("GPU Memory").addCount(e),i.get("".concat(n," Memory")).addCount(e)}_trackDeallocatedMemory(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this[Symbol.toStringTag];this._trackDeallocatedMemoryForContext(e),this._trackDeallocatedMemoryForContext(e,this.gl.canvas&&this.gl.canvas.id),this.byteLength=0}_trackDeallocatedMemoryForContext(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this[Symbol.toStringTag],n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"";const r=cr.get("Memory Usage".concat(n));r.get("GPU Memory").subtractCount(this.byteLength),r.get("".concat(e," Memory")).subtractCount(this.byteLength)}};const BS="Failed to deduce GL constant from typed array";function Uc(t){switch(ArrayBuffer.isView(t)?t.constructor:t){case Float32Array:return 5126;case Uint16Array:return 5123;case Uint32Array:return 5125;case Uint8Array:return 5121;case Uint8ClampedArray:return 5121;case Int8Array:return 5120;case Int16Array:return 5122;case Int32Array:return 5124;default:throw new Error(BS)}}function Ms(t){let{clamped:e=!0}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};switch(t){case 5126:return Float32Array;case 5123:case 33635:case 32819:case 32820:return Uint16Array;case 5125:return Uint32Array;case 5121:return e?Uint8ClampedArray:Uint8Array;case 5120:return Int8Array;case 5122:return Int16Array;case 5124:return Int32Array;default:throw new Error("Failed to deduce typed array type from GL constant")}}function VS(t){let{data:e,width:n,height:r,bytesPerPixel:i=4,temp:s}=t;const o=n*i;s=s||new Uint8Array(o);for(let a=0;a<r/2;++a){const l=a*o,u=(r-a-1)*o;s.set(e.subarray(l,l+o)),e.copyWithin(l,u,u+o),e.set(s,u)}}function zS(t){let{data:e,width:n,height:r}=t;const i=Math.round(n/2),s=Math.round(r/2),o=new Uint8Array(i*s*4);for(let a=0;a<s;a++)for(let l=0;l<i;l++)for(let u=0;u<4;u++)o[(a*i+l)*4+u]=e[(a*2*n+l*2)*4+u];return{data:o,width:i,height:s}}function Bc(t,e,n){const{removedProps:r={},deprecatedProps:i={},replacedProps:s={}}=n;for(const a in r)if(a in e){const u=r[a]?"".concat(t,".").concat(r[a]):"N/A";z.removed("".concat(t,".").concat(a),u)()}for(const a in i)if(a in e){const l=i[a];z.deprecated("".concat(t,".").concat(a),"".concat(t,".").concat(l))()}let o=null;for(const a in s)if(a in e){const l=s[a];z.deprecated("".concat(t,".").concat(a),"".concat(t,".").concat(l))(),o=o||Object.assign({},e),o[l]=e[a],delete o[a]}return o||e}const jS={offset:0,stride:0,type:5126,size:1,divisor:0,normalized:!1,integer:!1},GS={deprecatedProps:{instanced:"divisor",isInstanced:"divisor"}};class at{static getBytesPerElement(e){return Ms(e.type||5126).BYTES_PER_ELEMENT}static getBytesPerVertex(e){return F(e.size),Ms(e.type||5126).BYTES_PER_ELEMENT*e.size}static resolve(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return new at(jS,...n)}constructor(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];n.forEach(i=>this._assign(i)),Object.freeze(this)}toString(){return JSON.stringify(this)}get BYTES_PER_ELEMENT(){return at.getBytesPerElement(this)}get BYTES_PER_VERTEX(){return at.getBytesPerVertex(this)}_assign(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return e=Bc("Accessor",e,GS),e.type!==void 0&&(this.type=e.type,(e.type===5124||e.type===5125)&&(this.integer=!0)),e.size!==void 0&&(this.size=e.size),e.offset!==void 0&&(this.offset=e.offset),e.stride!==void 0&&(this.stride=e.stride),e.normalized!==void 0&&(this.normalized=e.normalized),e.integer!==void 0&&(this.integer=e.integer),e.divisor!==void 0&&(this.divisor=e.divisor),e.buffer!==void 0&&(this.buffer=e.buffer),e.index!==void 0&&(typeof e.index=="boolean"?this.index=e.index?1:0:this.index=e.index),e.instanced!==void 0&&(this.divisor=e.instanced?1:0),e.isInstanced!==void 0&&(this.divisor=e.isInstanced?1:0),this}}const Fg=10,Hy={offset:"accessor.offset",stride:"accessor.stride",type:"accessor.type",size:"accessor.size",divisor:"accessor.divisor",normalized:"accessor.normalized",integer:"accessor.integer",instanced:"accessor.divisor",isInstanced:"accessor.divisor"},HS={removedProps:{},replacedProps:{bytes:"byteLength"},deprecatedProps:Hy},WS={removedProps:Hy};class te extends Tn{get[Symbol.toStringTag](){return"Buffer"}constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};super(e,n),this.stubRemovedMethods("Buffer","v6.0",["layout","setLayout","getIndexedParameter"]),this.target=n.target||(this.gl.webgl2?36662:34962),this.initialize(n),Object.seal(this)}getElementCount(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.accessor;return Math.round(this.byteLength/at.getBytesPerElement(e))}getVertexCount(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.accessor;return Math.round(this.byteLength/at.getBytesPerVertex(e))}initialize(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return ArrayBuffer.isView(e)&&(e={data:e}),Number.isFinite(e)&&(e={byteLength:e}),e=Bc("Buffer",e,HS),this.usage=e.usage||35044,this.debugData=null,this.setAccessor(Object.assign({},e,e.accessor)),e.data?this._setData(e.data,e.offset,e.byteLength):this._setByteLength(e.byteLength||0),this}setProps(e){return e=Bc("Buffer",e,WS),"accessor"in e&&this.setAccessor(e.accessor),this}setAccessor(e){return e=Object.assign({},e),delete e.buffer,this.accessor=new at(e),this}reallocate(e){return e>this.byteLength?(this._setByteLength(e),!0):(this.bytesUsed=e,!1)}setData(e){return this.initialize(e)}subData(e){ArrayBuffer.isView(e)&&(e={data:e});const{data:n,offset:r=0,srcOffset:i=0}=e,s=e.byteLength||e.length;F(n);const o=this.gl.webgl2?36663:this.target;return this.gl.bindBuffer(o,this.handle),i!==0||s!==void 0?(We(this.gl),this.gl.bufferSubData(this.target,r,n,i,s)):this.gl.bufferSubData(o,r,n),this.gl.bindBuffer(o,null),this.debugData=null,this._inferType(n),this}copyData(e){let{sourceBuffer:n,readOffset:r=0,writeOffset:i=0,size:s}=e;const{gl:o}=this;return We(o),o.bindBuffer(36662,n.handle),o.bindBuffer(36663,this.handle),o.copyBufferSubData(36662,36663,r,i,s),o.bindBuffer(36662,null),o.bindBuffer(36663,null),this.debugData=null,this}getData(){let{dstData:e=null,srcByteOffset:n=0,dstOffset:r=0,length:i=0}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};We(this.gl);const s=Ms(this.accessor.type||5126,{clamped:!1}),o=this._getAvailableElementCount(n),a=r;let l,u;e?(u=e.length,l=u-a):(l=Math.min(o,i||o),u=a+l);const c=Math.min(o,l);return i=i||c,F(i<=c),e=e||new s(u),this.gl.bindBuffer(36662,this.handle),this.gl.getBufferSubData(36662,n,e,r,i),this.gl.bindBuffer(36662,null),e}bind(){let{target:e=this.target,index:n=this.accessor&&this.accessor.index,offset:r=0,size:i}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return e===35345||e===35982?i!==void 0?this.gl.bindBufferRange(e,n,this.handle,r,i):(F(r===0),this.gl.bindBufferBase(e,n,this.handle)):this.gl.bindBuffer(e,this.handle),this}unbind(){let{target:e=this.target,index:n=this.accessor&&this.accessor.index}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return e===35345||e===35982?this.gl.bindBufferBase(e,n,null):this.gl.bindBuffer(e,null),this}getDebugData(){return this.debugData?{data:this.debugData,changed:!1}:(this.debugData=this.getData({length:Math.min(Fg,this.byteLength)}),{data:this.debugData,changed:!0})}invalidateDebugData(){this.debugData=null}_setData(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:e.byteLength+n;F(ArrayBuffer.isView(e)),this._trackDeallocatedMemory();const i=this._getTarget();this.gl.bindBuffer(i,this.handle),this.gl.bufferData(i,r,this.usage),this.gl.bufferSubData(i,n,e),this.gl.bindBuffer(i,null),this.debugData=e.slice(0,Fg),this.bytesUsed=r,this._trackAllocatedMemory(r);const s=Uc(e);return F(s),this.setAccessor(new at(this.accessor,{type:s})),this}_setByteLength(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.usage;F(e>=0),this._trackDeallocatedMemory();let r=e;e===0&&(r=new Float32Array(0));const i=this._getTarget();return this.gl.bindBuffer(i,this.handle),this.gl.bufferData(i,r,n),this.gl.bindBuffer(i,null),this.usage=n,this.debugData=null,this.bytesUsed=e,this._trackAllocatedMemory(e),this}_getTarget(){return this.gl.webgl2?36663:this.target}_getAvailableElementCount(e){const n=Ms(this.accessor.type||5126,{clamped:!1}),r=e/n.BYTES_PER_ELEMENT;return this.getElementCount()-r}_inferType(e){this.accessor.type||this.setAccessor(new at(this.accessor,{type:Uc(e)}))}_createHandle(){return this.gl.createBuffer()}_deleteHandle(){this.gl.deleteBuffer(this.handle),this._trackDeallocatedMemory()}_getParameter(e){this.gl.bindBuffer(this.target,this.handle);const n=this.gl.getBufferParameter(this.target,e);return this.gl.bindBuffer(this.target,null),n}get type(){return z.deprecated("Buffer.type","Buffer.accessor.type")(),this.accessor.type}get bytes(){return z.deprecated("Buffer.bytes","Buffer.byteLength")(),this.byteLength}setByteLength(e){return z.deprecated("setByteLength","reallocate")(),this.reallocate(e)}updateAccessor(e){return z.deprecated("updateAccessor(...)","setAccessor(new Accessor(buffer.accessor, ...)")(),this.accessor=new at(this.accessor,e),this}}const cf={[6407]:{dataFormat:6407,types:[5121,33635]},[6408]:{dataFormat:6408,types:[5121,32819,32820]},[6406]:{dataFormat:6406,types:[5121]},[6409]:{dataFormat:6409,types:[5121]},[6410]:{dataFormat:6410,types:[5121]},[33326]:{dataFormat:6403,types:[5126],gl2:!0},[33328]:{dataFormat:33319,types:[5126],gl2:!0},[34837]:{dataFormat:6407,types:[5126],gl2:!0},[34836]:{dataFormat:6408,types:[5126],gl2:!0}},Wy={[6403]:1,[36244]:1,[33319]:2,[33320]:2,[6407]:3,[36248]:3,[6408]:4,[36249]:4,[6402]:1,[34041]:1,[6406]:1,[6409]:1,[6410]:2},Xy={[5126]:4,[5125]:4,[5124]:4,[5123]:2,[5122]:2,[5131]:2,[5120]:1,[5121]:1};function XS(t,e){const n=cf[e];if(!n)return!1;if(n.gl1===void 0&&n.gl2===void 0)return!0;const r=Y(t)&&n.gl2||n.gl1;return typeof r=="string"?t.getExtension(r):r}function YS(t,e){const n=cf[e];switch(n&&n.types[0]){case 5126:return t.getExtension("OES_texture_float_linear");case 5131:return t.getExtension("OES_texture_half_float_linear");default:return!0}}const $S=[9729,9728],Ug=globalThis.WebGLBuffer||function(){};class gi extends Tn{get[Symbol.toStringTag](){return"Texture"}static isSupported(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const{format:r,linearFiltering:i}=n;let s=!0;return r&&(s=s&&XS(e,r),s=s&&(!i||YS(e,r))),s}constructor(e,n){const{id:r=_n("texture"),handle:i,target:s}=n;super(e,{id:r,handle:i}),this.target=s,this.textureUnit=void 0,this.loaded=!1,this.width=void 0,this.height=void 0,this.depth=void 0,this.format=void 0,this.type=void 0,this.dataFormat=void 0,this.border=void 0,this.textureUnit=void 0,this.mipmaps=void 0}toString(){return"Texture(".concat(this.id,",").concat(this.width,"x").concat(this.height,")")}initialize(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},n=e.data;if(n instanceof Promise)return n.then(m=>this.initialize(Object.assign({},e,{pixels:m,data:m}))),this;const r=typeof HTMLVideoElement<"u"&&n instanceof HTMLVideoElement;if(r&&n.readyState<HTMLVideoElement.HAVE_METADATA)return this._video=null,n.addEventListener("loadeddata",()=>this.initialize(e)),this;const{pixels:i=null,format:s=6408,border:o=0,recreate:a=!1,parameters:l={},pixelStore:u={},textureUnit:c=void 0}=e;n||(n=i);let{width:h,height:f,dataFormat:g,type:w,compressed:E=!1,mipmaps:T=!0}=e;const{depth:y=0}=e;return{width:h,height:f,compressed:E,dataFormat:g,type:w}=this._deduceParameters({format:s,type:w,dataFormat:g,compressed:E,data:n,width:h,height:f}),this.width=h,this.height=f,this.depth=y,this.format=s,this.type=w,this.dataFormat=g,this.border=o,this.textureUnit=c,Number.isFinite(this.textureUnit)&&(this.gl.activeTexture(33984+this.textureUnit),this.gl.bindTexture(this.target,this.handle)),T&&this._isNPOT()&&(z.warn("texture: ".concat(this," is Non-Power-Of-Two, disabling mipmaping"))(),T=!1,this._updateForNPOT(l)),this.mipmaps=T,this.setImageData({data:n,width:h,height:f,depth:y,format:s,type:w,dataFormat:g,border:o,mipmaps:T,parameters:u,compressed:E}),T&&this.generateMipmap(),this.setParameters(l),a&&(this.data=n),r&&(this._video={video:n,parameters:l,lastTime:n.readyState>=HTMLVideoElement.HAVE_CURRENT_DATA?n.currentTime:-1}),this}update(){if(this._video){const{video:e,parameters:n,lastTime:r}=this._video;if(r===e.currentTime||e.readyState<HTMLVideoElement.HAVE_CURRENT_DATA)return;this.setSubImageData({data:e,parameters:n}),this.mipmaps&&this.generateMipmap(),this._video.lastTime=e.currentTime}}resize(e){let{height:n,width:r,mipmaps:i=!1}=e;return r!==this.width||n!==this.height?this.initialize({width:r,height:n,format:this.format,type:this.type,dataFormat:this.dataFormat,border:this.border,mipmaps:i}):this}generateMipmap(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return this._isNPOT()?(z.warn("texture: ".concat(this," is Non-Power-Of-Two, disabling mipmaping"))(),this):(this.mipmaps=!0,this.gl.bindTexture(this.target,this.handle),St(this.gl,e,()=>{this.gl.generateMipmap(this.target)}),this.gl.bindTexture(this.target,null),this)}setImageData(e){this._trackDeallocatedMemory("Texture");const{target:n=this.target,pixels:r=null,level:i=0,format:s=this.format,border:o=this.border,offset:a=0,parameters:l={}}=e;let{data:u=null,type:c=this.type,width:h=this.width,height:f=this.height,dataFormat:g=this.dataFormat,compressed:w=!1}=e;u||(u=r),{type:c,dataFormat:g,compressed:w,width:h,height:f}=this._deduceParameters({format:s,type:c,dataFormat:g,compressed:w,data:u,width:h,height:f});const{gl:E}=this;E.bindTexture(this.target,this.handle);let T=null;({data:u,dataType:T}=this._getDataType({data:u,compressed:w}));let y,m=0;if(St(this.gl,l,()=>{switch(T){case"null":E.texImage2D(n,i,s,h,f,o,g,c,u);break;case"typed-array":E.texImage2D(n,i,s,h,f,o,g,c,u,a);break;case"buffer":y=We(E),y.bindBuffer(35052,u.handle||u),y.texImage2D(n,i,s,h,f,o,g,c,a),y.bindBuffer(35052,null);break;case"browser-object":Y(E)?E.texImage2D(n,i,s,h,f,o,g,c,u):E.texImage2D(n,i,s,g,c,u);break;case"compressed":for(const[_,S]of u.entries())E.compressedTexImage2D(n,_,S.format,S.width,S.height,o,S.data),m+=S.levelSize;break;default:F(!1,"Unknown image data type")}}),T==="compressed")this._trackAllocatedMemory(m,"Texture");else if(u&&u.byteLength)this._trackAllocatedMemory(u.byteLength,"Texture");else{const _=Wy[this.dataFormat]||4,S=Xy[this.type]||1;this._trackAllocatedMemory(this.width*this.height*_*S,"Texture")}return this.loaded=!0,this}setSubImageData(e){let{target:n=this.target,pixels:r=null,data:i=null,x:s=0,y:o=0,width:a=this.width,height:l=this.height,level:u=0,format:c=this.format,type:h=this.type,dataFormat:f=this.dataFormat,compressed:g=!1,offset:w=0,border:E=this.border,parameters:T={}}=e;if({type:h,dataFormat:f,compressed:g,width:a,height:l}=this._deduceParameters({format:c,type:h,dataFormat:f,compressed:g,data:i,width:a,height:l}),F(this.depth===0,"texSubImage not supported for 3D textures"),i||(i=r),i&&i.data){const y=i;i=y.data,a=y.shape[0],l=y.shape[1]}i instanceof te&&(i=i.handle),this.gl.bindTexture(this.target,this.handle),St(this.gl,T,()=>{if(g)this.gl.compressedTexSubImage2D(n,u,s,o,a,l,c,i);else if(i===null)this.gl.texSubImage2D(n,u,s,o,a,l,f,h,null);else if(ArrayBuffer.isView(i))this.gl.texSubImage2D(n,u,s,o,a,l,f,h,i,w);else if(i instanceof Ug){const y=We(this.gl);y.bindBuffer(35052,i),y.texSubImage2D(n,u,s,o,a,l,f,h,w),y.bindBuffer(35052,null)}else Y(this.gl)?We(this.gl).texSubImage2D(n,u,s,o,a,l,f,h,i):this.gl.texSubImage2D(n,u,s,o,f,h,i)}),this.gl.bindTexture(this.target,null)}copyFramebuffer(){return z.error("Texture.copyFramebuffer({...}) is no logner supported, use copyToTexture(source, target, opts})")(),null}getActiveUnit(){return this.gl.getParameter(34016)-33984}bind(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.textureUnit;const{gl:n}=this;return e!==void 0&&(this.textureUnit=e,n.activeTexture(33984+e)),n.bindTexture(this.target,this.handle),e}unbind(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.textureUnit;const{gl:n}=this;return e!==void 0&&(this.textureUnit=e,n.activeTexture(33984+e)),n.bindTexture(this.target,null),e}_getDataType(e){let{data:n,compressed:r=!1}=e;return r?{data:n,dataType:"compressed"}:n===null?{data:n,dataType:"null"}:ArrayBuffer.isView(n)?{data:n,dataType:"typed-array"}:n instanceof te?{data:n.handle,dataType:"buffer"}:n instanceof Ug?{data:n,dataType:"buffer"}:{data:n,dataType:"browser-object"}}_deduceParameters(e){const{format:n,data:r}=e;let{width:i,height:s,dataFormat:o,type:a,compressed:l}=e;const u=cf[n];return o=o||u&&u.dataFormat,a=a||u&&u.types[0],l=l||u&&u.compressed,{width:i,height:s}=this._deduceImageSize(r,i,s),{dataFormat:o,type:a,compressed:l,width:i,height:s,format:n,data:r}}_deduceImageSize(e,n,r){let i;return typeof ImageData<"u"&&e instanceof ImageData?i={width:e.width,height:e.height}:typeof HTMLImageElement<"u"&&e instanceof HTMLImageElement?i={width:e.naturalWidth,height:e.naturalHeight}:typeof HTMLCanvasElement<"u"&&e instanceof HTMLCanvasElement?i={width:e.width,height:e.height}:typeof ImageBitmap<"u"&&e instanceof ImageBitmap?i={width:e.width,height:e.height}:typeof HTMLVideoElement<"u"&&e instanceof HTMLVideoElement?i={width:e.videoWidth,height:e.videoHeight}:e?i={width:n,height:r}:i={width:n>=0?n:1,height:r>=0?r:1},F(i,"Could not deduced texture size"),F(n===void 0||i.width===n,"Deduced texture width does not match supplied width"),F(r===void 0||i.height===r,"Deduced texture height does not match supplied height"),i}_createHandle(){return this.gl.createTexture()}_deleteHandle(){this.gl.deleteTexture(this.handle),this._trackDeallocatedMemory("Texture")}_getParameter(e){switch(e){case 4096:return this.width;case 4097:return this.height;default:this.gl.bindTexture(this.target,this.handle);const n=this.gl.getTexParameter(this.target,e);return this.gl.bindTexture(this.target,null),n}}_setParameter(e,n){switch(this.gl.bindTexture(this.target,this.handle),n=this._getNPOTParam(e,n),e){case 33082:case 33083:this.gl.texParameterf(this.handle,e,n);break;case 4096:case 4097:F(!1);break;default:this.gl.texParameteri(this.target,e,n);break}return this.gl.bindTexture(this.target,null),this}_isNPOT(){return Y(this.gl)||!this.width||!this.height?!1:!Dg(this.width)||!Dg(this.height)}_updateForNPOT(e){e[this.gl.TEXTURE_MIN_FILTER]===void 0&&(e[this.gl.TEXTURE_MIN_FILTER]=this.gl.LINEAR),e[this.gl.TEXTURE_WRAP_S]===void 0&&(e[this.gl.TEXTURE_WRAP_S]=this.gl.CLAMP_TO_EDGE),e[this.gl.TEXTURE_WRAP_T]===void 0&&(e[this.gl.TEXTURE_WRAP_T]=this.gl.CLAMP_TO_EDGE)}_getNPOTParam(e,n){if(this._isNPOT())switch(e){case 10241:$S.indexOf(n)===-1&&(n=9729);break;case 10242:case 10243:n!==33071&&(n=33071);break}return n}}let qS="";function ZS(t,e){return F(typeof t=="string"),t=qS+t,new Promise((n,r)=>{try{const i=new Image;i.onload=()=>n(i),i.onerror=()=>r(new Error("Could not load image ".concat(t,"."))),i.crossOrigin=e&&e.crossOrigin||"anonymous",i.src=t}catch(i){r(i)}})}class dt extends gi{get[Symbol.toStringTag](){return"Texture2D"}static isSupported(e,n){return gi.isSupported(e,n)}constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};gl(e),(n instanceof Promise||typeof n=="string")&&(n={data:n}),typeof n.data=="string"&&(n=Object.assign({},n,{data:ZS(n.data)})),super(e,Object.assign({},n,{target:3553})),this.initialize(n),Object.seal(this)}}const Vc=[34069,34070,34071,34072,34073,34074];class Yy extends gi{get[Symbol.toStringTag](){return"TextureCube"}constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};gl(e),super(e,Object.assign({},n,{target:34067})),this.initialize(n),Object.seal(this)}initialize(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{mipmaps:n=!0,parameters:r={}}=e;return this.opts=e,this.setCubeMapImageData(e).then(()=>{this.loaded=!0,n&&this.generateMipmap(e),this.setParameters(r)}),this}subImage(e){let{face:n,data:r,x:i=0,y:s=0,mipmapLevel:o=0}=e;return this._subImage({target:n,data:r,x:i,y:s,mipmapLevel:o})}async setCubeMapImageData(e){let{width:n,height:r,pixels:i,data:s,border:o=0,format:a=6408,type:l=5121}=e;const{gl:u}=this,c=i||s,h=await Promise.all(Vc.map(f=>{const g=c[f];return Promise.all(Array.isArray(g)?g:[g])}));this.bind(),Vc.forEach((f,g)=>{h[g].length>1&&this.opts.mipmaps!==!1&&z.warn("".concat(this.id," has mipmap and multiple LODs."))(),h[g].forEach((w,E)=>{n&&r?u.texImage2D(f,E,a,n,r,o,a,l,w):u.texImage2D(f,E,a,a,l,w)})}),this.unbind()}setImageDataForFace(e){const{face:n,width:r,height:i,pixels:s,data:o,border:a=0,format:l=6408,type:u=5121}=e,{gl:c}=this,h=s||o;return this.bind(),h instanceof Promise?h.then(f=>this.setImageDataForFace(Object.assign({},e,{face:n,data:f,pixels:f}))):this.width||this.height?c.texImage2D(n,0,l,r,i,a,l,u,h):c.texImage2D(n,0,l,l,u,h),this}}Yy.FACES=Vc;class QS extends gi{get[Symbol.toStringTag](){return"Texture3D"}static isSupported(e){return Y(e)}constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};We(e),n=Object.assign({depth:1},n,{target:32879,unpackFlipY:!1}),super(e,n),this.initialize(n),Object.seal(this)}setImageData(e){let{level:n=0,dataFormat:r=6408,width:i,height:s,depth:o=1,border:a=0,format:l,type:u=5121,offset:c=0,data:h,parameters:f={}}=e;if(this._trackDeallocatedMemory("Texture"),this.gl.bindTexture(this.target,this.handle),St(this.gl,f,()=>{ArrayBuffer.isView(h)&&this.gl.texImage3D(this.target,n,r,i,s,o,a,l,u,h),h instanceof te&&(this.gl.bindBuffer(35052,h.handle),this.gl.texImage3D(this.target,n,r,i,s,o,a,l,u,c))}),h&&h.byteLength)this._trackAllocatedMemory(h.byteLength,"Texture");else{const g=Wy[this.dataFormat]||4,w=Xy[this.type]||1;this._trackAllocatedMemory(this.width*this.height*this.depth*g*w,"Texture")}return this.loaded=!0,this}}const tr="EXT_color_buffer_float",Bg={[33189]:{bpp:2},[33190]:{gl2:!0,bpp:3},[36012]:{gl2:!0,bpp:4},[36168]:{bpp:1},[34041]:{bpp:4},[35056]:{gl2:!0,bpp:4},[36013]:{gl2:!0,bpp:5},[32854]:{bpp:2},[36194]:{bpp:2},[32855]:{bpp:2},[33321]:{gl2:!0,bpp:1},[33330]:{gl2:!0,bpp:1},[33329]:{gl2:!0,bpp:1},[33332]:{gl2:!0,bpp:2},[33331]:{gl2:!0,bpp:2},[33334]:{gl2:!0,bpp:4},[33333]:{gl2:!0,bpp:4},[33323]:{gl2:!0,bpp:2},[33336]:{gl2:!0,bpp:2},[33335]:{gl2:!0,bpp:2},[33338]:{gl2:!0,bpp:4},[33337]:{gl2:!0,bpp:4},[33340]:{gl2:!0,bpp:8},[33339]:{gl2:!0,bpp:8},[32849]:{gl2:!0,bpp:3},[32856]:{gl2:!0,bpp:4},[32857]:{gl2:!0,bpp:4},[36220]:{gl2:!0,bpp:4},[36238]:{gl2:!0,bpp:4},[36975]:{gl2:!0,bpp:4},[36214]:{gl2:!0,bpp:8},[36232]:{gl2:!0,bpp:8},[36226]:{gl2:!0,bpp:16},[36208]:{gl2:!0,bpp:16},[33325]:{gl2:tr,bpp:2},[33327]:{gl2:tr,bpp:4},[34842]:{gl2:tr,bpp:8},[33326]:{gl2:tr,bpp:4},[33328]:{gl2:tr,bpp:8},[34836]:{gl2:tr,bpp:16},[35898]:{gl2:tr,bpp:4}};function KS(t,e,n){const r=n[e];if(!r)return!1;const i=Y(t)&&r.gl2||r.gl1;return typeof i=="string"?t.getExtension(i):i}class Zr extends Tn{get[Symbol.toStringTag](){return"Renderbuffer"}static isSupported(e){let{format:n}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{format:null};return!n||KS(e,n,Bg)}static getSamplesForFormat(e,n){let{format:r}=n;return e.getInternalformatParameter(36161,r,32937)}constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};super(e,n),this.initialize(n),Object.seal(this)}initialize(e){let{format:n,width:r=1,height:i=1,samples:s=0}=e;return F(n,"Needs format"),this._trackDeallocatedMemory(),this.gl.bindRenderbuffer(36161,this.handle),s!==0&&Y(this.gl)?this.gl.renderbufferStorageMultisample(36161,s,n,r,i):this.gl.renderbufferStorage(36161,n,r,i),this.format=n,this.width=r,this.height=i,this.samples=s,this._trackAllocatedMemory(this.width*this.height*(this.samples||1)*Bg[this.format].bpp),this}resize(e){let{width:n,height:r}=e;return n!==this.width||r!==this.height?this.initialize({width:n,height:r,format:this.format,samples:this.samples}):this}_createHandle(){return this.gl.createRenderbuffer()}_deleteHandle(){this.gl.deleteRenderbuffer(this.handle),this._trackDeallocatedMemory()}_bindHandle(e){this.gl.bindRenderbuffer(36161,e)}_syncHandle(e){this.format=this.getParameter(36164),this.width=this.getParameter(36162),this.height=this.getParameter(36163),this.samples=this.getParameter(36011)}_getParameter(e){return this.gl.bindRenderbuffer(36161,this.handle),this.gl.getRenderbufferParameter(36161,e)}}const JS=256,eA=1024,tA=16384,Vg=6144,zg=6145,jg=6146,Gg=34041,$y="clear: bad arguments";function hf(t){let{framebuffer:e=null,color:n=null,depth:r=null,stencil:i=null}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const s={};e&&(s.framebuffer=e);let o=0;n&&(o|=tA,n!==!0&&(s.clearColor=n)),r&&(o|=JS,r!==!0&&(s.clearDepth=r)),i&&(o|=eA,r!==!0&&(s.clearStencil=r)),F(o!==0,$y),St(t,s,()=>{t.clear(o)})}function nA(t){let{framebuffer:e=null,buffer:n=Vg,drawBuffer:r=0,value:i=[0,0,0,0]}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};We(t),St(t,{framebuffer:e},()=>{switch(n){case Vg:switch(i.constructor){case Int32Array:t.clearBufferiv(n,r,i);break;case Uint32Array:t.clearBufferuiv(n,r,i);break;case Float32Array:default:t.clearBufferfv(n,r,i)}break;case zg:t.clearBufferfv(zg,0,[i]);break;case jg:t.clearBufferiv(jg,0,[i]);break;case Gg:const[s,o]=i;t.clearBufferfi(Gg,0,s,o);break;default:F(!1,$y)}})}function rA(t){switch(t){case 6406:case 33326:case 6403:return 1;case 33328:case 33319:return 2;case 6407:case 34837:return 3;case 6408:case 34836:return 4;default:return F(!1),0}}function pl(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const{sourceX:n=0,sourceY:r=0,sourceFormat:i=6408}=e;let{sourceAttachment:s=36064,target:o=null,sourceWidth:a,sourceHeight:l,sourceType:u}=e;const{framebuffer:c,deleteFramebuffer:h}=iA(t);F(c);const{gl:f,handle:g,attachments:w}=c;a=a||c.width,l=l||c.height,s===36064&&g===null&&(s=1028),F(w[s]),u=u||w[s].type,o=sA(o,u,i,a,l),u=u||Uc(o);const E=f.bindFramebuffer(36160,g);return f.readPixels(n,r,a,l,i,u,o),f.bindFramebuffer(36160,E||null),h&&c.delete(),o}function Hg(t){let{sourceAttachment:e=36064,targetMaxHeight:n=Number.MAX_SAFE_INTEGER}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},r=pl(t,{sourceAttachment:e}),{width:i,height:s}=t;for(;s>n;)({data:r,width:i,height:s}=zS({data:r,width:i,height:s}));VS({data:r,width:i,height:s});const o=document.createElement("canvas");o.width=i,o.height=s;const a=o.getContext("2d"),l=a.createImageData(i,s);return l.data.set(r),a.putImageData(l,0,0),o.toDataURL()}function iA(t){return t instanceof we?{framebuffer:t,deleteFramebuffer:!1}:{framebuffer:gA(t),deleteFramebuffer:!0}}function sA(t,e,n,r,i){if(t)return t;e=e||5121;const s=Ms(e,{clamped:!1}),o=rA(n);return new s(r*i*o)}const ae={WEBGL2:"WEBGL2",VERTEX_ARRAY_OBJECT:"VERTEX_ARRAY_OBJECT",TIMER_QUERY:"TIMER_QUERY",INSTANCED_RENDERING:"INSTANCED_RENDERING",MULTIPLE_RENDER_TARGETS:"MULTIPLE_RENDER_TARGETS",ELEMENT_INDEX_UINT32:"ELEMENT_INDEX_UINT32",BLEND_EQUATION_MINMAX:"BLEND_EQUATION_MINMAX",FLOAT_BLEND:"FLOAT_BLEND",COLOR_ENCODING_SRGB:"COLOR_ENCODING_SRGB",TEXTURE_DEPTH:"TEXTURE_DEPTH",TEXTURE_FLOAT:"TEXTURE_FLOAT",TEXTURE_HALF_FLOAT:"TEXTURE_HALF_FLOAT",TEXTURE_FILTER_LINEAR_FLOAT:"TEXTURE_FILTER_LINEAR_FLOAT",TEXTURE_FILTER_LINEAR_HALF_FLOAT:"TEXTURE_FILTER_LINEAR_HALF_FLOAT",TEXTURE_FILTER_ANISOTROPIC:"TEXTURE_FILTER_ANISOTROPIC",COLOR_ATTACHMENT_RGBA32F:"COLOR_ATTACHMENT_RGBA32F",COLOR_ATTACHMENT_FLOAT:"COLOR_ATTACHMENT_FLOAT",COLOR_ATTACHMENT_HALF_FLOAT:"COLOR_ATTACHMENT_HALF_FLOAT",GLSL_FRAG_DATA:"GLSL_FRAG_DATA",GLSL_FRAG_DEPTH:"GLSL_FRAG_DEPTH",GLSL_DERIVATIVES:"GLSL_DERIVATIVES",GLSL_TEXTURE_LOD:"GLSL_TEXTURE_LOD"};function oA(t){const e=new dt(t,{format:6408,type:5126,dataFormat:6408}),n=new we(t,{id:"test-framebuffer",check:!1,attachments:{[36064]:e}}),r=n.getStatus();return e.delete(),n.delete(),r===36053}const qy={[ae.WEBGL2]:[!1,!0],[ae.VERTEX_ARRAY_OBJECT]:["OES_vertex_array_object",!0],[ae.TIMER_QUERY]:["EXT_disjoint_timer_query","EXT_disjoint_timer_query_webgl2"],[ae.INSTANCED_RENDERING]:["ANGLE_instanced_arrays",!0],[ae.MULTIPLE_RENDER_TARGETS]:["WEBGL_draw_buffers",!0],[ae.ELEMENT_INDEX_UINT32]:["OES_element_index_uint",!0],[ae.BLEND_EQUATION_MINMAX]:["EXT_blend_minmax",!0],[ae.FLOAT_BLEND]:["EXT_float_blend"],[ae.COLOR_ENCODING_SRGB]:["EXT_sRGB",!0],[ae.TEXTURE_DEPTH]:["WEBGL_depth_texture",!0],[ae.TEXTURE_FLOAT]:["OES_texture_float",!0],[ae.TEXTURE_HALF_FLOAT]:["OES_texture_half_float",!0],[ae.TEXTURE_FILTER_LINEAR_FLOAT]:["OES_texture_float_linear"],[ae.TEXTURE_FILTER_LINEAR_HALF_FLOAT]:["OES_texture_half_float_linear"],[ae.TEXTURE_FILTER_ANISOTROPIC]:["EXT_texture_filter_anisotropic"],[ae.COLOR_ATTACHMENT_RGBA32F]:[oA,"EXT_color_buffer_float"],[ae.COLOR_ATTACHMENT_FLOAT]:[!1,"EXT_color_buffer_float"],[ae.COLOR_ATTACHMENT_HALF_FLOAT]:["EXT_color_buffer_half_float"],[ae.GLSL_FRAG_DATA]:["WEBGL_draw_buffers",!0],[ae.GLSL_FRAG_DEPTH]:["EXT_frag_depth",!0],[ae.GLSL_DERIVATIVES]:["OES_standard_derivatives",!0],[ae.GLSL_TEXTURE_LOD]:["EXT_shader_texture_lod",!0]},aA=2;function Zy(t,e){return Qy(t,e)}function Qy(t,e){return e=Array.isArray(e)?e:[e],e.every(n=>Ky(t,n))}function lA(t){t.luma=t.luma||{},t.luma.caps=t.luma.caps||{};for(const e in qy)t.luma.caps[e]===void 0&&(t.luma.caps[e]=Ky(t,e));return t.luma.caps}function Ky(t,e){return t.luma=t.luma||{},t.luma.caps=t.luma.caps||{},t.luma.caps[e]===void 0&&(t.luma.caps[e]=uA(t,e)),t.luma.caps[e]||z.log(aA,"Feature: ".concat(e," not supported"))(),t.luma.caps[e]}function uA(t,e){const n=qy[e];F(n,e);let r;const i=Y(t)&&n[1]||n[0];if(typeof i=="function")r=i(t);else if(Array.isArray(i)){r=!0;for(const s of i)r=r&&Boolean(t.getExtension(s))}else typeof i=="string"?r=Boolean(t.getExtension(i)):typeof i=="boolean"?r=i:F(!1);return r}const Wg="Multiple render targets not supported";class we extends Tn{get[Symbol.toStringTag](){return"Framebuffer"}static isSupported(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const{colorBufferFloat:r,colorBufferHalfFloat:i}=n;let s=!0;return r&&(s=Boolean(e.getExtension("EXT_color_buffer_float")||e.getExtension("WEBGL_color_buffer_float")||e.getExtension("OES_texture_float"))),i&&(s=s&&Boolean(e.getExtension("EXT_color_buffer_float")||e.getExtension("EXT_color_buffer_half_float"))),s}static getDefaultFramebuffer(e){return e.luma=e.luma||{},e.luma.defaultFramebuffer=e.luma.defaultFramebuffer||new we(e,{id:"default-framebuffer",handle:null,attachments:{}}),e.luma.defaultFramebuffer}get MAX_COLOR_ATTACHMENTS(){const e=We(this.gl);return e.getParameter(e.MAX_COLOR_ATTACHMENTS)}get MAX_DRAW_BUFFERS(){const e=We(this.gl);return e.getParameter(e.MAX_DRAW_BUFFERS)}constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};super(e,n),this.width=null,this.height=null,this.attachments={},this.readBuffer=36064,this.drawBuffers=[36064],this.ownResources=[],this.initialize(n),Object.seal(this)}get color(){return this.attachments[36064]||null}get texture(){return this.attachments[36064]||null}get depth(){return this.attachments[36096]||this.attachments[33306]||null}get stencil(){return this.attachments[36128]||this.attachments[33306]||null}initialize(e){let{width:n=1,height:r=1,attachments:i=null,color:s=!0,depth:o=!0,stencil:a=!1,check:l=!0,readBuffer:u=void 0,drawBuffers:c=void 0}=e;if(F(n>=0&&r>=0,"Width and height need to be integers"),this.width=n,this.height=r,i)for(const h in i){const f=i[h];(Array.isArray(f)?f[0]:f).resize({width:n,height:r})}else i=this._createDefaultAttachments(s,o,a,n,r);this.update({clearAttachments:!0,attachments:i,readBuffer:u,drawBuffers:c}),i&&l&&this.checkStatus()}delete(){for(const e of this.ownResources)e.delete();return super.delete(),this}update(e){let{attachments:n={},readBuffer:r,drawBuffers:i,clearAttachments:s=!1,resizeAttachments:o=!0}=e;this.attach(n,{clearAttachments:s,resizeAttachments:o});const{gl:a}=this,l=a.bindFramebuffer(36160,this.handle);return r&&this._setReadBuffer(r),i&&this._setDrawBuffers(i),a.bindFramebuffer(36160,l||null),this}resize(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},{width:n,height:r}=e;if(this.handle===null)return F(n===void 0&&r===void 0),this.width=this.gl.drawingBufferWidth,this.height=this.gl.drawingBufferHeight,this;n===void 0&&(n=this.gl.drawingBufferWidth),r===void 0&&(r=this.gl.drawingBufferHeight),n!==this.width&&r!==this.height&&z.log(2,"Resizing framebuffer ".concat(this.id," to ").concat(n,"x").concat(r))();for(const i in this.attachments)this.attachments[i].resize({width:n,height:r});return this.width=n,this.height=r,this}attach(e){let{clearAttachments:n=!1,resizeAttachments:r=!0}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const i={};n&&Object.keys(this.attachments).forEach(o=>{i[o]=null}),Object.assign(i,e);const s=this.gl.bindFramebuffer(36160,this.handle);for(const o in i){F(o!==void 0,"Misspelled framebuffer binding point?");const a=Number(o),l=i[a];let u=l;if(!u)this._unattach(a);else if(u instanceof Zr)this._attachRenderbuffer({attachment:a,renderbuffer:u});else if(Array.isArray(l)){const[c,h=0,f=0]=l;u=c,this._attachTexture({attachment:a,texture:c,layer:h,level:f})}else this._attachTexture({attachment:a,texture:u,layer:0,level:0});r&&u&&u.resize({width:this.width,height:this.height})}this.gl.bindFramebuffer(36160,s||null),Object.assign(this.attachments,e),Object.keys(this.attachments).filter(o=>!this.attachments[o]).forEach(o=>{delete this.attachments[o]})}checkStatus(){const e=this.getStatus();if(e!==36053)throw new Error(hA(e));return this}getStatus(){const{gl:e}=this,n=e.bindFramebuffer(36160,this.handle),r=e.checkFramebufferStatus(36160);return e.bindFramebuffer(36160,n||null),r}clear(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{color:n,depth:r,stencil:i,drawBuffers:s=[]}=e,o=this.gl.bindFramebuffer(36160,this.handle);return(n||r||i)&&hf(this.gl,{color:n,depth:r,stencil:i}),s.forEach((a,l)=>{nA(this.gl,{drawBuffer:l,value:a})}),this.gl.bindFramebuffer(36160,o||null),this}readPixels(){return z.error("Framebuffer.readPixels() is no logner supported, use readPixelsToArray(framebuffer)")(),null}readPixelsToBuffer(){return z.error("Framebuffer.readPixelsToBuffer()is no logner supported, use readPixelsToBuffer(framebuffer)")(),null}copyToDataUrl(){return z.error("Framebuffer.copyToDataUrl() is no logner supported, use copyToDataUrl(framebuffer)")(),null}copyToImage(){return z.error("Framebuffer.copyToImage() is no logner supported, use copyToImage(framebuffer)")(),null}copyToTexture(){return z.error("Framebuffer.copyToTexture({...}) is no logner supported, use copyToTexture(source, target, opts})")(),null}blit(){return z.error("Framebuffer.blit({...}) is no logner supported, use blit(source, target, opts)")(),null}invalidate(e){let{attachments:n=[],x:r=0,y:i=0,width:s,height:o}=e;const a=We(this.gl),l=a.bindFramebuffer(36008,this.handle);return r===0&&i===0&&s===void 0&&o===void 0?a.invalidateFramebuffer(36008,n):a.invalidateFramebuffer(36008,n,r,i,s,o),a.bindFramebuffer(36008,l),this}getAttachmentParameter(e,n,r){let i=this._getAttachmentParameterFallback(n);return i===null&&(this.gl.bindFramebuffer(36160,this.handle),i=this.gl.getFramebufferAttachmentParameter(36160,e,n),this.gl.bindFramebuffer(36160,null)),r&&i>1e3&&(i=Wn(this.gl,i)),i}getAttachmentParameters(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:36064,n=arguments.length>1?arguments[1]:void 0,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.constructor.ATTACHMENT_PARAMETERS||[];const i={};for(const s of r){const o=n?Wn(this.gl,s):s;i[o]=this.getAttachmentParameter(e,s,n)}return i}getParameters(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;const n=Object.keys(this.attachments),r={};for(const i of n){const s=Number(i),o=e?Wn(this.gl,s):s;r[o]=this.getAttachmentParameters(s,e)}return r}show(){return typeof window<"u"&&window.open(Hg(this),"luma-debug-texture"),this}log(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"";if(e>z.level||typeof window>"u")return this;n=n||"Framebuffer ".concat(this.id);const r=Hg(this,{targetMaxHeight:100});return z.image({logLevel:e,message:n,image:r},n)(),this}bind(){let{target:e=36160}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return this.gl.bindFramebuffer(e,this.handle),this}unbind(){let{target:e=36160}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return this.gl.bindFramebuffer(e,null),this}_createDefaultAttachments(e,n,r,i,s){let o=null;return e&&(o=o||{},o[36064]=new dt(this.gl,{id:"".concat(this.id,"-color0"),pixels:null,format:6408,type:5121,width:i,height:s,mipmaps:!1,parameters:{[10241]:9729,[10240]:9729,[10242]:33071,[10243]:33071}}),this.ownResources.push(o[36064])),n&&r?(o=o||{},o[33306]=new Zr(this.gl,{id:"".concat(this.id,"-depth-stencil"),format:35056,width:i,height:111}),this.ownResources.push(o[33306])):n?(o=o||{},o[36096]=new Zr(this.gl,{id:"".concat(this.id,"-depth"),format:33189,width:i,height:s}),this.ownResources.push(o[36096])):r&&F(!1),o}_unattach(e){const n=this.attachments[e];n&&(n instanceof Zr?this.gl.framebufferRenderbuffer(36160,e,36161,null):this.gl.framebufferTexture2D(36160,e,3553,null,0),delete this.attachments[e])}_attachRenderbuffer(e){let{attachment:n=36064,renderbuffer:r}=e;const{gl:i}=this;i.framebufferRenderbuffer(36160,n,36161,r.handle),this.attachments[n]=r}_attachTexture(e){let{attachment:n=36064,texture:r,layer:i,level:s}=e;const{gl:o}=this;switch(o.bindTexture(r.target,r.handle),r.target){case 35866:case 32879:We(o).framebufferTextureLayer(36160,n,r.target,s,i);break;case 34067:const l=cA(i);o.framebufferTexture2D(36160,n,l,r.handle,s);break;case 3553:o.framebufferTexture2D(36160,n,3553,r.handle,s);break;default:F(!1,"Illegal texture type")}o.bindTexture(r.target,null),this.attachments[n]=r}_setReadBuffer(e){const n=Vb(this.gl);n?n.readBuffer(e):F(e===36064||e===1029,Wg),this.readBuffer=e}_setDrawBuffers(e){const{gl:n}=this,r=We(n);if(r)r.drawBuffers(e);else{const i=n.getExtension("WEBGL_draw_buffers");i?i.drawBuffersWEBGL(e):F(e.length===1&&(e[0]===36064||e[0]===1029),Wg)}this.drawBuffers=e}_getAttachmentParameterFallback(e){const n=lA(this.gl);switch(e){case 36052:return n.WEBGL2?null:0;case 33298:case 33299:case 33300:case 33301:case 33302:case 33303:return n.WEBGL2?null:8;case 33297:return n.WEBGL2?null:5125;case 33296:return!n.WEBGL2&&!n.EXT_sRGB?9729:null;default:return null}}_createHandle(){return this.gl.createFramebuffer()}_deleteHandle(){this.gl.deleteFramebuffer(this.handle)}_bindHandle(e){return this.gl.bindFramebuffer(36160,e)}}function cA(t){return t<34069?t+34069:t}function hA(t){return(we.STATUS||{})[t]||"Framebuffer error ".concat(t)}const fA=[36049,36048,33296,33298,33299,33300,33301,33302,33303];we.ATTACHMENT_PARAMETERS=fA;function dA(t,e){F(t instanceof dt||t instanceof Yy||t instanceof QS);const n=t.constructor,{gl:r,width:i,height:s,format:o,type:a,dataFormat:l,border:u,mipmaps:c}=t,h=Object.assign({width:i,height:s,format:o,type:a,dataFormat:l,border:u,mipmaps:c},e);return new n(r,h)}function gA(t,e){const{gl:n,width:r,height:i,id:s}=t;return new we(n,Object.assign({},e,{id:"framebuffer-for-".concat(s),width:r,height:i,attachments:{[36064]:t}}))}function ea(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"unnamed";const n=/#define[\s*]SHADER_NAME[\s*]([A-Za-z0-9_-]+)[\s*]/,r=t.match(n);return r?r[1]:e}const pA=35632,mA=35633;function yA(t){switch(t){case pA:return"fragment";case mA:return"vertex";default:return"unknown type"}}function _A(t,e,n,r){const i=t.split(/\r?\n/),s={},o={},a=r||ea(e)||"(unnamed)",l="".concat(yA(n)," shader ").concat(a);for(let c=0;c<i.length;c++){const h=i[c];if(h.length<=1)continue;const f=h.split(":"),g=f[0],w=parseInt(f[2],10);if(isNaN(w))throw new Error("GLSL compilation error in ".concat(l,": ").concat(t));g!=="WARNING"?s[w]=h:o[w]=h}const u=vA(e);return{shaderName:l,errors:Xg(s,u),warnings:Xg(o,u)}}function Xg(t,e){let n="";for(let r=0;r<e.length;r++){const i=e[r];if(!(!t[r+3]&&!t[r+2]&&!t[r+1])&&(n+="".concat(i,`
`),t[r+1])){const s=t[r+1],o=s.split(":",3),a=o[0],l=parseInt(o[1],10)||0,u=s.substring(o.join(":").length+1).trim();n+=Jy("^^^ ".concat(a,": ").concat(u,`

`),l)}}return n}function vA(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:": ";const r=t.split(/\r?\n/),i=String(r.length+e-1).length;return r.map((s,o)=>{const a=String(o+e),l=a.length;return Jy(a,i-l)+n+s})}function Jy(t,e){let n="";for(let r=0;r<e;++r)n+=" ";return"".concat(n).concat(t)}function e_(t){let e=100;const n=t.match(/[^\s]+/g);if(n.length>=2&&n[0]==="#version"){const r=parseInt(n[1],10);Number.isFinite(r)&&(e=r)}return e}const wA="Shader: GLSL source code must be a JavaScript string";class ks extends Tn{get[Symbol.toStringTag](){return"Shader"}static getTypeName(e){switch(e){case 35633:return"vertex-shader";case 35632:return"fragment-shader";default:return F(!1),"unknown"}}constructor(e,n){gl(e),F(typeof n.source=="string",wA);const r=ea(n.source,null)||n.id||_n("unnamed ".concat(ks.getTypeName(n.shaderType)));super(e,{id:r}),this.shaderType=n.shaderType,this.source=n.source,this.initialize(n)}initialize(e){let{source:n}=e;const r=ea(n,null);r&&(this.id=_n(r)),this._compile(n)}getParameter(e){return this.gl.getShaderParameter(this.handle,e)}toString(){return"".concat(ks.getTypeName(this.shaderType),":").concat(this.id)}getName(){return ea(this.source)||"unnamed-shader"}getSource(){return this.gl.getShaderSource(this.handle)}getTranslatedSource(){const e=this.gl.getExtension("WEBGL_debug_shaders");return e?e.getTranslatedShaderSource(this.handle):"No translated source available. WEBGL_debug_shaders not implemented"}_compile(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.source;if(e.startsWith("#version ")||(e=`#version 100
`.concat(e)),this.source=e,this.gl.shaderSource(this.handle,this.source),this.gl.compileShader(this.handle),!this.getParameter(35713)){const r=this.gl.getShaderInfoLog(this.handle),{shaderName:i,errors:s,warnings:o}=_A(r,this.source,this.shaderType,this.id);throw z.error("GLSL compilation errors in ".concat(i,`
`).concat(s))(),z.warn("GLSL compilation warnings in ".concat(i,`
`).concat(o))(),new Error("GLSL compilation errors in ".concat(i))}}_deleteHandle(){this.gl.deleteShader(this.handle)}_getOptsFromHandle(){return{type:this.getParameter(35663),source:this.getSource()}}}class yu extends ks{get[Symbol.toStringTag](){return"VertexShader"}constructor(e,n){typeof n=="string"&&(n={source:n}),super(e,Object.assign({},n,{shaderType:35633}))}_createHandle(){return this.gl.createShader(35633)}}class _u extends ks{get[Symbol.toStringTag](){return"FragmentShader"}constructor(e,n){typeof n=="string"&&(n={source:n}),super(e,Object.assign({},n,{shaderType:35632}))}_createHandle(){return this.gl.createShader(35632)}}const EA={[5126]:se.bind(null,"uniform1fv",rt,1,Fe),[35664]:se.bind(null,"uniform2fv",rt,2,Fe),[35665]:se.bind(null,"uniform3fv",rt,3,Fe),[35666]:se.bind(null,"uniform4fv",rt,4,Fe),[5124]:se.bind(null,"uniform1iv",xn,1,Fe),[35667]:se.bind(null,"uniform2iv",xn,2,Fe),[35668]:se.bind(null,"uniform3iv",xn,3,Fe),[35669]:se.bind(null,"uniform4iv",xn,4,Fe),[35670]:se.bind(null,"uniform1iv",xn,1,Fe),[35671]:se.bind(null,"uniform2iv",xn,2,Fe),[35672]:se.bind(null,"uniform3iv",xn,3,Fe),[35673]:se.bind(null,"uniform4iv",xn,4,Fe),[35674]:se.bind(null,"uniformMatrix2fv",rt,4,sn),[35675]:se.bind(null,"uniformMatrix3fv",rt,9,sn),[35676]:se.bind(null,"uniformMatrix4fv",rt,16,sn),[35678]:Ce,[35680]:Ce,[5125]:se.bind(null,"uniform1uiv",Lo,1,Fe),[36294]:se.bind(null,"uniform2uiv",Lo,2,Fe),[36295]:se.bind(null,"uniform3uiv",Lo,3,Fe),[36296]:se.bind(null,"uniform4uiv",Lo,4,Fe),[35685]:se.bind(null,"uniformMatrix2x3fv",rt,6,sn),[35686]:se.bind(null,"uniformMatrix2x4fv",rt,8,sn),[35687]:se.bind(null,"uniformMatrix3x2fv",rt,6,sn),[35688]:se.bind(null,"uniformMatrix3x4fv",rt,12,sn),[35689]:se.bind(null,"uniformMatrix4x2fv",rt,8,sn),[35690]:se.bind(null,"uniformMatrix4x3fv",rt,12,sn),[35678]:Ce,[35680]:Ce,[35679]:Ce,[35682]:Ce,[36289]:Ce,[36292]:Ce,[36293]:Ce,[36298]:Ce,[36299]:Ce,[36300]:Ce,[36303]:Ce,[36306]:Ce,[36307]:Ce,[36308]:Ce,[36311]:Ce},TA={},bA={},SA={},Yg=[0];function ff(t,e,n,r){e===1&&typeof t=="boolean"&&(t=t?1:0),Number.isFinite(t)&&(Yg[0]=t,t=Yg);const i=t.length;if(i%e&&z.warn("Uniform size should be multiples of ".concat(e),t)(),t instanceof n)return t;let s=r[i];s||(s=new n(i),r[i]=s);for(let o=0;o<i;o++)s[o]=t[o];return s}function rt(t,e){return ff(t,e,Float32Array,TA)}function xn(t,e){return ff(t,e,Int32Array,bA)}function Lo(t,e){return ff(t,e,Uint32Array,SA)}function $g(t,e,n){const r=EA[n.type];if(!r)throw new Error("Unknown GLSL uniform type ".concat(n.type));return r().bind(null,t,e)}function AA(t){if(t[t.length-1]!=="]")return{name:t,length:1,isArray:!1};const e=/([^[]*)(\[[0-9]+\])?/,n=t.match(e);if(!n||n.length<2)throw new Error("Failed to parse GLSL uniform name ".concat(t));return{name:n[1],length:n[2]||1,isArray:Boolean(n[2])}}function xA(t,e,n){for(const r in t){const i=t[r];if((!n||Boolean(n[r]))&&!PA(i))throw e=e?"".concat(e," "):"",console.error("".concat(e," Bad uniform ").concat(r),i),new Error("".concat(e," Bad uniform ").concat(r))}return!0}function PA(t){return Array.isArray(t)||ArrayBuffer.isView(t)?LA(t):isFinite(t)||t===!0||t===!1||t instanceof gi||t instanceof Zr?!0:t instanceof we?Boolean(t.texture):!1}function CA(t,e,n){if(Array.isArray(n)||ArrayBuffer.isView(n))if(t[e]){const r=t[e];for(let i=0,s=n.length;i<s;++i)r[i]=n[i]}else t[e]=n.slice();else t[e]=n}function LA(t){if(t.length===0)return!1;const e=Math.min(t.length,16);for(let n=0;n<e;++n)if(!Number.isFinite(t[n]))return!1;return!0}function Ce(){let t=null;return(e,n,r)=>{const i=t!==r;return i&&(e.uniform1i(n,r),t=r),i}}function se(t,e,n,r){let i=null,s=null;return(o,a,l)=>{const u=e(l,n),c=u.length;let h=!1;if(i===null)i=new Float32Array(c),s=c,h=!0;else{F(s===c,"Uniform length cannot change.");for(let f=0;f<c;++f)if(u[f]!==i[f]){h=!0;break}}return h&&(r(o,t,a,u),i.set(u)),h}}function Fe(t,e,n,r){t[e](n,r)}function sn(t,e,n,r){t[e](n,!1,r)}const RA=5120,MA=5121,kA=5122,IA=5123,qg=0,Ro=1,OA=2,NA=3,Mo=4,DA=5,FA=6,Ee=5126,UA=35664,BA=35665,VA=35666,Hi=5124,zA=35667,jA=35668,GA=35669,Wi=5125,HA=36294,WA=36295,XA=36296,YA=35670,$A=35671,qA=35672,ZA=35673,QA=35674,KA=35675,JA=35676,ex=35685,tx=35686,nx=35687,rx=35688,ix=35689,sx=35690,zc={[Ee]:[Ee,1,"float"],[UA]:[Ee,2,"vec2"],[BA]:[Ee,3,"vec3"],[VA]:[Ee,4,"vec4"],[Hi]:[Hi,1,"int"],[zA]:[Hi,2,"ivec2"],[jA]:[Hi,3,"ivec3"],[GA]:[Hi,4,"ivec4"],[Wi]:[Wi,1,"uint"],[HA]:[Wi,2,"uvec2"],[WA]:[Wi,3,"uvec3"],[XA]:[Wi,4,"uvec4"],[YA]:[Ee,1,"bool"],[$A]:[Ee,2,"bvec2"],[qA]:[Ee,3,"bvec3"],[ZA]:[Ee,4,"bvec4"],[QA]:[Ee,8,"mat2"],[ex]:[Ee,8,"mat2x3"],[tx]:[Ee,8,"mat2x4"],[KA]:[Ee,12,"mat3"],[nx]:[Ee,12,"mat3x2"],[rx]:[Ee,12,"mat3x4"],[JA]:[Ee,16,"mat4"],[ix]:[Ee,16,"mat4x2"],[sx]:[Ee,16,"mat4x3"]};function ox(t){switch(t){case qg:return qg;case Ro:return Ro;case NA:return Ro;case OA:return Ro;case Mo:return Mo;case DA:return Mo;case FA:return Mo;default:return F(!1),0}}function Zg(t){const e=zc[t];if(!e)return null;const[n,r]=e;return{type:n,components:r}}function t_(t,e){switch(t){case RA:case MA:case kA:case IA:t=Ee;break}for(const n in zc){const[r,i,s]=zc[n];if(r===t&&i===e)return{glType:n,name:s}}return null}class ax{constructor(e){this.id=e.id,this.attributeInfos=[],this.attributeInfosByName={},this.attributeInfosByLocation=[],this.varyingInfos=[],this.varyingInfosByName={},Object.seal(this),this._readAttributesFromProgram(e),this._readVaryingsFromProgram(e)}getAttributeInfo(e){const n=Number(e);return Number.isFinite(n)?this.attributeInfosByLocation[n]:this.attributeInfosByName[e]||null}getAttributeLocation(e){const n=this.getAttributeInfo(e);return n?n.location:-1}getAttributeAccessor(e){const n=this.getAttributeInfo(e);return n?n.accessor:null}getVaryingInfo(e){const n=Number(e);return Number.isFinite(n)?this.varyingInfos[n]:this.varyingInfosByName[e]||null}getVaryingIndex(e){const n=this.getVaryingInfo();return n?n.location:-1}getVaryingAccessor(e){const n=this.getVaryingInfo();return n?n.accessor:null}_readAttributesFromProgram(e){const{gl:n}=e,r=n.getProgramParameter(e.handle,35721);for(let i=0;i<r;i++){const{name:s,type:o,size:a}=n.getActiveAttrib(e.handle,i),l=n.getAttribLocation(e.handle,s);l>=0&&this._addAttribute(l,s,o,a)}this.attributeInfos.sort((i,s)=>i.location-s.location)}_readVaryingsFromProgram(e){const{gl:n}=e;if(!Y(n))return;const r=n.getProgramParameter(e.handle,35971);for(let i=0;i<r;i++){const{name:s,type:o,size:a}=n.getTransformFeedbackVarying(e.handle,i);this._addVarying(i,s,o,a)}this.varyingInfos.sort((i,s)=>i.location-s.location)}_addAttribute(e,n,r,i){const{type:s,components:o}=Zg(r),a={type:s,size:i*o};this._inferProperties(e,n,a);const l={location:e,name:n,accessor:new at(a)};this.attributeInfos.push(l),this.attributeInfosByLocation[e]=l,this.attributeInfosByName[l.name]=l}_inferProperties(e,n,r){/instance/i.test(n)&&(r.divisor=1)}_addVarying(e,n,r,i){const{type:s,components:o}=Zg(r),a=new at({type:s,size:i*o}),l={location:e,name:n,accessor:a};this.varyingInfos.push(l),this.varyingInfosByName[l.name]=l}}const Qg=4,lx=35981,ux=["setVertexArray","setAttributes","setBuffers","unsetBuffers","use","getUniformCount","getUniformInfo","getUniformLocation","getUniformValue","getVarying","getFragDataLocation","getAttachedShaders","getAttributeCount","getAttributeLocation","getAttributeInfo"];class n_ extends Tn{get[Symbol.toStringTag](){return"Program"}constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};super(e,n),this.stubRemovedMethods("Program","v6.0",ux),this._isCached=!1,this.initialize(n),Object.seal(this),this._setId(n.id)}initialize(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{hash:n,vs:r,fs:i,varyings:s,bufferMode:o=lx}=e;return this.hash=n||"",this.vs=typeof r=="string"?new yu(this.gl,{id:"".concat(e.id,"-vs"),source:r}):r,this.fs=typeof i=="string"?new _u(this.gl,{id:"".concat(e.id,"-fs"),source:i}):i,F(this.vs instanceof yu),F(this.fs instanceof _u),this.uniforms={},this._textureUniforms={},s&&s.length>0&&(We(this.gl),this.varyings=s,this.gl2.transformFeedbackVaryings(this.handle,s,o)),this._compileAndLink(),this._readUniformLocationsFromLinkedProgram(),this.configuration=new ax(this),this.setProps(e)}delete(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return this._isCached?this:super.delete(e)}setProps(e){return"uniforms"in e&&this.setUniforms(e.uniforms),this}draw(e){let{logPriority:n,drawMode:r=4,vertexCount:i,offset:s=0,start:o,end:a,isIndexed:l=!1,indexType:u=5123,instanceCount:c=0,isInstanced:h=c>0,vertexArray:f=null,transformFeedback:g,framebuffer:w,parameters:E={},uniforms:T,samplers:y}=e;if((T||y)&&(z.deprecated("Program.draw({uniforms})","Program.setUniforms(uniforms)")(),this.setUniforms(T||{})),z.priority>=n){const m=w?w.id:"default",_="mode=".concat(Wn(this.gl,r)," verts=").concat(i," ")+"instances=".concat(c," indexType=").concat(Wn(this.gl,u)," ")+"isInstanced=".concat(h," isIndexed=").concat(l," ")+"Framebuffer=".concat(m);z.log(n,_)()}return F(f),this.gl.useProgram(this.handle),!this._areTexturesRenderable()||i===0||h&&c===0?!1:(f.bindForDraw(i,c,()=>{if(w!==void 0&&(E=Object.assign({},E,{framebuffer:w})),g){const m=ox(r);g.begin(m)}this._bindTextures(),St(this.gl,E,()=>{l&&h?this.gl2.drawElementsInstanced(r,i,u,s,c):l&&Y(this.gl)&&!isNaN(o)&&!isNaN(a)?this.gl2.drawRangeElements(r,o,a,i,u,s):l?this.gl.drawElements(r,i,u,s):h?this.gl2.drawArraysInstanced(r,s,i,c):this.gl.drawArrays(r,s,i)}),g&&g.end()}),!0)}setUniforms(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};z.priority>=2&&xA(e,this.id,this._uniformSetters),this.gl.useProgram(this.handle);for(const n in e){const r=e[n],i=this._uniformSetters[n];if(i){let s=r,o=!1;if(s instanceof we&&(s=s.texture),s instanceof gi)if(o=this.uniforms[n]!==r,o){i.textureIndex===void 0&&(i.textureIndex=this._textureIndexCounter++);const a=s,{textureIndex:l}=i;a.bind(l),s=l,this._textureUniforms[n]=a}else s=i.textureIndex;else this._textureUniforms[n]&&delete this._textureUniforms[n];(i(s)||o)&&CA(this.uniforms,n,r)}}return this}_areTexturesRenderable(){let e=!0;for(const n in this._textureUniforms){const r=this._textureUniforms[n];r.update(),e=e&&r.loaded}return e}_bindTextures(){for(const e in this._textureUniforms){const n=this._uniformSetters[e].textureIndex;this._textureUniforms[e].bind(n)}}_createHandle(){return this.gl.createProgram()}_deleteHandle(){this.gl.deleteProgram(this.handle)}_getOptionsFromHandle(e){const n=this.gl.getAttachedShaders(e),r={};for(const i of n)switch(this.gl.getShaderParameter(this.handle,35663)){case 35633:r.vs=new yu({handle:i});break;case 35632:r.fs=new _u({handle:i});break}return r}_getParameter(e){return this.gl.getProgramParameter(this.handle,e)}_setId(e){if(!e){const n=this._getName();this.id=_n(n)}}_getName(){let e=this.vs.getName()||this.fs.getName();return e=e.replace(/shader/i,""),e=e?"".concat(e,"-program"):"program",e}_compileAndLink(){const{gl:e}=this;if(e.attachShader(this.handle,this.vs.handle),e.attachShader(this.handle,this.fs.handle),z.time(Qg,"linkProgram for ".concat(this._getName()))(),e.linkProgram(this.handle),z.timeEnd(Qg,"linkProgram for ".concat(this._getName()))(),e.debug||z.level>0){if(!e.getProgramParameter(this.handle,35714))throw new Error("Error linking: ".concat(e.getProgramInfoLog(this.handle)));if(e.validateProgram(this.handle),!e.getProgramParameter(this.handle,35715))throw new Error("Error validating: ".concat(e.getProgramInfoLog(this.handle)))}}_readUniformLocationsFromLinkedProgram(){const{gl:e}=this;this._uniformSetters={},this._uniformCount=this._getParameter(35718);for(let n=0;n<this._uniformCount;n++){const r=this.gl.getActiveUniform(this.handle,n),{name:i}=AA(r.name);let s=e.getUniformLocation(this.handle,i);if(this._uniformSetters[i]=$g(e,s,r),r.size>1)for(let o=0;o<r.size;o++)s=e.getUniformLocation(this.handle,"".concat(i,"[").concat(o,"]")),this._uniformSetters["".concat(i,"[").concat(o,"]")]=$g(e,s,r)}this._textureIndexCounter=0}getActiveUniforms(e,n){return this.gl2.getActiveUniforms(this.handle,e,n)}getUniformBlockIndex(e){return this.gl2.getUniformBlockIndex(this.handle,e)}getActiveUniformBlockParameter(e,n){return this.gl2.getActiveUniformBlockParameter(this.handle,e,n)}uniformBlockBinding(e,n){this.gl2.uniformBlockBinding(this.handle,e,n)}}const cx=34918,hx=34919,fx=35007,dx=36795,gx=35976,px=35887,mx=36202;class Oa extends Tn{get[Symbol.toStringTag](){return"Query"}static isSupported(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];const r=Y(e),i=Qy(e,ae.TIMER_QUERY);let s=r||i;for(const o of n)switch(o){case"queries":s=s&&r;break;case"timers":s=s&&i;break;default:F(!1)}return s}constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};super(e,n),this.target=null,this._queryPending=!1,this._pollingPromise=null,Object.seal(this)}beginTimeElapsedQuery(){return this.begin(fx)}beginOcclusionQuery(){let{conservative:e=!1}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return this.begin(e?mx:px)}beginTransformFeedbackQuery(){return this.begin(gx)}begin(e){return this._queryPending?this:(this.target=e,this.gl2.beginQuery(this.target,this.handle),this)}end(){return this._queryPending?this:(this.target&&(this.gl2.endQuery(this.target),this.target=null,this._queryPending=!0),this)}isResultAvailable(){if(!this._queryPending)return!1;const e=this.gl2.getQueryParameter(this.handle,hx);return e&&(this._queryPending=!1),e}isTimerDisjoint(){return this.gl2.getParameter(dx)}getResult(){return this.gl2.getQueryParameter(this.handle,cx)}getTimerMilliseconds(){return this.getResult()/1e6}createPoll(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:Number.POSITIVE_INFINITY;if(this._pollingPromise)return this._pollingPromise;let n=0;return this._pollingPromise=new Promise((r,i)=>{const s=()=>{this.isResultAvailable()?(r(this.getResult()),this._pollingPromise=null):n++>e?(i("Timed out"),this._pollingPromise=null):requestAnimationFrame(s)};requestAnimationFrame(s)}),this._pollingPromise}_createHandle(){return Oa.isSupported(this.gl)?this.gl2.createQuery():null}_deleteHandle(){this.gl2.deleteQuery(this.handle)}}class r_ extends Tn{get[Symbol.toStringTag](){return"TransformFeedback"}static isSupported(e){return Y(e)}constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};We(e),super(e,n),this.initialize(n),this.stubRemovedMethods("TransformFeedback","v6.0",["pause","resume"]),Object.seal(this)}initialize(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return this.buffers={},this.unused={},this.configuration=null,this.bindOnUse=!0,di(this.buffers)||this.bind(()=>this._unbindBuffers()),this.setProps(e),this}setProps(e){"program"in e&&(this.configuration=e.program&&e.program.configuration),"configuration"in e&&(this.configuration=e.configuration),"bindOnUse"in e&&(e=e.bindOnUse),"buffers"in e&&this.setBuffers(e.buffers)}setBuffers(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return this.bind(()=>{for(const n in e)this.setBuffer(n,e[n])}),this}setBuffer(e,n){const r=this._getVaryingIndex(e),{buffer:i,byteSize:s,byteOffset:o}=this._getBufferParams(n);return r<0?(this.unused[e]=i,z.warn("".concat(this.id," unused varying buffer ").concat(e))(),this):(this.buffers[r]=n,this.bindOnUse||this._bindBuffer(r,i,o,s),this)}begin(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;return this.gl.bindTransformFeedback(36386,this.handle),this._bindBuffers(),this.gl.beginTransformFeedback(e),this}end(){return this.gl.endTransformFeedback(),this._unbindBuffers(),this.gl.bindTransformFeedback(36386,null),this}_getBufferParams(e){let n,r,i;return e instanceof te?i=e:(i=e.buffer,r=e.byteSize,n=e.byteOffset),(n!==void 0||r!==void 0)&&(n=n||0,r=r||i.byteLength-n),{buffer:i,byteOffset:n,byteSize:r}}_getVaryingInfo(e){return this.configuration&&this.configuration.getVaryingInfo(e)}_getVaryingIndex(e){if(this.configuration)return this.configuration.getVaryingInfo(e).location;const n=Number(e);return Number.isFinite(n)?n:-1}_bindBuffers(){if(this.bindOnUse)for(const e in this.buffers){const{buffer:n,byteSize:r,byteOffset:i}=this._getBufferParams(this.buffers[e]);this._bindBuffer(e,n,i,r)}}_unbindBuffers(){if(this.bindOnUse)for(const e in this.buffers)this._bindBuffer(e,null)}_bindBuffer(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,i=arguments.length>3?arguments[3]:void 0;const s=n&&n.handle;return!s||i===void 0?this.gl.bindBufferBase(35982,e,s):this.gl.bindBufferRange(35982,e,s,r,i),this}_createHandle(){return this.gl.createTransformFeedback()}_deleteHandle(){this.gl.deleteTransformFeedback(this.handle)}_bindHandle(e){this.gl.bindTransformFeedback(36386,this.handle)}}let ko=null;function yx(t){return(!ko||ko.byteLength<t)&&(ko=new ArrayBuffer(t)),ko}function _x(t,e){const n=yx(t.BYTES_PER_ELEMENT*e);return new t(n,0,e)}function vx(t){let{target:e,source:n,start:r=0,count:i=1}=t;const s=n.length,o=i*s;let a=0;for(let l=r;a<s;a++)e[l++]=n[a];for(;a<o;)a<o-a?(e.copyWithin(r+a,r,r+a),a*=2):(e.copyWithin(r+a,r,r+o-a),a=o);return e}const wx="elements must be GL.ELEMENT_ARRAY_BUFFER";class it extends Tn{get[Symbol.toStringTag](){return"VertexArrayObject"}static isSupported(e){return(arguments.length>1&&arguments[1]!==void 0?arguments[1]:{}).constantAttributeZero?Y(e)||by()==="Chrome":!0}static getDefaultArray(e){return e.luma=e.luma||{},e.luma.defaultVertexArray||(e.luma.defaultVertexArray=new it(e,{handle:null,isDefaultArray:!0})),e.luma.defaultVertexArray}static getMaxAttributes(e){return it.MAX_ATTRIBUTES=it.MAX_ATTRIBUTES||e.getParameter(34921),it.MAX_ATTRIBUTES}static setConstant(e,n,r){switch(r.constructor){case Float32Array:it._setConstantFloatArray(e,n,r);break;case Int32Array:it._setConstantIntArray(e,n,r);break;case Uint32Array:it._setConstantUintArray(e,n,r);break;default:F(!1)}}constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const r=n.id||n.program&&n.program.id;super(e,Object.assign({},n,{id:r})),this.buffer=null,this.bufferValue=null,this.isDefaultArray=n.isDefaultArray||!1,this.gl2=e,this.initialize(n),Object.seal(this)}delete(){return super.delete(),this.buffer&&this.buffer.delete(),this}get MAX_ATTRIBUTES(){return it.getMaxAttributes(this.gl)}initialize(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return this.setProps(e)}setProps(e){return this}setElementBuffer(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;return F(!e||e.target===34963,wx),this.bind(()=>{this.gl.bindBuffer(34963,e?e.handle:null)}),this}setBuffer(e,n,r){if(n.target===34963)return this.setElementBuffer(n,r);const{size:i,type:s,stride:o,offset:a,normalized:l,integer:u,divisor:c}=r,{gl:h,gl2:f}=this;return e=Number(e),this.bind(()=>{h.bindBuffer(34962,n.handle),u?(F(Y(h)),f.vertexAttribIPointer(e,i,s,o,a)):h.vertexAttribPointer(e,i,s,l,o,a),h.enableVertexAttribArray(e),f.vertexAttribDivisor(e,c||0)}),this}enable(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;return!n&&e===0&&!it.isSupported(this.gl,{constantAttributeZero:!0})||(e=Number(e),this.bind(()=>n?this.gl.enableVertexAttribArray(e):this.gl.disableVertexAttribArray(e))),this}getConstantBuffer(e,n){const r=this._normalizeConstantArrayValue(n),i=r.byteLength*e,s=r.length*e;let o=!this.buffer;if(this.buffer=this.buffer||new te(this.gl,i),o=o||this.buffer.reallocate(i),o=o||!this._compareConstantArrayValues(r,this.bufferValue),o){const a=_x(n.constructor,s);vx({target:a,source:r,start:0,count:s}),this.buffer.subData(a),this.bufferValue=n}return this.buffer}_normalizeConstantArrayValue(e){return Array.isArray(e)?new Float32Array(e):e}_compareConstantArrayValues(e,n){if(!e||!n||e.length!==n.length||e.constructor!==n.constructor)return!1;for(let r=0;r<e.length;++r)if(e[r]!==n[r])return!1;return!0}static _setConstantFloatArray(e,n,r){switch(r.length){case 1:e.vertexAttrib1fv(n,r);break;case 2:e.vertexAttrib2fv(n,r);break;case 3:e.vertexAttrib3fv(n,r);break;case 4:e.vertexAttrib4fv(n,r);break;default:F(!1)}}static _setConstantIntArray(e,n,r){switch(F(Y(e)),r.length){case 1:e.vertexAttribI1iv(n,r);break;case 2:e.vertexAttribI2iv(n,r);break;case 3:e.vertexAttribI3iv(n,r);break;case 4:e.vertexAttribI4iv(n,r);break;default:F(!1)}}static _setConstantUintArray(e,n,r){switch(F(Y(e)),r.length){case 1:e.vertexAttribI1uiv(n,r);break;case 2:e.vertexAttribI2uiv(n,r);break;case 3:e.vertexAttribI3uiv(n,r);break;case 4:e.vertexAttribI4uiv(n,r);break;default:F(!1)}}_createHandle(){return this.gl.createVertexArray()}_deleteHandle(e){return this.gl2.deleteVertexArray(e),[this.elements]}_bindHandle(e){this.gl2.bindVertexArray(e)}_getParameter(e,n){let{location:r}=n;return F(Number.isFinite(r)),this.bind(()=>{switch(e){case 34373:return this.gl.getVertexAttribOffset(r,e);default:return this.gl.getVertexAttrib(r,e)}})}}const Ex="VertexArray: attributes must be Buffers or constants (i.e. typed array)",Tx=/^(.+)__LOCATION_([0-9]+)$/,bx=["setBuffers","setGeneric","clearBindings","setLocations","setGenericValues","setDivisor","enable","disable"];class Sx{constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const r=n.id||n.program&&n.program.id;this.id=r,this.gl=e,this.configuration=null,this.elements=null,this.elementsAccessor=null,this.values=null,this.accessors=null,this.unused=null,this.drawParams=null,this.buffer=null,this.attributes={},this.vertexArrayObject=new it(e),Gy(this,"VertexArray","v6.0",bx),this.initialize(n),Object.seal(this)}delete(){this.buffer&&this.buffer.delete(),this.vertexArrayObject.delete()}initialize(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return this.reset(),this.configuration=null,this.bindOnUse=!1,this.setProps(e)}reset(){this.elements=null,this.elementsAccessor=null;const{MAX_ATTRIBUTES:e}=this.vertexArrayObject;return this.values=new Array(e).fill(null),this.accessors=new Array(e).fill(null),this.unused={},this.drawParams=null,this}setProps(e){return"program"in e&&(this.configuration=e.program&&e.program.configuration),"configuration"in e&&(this.configuration=e.configuration),"attributes"in e&&this.setAttributes(e.attributes),"elements"in e&&this.setElementBuffer(e.elements),"bindOnUse"in e&&(e=e.bindOnUse),this}clearDrawParams(){this.drawParams=null}getDrawParams(){return this.drawParams=this.drawParams||this._updateDrawParams(),this.drawParams}setAttributes(e){return Object.assign(this.attributes,e),this.vertexArrayObject.bind(()=>{for(const n in e){const r=e[n];this._setAttribute(n,r)}this.gl.bindBuffer(34962,null)}),this}setElementBuffer(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null,n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return this.elements=e,this.elementsAccessor=n,this.clearDrawParams(),this.vertexArrayObject.setElementBuffer(e,n),this}setBuffer(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};if(n.target===34963)return this.setElementBuffer(n,r);const{location:i,accessor:s}=this._resolveLocationAndAccessor(e,n,n.accessor,r);return i>=0&&(this.values[i]=n,this.accessors[i]=s,this.clearDrawParams(),this.vertexArrayObject.setBuffer(i,n,s)),this}setConstant(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};const{location:i,accessor:s}=this._resolveLocationAndAccessor(e,n,Object.assign({size:n.length},r));return i>=0&&(n=this.vertexArrayObject._normalizeConstantArrayValue(n),this.values[i]=n,this.accessors[i]=s,this.clearDrawParams(),this.vertexArrayObject.enable(i,!1)),this}unbindBuffers(){return this.vertexArrayObject.bind(()=>{this.elements&&this.vertexArrayObject.setElementBuffer(null),this.buffer=this.buffer||new te(this.gl,{accessor:{size:4}});for(let e=0;e<this.vertexArrayObject.MAX_ATTRIBUTES;e++)this.values[e]instanceof te&&(this.gl.disableVertexAttribArray(e),this.gl.bindBuffer(34962,this.buffer.handle),this.gl.vertexAttribPointer(e,1,5126,!1,0,0))}),this}bindBuffers(){return this.vertexArrayObject.bind(()=>{this.elements&&this.setElementBuffer(this.elements);for(let e=0;e<this.vertexArrayObject.MAX_ATTRIBUTES;e++){const n=this.values[e];n instanceof te&&this.setBuffer(e,n)}}),this}bindForDraw(e,n,r){let i;return this.vertexArrayObject.bind(()=>{this._setConstantAttributes(e,n),i=r()}),i}_resolveLocationAndAccessor(e,n,r,i){const s={location:-1,accessor:null},{location:o,name:a}=this._getAttributeIndex(e);if(!Number.isFinite(o)||o<0)return this.unused[e]=n,z.once(3,()=>"unused value ".concat(e," in ").concat(this.id))(),s;const l=this._getAttributeInfo(a||o);if(!l)return s;const u=this.accessors[o]||{},c=at.resolve(l.accessor,u,r,i),{size:h,type:f}=c;return F(Number.isFinite(h)&&Number.isFinite(f)),{location:o,accessor:c}}_getAttributeInfo(e){return this.configuration&&this.configuration.getAttributeInfo(e)}_getAttributeIndex(e){const n=Number(e);if(Number.isFinite(n))return{location:n};const r=Tx.exec(e),i=r?r[1]:e,s=r?Number(r[2]):0;return this.configuration?{location:this.configuration.getAttributeLocation(i)+s,name:i}:{location:-1}}_setAttribute(e,n){if(n instanceof te)this.setBuffer(e,n);else if(Array.isArray(n)&&n.length&&n[0]instanceof te){const r=n[0],i=n[1];this.setBuffer(e,r,i)}else if(ArrayBuffer.isView(n)||Array.isArray(n)){const r=n;this.setConstant(e,r)}else if(n.buffer instanceof te){const r=n;this.setBuffer(e,r.buffer,r)}else throw new Error(Ex)}_setConstantAttributes(e,n){const r=Math.max(e|0,n|0);let i=this.values[0];ArrayBuffer.isView(i)&&this._setConstantAttributeZero(i,r);for(let s=1;s<this.vertexArrayObject.MAX_ATTRIBUTES;s++)i=this.values[s],ArrayBuffer.isView(i)&&this._setConstantAttribute(s,i)}_setConstantAttributeZero(e,n){if(it.isSupported(this.gl,{constantAttributeZero:!0})){this._setConstantAttribute(0,e);return}const r=this.vertexArrayObject.getConstantBuffer(n,e);this.vertexArrayObject.setBuffer(0,r,this.accessors[0])}_setConstantAttribute(e,n){it.setConstant(this.gl,e,n)}_updateDrawParams(){const e={isIndexed:!1,isInstanced:!1,indexCount:1/0,vertexCount:1/0,instanceCount:1/0};for(let n=0;n<this.vertexArrayObject.MAX_ATTRIBUTES;n++)this._updateDrawParamsForLocation(e,n);return this.elements&&(e.elementCount=this.elements.getElementCount(this.elements.accessor),e.isIndexed=!0,e.indexType=this.elementsAccessor.type||this.elements.accessor.type,e.indexOffset=this.elementsAccessor.offset||0),e.indexCount===1/0&&(e.indexCount=0),e.vertexCount===1/0&&(e.vertexCount=0),e.instanceCount===1/0&&(e.instanceCount=0),e}_updateDrawParamsForLocation(e,n){const r=this.values[n],i=this.accessors[n];if(!r)return;const{divisor:s}=i,o=s>0;if(e.isInstanced=e.isInstanced||o,r instanceof te){const a=r;if(o){const l=a.getVertexCount(i);e.instanceCount=Math.min(e.instanceCount,l)}else{const l=a.getVertexCount(i);e.vertexCount=Math.min(e.vertexCount,l)}}}setElements(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null,n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return z.deprecated("setElements","setElementBuffer")(),this.setElementBuffer(e,n)}}function Ax(t,e){const{maxElts:n=16,size:r=1}=e;let i="[";for(let o=0;o<t.length&&o<n;++o)o>0&&(i+=",".concat(o%r===0?" ":"")),i+=Is(t[o],e);const s=t.length>n?"...":"]";return"".concat(i).concat(s)}function Is(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const n=1e-16,{isInteger:r=!1}=e;if(Array.isArray(t)||ArrayBuffer.isView(t))return Ax(t,e);if(!Number.isFinite(t))return String(t);if(Math.abs(t)<n)return r?"0":"0.";if(r||Math.abs(t)>100&&Math.abs(t)<1e4)return t.toFixed(0);const i=t.toPrecision(2);return i.indexOf(".0")===i.length-2?i.slice(0,-1):i}function Kg(t){let{header:e="Uniforms",program:n,uniforms:r,undefinedOnly:i=!1}=t;F(n);const s=".*_.*",o=".*Matrix",a=n._uniformSetters,l={},u=Object.keys(a).sort();let c=0;for(const g of u)!g.match(s)&&!g.match(o)&&vu({table:l,header:e,uniforms:r,uniformName:g,undefinedOnly:i})&&c++;for(const g of u)g.match(o)&&vu({table:l,header:e,uniforms:r,uniformName:g,undefinedOnly:i})&&c++;for(const g of u)l[g]||vu({table:l,header:e,uniforms:r,uniformName:g,undefinedOnly:i})&&c++;let h=0;const f={};if(!i)for(const g in r){const w=r[g];l[g]||(h++,f[g]={Type:"NOT USED: ".concat(w),[e]:Is(w)})}return{table:l,count:c,unusedTable:f,unusedCount:h}}function vu(t){let{table:e,header:n,uniforms:r,uniformName:i,undefinedOnly:s}=t;const o=r[i],a=xx(o);return!s||!a?(e[i]={[n]:a?Is(o):"N/A","Uniform Type":a?o:"NOT PROVIDED"},!0):!1}function xx(t){return t!=null}function Px(t){let{vertexArray:e,header:n="Attributes"}=t;if(!e.configuration)return{};const r={};e.elements&&(r.ELEMENT_ARRAY_BUFFER=Jg(e,e.elements,null,n));const i=e.values;for(const s in i){const o=e._getAttributeInfo(s);if(o){let a="".concat(s,": ").concat(o.name);const l=e.accessors[o.location];l&&(a="".concat(s,": ").concat(Cx(o.name,l))),r[a]=Jg(e,i[s],l,n)}}return r}function Jg(t,e,n,r){const{gl:i}=t;if(!e)return{[r]:"null","Format ":"N/A"};let s="NOT PROVIDED",o=1,a=0,l=0,u,c,h;if(n&&(s=n.type,o=n.size,s=String(s).replace("Array",""),u=s.indexOf("nt")!==-1),e instanceof te){const f=e,{data:g,changed:w}=f.getDebugData();c=w?"*":"",h=g,l=f.byteLength,a=l/g.BYTES_PER_ELEMENT/o;let E;if(n){const T=n.divisor>0;E="".concat(T?"I ":"P "," ").concat(a," (x").concat(o,"=").concat(l," bytes ").concat(Wn(i,s),")")}else u=!0,E="".concat(l," bytes");return{[r]:"".concat(c).concat(Is(h,{size:o,isInteger:u})),"Format ":E}}return h=e,o=e.length,s=String(e.constructor.name).replace("Array",""),u=s.indexOf("nt")!==-1,{[r]:"".concat(Is(h,{size:o,isInteger:u})," (constant)"),"Format ":"".concat(o,"x").concat(s," (constant)")}}function Cx(t,e){const{type:n,size:r}=e,i=t_(n,r);return i?"".concat(t," (").concat(i.name,")"):t}function Lx(t){const e={},n="Accessors for ".concat(t.id);for(const r of t.attributeInfos)if(r){const i=ep(r);e["in ".concat(i)]={[n]:JSON.stringify(r.accessor)}}for(const r of t.varyingInfos)if(r){const i=ep(r);e["out ".concat(i)]={[n]:JSON.stringify(r.accessor)}}return e}function ep(t){const{type:e,size:n}=t.accessor,r=t_(e,n);return r?"".concat(r.name," ").concat(t.name):t.name}const tp=En()&&typeof document<"u";let Rx=0;class Mx{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{onCreateContext:n=T=>jy(T),onAddHTML:r=null,onInitialize:i=()=>{},onRender:s=()=>{},onFinalize:o=()=>{},onError:a,gl:l=null,glOptions:u={},debug:c=!1,createFramebuffer:h=!1,autoResizeViewport:f=!0,autoResizeDrawingBuffer:g=!0,stats:w=cr.get("animation-loop-".concat(Rx++))}=e;let{useDevicePixels:E=!0}=e;"useDevicePixelRatio"in e&&(z.deprecated("useDevicePixelRatio","useDevicePixels")(),E=e.useDevicePixelRatio),this.props={onCreateContext:n,onAddHTML:r,onInitialize:i,onRender:s,onFinalize:o,onError:a,gl:l,glOptions:u,debug:c,createFramebuffer:h},this.gl=l,this.needsRedraw=null,this.timeline=null,this.stats=w,this.cpuTime=this.stats.get("CPU Time"),this.gpuTime=this.stats.get("GPU Time"),this.frameRate=this.stats.get("Frame Rate"),this._initialized=!1,this._running=!1,this._animationFrameId=null,this._nextFramePromise=null,this._resolveNextFrame=null,this._cpuStartTime=0,this.setProps({autoResizeViewport:f,autoResizeDrawingBuffer:g,useDevicePixels:E}),this.start=this.start.bind(this),this.stop=this.stop.bind(this),this._pageLoadPromise=null,this._onMousemove=this._onMousemove.bind(this),this._onMouseleave=this._onMouseleave.bind(this)}delete(){this.stop(),this._setDisplay(null)}setNeedsRedraw(e){return F(typeof e=="string"),this.needsRedraw=this.needsRedraw||e,this}setProps(e){return"autoResizeViewport"in e&&(this.autoResizeViewport=e.autoResizeViewport),"autoResizeDrawingBuffer"in e&&(this.autoResizeDrawingBuffer=e.autoResizeDrawingBuffer),"useDevicePixels"in e&&(this.useDevicePixels=e.useDevicePixels),this}start(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(this._running)return this;this._running=!0;const n=this._getPageLoadPromise().then(()=>!this._running||this._initialized?null:(this._createWebGLContext(e),this._createFramebuffer(),this._startEventHandling(),this._initializeCallbackData(),this._updateCallbackData(),this._resizeCanvasDrawingBuffer(),this._resizeViewport(),this._gpuTimeQuery=Oa.isSupported(this.gl,["timers"])?new Oa(this.gl):null,this._initialized=!0,this.onInitialize(this.animationProps))).then(r=>{this._running&&(this._addCallbackData(r||{}),r!==!1&&this._startLoop())});return this.props.onError&&n.catch(this.props.onError),this}redraw(){return this.isContextLost()?this:(this._beginTimers(),this._setupFrame(),this._updateCallbackData(),this._renderFrame(this.animationProps),this._clearNeedsRedraw(),this.offScreen&&this.gl.commit&&this.gl.commit(),this._resolveNextFrame&&(this._resolveNextFrame(this),this._nextFramePromise=null,this._resolveNextFrame=null),this._endTimers(),this)}stop(){return this._running&&(this._finalizeCallbackData(),this._cancelAnimationFrame(this._animationFrameId),this._nextFramePromise=null,this._resolveNextFrame=null,this._animationFrameId=null,this._running=!1),this}attachTimeline(e){return this.timeline=e,this.timeline}detachTimeline(){this.timeline=null}waitForRender(){return this.setNeedsRedraw("waitForRender"),this._nextFramePromise||(this._nextFramePromise=new Promise(e=>{this._resolveNextFrame=e})),this._nextFramePromise}async toDataURL(){return this.setNeedsRedraw("toDataURL"),await this.waitForRender(),this.gl.canvas.toDataURL()}isContextLost(){return this.gl.isContextLost()}onCreateContext(){return this.props.onCreateContext(...arguments)}onInitialize(){return this.props.onInitialize(...arguments)}onRender(){return this.props.onRender(...arguments)}onFinalize(){return this.props.onFinalize(...arguments)}getHTMLControlValue(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;const r=document.getElementById(e);return r?Number(r.value):n}setViewParameters(){return z.removed("AnimationLoop.setViewParameters","AnimationLoop.setProps")(),this}_startLoop(){const e=()=>{this._running&&(this.redraw(),this._animationFrameId=this._requestAnimationFrame(e))};this._cancelAnimationFrame(this._animationFrameId),this._animationFrameId=this._requestAnimationFrame(e)}_getPageLoadPromise(){return this._pageLoadPromise||(this._pageLoadPromise=tp?new Promise((e,n)=>{if(tp&&document.readyState==="complete"){e(document);return}window.addEventListener("load",()=>{e(document)})}):Promise.resolve({})),this._pageLoadPromise}_setDisplay(e){this.display&&(this.display.delete(),this.display.animationLoop=null),e&&(e.animationLoop=this),this.display=e}_cancelAnimationFrame(e){return this.display&&this.display.cancelAnimationFrame?this.display.cancelAnimationFrame(e):US(e)}_requestAnimationFrame(e){if(this._running)return this.display&&this.display.requestAnimationFrame?this.display.requestAnimationFrame(e):FS(e)}_renderFrame(){if(this.display){this.display._renderFrame(...arguments);return}this.onRender(...arguments)}_clearNeedsRedraw(){this.needsRedraw=null}_setupFrame(){this._resizeCanvasDrawingBuffer(),this._resizeViewport(),this._resizeFramebuffer()}_initializeCallbackData(){this.animationProps={gl:this.gl,stop:this.stop,canvas:this.gl.canvas,framebuffer:this.framebuffer,useDevicePixels:this.useDevicePixels,needsRedraw:null,startTime:Date.now(),engineTime:0,tick:0,tock:0,time:0,_timeline:this.timeline,_loop:this,_animationLoop:this,_mousePosition:null}}_updateCallbackData(){const{width:e,height:n,aspect:r}=this._getSizeAndAspect();(e!==this.animationProps.width||n!==this.animationProps.height)&&this.setNeedsRedraw("drawing buffer resized"),r!==this.animationProps.aspect&&this.setNeedsRedraw("drawing buffer aspect changed"),this.animationProps.width=e,this.animationProps.height=n,this.animationProps.aspect=r,this.animationProps.needsRedraw=this.needsRedraw,this.animationProps.engineTime=Date.now()-this.animationProps.startTime,this.timeline&&this.timeline.update(this.animationProps.engineTime),this.animationProps.tick=Math.floor(this.animationProps.time/1e3*60),this.animationProps.tock++,this.animationProps.time=this.timeline?this.timeline.getTime():this.animationProps.engineTime,this.animationProps._offScreen=this.offScreen}_finalizeCallbackData(){this.onFinalize(this.animationProps)}_addCallbackData(e){typeof e=="object"&&e!==null&&(this.animationProps=Object.assign({},this.animationProps,e))}_createWebGLContext(e){if(this.offScreen=e.canvas&&typeof OffscreenCanvas<"u"&&e.canvas instanceof OffscreenCanvas,e=Object.assign({},e,this.props.glOptions),this.gl=this.props.gl?uf(this.props.gl,e):this.onCreateContext(e),!dl(this.gl))throw new Error("AnimationLoop.onCreateContext - illegal context returned");SS(this.gl),this._createInfoDiv()}_createInfoDiv(){if(this.gl.canvas&&this.props.onAddHTML){const e=document.createElement("div");document.body.appendChild(e),e.style.position="relative";const n=document.createElement("div");n.style.position="absolute",n.style.left="10px",n.style.bottom="10px",n.style.width="300px",n.style.background="white",e.appendChild(this.gl.canvas),e.appendChild(n);const r=this.props.onAddHTML(n);r&&(n.innerHTML=r)}}_getSizeAndAspect(){const e=this.gl.drawingBufferWidth,n=this.gl.drawingBufferHeight;let r=1;const{canvas:i}=this.gl;return i&&i.clientHeight?r=i.clientWidth/i.clientHeight:e>0&&n>0&&(r=e/n),{width:e,height:n,aspect:r}}_resizeViewport(){this.autoResizeViewport&&this.gl.viewport(0,0,this.gl.drawingBufferWidth,this.gl.drawingBufferHeight)}_resizeCanvasDrawingBuffer(){this.autoResizeDrawingBuffer&&LS(this.gl,{useDevicePixels:this.useDevicePixels})}_createFramebuffer(){this.props.createFramebuffer&&(this.framebuffer=new we(this.gl))}_resizeFramebuffer(){this.framebuffer&&this.framebuffer.resize({width:this.gl.drawingBufferWidth,height:this.gl.drawingBufferHeight})}_beginTimers(){this.frameRate.timeEnd(),this.frameRate.timeStart(),this._gpuTimeQuery&&this._gpuTimeQuery.isResultAvailable()&&!this._gpuTimeQuery.isTimerDisjoint()&&this.stats.get("GPU Time").addTime(this._gpuTimeQuery.getTimerMilliseconds()),this._gpuTimeQuery&&this._gpuTimeQuery.beginTimeElapsedQuery(),this.cpuTime.timeStart()}_endTimers(){this.cpuTime.timeEnd(),this._gpuTimeQuery&&this._gpuTimeQuery.end()}_startEventHandling(){const{canvas:e}=this.gl;e&&(e.addEventListener("mousemove",this._onMousemove),e.addEventListener("mouseleave",this._onMouseleave))}_onMousemove(e){this.animationProps._mousePosition=[e.offsetX,e.offsetY]}_onMouseleave(e){this.animationProps._mousePosition=null}}const $s="vs",df="fs";function ht(t,e){if(!t)throw new Error(e||"shadertools: assertion failed.")}const wu={number:{validate(t,e){return Number.isFinite(t)&&(!("max"in e)||t<=e.max)&&(!("min"in e)||t>=e.min)}},array:{validate(t,e){return Array.isArray(t)||ArrayBuffer.isView(t)}}};function kx(t){const e={};for(const n in t){const r=t[n],i=Ix(r);e[n]=i}return e}function Ix(t){let e=np(t);return e==="object"?t?"type"in t?Object.assign({},t,wu[t.type]):"value"in t?(e=np(t.value),Object.assign({type:e},t,wu[e])):{type:"object",value:t}:{type:"object",value:null}:Object.assign({type:e,value:t},wu[e])}function np(t){return Array.isArray(t)||ArrayBuffer.isView(t)?"array":typeof t}const Ox="vs",Nx="fs";class rp{constructor(e){let{name:n,vs:r,fs:i,dependencies:s=[],uniforms:o,getUniforms:a,deprecations:l=[],defines:u={},inject:c={},vertexShader:h,fragmentShader:f}=e;ht(typeof n=="string"),this.name=n,this.vs=r||h,this.fs=i||f,this.getModuleUniforms=a,this.dependencies=s,this.deprecations=this._parseDeprecationDefinitions(l),this.defines=u,this.injections=Dx(c),o&&(this.uniforms=kx(o))}getModuleSource(e){let n;switch(e){case Ox:n=this.vs||"";break;case Nx:n=this.fs||"";break;default:ht(!1)}return"#define MODULE_".concat(this.name.toUpperCase().replace(/[^0-9a-z]/gi,"_"),`
`).concat(n,"// END MODULE_").concat(this.name,`

`)}getUniforms(e,n){return this.getModuleUniforms?this.getModuleUniforms(e,n):this.uniforms?this._defaultGetUniforms(e):{}}getDefines(){return this.defines}checkDeprecations(e,n){this.deprecations.forEach(r=>{r.regex.test(e)&&(r.deprecated?n.deprecated(r.old,r.new)():n.removed(r.old,r.new)())})}_parseDeprecationDefinitions(e){return e.forEach(n=>{switch(n.type){case"function":n.regex=new RegExp("\\b".concat(n.old,"\\("));break;default:n.regex=new RegExp("".concat(n.type," ").concat(n.old,";"))}}),e}_defaultGetUniforms(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const n={},r=this.uniforms;for(const i in r){const s=r[i];i in e&&!s.private?(s.validate&&ht(s.validate(e[i],s),"".concat(this.name,": invalid ").concat(i)),n[i]=e[i]):n[i]=s.value}return n}}function Dx(t){const e={vs:{},fs:{}};for(const n in t){let r=t[n];const i=n.slice(0,2);typeof r=="string"&&(r={order:0,injection:r}),e[i][n]=r}return e}function Fx(t){return Ux(s_(t))}function Ux(t){const e={},n={};return i_({modules:t,level:0,moduleMap:e,moduleDepth:n}),Object.keys(n).sort((r,i)=>n[i]-n[r]).map(r=>e[r])}function i_(t){let{modules:e,level:n,moduleMap:r,moduleDepth:i}=t;if(n>=5)throw new Error("Possible loop in shader dependency graph");for(const s of e)r[s.name]=s,(i[s.name]===void 0||i[s.name]<n)&&(i[s.name]=n);for(const s of e)s.dependencies&&i_({modules:s.dependencies,level:n+1,moduleMap:r,moduleDepth:i})}function s_(t,e){return t.map(n=>(n instanceof rp||(ht(typeof n!="string","Shader module use by name is deprecated. Import shader module '".concat(n,"' and use it directly.")),ht(n.name,"shader module has no name"),n=new rp(n),n.dependencies=s_(n.dependencies)),n))}function Bx(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const e=typeof window<"u"?window.navigator||{}:{},n=t.userAgent||e.userAgent||"",r=n.indexOf("MSIE ")!==-1,i=n.indexOf("Trident/")!==-1;return r||i}const Vx=7936,zx=7937,jx=7938,Gx=35724,gf={GLSL_FRAG_DATA:["WEBGL_draw_buffers",!0],GLSL_FRAG_DEPTH:["EXT_frag_depth",!0],GLSL_DERIVATIVES:["OES_standard_derivatives",!0],GLSL_TEXTURE_LOD:["EXT_shader_texture_lod",!0]},or={};Object.keys(gf).forEach(t=>{or[t]=t});function Hx(t){return typeof WebGL2RenderingContext<"u"&&t instanceof WebGL2RenderingContext?!0:Boolean(t&&t._version===2)}function Wx(t){const e=t.getExtension("WEBGL_debug_renderer_info"),n=t.getParameter(e&&e.UNMASKED_VENDOR_WEBGL||Vx),r=t.getParameter(e&&e.UNMASKED_RENDERER_WEBGL||zx);return{gpuVendor:Xx(n,r),vendor:n,renderer:r,version:t.getParameter(jx),shadingLanguageVersion:t.getParameter(Gx)}}function Xx(t,e){return t.match(/NVIDIA/i)||e.match(/NVIDIA/i)?"NVIDIA":t.match(/INTEL/i)||e.match(/INTEL/i)?"INTEL":t.match(/AMD/i)||e.match(/AMD/i)||t.match(/ATI/i)||e.match(/ATI/i)?"AMD":"UNKNOWN GPU"}const Eu={};function ip(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};const r=gf[e];if(ht(r,e),!Bx(n))return!0;if(e in Eu)return Eu[e];const i=r[0],s=n.behavior||"enable",o="#extension GL_".concat(i," : ").concat(s,`
void main(void) {}`),a=t.createShader(35633);t.shaderSource(a,o),t.compileShader(a);const l=t.getShaderParameter(a,35713);return t.deleteShader(a),Eu[e]=l,l}function Yx(t,e){const n=gf[e];ht(n,e);const r=Hx(t)&&n[1]||n[0],i=typeof r=="string"?Boolean(t.getExtension(r)):r;return ht(i===!1||i===!0),i}function Io(t,e){return e=Array.isArray(e)?e:[e],e.every(n=>Yx(t,n))}function $x(t){switch(Wx(t).gpuVendor.toLowerCase()){case"nvidia":return`#define NVIDIA_GPU
// Nvidia optimizes away the calculation necessary for emulated fp64
#define LUMA_FP64_CODE_ELIMINATION_WORKAROUND 1
`;case"intel":return`#define INTEL_GPU
// Intel optimizes away the calculation necessary for emulated fp64
#define LUMA_FP64_CODE_ELIMINATION_WORKAROUND 1
// Intel's built-in 'tan' function doesn't have acceptable precision
#define LUMA_FP32_TAN_PRECISION_WORKAROUND 1
// Intel GPU doesn't have full 32 bits precision in same cases, causes overflow
#define LUMA_FP64_HIGH_BITS_OVERFLOW_WORKAROUND 1
`;case"amd":return`#define AMD_GPU
`;default:return`#define DEFAULT_GPU
// Prevent driver from optimizing away the calculation necessary for emulated fp64
#define LUMA_FP64_CODE_ELIMINATION_WORKAROUND 1
// Intel's built-in 'tan' function doesn't have acceptable precision
#define LUMA_FP32_TAN_PRECISION_WORKAROUND 1
// Intel GPU doesn't have full 32 bits precision in same cases, causes overflow
#define LUMA_FP64_HIGH_BITS_OVERFLOW_WORKAROUND 1
`}}function qx(t,e,n){let r=`#if (__VERSION__ > 120)

# define FEATURE_GLSL_DERIVATIVES
# define FEATURE_GLSL_DRAW_BUFFERS
# define FEATURE_GLSL_FRAG_DEPTH
# define FEATURE_GLSL_TEXTURE_LOD

// DEPRECATED FLAGS, remove in v9
# define FRAG_DEPTH
# define DERIVATIVES
# define DRAW_BUFFERS
# define TEXTURE_LOD

#endif // __VERSION
`;return Io(t,or.GLSL_FRAG_DEPTH)&&(r+=`
// FRAG_DEPTH => gl_FragDepth is available
#ifdef GL_EXT_frag_depth
#extension GL_EXT_frag_depth : enable
# define FEATURE_GLSL_FRAG_DEPTH
# define FRAG_DEPTH
# define gl_FragDepth gl_FragDepthEXT
#endif
`),Io(t,or.GLSL_DERIVATIVES)&&ip(t,or.GLSL_DERIVATIVES)&&(r+=`
// DERIVATIVES => dxdF, dxdY and fwidth are available
#ifdef GL_OES_standard_derivatives
#extension GL_OES_standard_derivatives : enable
# define FEATURE_GLSL_DERIVATIVES
# define DERIVATIVES
#endif
`),Io(t,or.GLSL_FRAG_DATA)&&ip(t,or.GLSL_FRAG_DATA,{behavior:"require"})&&(r+=`
// DRAW_BUFFERS => gl_FragData[] is available
#ifdef GL_EXT_draw_buffers
#extension GL_EXT_draw_buffers : require
#define FEATURE_GLSL_DRAW_BUFFERS
#define DRAW_BUFFERS
#endif
`),Io(t,or.GLSL_TEXTURE_LOD)&&(r+=`// TEXTURE_LOD => texture2DLod etc are available
#ifdef GL_EXT_shader_texture_lod
#extension GL_EXT_shader_texture_lod : enable

# define FEATURE_GLSL_TEXTURE_LOD
# define TEXTURE_LOD

#endif
`),r}const Zx=`#ifdef MODULE_LOGDEPTH
  logdepth_adjustPosition(gl_Position);
#endif
`,Qx=`#ifdef MODULE_MATERIAL
  gl_FragColor = material_filterColor(gl_FragColor);
#endif

#ifdef MODULE_LIGHTING
  gl_FragColor = lighting_filterColor(gl_FragColor);
#endif

#ifdef MODULE_FOG
  gl_FragColor = fog_filterColor(gl_FragColor);
#endif

#ifdef MODULE_PICKING
  gl_FragColor = picking_filterHighlightColor(gl_FragColor);
  gl_FragColor = picking_filterPickingColor(gl_FragColor);
#endif

#ifdef MODULE_LOGDEPTH
  logdepth_setFragDepth();
#endif
`,Kx={[$s]:Zx,[df]:Qx},ta="__LUMA_INJECT_DECLARATIONS__",sp=/void\s+main\s*\([^)]*\)\s*\{\n?/,op=/}\n?[^{}]*$/,Tu=[];function ap(t,e,n){let r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;const i=e===$s;for(const s in n){const o=n[s];o.sort((l,u)=>l.order-u.order),Tu.length=o.length;for(let l=0,u=o.length;l<u;++l)Tu[l]=o[l].injection;const a="".concat(Tu.join(`
`),`
`);switch(s){case"vs:#decl":i&&(t=t.replace(ta,a));break;case"vs:#main-start":i&&(t=t.replace(sp,l=>l+a));break;case"vs:#main-end":i&&(t=t.replace(op,l=>a+l));break;case"fs:#decl":i||(t=t.replace(ta,a));break;case"fs:#main-start":i||(t=t.replace(sp,l=>l+a));break;case"fs:#main-end":i||(t=t.replace(op,l=>a+l));break;default:t=t.replace(s,l=>l+a)}}return t=t.replace(ta,""),r&&(t=t.replace(/\}\s*$/,s=>s+Kx[e])),t}function jc(t){const e={};return ht(Array.isArray(t)&&t.length>1),t.forEach(n=>{for(const r in n)e[r]=e[r]?"".concat(e[r],`
`).concat(n[r]):n[r]}),e}function pi(t){return new RegExp("\\b".concat(t,"[ \\t]+(\\w+[ \\t]+\\w+(\\[\\w+\\])?;)"),"g")}const o_=[[/^(#version[ \t]+(100|300[ \t]+es))?[ \t]*\n/,`#version 300 es
`],[/\btexture(2D|2DProj|Cube)Lod(EXT)?\(/g,"textureLod("],[/\btexture(2D|2DProj|Cube)(EXT)?\(/g,"texture("]],Jx=[...o_,[pi("attribute"),"in $1"],[pi("varying"),"out $1"]],eP=[...o_,[pi("varying"),"in $1"]],a_=[[/^#version[ \t]+300[ \t]+es/,"#version 100"],[/\btexture(2D|2DProj|Cube)Lod\(/g,"texture$1LodEXT("],[/\btexture\(/g,"texture2D("],[/\btextureLod\(/g,"texture2DLodEXT("]],tP=[...a_,[pi("in"),"attribute $1"],[pi("out"),"varying $1"]],nP=[...a_,[pi("in"),"varying $1"]],Gc="gl_FragColor",Hc=/\bout[ \t]+vec4[ \t]+(\w+)[ \t]*;\n?/,rP=/void\s+main\s*\([^)]*\)\s*\{\n?/;function iP(t,e,n){switch(e){case 300:return n?Na(t,Jx):sP(t);case 100:return n?Na(t,tP):oP(t);default:throw new Error("unknown GLSL version ".concat(e))}}function Na(t,e){for(const[n,r]of e)t=t.replace(n,r);return t}function sP(t){t=Na(t,eP);const e=t.match(Hc);if(e){const n=e[1];t=t.replace(new RegExp("\\b".concat(Gc,"\\b"),"g"),n)}else{const n="fragmentColor";t=t.replace(rP,r=>"out vec4 ".concat(n,`;
`).concat(r)).replace(new RegExp("\\b".concat(Gc,"\\b"),"g"),n)}return t}function oP(t){t=Na(t,nP);const e=t.match(Hc);if(e){const n=e[1];t=t.replace(Hc,"").replace(new RegExp("\\b".concat(n,"\\b"),"g"),Gc)}return t}const aP=`

`.concat(ta,`

`),l_={[$s]:"vertex",[df]:"fragment"},lP=`precision highp float;

`;function uP(t,e){const{vs:n,fs:r}=e,i=Fx(e.modules||[]);return{gl:t,vs:lp(t,Object.assign({},e,{source:n,type:$s,modules:i})),fs:lp(t,Object.assign({},e,{source:r,type:df,modules:i})),getUniforms:cP(i)}}function lp(t,e){let{id:n,source:r,type:i,modules:s,defines:o={},hookFunctions:a=[],inject:l={},transpileToGLSL100:u=!1,prologue:c=!0,log:h}=e;ht(typeof r=="string","shader source must be a string");const f=i===$s,g=r.split(`
`);let w=100,E="",T=r;g[0].indexOf("#version ")===0?(w=300,E=g[0],T=g.slice(1).join(`
`)):E="#version ".concat(w);const y={};s.forEach(L=>{Object.assign(y,L.getDefines())}),Object.assign(y,o);let m=c?"".concat(E,`
`).concat(fP({id:n,source:r,type:i}),`
`).concat(hP({type:i}),`
`).concat($x(t),`
`).concat(qx(t),`
`).concat(dP(y),`
`).concat(f?"":lP,`
`):"".concat(E,`
`);const _=pP(a),S={},A={},P={};for(const L in l){const C=typeof l[L]=="string"?{injection:l[L],order:0}:l[L],R=L.match(/^(v|f)s:(#)?([\w-]+)$/);if(R){const M=R[2],O=R[3];M?O==="decl"?A[L]=[C]:P[L]=[C]:S[L]=[C]}else P[L]=[C]}for(const L of s){h&&L.checkDeprecations(T,h);const C=L.getModuleSource(i,w);m+=C;const R=L.injections[i];for(const M in R){const O=M.match(/^(v|f)s:#([\w-]+)$/);if(O){const G=O[2]==="decl"?A:P;G[M]=G[M]||[],G[M].push(R[M])}else S[M]=S[M]||[],S[M].push(R[M])}}return m+=aP,m=ap(m,i,A),m+=gP(_[i],S),m+=T,m=ap(m,i,P),m=iP(m,u?100:w,f),m}function cP(t){return function(n){const r={};for(const i of t){const s=i.getUniforms(n,r);Object.assign(r,s)}return r}}function hP(t){let{type:e}=t;return`
#define SHADER_TYPE_`.concat(l_[e].toUpperCase(),`
`)}function fP(t){let{id:e,source:n,type:r}=t;return e&&typeof e=="string"&&n.indexOf("SHADER_NAME")===-1?`
#define SHADER_NAME `.concat(e,"_").concat(l_[r],`

`):""}function dP(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},e=0,n="";for(const r in t){e===0&&(n+=`
// APPLICATION DEFINES
`),e++;const i=t[r];(i||Number.isFinite(i))&&(n+="#define ".concat(r.toUpperCase()," ").concat(t[r],`
`))}return e===0&&(n+=`
`),n}function gP(t,e){let n="";for(const r in t){const i=t[r];if(n+="void ".concat(i.signature,` {
`),i.header&&(n+="  ".concat(i.header)),e[r]){const s=e[r];s.sort((o,a)=>o.order-a.order);for(const o of s)n+="  ".concat(o.injection,`
`)}i.footer&&(n+="  ".concat(i.footer)),n+=`}
`}return n}function pP(t){const e={vs:{},fs:{}};return t.forEach(n=>{let r;typeof n!="string"?(r=n,n=r.hook):r={},n=n.trim();const[i,s]=n.split(":"),o=n.replace(/\(.+/,"");e[i][o]=Object.assign(r,{signature:s})}),e}const mP="void main() {gl_FragColor = vec4(0);}",u_=`out vec4 transform_output;
void main() {
  transform_output = vec4(0);
}`,yP=`#version 300 es
`.concat(u_);function c_(t,e){e=Array.isArray(e)?e:[e];const n=t.replace(/^\s+/,"").split(/\s+/),[r,i,s]=n;if(!e.includes(r)||!i||!s)return null;const o=s.split(";")[0];return{qualifier:r,type:i,name:o}}function h_(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{version:e=100,input:n,inputType:r,output:i}=t;if(!n)return e===300?yP:e>300?"#version ".concat(e,`
`).concat(u_):mP;const s=wP(n,r);return e>=300?"#version ".concat(e," ").concat(e===300?"es":"",`
in `).concat(r," ").concat(n,`;
out vec4 `).concat(i,`;
void main() {
  `).concat(i," = ").concat(s,`;
}`):"varying ".concat(r," ").concat(n,`;
void main() {
  gl_FragColor = `).concat(s,`;
}`)}function _P(t){switch(t){case"float":return"x";case"vec2":return"xy";case"vec3":return"xyz";case"vec4":return"xyzw";default:return ht(!1),null}}function vP(t){switch(t){case"float":return 1;case"vec2":return 2;case"vec3":return 3;case"vec4":return 4;default:return ht(!1),null}}function wP(t,e){switch(e){case"float":return"vec4(".concat(t,", 0.0, 0.0, 1.0)");case"vec2":return"vec4(".concat(t,", 0.0, 1.0)");case"vec3":return"vec4(".concat(t,", 1.0)");case"vec4":return t;default:return ht(!1),null}}const EP=`#ifdef LUMA_FP32_TAN_PRECISION_WORKAROUND
const float TWO_PI = 6.2831854820251465;
const float PI_2 = 1.5707963705062866;
const float PI_16 = 0.1963495463132858;

const float SIN_TABLE_0 = 0.19509032368659973;
const float SIN_TABLE_1 = 0.3826834261417389;
const float SIN_TABLE_2 = 0.5555702447891235;
const float SIN_TABLE_3 = 0.7071067690849304;

const float COS_TABLE_0 = 0.9807852506637573;
const float COS_TABLE_1 = 0.9238795042037964;
const float COS_TABLE_2 = 0.8314695954322815;
const float COS_TABLE_3 = 0.7071067690849304;

const float INVERSE_FACTORIAL_3 = 1.666666716337204e-01;
const float INVERSE_FACTORIAL_5 = 8.333333767950535e-03;
const float INVERSE_FACTORIAL_7 = 1.9841270113829523e-04;
const float INVERSE_FACTORIAL_9 = 2.75573188446287533e-06;

float sin_taylor_fp32(float a) {
  float r, s, t, x;

  if (a == 0.0) {
    return 0.0;
  }

  x = -a * a;
  s = a;
  r = a;

  r = r * x;
  t = r * INVERSE_FACTORIAL_3;
  s = s + t;

  r = r * x;
  t = r * INVERSE_FACTORIAL_5;
  s = s + t;

  r = r * x;
  t = r * INVERSE_FACTORIAL_7;
  s = s + t;

  r = r * x;
  t = r * INVERSE_FACTORIAL_9;
  s = s + t;

  return s;
}

void sincos_taylor_fp32(float a, out float sin_t, out float cos_t) {
  if (a == 0.0) {
    sin_t = 0.0;
    cos_t = 1.0;
  }
  sin_t = sin_taylor_fp32(a);
  cos_t = sqrt(1.0 - sin_t * sin_t);
}

float tan_taylor_fp32(float a) {
    float sin_a;
    float cos_a;

    if (a == 0.0) {
        return 0.0;
    }
    float z = floor(a / TWO_PI);
    float r = a - TWO_PI * z;

    float t;
    float q = floor(r / PI_2 + 0.5);
    int j = int(q);

    if (j < -2 || j > 2) {
        return 1.0 / 0.0;
    }

    t = r - PI_2 * q;

    q = floor(t / PI_16 + 0.5);
    int k = int(q);
    int abs_k = int(abs(float(k)));

    if (abs_k > 4) {
        return 1.0 / 0.0;
    } else {
        t = t - PI_16 * q;
    }

    float u = 0.0;
    float v = 0.0;

    float sin_t, cos_t;
    float s, c;
    sincos_taylor_fp32(t, sin_t, cos_t);

    if (k == 0) {
        s = sin_t;
        c = cos_t;
    } else {
        if (abs(float(abs_k) - 1.0) < 0.5) {
            u = COS_TABLE_0;
            v = SIN_TABLE_0;
        } else if (abs(float(abs_k) - 2.0) < 0.5) {
            u = COS_TABLE_1;
            v = SIN_TABLE_1;
        } else if (abs(float(abs_k) - 3.0) < 0.5) {
            u = COS_TABLE_2;
            v = SIN_TABLE_2;
        } else if (abs(float(abs_k) - 4.0) < 0.5) {
            u = COS_TABLE_3;
            v = SIN_TABLE_3;
        }
        if (k > 0) {
            s = u * sin_t + v * cos_t;
            c = u * cos_t - v * sin_t;
        } else {
            s = u * sin_t - v * cos_t;
            c = u * cos_t + v * sin_t;
        }
    }

    if (j == 0) {
        sin_a = s;
        cos_a = c;
    } else if (j == 1) {
        sin_a = c;
        cos_a = -s;
    } else if (j == -1) {
        sin_a = -c;
        cos_a = s;
    } else {
        sin_a = -s;
        cos_a = -c;
    }
    return sin_a / cos_a;
}
#endif

float tan_fp32(float a) {
#ifdef LUMA_FP32_TAN_PRECISION_WORKAROUND
  return tan_taylor_fp32(a);
#else
  return tan(a);
#endif
}
`,TP={name:"fp32",vs:EP,fs:null};function up(t,e){if(!t)throw new Error("math.gl assertion ".concat(e))}const ut={EPSILON:1e-12,debug:!1,precision:4,printTypes:!1,printDegrees:!1,printRowMajor:!0};function bP(t,{precision:e=ut.precision}={}){return t=SP(t),"".concat(parseFloat(t.toPrecision(e)))}function mi(t){return Array.isArray(t)||ArrayBuffer.isView(t)&&!(t instanceof DataView)}function Me(t,e,n){return xP(t,r=>Math.max(e,Math.min(n,r)))}function Da(t,e,n){return mi(t)?t.map((r,i)=>Da(r,e[i],n)):n*e+(1-n)*t}function yi(t,e,n){const r=ut.EPSILON;n&&(ut.EPSILON=n);try{if(t===e)return!0;if(mi(t)&&mi(e)){if(t.length!==e.length)return!1;for(let i=0;i<t.length;++i)if(!yi(t[i],e[i]))return!1;return!0}return t&&t.equals?t.equals(e):e&&e.equals?e.equals(t):typeof t=="number"&&typeof e=="number"?Math.abs(t-e)<=ut.EPSILON*Math.max(1,Math.abs(t),Math.abs(e)):!1}finally{ut.EPSILON=r}}function SP(t){return Math.round(t/ut.EPSILON)*ut.EPSILON}function AP(t){return t.clone?t.clone():new Array(t.length)}function xP(t,e,n){if(mi(t)){const r=t;n=n||AP(r);for(let i=0;i<n.length&&i<r.length;++i)n[i]=e(t[i],i,n);return n}return e(t)}function PP(t){function e(){var n=Reflect.construct(t,Array.from(arguments));return Object.setPrototypeOf(n,Object.getPrototypeOf(this)),n}return e.prototype=Object.create(t.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t,e}class f_ extends PP(Array){clone(){return new this.constructor().copy(this)}fromArray(e,n=0){for(let r=0;r<this.ELEMENTS;++r)this[r]=e[r+n];return this.check()}toArray(e=[],n=0){for(let r=0;r<this.ELEMENTS;++r)e[n+r]=this[r];return e}from(e){return Array.isArray(e)?this.copy(e):this.fromObject(e)}to(e){return e===this?this:mi(e)?this.toArray(e):this.toObject(e)}toTarget(e){return e?this.to(e):this}toFloat32Array(){return new Float32Array(this)}toString(){return this.formatString(ut)}formatString(e){let n="";for(let r=0;r<this.ELEMENTS;++r)n+=(r>0?", ":"")+bP(this[r],e);return"".concat(e.printTypes?this.constructor.name:"","[").concat(n,"]")}equals(e){if(!e||this.length!==e.length)return!1;for(let n=0;n<this.ELEMENTS;++n)if(!yi(this[n],e[n]))return!1;return!0}exactEquals(e){if(!e||this.length!==e.length)return!1;for(let n=0;n<this.ELEMENTS;++n)if(this[n]!==e[n])return!1;return!0}negate(){for(let e=0;e<this.ELEMENTS;++e)this[e]=-this[e];return this.check()}lerp(e,n,r){if(r===void 0)return this.lerp(this,e,n);for(let i=0;i<this.ELEMENTS;++i){const s=e[i];this[i]=s+r*(n[i]-s)}return this.check()}min(e){for(let n=0;n<this.ELEMENTS;++n)this[n]=Math.min(e[n],this[n]);return this.check()}max(e){for(let n=0;n<this.ELEMENTS;++n)this[n]=Math.max(e[n],this[n]);return this.check()}clamp(e,n){for(let r=0;r<this.ELEMENTS;++r)this[r]=Math.min(Math.max(this[r],e[r]),n[r]);return this.check()}add(...e){for(const n of e)for(let r=0;r<this.ELEMENTS;++r)this[r]+=n[r];return this.check()}subtract(...e){for(const n of e)for(let r=0;r<this.ELEMENTS;++r)this[r]-=n[r];return this.check()}scale(e){if(typeof e=="number")for(let n=0;n<this.ELEMENTS;++n)this[n]*=e;else for(let n=0;n<this.ELEMENTS&&n<e.length;++n)this[n]*=e[n];return this.check()}multiplyByScalar(e){for(let n=0;n<this.ELEMENTS;++n)this[n]*=e;return this.check()}check(){if(ut.debug&&!this.validate())throw new Error("math.gl: ".concat(this.constructor.name," some fields set to invalid numbers'"));return this}validate(){let e=this.length===this.ELEMENTS;for(let n=0;n<this.ELEMENTS;++n)e=e&&Number.isFinite(this[n]);return e}sub(e){return this.subtract(e)}setScalar(e){for(let n=0;n<this.ELEMENTS;++n)this[n]=e;return this.check()}addScalar(e){for(let n=0;n<this.ELEMENTS;++n)this[n]+=e;return this.check()}subScalar(e){return this.addScalar(-e)}multiplyScalar(e){for(let n=0;n<this.ELEMENTS;++n)this[n]*=e;return this.check()}divideScalar(e){return this.multiplyByScalar(1/e)}clampScalar(e,n){for(let r=0;r<this.ELEMENTS;++r)this[r]=Math.min(Math.max(this[r],e),n);return this.check()}get elements(){return this}}function CP(t,e){if(t.length!==e)return!1;for(let n=0;n<t.length;++n)if(!Number.isFinite(t[n]))return!1;return!0}function ot(t){if(!Number.isFinite(t))throw new Error("Invalid number ".concat(t));return t}function bu(t,e,n=""){if(ut.debug&&!CP(t,e))throw new Error("math.gl: ".concat(n," some fields set to invalid numbers'"));return t}class LP extends f_{get x(){return this[0]}set x(e){this[0]=ot(e)}get y(){return this[1]}set y(e){this[1]=ot(e)}len(){return Math.sqrt(this.lengthSquared())}magnitude(){return this.len()}lengthSquared(){let e=0;for(let n=0;n<this.ELEMENTS;++n)e+=this[n]*this[n];return e}magnitudeSquared(){return this.lengthSquared()}distance(e){return Math.sqrt(this.distanceSquared(e))}distanceSquared(e){let n=0;for(let r=0;r<this.ELEMENTS;++r){const i=this[r]-e[r];n+=i*i}return ot(n)}dot(e){let n=0;for(let r=0;r<this.ELEMENTS;++r)n+=this[r]*e[r];return ot(n)}normalize(){const e=this.magnitude();if(e!==0)for(let n=0;n<this.ELEMENTS;++n)this[n]/=e;return this.check()}multiply(...e){for(const n of e)for(let r=0;r<this.ELEMENTS;++r)this[r]*=n[r];return this.check()}divide(...e){for(const n of e)for(let r=0;r<this.ELEMENTS;++r)this[r]/=n[r];return this.check()}lengthSq(){return this.lengthSquared()}distanceTo(e){return this.distance(e)}distanceToSquared(e){return this.distanceSquared(e)}getComponent(e){return up(e>=0&&e<this.ELEMENTS,"index is out of range"),ot(this[e])}setComponent(e,n){return up(e>=0&&e<this.ELEMENTS,"index is out of range"),this[e]=n,this.check()}addVectors(e,n){return this.copy(e).add(n)}subVectors(e,n){return this.copy(e).subtract(n)}multiplyVectors(e,n){return this.copy(e).multiply(n)}addScaledVector(e,n){return this.add(new this.constructor(e).multiplyScalar(n))}}var na=1e-6,_i=typeof Float32Array<"u"?Float32Array:Array;Math.hypot||(Math.hypot=function(){for(var t=0,e=arguments.length;e--;)t+=arguments[e]*arguments[e];return Math.sqrt(t)});function RP(){var t=new _i(2);return _i!=Float32Array&&(t[0]=0,t[1]=0),t}function Fa(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t}function d_(t,e){return t[0]=-e[0],t[1]=-e[1],t}function g_(t,e,n,r){var i=e[0],s=e[1];return t[0]=i+r*(n[0]-i),t[1]=s+r*(n[1]-s),t}function MP(t,e,n){var r=e[0],i=e[1];return t[0]=n[0]*r+n[4]*i+n[12],t[1]=n[1]*r+n[5]*i+n[13],t}(function(){var t=RP();return function(e,n,r,i,s,o){var a,l;for(n||(n=2),r||(r=0),i?l=Math.min(i*n+r,e.length):l=e.length,a=r;a<l;a+=n)t[0]=e[a],t[1]=e[a+1],s(t,t,o),e[a]=t[0],e[a+1]=t[1];return e}})();function kP(t,e,n){const r=e[0],i=e[1],s=n[3]*r+n[7]*i||1;return t[0]=(n[0]*r+n[4]*i)/s,t[1]=(n[1]*r+n[5]*i)/s,t}function p_(t,e,n){const r=e[0],i=e[1],s=e[2],o=n[3]*r+n[7]*i+n[11]*s||1;return t[0]=(n[0]*r+n[4]*i+n[8]*s)/o,t[1]=(n[1]*r+n[5]*i+n[9]*s)/o,t[2]=(n[2]*r+n[6]*i+n[10]*s)/o,t}function IP(t,e,n){const r=e[0],i=e[1];return t[0]=n[0]*r+n[2]*i,t[1]=n[1]*r+n[3]*i,t[2]=e[2],t}function OP(){var t=new _i(3);return _i!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0),t}function NP(t,e,n){return t[0]=e[0]-n[0],t[1]=e[1]-n[1],t[2]=e[2]-n[2],t}function DP(t,e){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t}function FP(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]}function UP(t,e,n){var r=e[0],i=e[1],s=e[2],o=n[0],a=n[1],l=n[2];return t[0]=i*l-s*a,t[1]=s*o-r*l,t[2]=r*a-i*o,t}function m_(t,e,n){var r=e[0],i=e[1],s=e[2],o=n[3]*r+n[7]*i+n[11]*s+n[15];return o=o||1,t[0]=(n[0]*r+n[4]*i+n[8]*s+n[12])/o,t[1]=(n[1]*r+n[5]*i+n[9]*s+n[13])/o,t[2]=(n[2]*r+n[6]*i+n[10]*s+n[14])/o,t}function BP(t,e,n){var r=e[0],i=e[1],s=e[2];return t[0]=r*n[0]+i*n[3]+s*n[6],t[1]=r*n[1]+i*n[4]+s*n[7],t[2]=r*n[2]+i*n[5]+s*n[8],t}function VP(t,e,n){var r=n[0],i=n[1],s=n[2],o=n[3],a=e[0],l=e[1],u=e[2],c=i*u-s*l,h=s*a-r*u,f=r*l-i*a,g=i*f-s*h,w=s*c-r*f,E=r*h-i*c,T=o*2;return c*=T,h*=T,f*=T,g*=2,w*=2,E*=2,t[0]=a+c+g,t[1]=l+h+w,t[2]=u+f+E,t}function zP(t,e,n,r){var i=[],s=[];return i[0]=e[0]-n[0],i[1]=e[1]-n[1],i[2]=e[2]-n[2],s[0]=i[0],s[1]=i[1]*Math.cos(r)-i[2]*Math.sin(r),s[2]=i[1]*Math.sin(r)+i[2]*Math.cos(r),t[0]=s[0]+n[0],t[1]=s[1]+n[1],t[2]=s[2]+n[2],t}function jP(t,e,n,r){var i=[],s=[];return i[0]=e[0]-n[0],i[1]=e[1]-n[1],i[2]=e[2]-n[2],s[0]=i[2]*Math.sin(r)+i[0]*Math.cos(r),s[1]=i[1],s[2]=i[2]*Math.cos(r)-i[0]*Math.sin(r),t[0]=s[0]+n[0],t[1]=s[1]+n[1],t[2]=s[2]+n[2],t}function GP(t,e,n,r){var i=[],s=[];return i[0]=e[0]-n[0],i[1]=e[1]-n[1],i[2]=e[2]-n[2],s[0]=i[0]*Math.cos(r)-i[1]*Math.sin(r),s[1]=i[0]*Math.sin(r)+i[1]*Math.cos(r),s[2]=i[2],t[0]=s[0]+n[0],t[1]=s[1]+n[1],t[2]=s[2]+n[2],t}function HP(t,e){var n=t[0],r=t[1],i=t[2],s=e[0],o=e[1],a=e[2],l=Math.sqrt(n*n+r*r+i*i),u=Math.sqrt(s*s+o*o+a*a),c=l*u,h=c&&FP(t,e)/c;return Math.acos(Math.min(Math.max(h,-1),1))}var WP=NP;(function(){var t=OP();return function(e,n,r,i,s,o){var a,l;for(n||(n=3),r||(r=0),i?l=Math.min(i*n+r,e.length):l=e.length,a=r;a<l;a+=n)t[0]=e[a],t[1]=e[a+1],t[2]=e[a+2],s(t,t,o),e[a]=t[0],e[a+1]=t[1],e[a+2]=t[2];return e}})();const Su=[0,0,0];let Oo;class Jt extends LP{static get ZERO(){return Oo||(Oo=new Jt(0,0,0),Object.freeze(Oo)),Oo}constructor(e=0,n=0,r=0){super(-0,-0,-0),arguments.length===1&&mi(e)?this.copy(e):(ut.debug&&(ot(e),ot(n),ot(r)),this[0]=e,this[1]=n,this[2]=r)}set(e,n,r){return this[0]=e,this[1]=n,this[2]=r,this.check()}copy(e){return this[0]=e[0],this[1]=e[1],this[2]=e[2],this.check()}fromObject(e){return ut.debug&&(ot(e.x),ot(e.y),ot(e.z)),this[0]=e.x,this[1]=e.y,this[2]=e.z,this.check()}toObject(e){return e.x=this[0],e.y=this[1],e.z=this[2],e}get ELEMENTS(){return 3}get z(){return this[2]}set z(e){this[2]=ot(e)}angle(e){return HP(this,e)}cross(e){return UP(this,this,e),this.check()}rotateX({radians:e,origin:n=Su}){return zP(this,this,n,e),this.check()}rotateY({radians:e,origin:n=Su}){return jP(this,this,n,e),this.check()}rotateZ({radians:e,origin:n=Su}){return GP(this,this,n,e),this.check()}transform(e){return this.transformAsPoint(e)}transformAsPoint(e){return m_(this,this,e),this.check()}transformAsVector(e){return p_(this,this,e),this.check()}transformByMatrix3(e){return BP(this,this,e),this.check()}transformByMatrix2(e){return IP(this,this,e),this.check()}transformByQuaternion(e){return VP(this,this,e),this.check()}}class XP extends f_{toString(){let e="[";if(ut.printRowMajor){e+="row-major:";for(let n=0;n<this.RANK;++n)for(let r=0;r<this.RANK;++r)e+=" ".concat(this[r*this.RANK+n])}else{e+="column-major:";for(let n=0;n<this.ELEMENTS;++n)e+=" ".concat(this[n])}return e+="]",e}getElementIndex(e,n){return n*this.RANK+e}getElement(e,n){return this[n*this.RANK+e]}setElement(e,n,r){return this[n*this.RANK+e]=ot(r),this}getColumn(e,n=new Array(this.RANK).fill(-0)){const r=e*this.RANK;for(let i=0;i<this.RANK;++i)n[i]=this[r+i];return n}setColumn(e,n){const r=e*this.RANK;for(let i=0;i<this.RANK;++i)this[r+i]=n[i];return this}}function YP(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function $P(t,e){if(t===e){var n=e[1],r=e[2],i=e[3],s=e[6],o=e[7],a=e[11];t[1]=e[4],t[2]=e[8],t[3]=e[12],t[4]=n,t[6]=e[9],t[7]=e[13],t[8]=r,t[9]=s,t[11]=e[14],t[12]=i,t[13]=o,t[14]=a}else t[0]=e[0],t[1]=e[4],t[2]=e[8],t[3]=e[12],t[4]=e[1],t[5]=e[5],t[6]=e[9],t[7]=e[13],t[8]=e[2],t[9]=e[6],t[10]=e[10],t[11]=e[14],t[12]=e[3],t[13]=e[7],t[14]=e[11],t[15]=e[15];return t}function Wc(t,e){var n=e[0],r=e[1],i=e[2],s=e[3],o=e[4],a=e[5],l=e[6],u=e[7],c=e[8],h=e[9],f=e[10],g=e[11],w=e[12],E=e[13],T=e[14],y=e[15],m=n*a-r*o,_=n*l-i*o,S=n*u-s*o,A=r*l-i*a,P=r*u-s*a,L=i*u-s*l,C=c*E-h*w,R=c*T-f*w,M=c*y-g*w,O=h*T-f*E,D=h*y-g*E,G=f*y-g*T,V=m*G-_*D+S*O+A*M-P*R+L*C;return V?(V=1/V,t[0]=(a*G-l*D+u*O)*V,t[1]=(i*D-r*G-s*O)*V,t[2]=(E*L-T*P+y*A)*V,t[3]=(f*P-h*L-g*A)*V,t[4]=(l*M-o*G-u*R)*V,t[5]=(n*G-i*M+s*R)*V,t[6]=(T*S-w*L-y*_)*V,t[7]=(c*L-f*S+g*_)*V,t[8]=(o*D-a*M+u*C)*V,t[9]=(r*M-n*D-s*C)*V,t[10]=(w*P-E*S+y*m)*V,t[11]=(h*S-c*P-g*m)*V,t[12]=(a*R-o*O-l*C)*V,t[13]=(n*O-r*R+i*C)*V,t[14]=(E*_-w*A-T*m)*V,t[15]=(c*A-h*_+f*m)*V,t):null}function qP(t){var e=t[0],n=t[1],r=t[2],i=t[3],s=t[4],o=t[5],a=t[6],l=t[7],u=t[8],c=t[9],h=t[10],f=t[11],g=t[12],w=t[13],E=t[14],T=t[15],y=e*o-n*s,m=e*a-r*s,_=e*l-i*s,S=n*a-r*o,A=n*l-i*o,P=r*l-i*a,L=u*w-c*g,C=u*E-h*g,R=u*T-f*g,M=c*E-h*w,O=c*T-f*w,D=h*T-f*E;return y*D-m*O+_*M+S*R-A*C+P*L}function dr(t,e,n){var r=e[0],i=e[1],s=e[2],o=e[3],a=e[4],l=e[5],u=e[6],c=e[7],h=e[8],f=e[9],g=e[10],w=e[11],E=e[12],T=e[13],y=e[14],m=e[15],_=n[0],S=n[1],A=n[2],P=n[3];return t[0]=_*r+S*a+A*h+P*E,t[1]=_*i+S*l+A*f+P*T,t[2]=_*s+S*u+A*g+P*y,t[3]=_*o+S*c+A*w+P*m,_=n[4],S=n[5],A=n[6],P=n[7],t[4]=_*r+S*a+A*h+P*E,t[5]=_*i+S*l+A*f+P*T,t[6]=_*s+S*u+A*g+P*y,t[7]=_*o+S*c+A*w+P*m,_=n[8],S=n[9],A=n[10],P=n[11],t[8]=_*r+S*a+A*h+P*E,t[9]=_*i+S*l+A*f+P*T,t[10]=_*s+S*u+A*g+P*y,t[11]=_*o+S*c+A*w+P*m,_=n[12],S=n[13],A=n[14],P=n[15],t[12]=_*r+S*a+A*h+P*E,t[13]=_*i+S*l+A*f+P*T,t[14]=_*s+S*u+A*g+P*y,t[15]=_*o+S*c+A*w+P*m,t}function Ua(t,e,n){var r=n[0],i=n[1],s=n[2],o,a,l,u,c,h,f,g,w,E,T,y;return e===t?(t[12]=e[0]*r+e[4]*i+e[8]*s+e[12],t[13]=e[1]*r+e[5]*i+e[9]*s+e[13],t[14]=e[2]*r+e[6]*i+e[10]*s+e[14],t[15]=e[3]*r+e[7]*i+e[11]*s+e[15]):(o=e[0],a=e[1],l=e[2],u=e[3],c=e[4],h=e[5],f=e[6],g=e[7],w=e[8],E=e[9],T=e[10],y=e[11],t[0]=o,t[1]=a,t[2]=l,t[3]=u,t[4]=c,t[5]=h,t[6]=f,t[7]=g,t[8]=w,t[9]=E,t[10]=T,t[11]=y,t[12]=o*r+c*i+w*s+e[12],t[13]=a*r+h*i+E*s+e[13],t[14]=l*r+f*i+T*s+e[14],t[15]=u*r+g*i+y*s+e[15]),t}function pf(t,e,n){var r=n[0],i=n[1],s=n[2];return t[0]=e[0]*r,t[1]=e[1]*r,t[2]=e[2]*r,t[3]=e[3]*r,t[4]=e[4]*i,t[5]=e[5]*i,t[6]=e[6]*i,t[7]=e[7]*i,t[8]=e[8]*s,t[9]=e[9]*s,t[10]=e[10]*s,t[11]=e[11]*s,t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t}function ZP(t,e,n,r){var i=r[0],s=r[1],o=r[2],a=Math.hypot(i,s,o),l,u,c,h,f,g,w,E,T,y,m,_,S,A,P,L,C,R,M,O,D,G,V,K;return a<na?null:(a=1/a,i*=a,s*=a,o*=a,l=Math.sin(n),u=Math.cos(n),c=1-u,h=e[0],f=e[1],g=e[2],w=e[3],E=e[4],T=e[5],y=e[6],m=e[7],_=e[8],S=e[9],A=e[10],P=e[11],L=i*i*c+u,C=s*i*c+o*l,R=o*i*c-s*l,M=i*s*c-o*l,O=s*s*c+u,D=o*s*c+i*l,G=i*o*c+s*l,V=s*o*c-i*l,K=o*o*c+u,t[0]=h*L+E*C+_*R,t[1]=f*L+T*C+S*R,t[2]=g*L+y*C+A*R,t[3]=w*L+m*C+P*R,t[4]=h*M+E*O+_*D,t[5]=f*M+T*O+S*D,t[6]=g*M+y*O+A*D,t[7]=w*M+m*O+P*D,t[8]=h*G+E*V+_*K,t[9]=f*G+T*V+S*K,t[10]=g*G+y*V+A*K,t[11]=w*G+m*V+P*K,e!==t&&(t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t)}function y_(t,e,n){var r=Math.sin(n),i=Math.cos(n),s=e[4],o=e[5],a=e[6],l=e[7],u=e[8],c=e[9],h=e[10],f=e[11];return e!==t&&(t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[4]=s*i+u*r,t[5]=o*i+c*r,t[6]=a*i+h*r,t[7]=l*i+f*r,t[8]=u*i-s*r,t[9]=c*i-o*r,t[10]=h*i-a*r,t[11]=f*i-l*r,t}function QP(t,e,n){var r=Math.sin(n),i=Math.cos(n),s=e[0],o=e[1],a=e[2],l=e[3],u=e[8],c=e[9],h=e[10],f=e[11];return e!==t&&(t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[0]=s*i-u*r,t[1]=o*i-c*r,t[2]=a*i-h*r,t[3]=l*i-f*r,t[8]=s*r+u*i,t[9]=o*r+c*i,t[10]=a*r+h*i,t[11]=l*r+f*i,t}function __(t,e,n){var r=Math.sin(n),i=Math.cos(n),s=e[0],o=e[1],a=e[2],l=e[3],u=e[4],c=e[5],h=e[6],f=e[7];return e!==t&&(t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[0]=s*i+u*r,t[1]=o*i+c*r,t[2]=a*i+h*r,t[3]=l*i+f*r,t[4]=u*i-s*r,t[5]=c*i-o*r,t[6]=h*i-a*r,t[7]=f*i-l*r,t}function KP(t,e){var n=e[0],r=e[1],i=e[2],s=e[3],o=n+n,a=r+r,l=i+i,u=n*o,c=r*o,h=r*a,f=i*o,g=i*a,w=i*l,E=s*o,T=s*a,y=s*l;return t[0]=1-h-w,t[1]=c+y,t[2]=f-T,t[3]=0,t[4]=c-y,t[5]=1-u-w,t[6]=g+E,t[7]=0,t[8]=f+T,t[9]=g-E,t[10]=1-u-h,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function JP(t,e,n,r,i,s,o){var a=1/(n-e),l=1/(i-r),u=1/(s-o);return t[0]=s*2*a,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=s*2*l,t[6]=0,t[7]=0,t[8]=(n+e)*a,t[9]=(i+r)*l,t[10]=(o+s)*u,t[11]=-1,t[12]=0,t[13]=0,t[14]=o*s*2*u,t[15]=0,t}function e2(t,e,n,r,i){var s=1/Math.tan(e/2),o;return t[0]=s/n,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=s,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[11]=-1,t[12]=0,t[13]=0,t[15]=0,i!=null&&i!==1/0?(o=1/(r-i),t[10]=(i+r)*o,t[14]=2*i*r*o):(t[10]=-1,t[14]=-2*r),t}var t2=e2;function n2(t,e,n,r,i,s,o){var a=1/(e-n),l=1/(r-i),u=1/(s-o);return t[0]=-2*a,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=-2*l,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=2*u,t[11]=0,t[12]=(e+n)*a,t[13]=(i+r)*l,t[14]=(o+s)*u,t[15]=1,t}var r2=n2;function i2(t,e,n,r){var i,s,o,a,l,u,c,h,f,g,w=e[0],E=e[1],T=e[2],y=r[0],m=r[1],_=r[2],S=n[0],A=n[1],P=n[2];return Math.abs(w-S)<na&&Math.abs(E-A)<na&&Math.abs(T-P)<na?YP(t):(c=w-S,h=E-A,f=T-P,g=1/Math.hypot(c,h,f),c*=g,h*=g,f*=g,i=m*f-_*h,s=_*c-y*f,o=y*h-m*c,g=Math.hypot(i,s,o),g?(g=1/g,i*=g,s*=g,o*=g):(i=0,s=0,o=0),a=h*o-f*s,l=f*i-c*o,u=c*s-h*i,g=Math.hypot(a,l,u),g?(g=1/g,a*=g,l*=g,u*=g):(a=0,l=0,u=0),t[0]=i,t[1]=a,t[2]=c,t[3]=0,t[4]=s,t[5]=l,t[6]=h,t[7]=0,t[8]=o,t[9]=u,t[10]=f,t[11]=0,t[12]=-(i*w+s*E+o*T),t[13]=-(a*w+l*E+u*T),t[14]=-(c*w+h*E+f*T),t[15]=1,t)}function s2(){var t=new _i(4);return _i!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0,t[3]=0),t}function o2(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t[3]=e[3]*n,t}function qs(t,e,n){var r=e[0],i=e[1],s=e[2],o=e[3];return t[0]=n[0]*r+n[4]*i+n[8]*s+n[12]*o,t[1]=n[1]*r+n[5]*i+n[9]*s+n[13]*o,t[2]=n[2]*r+n[6]*i+n[10]*s+n[14]*o,t[3]=n[3]*r+n[7]*i+n[11]*s+n[15]*o,t}(function(){var t=s2();return function(e,n,r,i,s,o){var a,l;for(n||(n=4),r||(r=0),i?l=Math.min(i*n+r,e.length):l=e.length,a=r;a<l;a+=n)t[0]=e[a],t[1]=e[a+1],t[2]=e[a+2],t[3]=e[a+3],s(t,t,o),e[a]=t[0],e[a+1]=t[1],e[a+2]=t[2],e[a+3]=t[3];return e}})();var Xc;(function(t){t[t.COL0ROW0=0]="COL0ROW0",t[t.COL0ROW1=1]="COL0ROW1",t[t.COL0ROW2=2]="COL0ROW2",t[t.COL0ROW3=3]="COL0ROW3",t[t.COL1ROW0=4]="COL1ROW0",t[t.COL1ROW1=5]="COL1ROW1",t[t.COL1ROW2=6]="COL1ROW2",t[t.COL1ROW3=7]="COL1ROW3",t[t.COL2ROW0=8]="COL2ROW0",t[t.COL2ROW1=9]="COL2ROW1",t[t.COL2ROW2=10]="COL2ROW2",t[t.COL2ROW3=11]="COL2ROW3",t[t.COL3ROW0=12]="COL3ROW0",t[t.COL3ROW1=13]="COL3ROW1",t[t.COL3ROW2=14]="COL3ROW2",t[t.COL3ROW3=15]="COL3ROW3"})(Xc||(Xc={}));const a2=45*Math.PI/180,l2=1,Au=.1,xu=500,u2=Object.freeze([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]);class Pt extends XP{static get IDENTITY(){return h2()}static get ZERO(){return c2()}get ELEMENTS(){return 16}get RANK(){return 4}get INDICES(){return Xc}constructor(e){super(-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0),arguments.length===1&&Array.isArray(e)?this.copy(e):this.identity()}copy(e){return this[0]=e[0],this[1]=e[1],this[2]=e[2],this[3]=e[3],this[4]=e[4],this[5]=e[5],this[6]=e[6],this[7]=e[7],this[8]=e[8],this[9]=e[9],this[10]=e[10],this[11]=e[11],this[12]=e[12],this[13]=e[13],this[14]=e[14],this[15]=e[15],this.check()}set(e,n,r,i,s,o,a,l,u,c,h,f,g,w,E,T){return this[0]=e,this[1]=n,this[2]=r,this[3]=i,this[4]=s,this[5]=o,this[6]=a,this[7]=l,this[8]=u,this[9]=c,this[10]=h,this[11]=f,this[12]=g,this[13]=w,this[14]=E,this[15]=T,this.check()}setRowMajor(e,n,r,i,s,o,a,l,u,c,h,f,g,w,E,T){return this[0]=e,this[1]=s,this[2]=u,this[3]=g,this[4]=n,this[5]=o,this[6]=c,this[7]=w,this[8]=r,this[9]=a,this[10]=h,this[11]=E,this[12]=i,this[13]=l,this[14]=f,this[15]=T,this.check()}toRowMajor(e){return e[0]=this[0],e[1]=this[4],e[2]=this[8],e[3]=this[12],e[4]=this[1],e[5]=this[5],e[6]=this[9],e[7]=this[13],e[8]=this[2],e[9]=this[6],e[10]=this[10],e[11]=this[14],e[12]=this[3],e[13]=this[7],e[14]=this[11],e[15]=this[15],e}identity(){return this.copy(u2)}fromObject(e){return this.check()}fromQuaternion(e){return KP(this,e),this.check()}frustum(e){const{left:n,right:r,bottom:i,top:s,near:o=Au,far:a=xu}=e;return a===1/0?f2(this,n,r,i,s,o):JP(this,n,r,i,s,o,a),this.check()}lookAt(e){const{eye:n,center:r=[0,0,0],up:i=[0,1,0]}=e;return i2(this,n,r,i),this.check()}ortho(e){const{left:n,right:r,bottom:i,top:s,near:o=Au,far:a=xu}=e;return r2(this,n,r,i,s,o,a),this.check()}orthographic(e){const{fovy:n=a2,aspect:r=l2,focalDistance:i=1,near:s=Au,far:o=xu}=e;cp(n);const a=n/2,l=i*Math.tan(a),u=l*r;return this.ortho({left:-u,right:u,bottom:-l,top:l,near:s,far:o})}perspective(e){const{fovy:n=45*Math.PI/180,aspect:r=1,near:i=.1,far:s=500}=e;return cp(n),t2(this,n,r,i,s),this.check()}determinant(){return qP(this)}getScale(e=[-0,-0,-0]){return e[0]=Math.sqrt(this[0]*this[0]+this[1]*this[1]+this[2]*this[2]),e[1]=Math.sqrt(this[4]*this[4]+this[5]*this[5]+this[6]*this[6]),e[2]=Math.sqrt(this[8]*this[8]+this[9]*this[9]+this[10]*this[10]),e}getTranslation(e=[-0,-0,-0]){return e[0]=this[12],e[1]=this[13],e[2]=this[14],e}getRotation(e,n){e=e||[-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0],n=n||[-0,-0,-0];const r=this.getScale(n),i=1/r[0],s=1/r[1],o=1/r[2];return e[0]=this[0]*i,e[1]=this[1]*s,e[2]=this[2]*o,e[3]=0,e[4]=this[4]*i,e[5]=this[5]*s,e[6]=this[6]*o,e[7]=0,e[8]=this[8]*i,e[9]=this[9]*s,e[10]=this[10]*o,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}getRotationMatrix3(e,n){e=e||[-0,-0,-0,-0,-0,-0,-0,-0,-0],n=n||[-0,-0,-0];const r=this.getScale(n),i=1/r[0],s=1/r[1],o=1/r[2];return e[0]=this[0]*i,e[1]=this[1]*s,e[2]=this[2]*o,e[3]=this[4]*i,e[4]=this[5]*s,e[5]=this[6]*o,e[6]=this[8]*i,e[7]=this[9]*s,e[8]=this[10]*o,e}transpose(){return $P(this,this),this.check()}invert(){return Wc(this,this),this.check()}multiplyLeft(e){return dr(this,e,this),this.check()}multiplyRight(e){return dr(this,this,e),this.check()}rotateX(e){return y_(this,this,e),this.check()}rotateY(e){return QP(this,this,e),this.check()}rotateZ(e){return __(this,this,e),this.check()}rotateXYZ(e){return this.rotateX(e[0]).rotateY(e[1]).rotateZ(e[2])}rotateAxis(e,n){return ZP(this,this,e,n),this.check()}scale(e){return pf(this,this,Array.isArray(e)?e:[e,e,e]),this.check()}translate(e){return Ua(this,this,e),this.check()}transform(e,n){return e.length===4?(n=qs(n||[-0,-0,-0,-0],e,this),bu(n,4),n):this.transformAsPoint(e,n)}transformAsPoint(e,n){const{length:r}=e;let i;switch(r){case 2:i=MP(n||[-0,-0],e,this);break;case 3:i=m_(n||[-0,-0,-0],e,this);break;default:throw new Error("Illegal vector")}return bu(i,e.length),i}transformAsVector(e,n){let r;switch(e.length){case 2:r=kP(n||[-0,-0],e,this);break;case 3:r=p_(n||[-0,-0,-0],e,this);break;default:throw new Error("Illegal vector")}return bu(r,e.length),r}transformPoint(e,n){return this.transformAsPoint(e,n)}transformVector(e,n){return this.transformAsPoint(e,n)}transformDirection(e,n){return this.transformAsVector(e,n)}makeRotationX(e){return this.identity().rotateX(e)}makeTranslation(e,n,r){return this.identity().translate([e,n,r])}}let No,Do;function c2(){return No||(No=new Pt([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),Object.freeze(No)),No}function h2(){return Do||(Do=new Pt,Object.freeze(Do)),Do}function cp(t){if(t>Math.PI*2)throw Error("expected radians")}function f2(t,e,n,r,i,s){const o=2*s/(n-e),a=2*s/(i-r),l=(n+e)/(n-e),u=(i+r)/(i-r),c=-1,h=-1,f=-2*s;return t[0]=o,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=a,t[6]=0,t[7]=0,t[8]=l,t[9]=u,t[10]=c,t[11]=h,t[12]=0,t[13]=0,t[14]=f,t[15]=0,t}const hp=`#if (defined(SHADER_TYPE_FRAGMENT) && defined(LIGHTING_FRAGMENT)) || (defined(SHADER_TYPE_VERTEX) && defined(LIGHTING_VERTEX))

struct AmbientLight {
 vec3 color;
};

struct PointLight {
 vec3 color;
 vec3 position;
 vec3 attenuation;
};

struct DirectionalLight {
  vec3 color;
  vec3 direction;
};

uniform AmbientLight lighting_uAmbientLight;
uniform PointLight lighting_uPointLight[MAX_LIGHTS];
uniform DirectionalLight lighting_uDirectionalLight[MAX_LIGHTS];
uniform int lighting_uPointLightCount;
uniform int lighting_uDirectionalLightCount;

uniform bool lighting_uEnabled;

float getPointLightAttenuation(PointLight pointLight, float distance) {
  return pointLight.attenuation.x
       + pointLight.attenuation.y * distance
       + pointLight.attenuation.z * distance * distance;
}

#endif
`,d2={lightSources:{}};function Pu(){let{color:t=[0,0,0],intensity:e=1}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return t.map(n=>n*e/255)}function g2(t){let{ambientLight:e,pointLights:n=[],directionalLights:r=[]}=t;const i={};return e?i["lighting_uAmbientLight.color"]=Pu(e):i["lighting_uAmbientLight.color"]=[0,0,0],n.forEach((s,o)=>{i["lighting_uPointLight[".concat(o,"].color")]=Pu(s),i["lighting_uPointLight[".concat(o,"].position")]=s.position,i["lighting_uPointLight[".concat(o,"].attenuation")]=s.attenuation||[1,0,0]}),i.lighting_uPointLightCount=n.length,r.forEach((s,o)=>{i["lighting_uDirectionalLight[".concat(o,"].color")]=Pu(s),i["lighting_uDirectionalLight[".concat(o,"].direction")]=s.direction}),i.lighting_uDirectionalLightCount=r.length,i}function v_(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:d2;if("lightSources"in t){const{ambientLight:e,pointLights:n,directionalLights:r}=t.lightSources||{};return e||n&&n.length>0||r&&r.length>0?Object.assign({},g2({ambientLight:e,pointLights:n,directionalLights:r}),{lighting_uEnabled:!0}):{lighting_uEnabled:!1}}if("lights"in t){const e={pointLights:[],directionalLights:[]};for(const n of t.lights||[])switch(n.type){case"ambient":e.ambientLight=n;break;case"directional":e.directionalLights.push(n);break;case"point":e.pointLights.push(n);break}return v_({lightSources:e})}return{}}const w_={name:"lights",vs:hp,fs:hp,getUniforms:v_,defines:{MAX_LIGHTS:3}},p2=new Uint8Array([0,255,255,255]),m2={pickingSelectedColor:null,pickingHighlightColor:p2,pickingActive:!1,pickingAttribute:!1};function y2(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:m2;const e={};if(t.pickingSelectedColor!==void 0)if(!t.pickingSelectedColor)e.picking_uSelectedColorValid=0;else{const n=t.pickingSelectedColor.slice(0,3);e.picking_uSelectedColorValid=1,e.picking_uSelectedColor=n}if(t.pickingHighlightColor){const n=Array.from(t.pickingHighlightColor,r=>r/255);Number.isFinite(n[3])||(n[3]=1),e.picking_uHighlightColor=n}return t.pickingActive!==void 0&&(e.picking_uActive=Boolean(t.pickingActive),e.picking_uAttribute=Boolean(t.pickingAttribute)),e}const _2=`uniform bool picking_uActive;
uniform bool picking_uAttribute;
uniform vec3 picking_uSelectedColor;
uniform bool picking_uSelectedColorValid;

out vec4 picking_vRGBcolor_Avalid;

const float COLOR_SCALE = 1. / 255.;

bool picking_isColorValid(vec3 color) {
  return dot(color, vec3(1.0)) > 0.001;
}

bool isVertexPicked(vec3 vertexColor) {
  return
    picking_uSelectedColorValid &&
    !picking_isColorValid(abs(vertexColor - picking_uSelectedColor));
}

void picking_setPickingColor(vec3 pickingColor) {
  if (picking_uActive) {
    picking_vRGBcolor_Avalid.a = float(picking_isColorValid(pickingColor));

    if (!picking_uAttribute) {
      picking_vRGBcolor_Avalid.rgb = pickingColor * COLOR_SCALE;
    }
  } else {
    picking_vRGBcolor_Avalid.a = float(isVertexPicked(pickingColor));
  }
}

void picking_setPickingAttribute(float value) {
  if (picking_uAttribute) {
    picking_vRGBcolor_Avalid.r = value;
  }
}
void picking_setPickingAttribute(vec2 value) {
  if (picking_uAttribute) {
    picking_vRGBcolor_Avalid.rg = value;
  }
}
void picking_setPickingAttribute(vec3 value) {
  if (picking_uAttribute) {
    picking_vRGBcolor_Avalid.rgb = value;
  }
}
`,v2=`uniform bool picking_uActive;
uniform vec3 picking_uSelectedColor;
uniform vec4 picking_uHighlightColor;

in vec4 picking_vRGBcolor_Avalid;
vec4 picking_filterHighlightColor(vec4 color) {
  if (picking_uActive) {
    return color;
  }
  bool selected = bool(picking_vRGBcolor_Avalid.a);

  if (selected) {
    float highLightAlpha = picking_uHighlightColor.a;
    float blendedAlpha = highLightAlpha + color.a * (1.0 - highLightAlpha);
    float highLightRatio = highLightAlpha / blendedAlpha;

    vec3 blendedRGB = mix(color.rgb, picking_uHighlightColor.rgb, highLightRatio);
    return vec4(blendedRGB, blendedAlpha);
  } else {
    return color;
  }
}
vec4 picking_filterPickingColor(vec4 color) {
  if (picking_uActive) {
    if (picking_vRGBcolor_Avalid.a == 0.0) {
      discard;
    }
    return picking_vRGBcolor_Avalid;
  }
  return color;
}
vec4 picking_filterColor(vec4 color) {
  vec4 highightColor = picking_filterHighlightColor(color);
  return picking_filterPickingColor(highightColor);
}

`,w2={name:"picking",vs:_2,fs:v2,getUniforms:y2},E_=`
uniform float lighting_uAmbient;
uniform float lighting_uDiffuse;
uniform float lighting_uShininess;
uniform vec3  lighting_uSpecularColor;

vec3 lighting_getLightColor(vec3 surfaceColor, vec3 light_direction, vec3 view_direction, vec3 normal_worldspace, vec3 color) {
    vec3 halfway_direction = normalize(light_direction + view_direction);
    float lambertian = dot(light_direction, normal_worldspace);
    float specular = 0.0;
    if (lambertian > 0.0) {
      float specular_angle = max(dot(normal_worldspace, halfway_direction), 0.0);
      specular = pow(specular_angle, lighting_uShininess);
    }
    lambertian = max(lambertian, 0.0);
    return (lambertian * lighting_uDiffuse * surfaceColor + specular * lighting_uSpecularColor) * color;
}

vec3 lighting_getLightColor(vec3 surfaceColor, vec3 cameraPosition, vec3 position_worldspace, vec3 normal_worldspace) {
  vec3 lightColor = surfaceColor;

  if (lighting_uEnabled) {
    vec3 view_direction = normalize(cameraPosition - position_worldspace);
    lightColor = lighting_uAmbient * surfaceColor * lighting_uAmbientLight.color;

    for (int i = 0; i < MAX_LIGHTS; i++) {
      if (i >= lighting_uPointLightCount) {
        break;
      }
      PointLight pointLight = lighting_uPointLight[i];
      vec3 light_position_worldspace = pointLight.position;
      vec3 light_direction = normalize(light_position_worldspace - position_worldspace);
      lightColor += lighting_getLightColor(surfaceColor, light_direction, view_direction, normal_worldspace, pointLight.color);
    }

    for (int i = 0; i < MAX_LIGHTS; i++) {
      if (i >= lighting_uDirectionalLightCount) {
        break;
      }
      DirectionalLight directionalLight = lighting_uDirectionalLight[i];
      lightColor += lighting_getLightColor(surfaceColor, -directionalLight.direction, view_direction, normal_worldspace, directionalLight.color);
    }
  }
  return lightColor;
}

vec3 lighting_getSpecularLightColor(vec3 cameraPosition, vec3 position_worldspace, vec3 normal_worldspace) {
  vec3 lightColor = vec3(0, 0, 0);
  vec3 surfaceColor = vec3(0, 0, 0);

  if (lighting_uEnabled) {
    vec3 view_direction = normalize(cameraPosition - position_worldspace);

    for (int i = 0; i < MAX_LIGHTS; i++) {
      if (i >= lighting_uPointLightCount) {
        break;
      }
      PointLight pointLight = lighting_uPointLight[i];
      vec3 light_position_worldspace = pointLight.position;
      vec3 light_direction = normalize(light_position_worldspace - position_worldspace);
      lightColor += lighting_getLightColor(surfaceColor, light_direction, view_direction, normal_worldspace, pointLight.color);
    }

    for (int i = 0; i < MAX_LIGHTS; i++) {
      if (i >= lighting_uDirectionalLightCount) {
        break;
      }
      DirectionalLight directionalLight = lighting_uDirectionalLight[i];
      lightColor += lighting_getLightColor(surfaceColor, -directionalLight.direction, view_direction, normal_worldspace, directionalLight.color);
    }
  }
  return lightColor;
}
`,E2={};function T2(t){const{ambient:e=.35,diffuse:n=.6,shininess:r=32,specularColor:i=[30,30,30]}=t;return{lighting_uAmbient:e,lighting_uDiffuse:n,lighting_uShininess:r,lighting_uSpecularColor:i.map(s=>s/255)}}function T_(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:E2;if(!("material"in t))return{};const{material:e}=t;return e?T2(e):{lighting_uEnabled:!1}}const b2={name:"gouraud-lighting",dependencies:[w_],vs:E_,defines:{LIGHTING_VERTEX:1},getUniforms:T_},S2={name:"phong-lighting",dependencies:[w_],fs:E_,defines:{LIGHTING_FRAGMENT:1},getUniforms:T_},A2=`attribute float transform_elementID;
vec2 transform_getPixelSizeHalf(vec2 size) {
  return vec2(1.) / (2. * size);
}

vec2 transform_getPixelIndices(vec2 texSize, vec2 pixelSizeHalf) {
  float yIndex = floor((transform_elementID / texSize[0]) + pixelSizeHalf[1]);
  float xIndex = transform_elementID - (yIndex * texSize[0]);
  return vec2(xIndex, yIndex);
}
vec2 transform_getTexCoord(vec2 size) {
  vec2 pixelSizeHalf = transform_getPixelSizeHalf(size);
  vec2 indices = transform_getPixelIndices(size, pixelSizeHalf);
  vec2 coord = indices / size + pixelSizeHalf;
  return coord;
}
vec2 transform_getPos(vec2 size) {
  vec2 texCoord = transform_getTexCoord(size);
  vec2 pos = (texCoord * (2.0, 2.0)) - (1., 1.);
  return pos;
}
vec4 transform_getInput(sampler2D texSampler, vec2 size) {
  vec2 texCoord = transform_getTexCoord(size);
  vec4 textureColor = texture2D(texSampler, texCoord);
  return textureColor;
}
`,x2={name:"transform",vs:A2,fs:null};class Zs{static getDefaultProgramManager(e){return e.luma=e.luma||{},e.luma.defaultProgramManager=e.luma.defaultProgramManager||new Zs(e),e.luma.defaultProgramManager}constructor(e){this.gl=e,this._programCache={},this._getUniforms={},this._registeredModules={},this._hookFunctions=[],this._defaultModules=[],this._hashes={},this._hashCounter=0,this.stateHash=0,this._useCounts={}}addDefaultModule(e){this._defaultModules.find(n=>n.name===e.name)||this._defaultModules.push(e),this.stateHash++}removeDefaultModule(e){const n=typeof e=="string"?e:e.name;this._defaultModules=this._defaultModules.filter(r=>r.name!==n),this.stateHash++}addShaderHook(e,n){n&&(e=Object.assign(n,{hook:e})),this._hookFunctions.push(e),this.stateHash++}get(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{vs:n="",fs:r="",defines:i={},inject:s={},varyings:o=[],bufferMode:a=35981,transpileToGLSL100:l=!1}=e,u=this._getModuleList(e.modules),c=this._getHash(n),h=this._getHash(r),f=u.map(_=>this._getHash(_.name)).sort(),g=o.map(_=>this._getHash(_)),w=Object.keys(i).sort(),E=Object.keys(s).sort(),T=[],y=[];for(const _ of w)T.push(this._getHash(_)),T.push(this._getHash(i[_]));for(const _ of E)y.push(this._getHash(_)),y.push(this._getHash(s[_]));const m="".concat(c,"/").concat(h,"D").concat(T.join("/"),"M").concat(f.join("/"),"I").concat(y.join("/"),"V").concat(g.join("/"),"H").concat(this.stateHash,"B").concat(a).concat(l?"T":"");if(!this._programCache[m]){const _=uP(this.gl,{vs:n,fs:r,modules:u,inject:s,defines:i,hookFunctions:this._hookFunctions,transpileToGLSL100:l});this._programCache[m]=new n_(this.gl,{hash:m,vs:_.vs,fs:_.fs,varyings:o,bufferMode:a}),this._getUniforms[m]=_.getUniforms||(S=>{}),this._useCounts[m]=0}return this._useCounts[m]++,this._programCache[m]}getUniforms(e){return this._getUniforms[e.hash]||null}release(e){const n=e.hash;this._useCounts[n]--,this._useCounts[n]===0&&(this._programCache[n].delete(),delete this._programCache[n],delete this._getUniforms[n],delete this._useCounts[n])}_getHash(e){return this._hashes[e]===void 0&&(this._hashes[e]=this._hashCounter++),this._hashes[e]}_getModuleList(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];const n=new Array(this._defaultModules.length+e.length),r={};let i=0;for(let s=0,o=this._defaultModules.length;s<o;++s){const a=this._defaultModules[s],l=a.name;n[i++]=a,r[l]=!0}for(let s=0,o=e.length;s<o;++s){const a=e[s],l=a.name;r[l]||(n[i++]=a,r[l]=!0)}return n.length=i,n}}const P2={POSITION:"positions",NORMAL:"normals",COLOR_0:"colors",TEXCOORD_0:"texCoords",TEXCOORD_1:"texCoords1",TEXCOORD_2:"texCoords2"};function C2(t,e,n){const r={};let i=e.indices;for(const s in e.attributes){const o=e.attributes[s],a=L2(s,n);if(s==="indices")i=o;else if(o.constant)r[a]=o.value;else{const l=o.value,u={...o};delete u.value,r[a]=[new te(t,l),u],R2(s,u)}}if(i){const s=i.value||i;F(s instanceof Uint16Array||s instanceof Uint32Array,'attribute array for "indices" must be of integer type');const o={size:1,isIndexed:i.isIndexed===void 0?!0:i.isIndexed};r.indices=[new te(t,{data:s,target:34963}),o]}return r}function L2(t,e){const{attributeMap:n=P2}=e||{};return n&&n[t]||t}function R2(t,e){let n;switch(t){case"texCoords":case"texCoord1":case"texCoord2":case"texCoord3":n="uvs";break;case"vertices":case"positions":case"normals":case"pickingColors":n="vectors";break}switch(n){case"vectors":e.size=e.size||3;break;case"uvs":e.size=e.size||2;break}F(Number.isFinite(e.size),"attribute ".concat(t," needs size"))}const kr=2,M2=1e4,k2="Model needs drawMode and vertexCount",fp=()=>{},I2={};class b_{constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const{id:r=_n("model")}=n;F(dl(e)),this.id=r,this.gl=e,this.id=n.id||_n("Model"),this.lastLogTime=0,this.animated=!1,this.initialize(n)}initialize(e){this.props={},this.programManager=e.programManager||Zs.getDefaultProgramManager(this.gl),this._programManagerState=-1,this._managedProgram=!1;const{program:n=null,vs:r,fs:i,modules:s,defines:o,inject:a,varyings:l,bufferMode:u,transpileToGLSL100:c}=e;this.programProps={program:n,vs:r,fs:i,modules:s,defines:o,inject:a,varyings:l,bufferMode:u,transpileToGLSL100:c},this.program=null,this.vertexArray=null,this._programDirty=!0,this.userData={},this.needsRedraw=!0,this._attributes={},this.attributes={},this.uniforms={},this.pickable=!0,this._checkProgram(),this.setUniforms(Object.assign({},this.getModuleUniforms(e.moduleSettings))),this.drawMode=e.drawMode!==void 0?e.drawMode:4,this.vertexCount=e.vertexCount||0,this.geometryBuffers={},this.isInstanced=e.isInstanced||e.instanced||e.instanceCount>0,this._setModelProps(e),this.geometry={},F(this.drawMode!==void 0&&Number.isFinite(this.vertexCount),k2)}setProps(e){this._setModelProps(e)}delete(){for(const e in this._attributes)this._attributes[e]!==this.attributes[e]&&this._attributes[e].delete();this._managedProgram&&(this.programManager.release(this.program),this._managedProgram=!1),this.vertexArray.delete(),this._deleteGeometryBuffers()}getDrawMode(){return this.drawMode}getVertexCount(){return this.vertexCount}getInstanceCount(){return this.instanceCount}getAttributes(){return this.attributes}getProgram(){return this.program}setProgram(e){const{program:n,vs:r,fs:i,modules:s,defines:o,inject:a,varyings:l,bufferMode:u,transpileToGLSL100:c}=e;this.programProps={program:n,vs:r,fs:i,modules:s,defines:o,inject:a,varyings:l,bufferMode:u,transpileToGLSL100:c},this._programDirty=!0}getUniforms(){return this.uniforms}setDrawMode(e){return this.drawMode=e,this}setVertexCount(e){return F(Number.isFinite(e)),this.vertexCount=e,this}setInstanceCount(e){return F(Number.isFinite(e)),this.instanceCount=e,this}setGeometry(e){return this.drawMode=e.drawMode,this.vertexCount=e.getVertexCount(),this._deleteGeometryBuffers(),this.geometryBuffers=C2(this.gl,e),this.vertexArray.setAttributes(this.geometryBuffers),this}setAttributes(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(di(e))return this;const n={};for(const r in e){const i=e[r];n[r]=i.getValue?i.getValue():i}return this.vertexArray.setAttributes(n),this}setUniforms(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return Object.assign(this.uniforms,e),this}getModuleUniforms(e){this._checkProgram();const n=this.programManager.getUniforms(this.program);return n?n(e):{}}updateModuleSettings(e){const n=this.getModuleUniforms(e||{});return this.setUniforms(n)}clear(e){return hf(this.program.gl,e),this}draw(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this._checkProgram();const{moduleSettings:n=null,framebuffer:r,uniforms:i={},attributes:s={},transformFeedback:o=this.transformFeedback,parameters:a={},vertexArray:l=this.vertexArray}=e;this.setAttributes(s),this.updateModuleSettings(n),this.setUniforms(i);let u;z.priority>=kr&&(u=this._logDrawCallStart(kr));const c=this.vertexArray.getDrawParams(),{isIndexed:h=c.isIndexed,indexType:f=c.indexType,indexOffset:g=c.indexOffset,vertexArrayInstanced:w=c.isInstanced}=this.props;w&&!this.isInstanced&&z.warn("Found instanced attributes on non-instanced model",this.id)();const{isInstanced:E,instanceCount:T}=this,{onBeforeRender:y=fp,onAfterRender:m=fp}=this.props;y(),this.program.setUniforms(this.uniforms);const _=this.program.draw(Object.assign(I2,e,{logPriority:u,uniforms:null,framebuffer:r,parameters:a,drawMode:this.getDrawMode(),vertexCount:this.getVertexCount(),vertexArray:l,transformFeedback:o,isIndexed:h,indexType:f,isInstanced:E,instanceCount:T,offset:h?g:0}));return m(),z.priority>=kr&&this._logDrawCallEnd(u,l,r),_}transform(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{discard:n=!0,feedbackBuffers:r,unbindModels:i=[]}=e;let{parameters:s}=e;r&&this._setFeedbackBuffers(r),n&&(s=Object.assign({},s,{[35977]:n})),i.forEach(o=>o.vertexArray.unbindBuffers());try{this.draw(Object.assign({},e,{parameters:s}))}finally{i.forEach(o=>o.vertexArray.bindBuffers())}return this}render(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return z.warn("Model.render() is deprecated. Use Model.setUniforms() and Model.draw()")(),this.setUniforms(e).draw()}_setModelProps(e){Object.assign(this.props,e),"uniforms"in e&&this.setUniforms(e.uniforms),"pickable"in e&&(this.pickable=e.pickable),"instanceCount"in e&&(this.instanceCount=e.instanceCount),"geometry"in e&&this.setGeometry(e.geometry),"attributes"in e&&this.setAttributes(e.attributes),"_feedbackBuffers"in e&&this._setFeedbackBuffers(e._feedbackBuffers)}_checkProgram(){if(!(this._programDirty||this.programManager.stateHash!==this._programManagerState))return;let{program:n}=this.programProps;if(n)this._managedProgram=!1;else{const{vs:r,fs:i,modules:s,inject:o,defines:a,varyings:l,bufferMode:u,transpileToGLSL100:c}=this.programProps;n=this.programManager.get({vs:r,fs:i,modules:s,inject:o,defines:a,varyings:l,bufferMode:u,transpileToGLSL100:c}),this.program&&this._managedProgram&&this.programManager.release(this.program),this._programManagerState=this.programManager.stateHash,this._managedProgram=!0}F(n instanceof n_,"Model needs a program"),this._programDirty=!1,n!==this.program&&(this.program=n,this.vertexArray?this.vertexArray.setProps({program:this.program,attributes:this.vertexArray.attributes}):this.vertexArray=new Sx(this.gl,{program:this.program}),this.setUniforms(Object.assign({},this.getModuleUniforms())))}_deleteGeometryBuffers(){for(const e in this.geometryBuffers){const n=this.geometryBuffers[e][0]||this.geometryBuffers[e];n instanceof te&&n.delete()}}_setAnimationProps(e){this.animated&&F(e,"Model.draw(): animated uniforms but no animationProps")}_setFeedbackBuffers(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(di(e))return this;const{gl:n}=this.program;return this.transformFeedback=this.transformFeedback||new r_(n,{program:this.program}),this.transformFeedback.setBuffers(e),this}_logDrawCallStart(e){const n=e>3?0:M2;if(!(Date.now()-this.lastLogTime<n))return this.lastLogTime=Date.now(),z.group(kr,">>> DRAWING MODEL ".concat(this.id),{collapsed:z.level<=2})(),e}_logDrawCallEnd(e,n,r,i){if(e===void 0)return;const s=Px({vertexArray:n,header:"".concat(this.id," attributes"),attributes:this._attributes}),{table:o,unusedTable:a,unusedCount:l}=Kg({header:"".concat(this.id," uniforms"),program:this.program,uniforms:Object.assign({},this.program.uniforms,r)}),{table:u,count:c}=Kg({header:"".concat(this.id," uniforms"),program:this.program,uniforms:Object.assign({},this.program.uniforms,r),undefinedOnly:!0});c>0&&z.log("MISSING UNIFORMS",Object.keys(u))(),l>0&&z.log("UNUSED UNIFORMS",Object.keys(a))();const h=Lx(this.vertexArray.configuration);z.table(e,s)(),z.table(e,o)(),z.table(e+1,h)(),i&&i.log({logLevel:kr,message:"Rendered to ".concat(i.id)}),z.groupEnd(kr)()}}class O2{constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};this.gl=e,this.currentIndex=0,this.feedbackMap={},this.varyings=null,this.bindings=[],this.resources={},this._initialize(n),Object.seal(this)}setupResources(e){for(const n of this.bindings)this._setupTransformFeedback(n,e)}updateModelProps(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{varyings:n}=this;return n.length>0&&(e=Object.assign({},e,{varyings:n})),e}getDrawOptions(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const n=this.bindings[this.currentIndex],{sourceBuffers:r,transformFeedback:i}=n;return{attributes:Object.assign({},r,e.attributes),transformFeedback:i}}swap(){return this.feedbackMap?(this.currentIndex=this._getNextIndex(),!0):!1}update(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this._setupBuffers(e)}getBuffer(e){const{feedbackBuffers:n}=this.bindings[this.currentIndex],r=e?n[e]:null;return r?r instanceof te?r:r.buffer:null}getData(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{varyingName:n}=e,r=this.getBuffer(n);return r?r.getData():null}delete(){for(const e in this.resources)this.resources[e].delete()}_initialize(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this._setupBuffers(e),this.varyings=e.varyings||Object.keys(this.bindings[this.currentIndex].feedbackBuffers),this.varyings.length>0&&F(Y(this.gl))}_getFeedbackBuffers(e){const{sourceBuffers:n={}}=e,r={};if(this.bindings[this.currentIndex]&&Object.assign(r,this.bindings[this.currentIndex].feedbackBuffers),this.feedbackMap)for(const i in this.feedbackMap){const s=this.feedbackMap[i];i in n&&(r[s]=i)}Object.assign(r,e.feedbackBuffers);for(const i in r){const s=r[i];if(typeof s=="string"){const o=n[s],{byteLength:a,usage:l,accessor:u}=o;r[i]=this._createNewBuffer(i,{byteLength:a,usage:l,accessor:u})}}return r}_setupBuffers(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{sourceBuffers:n=null}=e;Object.assign(this.feedbackMap,e.feedbackMap);const r=this._getFeedbackBuffers(e);this._updateBindings({sourceBuffers:n,feedbackBuffers:r})}_setupTransformFeedback(e,n){let{model:r}=n;const{program:i}=r;e.transformFeedback=new r_(this.gl,{program:i,buffers:e.feedbackBuffers})}_updateBindings(e){if(this.bindings[this.currentIndex]=this._updateBinding(this.bindings[this.currentIndex],e),this.feedbackMap){const{sourceBuffers:n,feedbackBuffers:r}=this._swapBuffers(this.bindings[this.currentIndex]),i=this._getNextIndex();this.bindings[i]=this._updateBinding(this.bindings[i],{sourceBuffers:n,feedbackBuffers:r})}}_updateBinding(e,n){return e?(Object.assign(e.sourceBuffers,n.sourceBuffers),Object.assign(e.feedbackBuffers,n.feedbackBuffers),e.transformFeedback&&e.transformFeedback.setBuffers(e.feedbackBuffers),e):{sourceBuffers:Object.assign({},n.sourceBuffers),feedbackBuffers:Object.assign({},n.feedbackBuffers)}}_swapBuffers(e){if(!this.feedbackMap)return null;const n=Object.assign({},e.sourceBuffers),r=Object.assign({},e.feedbackBuffers);for(const i in this.feedbackMap){const s=this.feedbackMap[i];n[i]=e.feedbackBuffers[s],r[s]=e.sourceBuffers[i],F(r[s]instanceof te)}return{sourceBuffers:n,feedbackBuffers:r}}_createNewBuffer(e,n){const r=new te(this.gl,n);return this.resources[e]&&this.resources[e].delete(),this.resources[e]=r,r}_getNextIndex(){return(this.currentIndex+1)%2}}const N2="transform_uSampler_",Ba="transform_uSize_",dp="transform_position";function D2(t){let{vs:e,sourceTextureMap:n,targetTextureVarying:r,targetTexture:i}=t,o=Object.keys(n).length,a=null;const l={};let u=e,c={};if(o>0||r){const h=u.split(`
`),f=h.slice();if(h.forEach((g,w,E)=>{if(o>0){const T=z2(g,n);if(T){const{updatedLine:y,inject:m}=T;f[w]=y,c=jc([c,m]),Object.assign(l,T.samplerTextureMap),o--}}r&&!a&&(a=V2(g,r))}),r){F(i);const g="".concat(Ba).concat(r),w="uniform vec2 ".concat(g,`;
`),E="     vec2 ".concat(dp," = transform_getPos(").concat(g,`);
     gl_Position = vec4(`).concat(dp,`, 0, 1.);
`);c=jc([c,{"vs:#decl":w,"vs:#main-start":E}])}u=f.join(`
`)}return{vs:u,targetTextureType:a,inject:c,samplerTextureMap:l}}function F2(t){let{sourceTextureMap:e,targetTextureVarying:n,targetTexture:r}=t;const i={};let s,o;n&&({width:s,height:o}=r,i["".concat(Ba).concat(n)]=[s,o]);for(const a in e)({width:s,height:o}=e[a]),i["".concat(Ba).concat(a)]=[s,o];return i}function U2(t){return c_(t,["attribute","in"])}function B2(t){const e="".concat(N2).concat(t),n="".concat(Ba).concat(t),r="  uniform sampler2D ".concat(e,`;
  uniform vec2 `).concat(n,";");return{samplerName:e,sizeName:n,uniformDeclerations:r}}function V2(t,e){const n=c_(t,["varying","out"]);return n&&n.name===e?n.type:null}function z2(t,e){const n={},r=U2(t);if(!r)return null;const{type:i,name:s}=r;if(s&&e[s]){const o="// ".concat(t," => Replaced by Transform with a sampler"),{samplerName:a,sizeName:l,uniformDeclerations:u}=B2(s),c=_P(i),h="  ".concat(i," ").concat(s," = transform_getInput(").concat(a,", ").concat(l,").").concat(c,`;
`);return n[a]=s,{updatedLine:o,inject:{"vs:#decl":u,"vs:#main-start":h},samplerTextureMap:n}}return null}const j2={[10241]:9728,[10240]:9728,[10242]:33071,[10243]:33071},G2="transform_output";class H2{constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};this.gl=e,this.id=this.currentIndex=0,this._swapTexture=null,this.targetTextureVarying=null,this.targetTextureType=null,this.samplerTextureMap=null,this.bindings=[],this.resources={},this._initialize(n),Object.seal(this)}updateModelProps(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const n=this._processVertexShader(e);return Object.assign({},e,n)}getDrawOptions(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{sourceBuffers:n,sourceTextures:r,framebuffer:i,targetTexture:s}=this.bindings[this.currentIndex],o=Object.assign({},n,e.attributes),a=Object.assign({},e.uniforms),l=Object.assign({},e.parameters);let u=e.discard;if(this.hasSourceTextures||this.hasTargetTexture){o.transform_elementID=this.elementIDBuffer;for(const h in this.samplerTextureMap){const f=this.samplerTextureMap[h];a[h]=r[f]}this._setSourceTextureParameters();const c=F2({sourceTextureMap:r,targetTextureVarying:this.targetTextureVarying,targetTexture:s});Object.assign(a,c)}return this.hasTargetTexture&&(u=!1,l.viewport=[0,0,i.width,i.height]),{attributes:o,framebuffer:i,uniforms:a,discard:u,parameters:l}}swap(){return this._swapTexture?(this.currentIndex=this._getNextIndex(),!0):!1}update(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this._setupTextures(e)}getTargetTexture(){const{targetTexture:e}=this.bindings[this.currentIndex];return e}getData(){let{packed:e=!1}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{framebuffer:n}=this.bindings[this.currentIndex],r=pl(n);if(!e)return r;const i=r.constructor,s=vP(this.targetTextureType),o=new i(r.length*s/4);let a=0;for(let l=0;l<r.length;l+=4)for(let u=0;u<s;u++)o[a++]=r[l+u];return o}getFramebuffer(){return this.bindings[this.currentIndex].framebuffer}delete(){this.ownTexture&&this.ownTexture.delete(),this.elementIDBuffer&&this.elementIDBuffer.delete()}_initialize(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{_targetTextureVarying:n,_swapTexture:r}=e;this._swapTexture=r,this.targetTextureVarying=n,this.hasTargetTexture=n,this._setupTextures(e)}_createTargetTexture(e){const{sourceTextures:n,textureOrReference:r}=e;if(r instanceof dt)return r;const i=n[r];return i?(this._targetRefTexName=r,this._createNewTexture(i)):null}_setupTextures(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{sourceBuffers:n,_sourceTextures:r={},_targetTexture:i}=e,s=this._createTargetTexture({sourceTextures:r,textureOrReference:i});this.hasSourceTextures=this.hasSourceTextures||r&&Object.keys(r).length>0,this._updateBindings({sourceBuffers:n,sourceTextures:r,targetTexture:s}),"elementCount"in e&&this._updateElementIDBuffer(e.elementCount)}_updateElementIDBuffer(e){if(typeof e!="number"||this.elementCount>=e)return;const n=new Float32Array(e);n.forEach((r,i,s)=>{s[i]=i}),this.elementIDBuffer?this.elementIDBuffer.setData({data:n}):this.elementIDBuffer=new te(this.gl,{data:n,accessor:{size:1}}),this.elementCount=e}_updateBindings(e){if(this.bindings[this.currentIndex]=this._updateBinding(this.bindings[this.currentIndex],e),this._swapTexture){const{sourceTextures:n,targetTexture:r}=this._swapTextures(this.bindings[this.currentIndex]),i=this._getNextIndex();this.bindings[i]=this._updateBinding(this.bindings[i],{sourceTextures:n,targetTexture:r})}}_updateBinding(e,n){const{sourceBuffers:r,sourceTextures:i,targetTexture:s}=n;if(e||(e={sourceBuffers:{},sourceTextures:{},targetTexture:null}),Object.assign(e.sourceTextures,i),Object.assign(e.sourceBuffers,r),s){e.targetTexture=s;const{width:o,height:a}=s,{framebuffer:l}=e;l?(l.update({attachments:{[36064]:s},resizeAttachments:!1}),l.resize({width:o,height:a})):e.framebuffer=new we(this.gl,{id:"transform-framebuffer",width:o,height:a,attachments:{[36064]:s}})}return e}_setSourceTextureParameters(){const e=this.currentIndex,{sourceTextures:n}=this.bindings[e];for(const r in n)n[r].setParameters(j2)}_swapTextures(e){if(!this._swapTexture)return null;const n=Object.assign({},e.sourceTextures);n[this._swapTexture]=e.targetTexture;const r=e.sourceTextures[this._swapTexture];return{sourceTextures:n,targetTexture:r}}_createNewTexture(e){const n=dA(e,{parameters:{[10241]:9728,[10240]:9728,[10242]:33071,[10243]:33071},pixelStore:{[37440]:!1}});return this.ownTexture&&this.ownTexture.delete(),this.ownTexture=n,n}_getNextIndex(){return(this.currentIndex+1)%2}_processVertexShader(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{sourceTextures:n,targetTexture:r}=this.bindings[this.currentIndex],{vs:i,uniforms:s,targetTextureType:o,inject:a,samplerTextureMap:l}=D2({vs:e.vs,sourceTextureMap:n,targetTextureVarying:this.targetTextureVarying,targetTexture:r}),u=jc([e.inject||{},a]);this.targetTextureType=o,this.samplerTextureMap=l;const c=e._fs||h_({version:e_(i),input:this.targetTextureVarying,inputType:o,output:G2}),h=this.hasSourceTextures||this.targetTextureVarying?[x2].concat(e.modules||[]):e.modules;return{vs:i,fs:c,modules:h,uniforms:s,inject:u}}}class mf{static isSupported(e){return Y(e)}constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};this.gl=e,this.model=null,this.elementCount=0,this.bufferTransform=null,this.textureTransform=null,this.elementIDBuffer=null,this._initialize(n),Object.seal(this)}delete(){const{model:e,bufferTransform:n,textureTransform:r}=this;e&&e.delete(),n&&n.delete(),r&&r.delete()}run(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{clearRenderTarget:n=!0}=e,r=this._updateDrawOptions(e);n&&r.framebuffer&&r.framebuffer.clear({color:!0}),this.model.transform(r)}swap(){let e=!1;const n=[this.bufferTransform,this.textureTransform].filter(Boolean);for(const r of n)e=e||r.swap();F(e,"Nothing to swap")}getBuffer(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;return this.bufferTransform&&this.bufferTransform.getBuffer(e)}getData(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const n=[this.bufferTransform,this.textureTransform].filter(Boolean);for(const r of n){const i=r.getData(e);if(i)return i}return null}getFramebuffer(){return this.textureTransform&&this.textureTransform.getFramebuffer()}update(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};"elementCount"in e&&this.model.setVertexCount(e.elementCount);const n=[this.bufferTransform,this.textureTransform].filter(Boolean);for(const r of n)r.update(e)}_initialize(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{gl:n}=this;this._buildResourceTransforms(n,e),e=this._updateModelProps(e),this.model=new b_(n,Object.assign({},e,{fs:e.fs||h_({version:e_(e.vs)}),id:e.id||"transform-model",drawMode:e.drawMode||0,vertexCount:e.elementCount})),this.bufferTransform&&this.bufferTransform.setupResources({model:this.model})}_updateModelProps(e){let n=Object.assign({},e);const r=[this.bufferTransform,this.textureTransform].filter(Boolean);for(const i of r)n=i.updateModelProps(n);return n}_buildResourceTransforms(e,n){W2(n)&&(this.bufferTransform=new O2(e,n)),X2(n)&&(this.textureTransform=new H2(e,n)),F(this.bufferTransform||this.textureTransform,"must provide source/feedback buffers or source/target textures")}_updateDrawOptions(e){let n=Object.assign({},e);const r=[this.bufferTransform,this.textureTransform].filter(Boolean);for(const i of r)n=Object.assign(n,i.getDrawOptions(n));return n}}function W2(t){return!!(!di(t.feedbackBuffers)||!di(t.feedbackMap)||t.varyings&&t.varyings.length>0)}function X2(t){return!!(!di(t._sourceTextures)||t._targetTexture||t._targetTextureVarying)}const gp={POINTS:0,LINES:1,LINE_LOOP:2,LINE_STRIP:3,TRIANGLES:4,TRIANGLE_STRIP:5,TRIANGLE_FAN:6};class Y2{static get DRAW_MODE(){return gp}constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{id:n=_n("geometry"),drawMode:r=gp.TRIANGLES,attributes:i={},indices:s=null,vertexCount:o=null}=e;this.id=n,this.drawMode=r|0,this.attributes={},this.userData={},this._setAttributes(i,s),this.vertexCount=o||this._calculateVertexCount(this.attributes,this.indices)}get mode(){return this.drawMode}getVertexCount(){return this.vertexCount}getAttributes(){return this.indices?{indices:this.indices,...this.attributes}:this.attributes}_print(e){return"Geometry ".concat(this.id," attribute ").concat(e)}_setAttributes(e,n){n&&(this.indices=ArrayBuffer.isView(n)?{value:n,size:1}:n);for(const r in e){let i=e[r];i=ArrayBuffer.isView(i)?{value:i}:i,F(ArrayBuffer.isView(i.value),"".concat(this._print(r),": must be typed array or object with value as typed array")),(r==="POSITION"||r==="positions")&&!i.size&&(i.size=3),r==="indices"?(F(!this.indices),this.indices=i):this.attributes[r]=i}return this.indices&&this.indices.isIndexed!==void 0&&(this.indices=Object.assign({},this.indices),delete this.indices.isIndexed),this}_calculateVertexCount(e,n){if(n)return n.value.length;let r=1/0;for(const i in e){const s=e[i],{value:o,size:a,constant:l}=s;!l&&o&&a>=1&&(r=Math.min(r,o.length/a))}return F(Number.isFinite(r)),r}}let $2=1,q2=1;class S_{constructor(){this.time=0,this.channels=new Map,this.animations=new Map,this.playing=!1,this.lastEngineTime=-1}addChannel(e){const{delay:n=0,duration:r=Number.POSITIVE_INFINITY,rate:i=1,repeat:s=1}=e,o=$2++,a={time:0,delay:n,duration:r,rate:i,repeat:s};return this._setChannelTime(a,this.time),this.channels.set(o,a),o}removeChannel(e){this.channels.delete(e);for(const[n,r]of this.animations)r.channel===e&&this.detachAnimation(n)}isFinished(e){const n=this.channels.get(e);return n===void 0?!1:this.time>=n.delay+n.duration*n.repeat}getTime(e){if(e===void 0)return this.time;const n=this.channels.get(e);return n===void 0?-1:n.time}setTime(e){this.time=Math.max(0,e);const n=this.channels.values();for(const i of n)this._setChannelTime(i,this.time);const r=this.animations.values();for(const i of r){const{animation:s,channel:o}=i;s.setTime(this.getTime(o))}}play(){this.playing=!0}pause(){this.playing=!1,this.lastEngineTime=-1}reset(){this.setTime(0)}attachAnimation(e,n){const r=q2++;return this.animations.set(r,{animation:e,channel:n}),e.setTime(this.getTime(n)),r}detachAnimation(e){this.animations.delete(e)}update(e){this.playing&&(this.lastEngineTime===-1&&(this.lastEngineTime=e),this.setTime(this.time+(e-this.lastEngineTime)),this.lastEngineTime=e)}_setChannelTime(e,n){const r=n-e.delay,i=e.duration*e.repeat;r>=i?e.time=e.duration*e.rate:(e.time=Math.max(0,r)%e.duration,e.time*=e.rate)}}const A_="#define SMOOTH_EDGE_RADIUS 0.5",Z2=`
`.concat(A_,`

struct VertexGeometry {
  vec4 position;
  vec3 worldPosition;
  vec3 worldPositionAlt;
  vec3 normal;
  vec2 uv;
  vec3 pickingColor;
} geometry = VertexGeometry(
  vec4(0.0, 0.0, 1.0, 0.0),
  vec3(0.0),
  vec3(0.0),
  vec3(0.0),
  vec2(0.0),
  vec3(0.0)
);
`),Q2=`
`.concat(A_,`

struct FragmentGeometry {
  vec2 uv;
} geometry;

float smoothedge(float edge, float x) {
  return smoothstep(edge - SMOOTH_EDGE_RADIUS, edge + SMOOTH_EDGE_RADIUS, x);
}
`),K2={name:"geometry",vs:Z2,fs:Q2},J={DEFAULT:-1,LNGLAT:1,METER_OFFSETS:2,LNGLAT_OFFSETS:3,CARTESIAN:0};Object.defineProperty(J,"IDENTITY",{get:()=>(Q.deprecated("COORDINATE_SYSTEM.IDENTITY","COORDINATE_SYSTEM.CARTESIAN")(),0)});const qt={WEB_MERCATOR:1,GLOBE:2,WEB_MERCATOR_AUTO_OFFSET:4,IDENTITY:0},Va={common:0,meters:1,pixels:2},pp={click:{handler:"onClick"},panstart:{handler:"onDragStart"},panmove:{handler:"onDrag"},panend:{handler:"onDragEnd"}},Qs={DRAW:"draw",MASK:"mask"},J2=Object.keys(J).map(t=>"const int COORDINATE_SYSTEM_".concat(t," = ").concat(J[t],";")).join(""),eC=Object.keys(qt).map(t=>"const int PROJECTION_MODE_".concat(t," = ").concat(qt[t],";")).join(""),tC=Object.keys(Va).map(t=>"const int UNIT_".concat(t.toUpperCase()," = ").concat(Va[t],";")).join(""),nC="".concat(J2,`
`).concat(eC,`
`).concat(tC,`

uniform int project_uCoordinateSystem;
uniform int project_uProjectionMode;
uniform float project_uScale;
uniform bool project_uWrapLongitude;
uniform vec3 project_uCommonUnitsPerMeter;
uniform vec3 project_uCommonUnitsPerWorldUnit;
uniform vec3 project_uCommonUnitsPerWorldUnit2;
uniform vec4 project_uCenter;
uniform mat4 project_uModelMatrix;
uniform mat4 project_uViewProjectionMatrix;
uniform vec2 project_uViewportSize;
uniform float project_uDevicePixelRatio;
uniform float project_uFocalDistance;
uniform vec3 project_uCameraPosition;
uniform vec3 project_uCoordinateOrigin;
uniform vec3 project_uCommonOrigin;
uniform bool project_uPseudoMeters;

const float TILE_SIZE = 512.0;
const float PI = 3.1415926536;
const float WORLD_SCALE = TILE_SIZE / (PI * 2.0);
const vec3 ZERO_64_LOW = vec3(0.0);
const float EARTH_RADIUS = 6370972.0; // meters
const float GLOBE_RADIUS = 256.0;

// returns an adjustment factor for uCommonUnitsPerMeter
float project_size_at_latitude(float lat) {
  float y = clamp(lat, -89.9, 89.9);
  return 1.0 / cos(radians(y));
}

float project_size() {
  if (project_uProjectionMode == PROJECTION_MODE_WEB_MERCATOR &&
    project_uCoordinateSystem == COORDINATE_SYSTEM_LNGLAT &&
    project_uPseudoMeters == false) {

    // uCommonUnitsPerMeter in low-zoom Web Mercator is non-linear
    // Adjust by 1 / cos(latitude)
    // If geometry.position (vertex in common space) is populated, use it
    // Otherwise use geometry.worldPosition (anchor in world space)
    
    if (geometry.position.w == 0.0) {
      return project_size_at_latitude(geometry.worldPosition.y);
    }

    // latitude from common y: 2.0 * (atan(exp(y / TILE_SIZE * 2.0 * PI - PI)) - PI / 4.0)
    // Taylor series of 1 / cos(latitude)
    // Max error < 0.003
  
    float y = geometry.position.y / TILE_SIZE * 2.0 - 1.0;
    float y2 = y * y;
    float y4 = y2 * y2;
    float y6 = y4 * y2;
    return 1.0 + 4.9348 * y2 + 4.0587 * y4 + 1.5642 * y6;
  }
  return 1.0;
}

float project_size_at_latitude(float meters, float lat) {
  return meters * project_uCommonUnitsPerMeter.z * project_size_at_latitude(lat);
}

//
// Scaling offsets - scales meters to "world distance"
// Note the scalar version of project_size is for scaling the z component only
//
float project_size(float meters) {
  return meters * project_uCommonUnitsPerMeter.z * project_size();
}

vec2 project_size(vec2 meters) {
  return meters * project_uCommonUnitsPerMeter.xy * project_size();
}

vec3 project_size(vec3 meters) {
  return meters * project_uCommonUnitsPerMeter * project_size();
}

vec4 project_size(vec4 meters) {
  return vec4(meters.xyz * project_uCommonUnitsPerMeter, meters.w);
}

// Get rotation matrix that aligns the z axis with the given up vector
// Find 3 unit vectors ux, uy, uz that are perpendicular to each other and uz == up
mat3 project_get_orientation_matrix(vec3 up) {
  vec3 uz = normalize(up);
  // Tangent on XY plane
  vec3 ux = abs(uz.z) == 1.0 ? vec3(1.0, 0.0, 0.0) : normalize(vec3(uz.y, -uz.x, 0));
  vec3 uy = cross(uz, ux);
  return mat3(ux, uy, uz);
}

bool project_needs_rotation(vec3 commonPosition, out mat3 transform) {
  if (project_uProjectionMode == PROJECTION_MODE_GLOBE) {
    transform = project_get_orientation_matrix(commonPosition);
    return true;
  }
  return false;
}

//
// Projecting normal - transform deltas from current coordinate system to
// normals in the worldspace
//
vec3 project_normal(vec3 vector) {
  // Apply model matrix
  vec4 normal_modelspace = project_uModelMatrix * vec4(vector, 0.0);
  vec3 n = normalize(normal_modelspace.xyz * project_uCommonUnitsPerMeter);
  mat3 rotation;
  if (project_needs_rotation(geometry.position.xyz, rotation)) {
    n = rotation * n;
  }
  return n;
}

vec4 project_offset_(vec4 offset) {
  float dy = offset.y;
  vec3 commonUnitsPerWorldUnit = project_uCommonUnitsPerWorldUnit + project_uCommonUnitsPerWorldUnit2 * dy;
  return vec4(offset.xyz * commonUnitsPerWorldUnit, offset.w);
}

//
// Projecting positions - non-linear projection: lnglats => unit tile [0-1, 0-1]
//
vec2 project_mercator_(vec2 lnglat) {
  float x = lnglat.x;
  if (project_uWrapLongitude) {
    x = mod(x + 180., 360.0) - 180.;
  }
  float y = clamp(lnglat.y, -89.9, 89.9);
  return vec2(
    radians(x) + PI,
    PI + log(tan_fp32(PI * 0.25 + radians(y) * 0.5))
  ) * WORLD_SCALE;
}

vec3 project_globe_(vec3 lnglatz) {
  float lambda = radians(lnglatz.x);
  float phi = radians(lnglatz.y);
  float cosPhi = cos(phi);
  float D = (lnglatz.z / EARTH_RADIUS + 1.0) * GLOBE_RADIUS;

  return vec3(
    sin(lambda) * cosPhi,
    -cos(lambda) * cosPhi,
    sin(phi)
  ) * D;
}

//
// Projects positions (defined by project_uCoordinateSystem) to common space (defined by project_uProjectionMode)
//
vec4 project_position(vec4 position, vec3 position64Low) {
  vec4 position_world = project_uModelMatrix * position;

  // Work around for a Mac+NVIDIA bug https://github.com/visgl/deck.gl/issues/4145
  if (project_uProjectionMode == PROJECTION_MODE_WEB_MERCATOR) {
    if (project_uCoordinateSystem == COORDINATE_SYSTEM_LNGLAT) {
      return vec4(
        project_mercator_(position_world.xy),
        project_size_at_latitude(position_world.z, position_world.y),
        position_world.w
      );
    }
    if (project_uCoordinateSystem == COORDINATE_SYSTEM_CARTESIAN) {
      position_world.xyz += project_uCoordinateOrigin;
    }
  }
  if (project_uProjectionMode == PROJECTION_MODE_GLOBE) {
    if (project_uCoordinateSystem == COORDINATE_SYSTEM_LNGLAT) {
      return vec4(
        project_globe_(position_world.xyz),
        position_world.w
      );
    }
  }
  if (project_uProjectionMode == PROJECTION_MODE_WEB_MERCATOR_AUTO_OFFSET) {
    if (project_uCoordinateSystem == COORDINATE_SYSTEM_LNGLAT) {
      if (abs(position_world.y - project_uCoordinateOrigin.y) > 0.25) {
        // Too far from the projection center for offset mode to be accurate
        // Only use high parts
        return vec4(
          project_mercator_(position_world.xy) - project_uCommonOrigin.xy,
          project_size(position_world.z),
          position_world.w
        );
      }
    }
  }
  if (project_uProjectionMode == PROJECTION_MODE_IDENTITY ||
    (project_uProjectionMode == PROJECTION_MODE_WEB_MERCATOR_AUTO_OFFSET &&
    (project_uCoordinateSystem == COORDINATE_SYSTEM_LNGLAT ||
     project_uCoordinateSystem == COORDINATE_SYSTEM_CARTESIAN))) {
    // Subtract high part of 64 bit value. Convert remainder to float32, preserving precision.
    position_world.xyz -= project_uCoordinateOrigin;
  }

  // Translation is already added to the high parts
  return project_offset_(position_world + project_uModelMatrix * vec4(position64Low, 0.0));
}

vec4 project_position(vec4 position) {
  return project_position(position, ZERO_64_LOW);
}

vec3 project_position(vec3 position, vec3 position64Low) {
  vec4 projected_position = project_position(vec4(position, 1.0), position64Low);
  return projected_position.xyz;
}

vec3 project_position(vec3 position) {
  vec4 projected_position = project_position(vec4(position, 1.0), ZERO_64_LOW);
  return projected_position.xyz;
}

vec2 project_position(vec2 position) {
  vec4 projected_position = project_position(vec4(position, 0.0, 1.0), ZERO_64_LOW);
  return projected_position.xy;
}

vec4 project_common_position_to_clipspace(vec4 position, mat4 viewProjectionMatrix, vec4 center) {
  return viewProjectionMatrix * position + center;
}

//
// Projects from common space coordinates to clip space.
// Uses project_uViewProjectionMatrix
//
vec4 project_common_position_to_clipspace(vec4 position) {
  return project_common_position_to_clipspace(position, project_uViewProjectionMatrix, project_uCenter);
}

// Returns a clip space offset that corresponds to a given number of screen pixels
vec2 project_pixel_size_to_clipspace(vec2 pixels) {
  vec2 offset = pixels / project_uViewportSize * project_uDevicePixelRatio * 2.0;
  return offset * project_uFocalDistance;
}

float project_size_to_pixel(float meters) {
  return project_size(meters) * project_uScale;
}
float project_size_to_pixel(float size, int unit) {
  if (unit == UNIT_METERS) return project_size_to_pixel(size);
  if (unit == UNIT_COMMON) return size * project_uScale;
  // UNIT_PIXELS
  return size;
}
float project_pixel_size(float pixels) {
  return pixels / project_uScale;
}
vec2 project_pixel_size(vec2 pixels) {
  return pixels / project_uScale;
}
`);function rC(t,e){if(t===e)return!0;if(Array.isArray(t)){const n=t.length;if(!e||e.length!==n)return!1;for(let r=0;r<n;r++)if(t[r]!==e[r])return!1;return!0}return!1}function ml(t){let e={},n;return r=>{for(const i in r)if(!rC(r[i],e[i])){n=t(r),e=r;break}return n}}const mp=[0,0,0,0],iC=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,0],x_=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],sC=[0,0,0],P_=[0,0,0],oC=ml(uC);function C_(t,e,n=P_){n.length<3&&(n=[n[0],n[1],0]);let r=n,i,s=!0;switch(e===J.LNGLAT_OFFSETS||e===J.METER_OFFSETS?i=n:i=t.isGeospatial?[Math.fround(t.longitude),Math.fround(t.latitude),0]:null,t.projectionMode){case qt.WEB_MERCATOR:(e===J.LNGLAT||e===J.CARTESIAN)&&(i=[0,0,0],s=!1);break;case qt.WEB_MERCATOR_AUTO_OFFSET:e===J.LNGLAT?r=i:e===J.CARTESIAN&&(r=[Math.fround(t.center[0]),Math.fround(t.center[1]),0],i=t.unprojectPosition(r),r[0]-=n[0],r[1]-=n[1],r[2]-=n[2]);break;case qt.IDENTITY:r=t.position.map(Math.fround),r[2]=r[2]||0;break;case qt.GLOBE:s=!1,i=null;break;default:s=!1}return{geospatialOrigin:i,shaderCoordinateOrigin:r,offsetMode:s}}function aC(t,e,n){const{viewMatrixUncentered:r,projectionMatrix:i}=t;let{viewMatrix:s,viewProjectionMatrix:o}=t,a=mp,l=mp,u=t.cameraPosition;const{geospatialOrigin:c,shaderCoordinateOrigin:h,offsetMode:f}=C_(t,e,n);return f&&(l=t.projectPosition(c||h),u=[u[0]-l[0],u[1]-l[1],u[2]-l[2]],l[3]=1,a=qs([],l,o),s=r||s,o=dr([],i,s),o=dr([],o,iC)),{viewMatrix:s,viewProjectionMatrix:o,projectionCenter:a,originCommon:l,cameraPosCommon:u,shaderCoordinateOrigin:h,geospatialOrigin:c}}function lC({viewport:t,devicePixelRatio:e=1,modelMatrix:n=null,coordinateSystem:r=J.DEFAULT,coordinateOrigin:i=P_,autoWrapLongitude:s=!1}){r===J.DEFAULT&&(r=t.isGeospatial?J.LNGLAT:J.CARTESIAN);const o=oC({viewport:t,devicePixelRatio:e,coordinateSystem:r,coordinateOrigin:i});return o.project_uWrapLongitude=s,o.project_uModelMatrix=n||x_,o}function uC({viewport:t,devicePixelRatio:e,coordinateSystem:n,coordinateOrigin:r}){const{projectionCenter:i,viewProjectionMatrix:s,originCommon:o,cameraPosCommon:a,shaderCoordinateOrigin:l,geospatialOrigin:u}=aC(t,n,r),c=t.getDistanceScales(),h=[t.width*e,t.height*e],f=qs([],[0,0,-t.focalDistance,1],t.projectionMatrix)[3]||1,g={project_uCoordinateSystem:n,project_uProjectionMode:t.projectionMode,project_uCoordinateOrigin:l,project_uCommonOrigin:o.slice(0,3),project_uCenter:i,project_uPseudoMeters:Boolean(t._pseudoMeters),project_uViewportSize:h,project_uDevicePixelRatio:e,project_uFocalDistance:f,project_uCommonUnitsPerMeter:c.unitsPerMeter,project_uCommonUnitsPerWorldUnit:c.unitsPerMeter,project_uCommonUnitsPerWorldUnit2:sC,project_uScale:t.scale,project_uWrapLongitude:!1,project_uViewProjectionMatrix:s,project_uModelMatrix:x_,project_uCameraPosition:a};if(u){const w=t.getDistanceScales(u);switch(n){case J.METER_OFFSETS:g.project_uCommonUnitsPerWorldUnit=w.unitsPerMeter,g.project_uCommonUnitsPerWorldUnit2=w.unitsPerMeter2;break;case J.LNGLAT:case J.LNGLAT_OFFSETS:t._pseudoMeters||(g.project_uCommonUnitsPerMeter=w.unitsPerMeter),g.project_uCommonUnitsPerWorldUnit=w.unitsPerDegree,g.project_uCommonUnitsPerWorldUnit2=w.unitsPerDegree2;break;case J.CARTESIAN:g.project_uCommonUnitsPerWorldUnit=[1,1,w.unitsPerMeter[2]],g.project_uCommonUnitsPerWorldUnit2=[0,0,w.unitsPerMeter2[2]];break}}return g}const cC={};function hC(t=cC){return"viewport"in t?lC(t):{}}const yf={name:"project",dependencies:[TP,K2],vs:nC,getUniforms:hC},fC=`
vec4 project_position_to_clipspace(
  vec3 position, vec3 position64Low, vec3 offset, out vec4 commonPosition
) {
  vec3 projectedPosition = project_position(position, position64Low);
  mat3 rotation;
  if (project_needs_rotation(projectedPosition, rotation)) {
    // offset is specified as ENU
    // when in globe projection, rotate offset so that the ground alighs with the surface of the globe
    offset = rotation * offset;
  }
  commonPosition = vec4(projectedPosition + offset, 1.0);
  return project_common_position_to_clipspace(commonPosition);
}

vec4 project_position_to_clipspace(
  vec3 position, vec3 position64Low, vec3 offset
) {
  vec4 commonPosition;
  return project_position_to_clipspace(position, position64Low, offset, commonPosition);
}
`,dC={name:"project32",dependencies:[yf],vs:fC};function gC(){return[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]}function ii(t,e){const n=qs([],e,t);return o2(n,n,1/n[3]),n}function yp(t,e){const n=t%e;return n<0?e+n:n}function Yc(t,e,n){return t<e?e:t>n?n:t}function pC(t){return Math.log(t)*Math.LOG2E}const _f=Math.log2||pC;function vn(t,e){if(!t)throw new Error(e||"@math.gl/web-mercator: assertion failed.")}const Ot=Math.PI,L_=Ot/4,Ft=Ot/180,$c=180/Ot,Os=512,qc=4003e4,Fo=85.051129,mC=1.5;function yC(t){return _f(t)}function za(t){const[e,n]=t;vn(Number.isFinite(e)),vn(Number.isFinite(n)&&n>=-90&&n<=90,"invalid latitude");const r=e*Ft,i=n*Ft,s=Os*(r+Ot)/(2*Ot),o=Os*(Ot+Math.log(Math.tan(L_+i*.5)))/(2*Ot);return[s,o]}function vi(t){const[e,n]=t,r=e/Os*(2*Ot)-Ot,i=2*(Math.atan(Math.exp(n/Os*(2*Ot)-Ot))-L_);return[r*$c,i*$c]}function _C(t){const{latitude:e}=t;vn(Number.isFinite(e));const n=Math.cos(e*Ft);return yC(qc*n)-9}function Zc(t){const{latitude:e,longitude:n,highPrecision:r=!1}=t;vn(Number.isFinite(e)&&Number.isFinite(n));const i=Os,s=Math.cos(e*Ft),o=i/360,a=o/s,l=i/qc/s,u={unitsPerMeter:[l,l,l],metersPerUnit:[1/l,1/l,1/l],unitsPerDegree:[o,a,l],degreesPerUnit:[1/o,1/a,1/l]};if(r){const c=Ft*Math.tan(e*Ft)/s,h=o*c/2,f=i/qc*c,g=f/a*l;u.unitsPerDegree2=[0,h,f],u.unitsPerMeter2=[g,0,g]}return u}function R_(t,e){const[n,r,i]=t,[s,o,a]=e,{unitsPerMeter:l,unitsPerMeter2:u}=Zc({longitude:n,latitude:r,highPrecision:!0}),c=za(t);c[0]+=s*(l[0]+u[0]*o),c[1]+=o*(l[1]+u[1]*o);const h=vi(c),f=(i||0)+(a||0);return Number.isFinite(i)||Number.isFinite(a)?[h[0],h[1],f]:h}function vC(t){const{height:e,pitch:n,bearing:r,altitude:i,scale:s,center:o}=t,a=gC();Ua(a,a,[0,0,-i]),y_(a,a,-n*Ft),__(a,a,r*Ft);const l=s/e;return pf(a,a,[l,l,l]),o&&Ua(a,a,DP([],o)),a}function wC(t){const{width:e,height:n,altitude:r,pitch:i=0,offset:s,center:o,scale:a,nearZMultiplier:l=1,farZMultiplier:u=1}=t;let{fovy:c=ja(mC)}=t;r!==void 0&&(c=ja(r));const h=c*Ft,f=i*Ft,g=M_(c);let w=g;o&&(w+=o[2]*a/Math.cos(f)/n);const E=h*(.5+(s?s[1]:0)/n),T=Math.sin(E)*w/Math.sin(Yc(Math.PI/2-f-E,.01,Math.PI-.01)),y=Math.sin(f)*T+w,m=w*10,_=Math.min(y*u,m);return{fov:h,aspect:e/n,focalDistance:g,near:l,far:_}}function ja(t){return 2*Math.atan(.5/t)*$c}function M_(t){return .5/Math.tan(.5*t*Ft)}function k_(t,e){const[n,r,i=0]=t;return vn(Number.isFinite(n)&&Number.isFinite(r)&&Number.isFinite(i)),ii(e,[n,r,i,1])}function yl(t,e,n=0){const[r,i,s]=t;if(vn(Number.isFinite(r)&&Number.isFinite(i),"invalid pixel coordinate"),Number.isFinite(s))return ii(e,[r,i,s,1]);const o=ii(e,[r,i,0,1]),a=ii(e,[r,i,1,1]),l=o[2],u=a[2],c=l===u?0:((n||0)-l)/(u-l);return g_([],o,a,c)}function I_(t){const{width:e,height:n,bounds:r,minExtent:i=0,maxZoom:s=24,offset:o=[0,0]}=t,[[a,l],[u,c]]=r,h=EC(t.padding),f=za([a,Yc(c,-Fo,Fo)]),g=za([u,Yc(l,-Fo,Fo)]),w=[Math.max(Math.abs(g[0]-f[0]),i),Math.max(Math.abs(g[1]-f[1]),i)],E=[e-h.left-h.right-Math.abs(o[0])*2,n-h.top-h.bottom-Math.abs(o[1])*2];vn(E[0]>0&&E[1]>0);const T=E[0]/w[0],y=E[1]/w[1],m=(h.right-h.left)/2/T,_=(h.top-h.bottom)/2/y,S=[(g[0]+f[0])/2+m,(g[1]+f[1])/2+_],A=vi(S),P=Math.min(s,_f(Math.abs(Math.min(T,y))));return vn(Number.isFinite(P)),{longitude:A[0],latitude:A[1],zoom:P}}function EC(t=0){return typeof t=="number"?{top:t,bottom:t,left:t,right:t}:(vn(Number.isFinite(t.top)&&Number.isFinite(t.bottom)&&Number.isFinite(t.left)&&Number.isFinite(t.right)),t)}const _p=Math.PI/180;function TC(t,e=0){const{width:n,height:r,unproject:i}=t,s={targetZ:e},o=i([0,r],s),a=i([n,r],s);let l,u;const c=t.fovy?.5*t.fovy*_p:Math.atan(.5/t.altitude),h=(90-t.pitch)*_p;return c>h-.01?(l=vp(t,0,e),u=vp(t,n,e)):(l=i([0,0],s),u=i([n,0],s)),[o,a,u,l]}function vp(t,e,n){const{pixelUnprojectionMatrix:r}=t,i=ii(r,[e,0,1,1]),s=ii(r,[e,t.height,1,1]),a=(n*t.distanceScales.unitsPerMeter[2]-i[2])/(s[2]-i[2]),l=g_([],i,s,a),u=vi(l);return u.push(n),u}const wp=512;function bC(t){const{width:e,height:n,pitch:r=0}=t;let{longitude:i,latitude:s,zoom:o,bearing:a=0}=t;(i<-180||i>180)&&(i=yp(i+180,360)-180),(a<-180||a>180)&&(a=yp(a+180,360)-180);const l=_f(n/wp);if(o<=l)o=l,s=0;else{const u=n/2/Math.pow(2,o),c=vi([0,u])[1];if(s<c)s=c;else{const h=vi([0,wp-u])[1];s>h&&(s=h)}}return{width:e,height:n,longitude:i,latitude:s,zoom:o,pitch:r,bearing:a}}const SC=`
const int max_lights = 2;
uniform mat4 shadow_uViewProjectionMatrices[max_lights];
uniform vec4 shadow_uProjectCenters[max_lights];
uniform bool shadow_uDrawShadowMap;
uniform bool shadow_uUseShadowMap;
uniform int shadow_uLightId;
uniform float shadow_uLightCount;

varying vec3 shadow_vPosition[max_lights];

vec4 shadow_setVertexPosition(vec4 position_commonspace) {
  if (shadow_uDrawShadowMap) {
    return project_common_position_to_clipspace(position_commonspace, shadow_uViewProjectionMatrices[shadow_uLightId], shadow_uProjectCenters[shadow_uLightId]);
  }
  if (shadow_uUseShadowMap) {
    for (int i = 0; i < max_lights; i++) {
      if(i < int(shadow_uLightCount)) {
        vec4 shadowMap_position = project_common_position_to_clipspace(position_commonspace, shadow_uViewProjectionMatrices[i], shadow_uProjectCenters[i]);
        shadow_vPosition[i] = (shadowMap_position.xyz / shadowMap_position.w + 1.0) / 2.0;
      }
    }
  }
  return gl_Position;
}
`,AC=`
const int max_lights = 2;
uniform bool shadow_uDrawShadowMap;
uniform bool shadow_uUseShadowMap;
uniform sampler2D shadow_uShadowMap0;
uniform sampler2D shadow_uShadowMap1;
uniform vec4 shadow_uColor;
uniform float shadow_uLightCount;

varying vec3 shadow_vPosition[max_lights];

const vec4 bitPackShift = vec4(1.0, 255.0, 65025.0, 16581375.0);
const vec4 bitUnpackShift = 1.0 / bitPackShift;
const vec4 bitMask = vec4(1.0 / 255.0, 1.0 / 255.0, 1.0 / 255.0,  0.0);

float shadow_getShadowWeight(vec3 position, sampler2D shadowMap) {
  vec4 rgbaDepth = texture2D(shadowMap, position.xy);

  float z = dot(rgbaDepth, bitUnpackShift);
  return smoothstep(0.001, 0.01, position.z - z);
}

vec4 shadow_filterShadowColor(vec4 color) {
  if (shadow_uDrawShadowMap) {
    vec4 rgbaDepth = fract(gl_FragCoord.z * bitPackShift);
    rgbaDepth -= rgbaDepth.gbaa * bitMask;
    return rgbaDepth;
  }
  if (shadow_uUseShadowMap) {
    float shadowAlpha = 0.0;
    shadowAlpha += shadow_getShadowWeight(shadow_vPosition[0], shadow_uShadowMap0);
    if(shadow_uLightCount > 1.0) {
      shadowAlpha += shadow_getShadowWeight(shadow_vPosition[1], shadow_uShadowMap1);
    }
    shadowAlpha *= shadow_uColor.a / shadow_uLightCount;
    float blendedAlpha = shadowAlpha + color.a * (1.0 - shadowAlpha);

    return vec4(
      mix(color.rgb, shadow_uColor.rgb, shadowAlpha / blendedAlpha),
      blendedAlpha
    );
  }
  return color;
}
`,xC=ml(MC),PC=ml(kC),CC=[0,0,0,1],LC=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,0];function RC(t,e){const[n,r,i]=t,s=yl([n,r,i],e);return Number.isFinite(i)?s:[s[0],s[1],0]}function MC({viewport:t,center:e}){return new Pt(t.viewProjectionMatrix).invert().transform(e)}function kC({viewport:t,shadowMatrices:e}){const n=[],r=t.pixelUnprojectionMatrix,i=t.isGeospatial?void 0:1,s=[[0,0,i],[t.width,0,i],[0,t.height,i],[t.width,t.height,i],[0,0,-1],[t.width,0,-1],[0,t.height,-1],[t.width,t.height,-1]].map(o=>RC(o,r));for(const o of e){const a=o.clone().translate(new Jt(t.center).negate()),l=s.map(c=>a.transform(c)),u=new Pt().ortho({left:Math.min(...l.map(c=>c[0])),right:Math.max(...l.map(c=>c[0])),bottom:Math.min(...l.map(c=>c[1])),top:Math.max(...l.map(c=>c[1])),near:Math.min(...l.map(c=>-c[2])),far:Math.max(...l.map(c=>-c[2]))});n.push(u.multiplyRight(o))}return n}function IC(t,e){const{shadowEnabled:n=!0}=t;if(!n||!t.shadowMatrices||!t.shadowMatrices.length)return{shadow_uDrawShadowMap:!1,shadow_uUseShadowMap:!1};const r={shadow_uDrawShadowMap:Boolean(t.drawToShadowMap),shadow_uUseShadowMap:t.shadowMaps?t.shadowMaps.length>0:!1,shadow_uColor:t.shadowColor||CC,shadow_uLightId:t.shadowLightId||0,shadow_uLightCount:t.shadowMatrices.length},i=xC({viewport:t.viewport,center:e.project_uCenter}),s=[],o=PC({shadowMatrices:t.shadowMatrices,viewport:t.viewport}).slice();for(let a=0;a<t.shadowMatrices.length;a++){const l=o[a],u=l.clone().translate(new Jt(t.viewport.center).negate());e.project_uCoordinateSystem===J.LNGLAT&&e.project_uProjectionMode===qt.WEB_MERCATOR?(o[a]=u,s[a]=i):(o[a]=l.clone().multiplyRight(LC),s[a]=u.transform(i))}for(let a=0;a<o.length;a++)r["shadow_uViewProjectionMatrices[".concat(a,"]")]=o[a],r["shadow_uProjectCenters[".concat(a,"]")]=s[a],t.shadowMaps&&t.shadowMaps.length>0?r["shadow_uShadowMap".concat(a)]=t.shadowMaps[a]:r["shadow_uShadowMap".concat(a)]=t.dummyShadowMap;return r}const Cu={name:"shadow",dependencies:[yf],vs:SC,fs:AC,inject:{"vs:DECKGL_FILTER_GL_POSITION":`
    position = shadow_setVertexPosition(geometry.position);
    `,"fs:DECKGL_FILTER_COLOR":`
    color = shadow_filterShadowColor(color);
    `},getUniforms:(t={},e={})=>"viewport"in t&&(t.drawToShadowMap||t.shadowMaps&&t.shadowMaps.length>0)?IC(t,e):{}},OC={inject:{"vs:DECKGL_FILTER_GL_POSITION":`
    // for picking depth values
    picking_setPickingAttribute(position.z / position.w);
  `,"vs:DECKGL_FILTER_COLOR":`
  picking_setPickingColor(geometry.pickingColor);
  `,"fs:DECKGL_FILTER_COLOR":{order:99,injection:`
  // use highlight color if this fragment belongs to the selected object.
  color = picking_filterHighlightColor(color);

  // use picking color if rendering to picking FBO.
  color = picking_filterPickingColor(color);
    `}},...w2},NC=[yf],DC=["vs:DECKGL_FILTER_SIZE(inout vec3 size, VertexGeometry geometry)","vs:DECKGL_FILTER_GL_POSITION(inout vec4 position, VertexGeometry geometry)","vs:DECKGL_FILTER_COLOR(inout vec4 color, VertexGeometry geometry)","fs:DECKGL_FILTER_COLOR(inout vec4 color, FragmentGeometry geometry)"];function FC(t){const e=Zs.getDefaultProgramManager(t);for(const n of NC)e.addDefaultModule(n);for(const n of DC)e.addShaderHook(n);return e}const UC=[255,255,255],BC=1;let VC=0;class O_{constructor(e={}){d(this,"id",void 0),d(this,"color",void 0),d(this,"intensity",void 0),d(this,"type","ambient");const{color:n=UC}=e,{intensity:r=BC}=e;this.id=e.id||"ambient-".concat(VC++),this.color=n,this.intensity=r}}const zC=[255,255,255],jC=1,GC=[0,0,-1];let HC=0;class Ep{constructor(e={}){d(this,"id",void 0),d(this,"color",void 0),d(this,"intensity",void 0),d(this,"type","directional"),d(this,"direction",void 0),d(this,"shadow",void 0);const{color:n=zC}=e,{intensity:r=jC}=e,{direction:i=GC}=e,{_shadow:s=!1}=e;this.id=e.id||"directional-".concat(HC++),this.color=n,this.intensity=r,this.type="directional",this.direction=new Jt(i).normalize().toArray(),this.shadow=s}getProjectedLight(e){return this}}class WC{constructor(e,n={id:"pass"}){d(this,"id",void 0),d(this,"gl",void 0),d(this,"props",void 0);const{id:r}=n;this.id=r,this.gl=e,this.props={...n}}setProps(e){Object.assign(this.props,e)}render(e){}cleanup(){}}class _l extends WC{constructor(...e){super(...e),d(this,"_lastRenderIndex",-1)}render(e){const n=this.gl;return yn(n,{framebuffer:e.target}),this._drawLayers(e)}_drawLayers(e){const{target:n,moduleParameters:r,viewports:i,views:s,onViewportActive:o,clearStack:a=!0,clearCanvas:l=!0}=e;e.pass=e.pass||"unknown";const u=this.gl;l&&YC(u),a&&(this._lastRenderIndex=-1);const c=[];for(const h of i){const f=s&&s[h.id];o(h);const g=this._getDrawLayerParams(h,e),w=h.subViewports||[h];for(const E of w){const T=this._drawLayersInViewport(u,{target:n,moduleParameters:r,viewport:E,view:f,pass:e.pass,layers:e.layers},g);c.push(T)}}return c}_getDrawLayerParams(e,{layers:n,pass:r,layerFilter:i,cullRect:s,effects:o,moduleParameters:a}){const l=[],u=N_(this._lastRenderIndex+1),c={layer:n[0],viewport:e,isPicking:r.startsWith("picking"),renderPass:r,cullRect:s},h={};for(let f=0;f<n.length;f++){const g=n[f],w=this._shouldDrawLayer(g,c,i,h),E={shouldDrawLayer:w};w&&(E.layerRenderIndex=u(g,w),E.moduleParameters=this._getModuleParameters(g,o,r,a),E.layerParameters=this.getLayerParameters(g,f,e)),l[f]=E}return l}_drawLayersInViewport(e,{layers:n,moduleParameters:r,pass:i,target:s,viewport:o,view:a},l){const u=XC(e,{moduleParameters:r,target:s,viewport:o});if(a&&a.props.clear){const h=a.props.clear===!0?{color:!0,depth:!0}:a.props.clear;St(e,{scissorTest:!0,scissor:u},()=>hf(e,h))}const c={totalCount:n.length,visibleCount:0,compositeCount:0,pickableCount:0};yn(e,{viewport:u});for(let h=0;h<n.length;h++){const f=n[h],{shouldDrawLayer:g,layerRenderIndex:w,moduleParameters:E,layerParameters:T}=l[h];if(g&&f.props.pickable&&c.pickableCount++,f.isComposite)c.compositeCount++;else if(g){c.visibleCount++,this._lastRenderIndex=Math.max(this._lastRenderIndex,w),E.viewport=o;try{f._drawLayer({moduleParameters:E,uniforms:{layerIndex:w},parameters:T})}catch(y){f.raiseError(y,"drawing ".concat(f," to ").concat(i))}}}return c}shouldDrawLayer(e){return!0}getModuleParameters(e,n){return null}getLayerParameters(e,n,r){return e.props.parameters}_shouldDrawLayer(e,n,r,i){if(!(e.props.visible&&this.shouldDrawLayer(e)))return!1;n.layer=e;let o=e.parent;for(;o;){if(!o.props.visible||!o.filterSubLayer(n))return!1;n.layer=o,o=o.parent}if(r){const a=n.layer.id;if(a in i||(i[a]=r(n)),!i[a])return!1}return e.activateViewport(n.viewport),!0}_getModuleParameters(e,n,r,i){var s;const o=Object.assign(Object.create(((s=e.internalState)===null||s===void 0?void 0:s.propsInTransition)||e.props),{autoWrapLongitude:e.wrapLongitude,viewport:e.context.viewport,mousePosition:e.context.mousePosition,pickingActive:0,devicePixelRatio:vr(this.gl)});if(n)for(const l of n){var a;Object.assign(o,(a=l.getModuleParameters)===null||a===void 0?void 0:a.call(l,e))}return Object.assign(o,this.getModuleParameters(e,n),i)}}function N_(t=0,e={}){const n={},r=(i,s)=>{const o=i.props._offset,a=i.id,l=i.parent&&i.parent.id;let u;if(l&&!(l in e)&&r(i.parent,!1),l in n){const c=n[l]=n[l]||N_(e[l],e);u=c(i,s),n[a]=c}else Number.isFinite(o)?(u=o+(e[l]||0),n[a]=null):u=t;return s&&u>=t&&(t=u+1),e[a]=u,u};return r}function XC(t,{moduleParameters:e,target:n,viewport:r}){const i=n&&n.id!=="default-framebuffer",s=e&&e.devicePixelRatio||vr(t),o=i?n.height:t.drawingBufferHeight,a=r;return[a.x*s,o-(a.y+a.height)*s,a.width*s,a.height*s]}function YC(t){const e=t.drawingBufferWidth,n=t.drawingBufferHeight;yn(t,{viewport:[0,0,e,n]}),t.clear(16640)}class $C extends _l{constructor(e,n){super(e,n),d(this,"shadowMap",void 0),d(this,"depthBuffer",void 0),d(this,"fbo",void 0),this.shadowMap=new dt(e,{width:1,height:1,parameters:{[10241]:9729,[10240]:9729,[10242]:33071,[10243]:33071}}),this.depthBuffer=new Zr(e,{format:33189,width:1,height:1}),this.fbo=new we(e,{id:"shadowmap",width:1,height:1,attachments:{[36064]:this.shadowMap,[36096]:this.depthBuffer}})}render(e){const n=this.fbo;St(this.gl,{depthRange:[0,1],depthTest:!0,blend:!1,clearColor:[1,1,1,1]},()=>{const r=e.viewports[0],i=vr(this.gl),s=r.width*i,o=r.height*i;(s!==n.width||o!==n.height)&&n.resize({width:s,height:o}),super.render({...e,target:n,pass:"shadow"})})}shouldDrawLayer(e){return e.props.shadowEnabled!==!1}getModuleParameters(){return{drawToShadowMap:!0}}delete(){this.fbo&&(this.fbo.delete(),this.fbo=null),this.shadowMap&&(this.shadowMap.delete(),this.shadowMap=null),this.depthBuffer&&(this.depthBuffer.delete(),this.depthBuffer=null)}}const qC={color:[255,255,255],intensity:1},Tp=[{color:[255,255,255],intensity:1,direction:[-1,3,-1]},{color:[255,255,255],intensity:.9,direction:[1,-8,-2.5]}],ZC=[0,0,0,200/255];class vf{constructor(e={}){d(this,"id","lighting-effect"),d(this,"props",null),d(this,"shadowColor",ZC),d(this,"shadow",void 0),d(this,"ambientLight",null),d(this,"directionalLights",[]),d(this,"pointLights",[]),d(this,"shadowPasses",[]),d(this,"shadowMaps",[]),d(this,"dummyShadowMap",null),d(this,"programManager",void 0),d(this,"shadowMatrices",void 0);for(const n in e){const r=e[n];switch(r.type){case"ambient":this.ambientLight=r;break;case"directional":this.directionalLights.push(r);break;case"point":this.pointLights.push(r);break}}this._applyDefaultLights(),this.shadow=this.directionalLights.some(n=>n.shadow)}preRender(e,{layers:n,layerFilter:r,viewports:i,onViewportActive:s,views:o}){if(this.shadow){this.shadowMatrices=this._calculateMatrices(),this.shadowPasses.length===0&&this._createShadowPasses(e),this.programManager||(this.programManager=Zs.getDefaultProgramManager(e),Cu&&this.programManager.addDefaultModule(Cu)),this.dummyShadowMap||(this.dummyShadowMap=new dt(e,{width:1,height:1}));for(let a=0;a<this.shadowPasses.length;a++)this.shadowPasses[a].render({layers:n,layerFilter:r,viewports:i,onViewportActive:s,views:o,moduleParameters:{shadowLightId:a,dummyShadowMap:this.dummyShadowMap,shadowMatrices:this.shadowMatrices}})}}getModuleParameters(e){const n=this.shadow?{shadowMaps:this.shadowMaps,dummyShadowMap:this.dummyShadowMap,shadowColor:this.shadowColor,shadowMatrices:this.shadowMatrices}:{};return n.lightSources={ambientLight:this.ambientLight,directionalLights:this.directionalLights.map(r=>r.getProjectedLight({layer:e})),pointLights:this.pointLights.map(r=>r.getProjectedLight({layer:e}))},n}cleanup(){for(const e of this.shadowPasses)e.delete();this.shadowPasses.length=0,this.shadowMaps.length=0,this.dummyShadowMap&&(this.dummyShadowMap.delete(),this.dummyShadowMap=null),this.shadow&&this.programManager&&(this.programManager.removeDefaultModule(Cu),this.programManager=null)}_calculateMatrices(){const e=[];for(const n of this.directionalLights){const r=new Pt().lookAt({eye:new Jt(n.direction).negate()});e.push(r)}return e}_createShadowPasses(e){for(let n=0;n<this.directionalLights.length;n++){const r=new $C(e);this.shadowPasses[n]=r,this.shadowMaps[n]=r.shadowMap}}_applyDefaultLights(){const{ambientLight:e,pointLights:n,directionalLights:r}=this;!e&&n.length===0&&r.length===0&&(this.ambientLight=new O_(qC),this.directionalLights.push(new Ep(Tp[0]),new Ep(Tp[1])))}}class QC{constructor(e={}){d(this,"_pool",[]),d(this,"opts",{overAlloc:2,poolSize:100}),this.setOptions(e)}setOptions(e){Object.assign(this.opts,e)}allocate(e,n,{size:r=1,type:i,padding:s=0,copy:o=!1,initialize:a=!1,maxCount:l}){const u=i||e&&e.constructor||Float32Array,c=n*r+s;if(ArrayBuffer.isView(e)){if(c<=e.length)return e;if(c*e.BYTES_PER_ELEMENT<=e.buffer.byteLength)return new u(e.buffer,0,c)}let h=1/0;l&&(h=l*r+s);const f=this._allocate(u,c,a,h);return e&&o?f.set(e):a||f.fill(0,0,4),this._release(e),f}release(e){this._release(e)}_allocate(e,n,r,i){let s=Math.max(Math.ceil(n*this.opts.overAlloc),1);s>i&&(s=i);const o=this._pool,a=e.BYTES_PER_ELEMENT*s,l=o.findIndex(u=>u.byteLength>=a);if(l>=0){const u=new e(o.splice(l,1)[0],0,s);return r&&u.fill(0),u}return new e(s)}_release(e){if(!ArrayBuffer.isView(e))return;const n=this._pool,{buffer:r}=e,{byteLength:i}=r,s=n.findIndex(o=>o.byteLength>=i);s<0?n.push(r):(s>0||n.length<this.opts.poolSize)&&n.splice(s,0,r),n.length>this.opts.poolSize&&n.shift()}}const Ns=new QC;function Ji(){return[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]}function KC(t,e){const n=t%e;return n<0?e+n:n}function JC(t){return[t[12],t[13],t[14]]}function eL(t){return{left:Ir(t[3]+t[0],t[7]+t[4],t[11]+t[8],t[15]+t[12]),right:Ir(t[3]-t[0],t[7]-t[4],t[11]-t[8],t[15]-t[12]),bottom:Ir(t[3]+t[1],t[7]+t[5],t[11]+t[9],t[15]+t[13]),top:Ir(t[3]-t[1],t[7]-t[5],t[11]-t[9],t[15]-t[13]),near:Ir(t[3]+t[2],t[7]+t[6],t[11]+t[10],t[15]+t[14]),far:Ir(t[3]-t[2],t[7]-t[6],t[11]-t[10],t[15]-t[14])}}const bp=new Jt;function Ir(t,e,n,r){bp.set(t,e,n);const i=bp.len();return{distance:r/i,normal:new Jt(-t/i,-e/i,-n/i)}}function tL(t){return t-Math.fround(t)}let Xi;function Lu(t,e){const{size:n=1,startIndex:r=0}=e,i=e.endIndex!==void 0?e.endIndex:t.length,s=(i-r)/n;Xi=Ns.allocate(Xi,s,{type:Float32Array,size:n*2});let o=r,a=0;for(;o<i;){for(let l=0;l<n;l++){const u=t[o++];Xi[a+l]=u,Xi[a+l+n]=tL(u)}a+=n*2}return Xi.subarray(0,s*n*2)}const nL=Math.PI/180,rL=Ji(),Sp=[0,0,0],iL={unitsPerMeter:[1,1,1],metersPerUnit:[1,1,1]};function sL({width:t,height:e,orthographic:n,fovyRadians:r,focalDistance:i,padding:s,near:o,far:a}){const l=t/e,u=n?new Pt().orthographic({fovy:r,aspect:l,focalDistance:i,near:o,far:a}):new Pt().perspective({fovy:r,aspect:l,near:o,far:a});if(s){const{left:c=0,right:h=0,top:f=0,bottom:g=0}=s,w=Me((c+t-h)/2,0,t)-t/2,E=Me((f+e-g)/2,0,e)-e/2;u[8]-=w*2/t,u[9]+=E*2/e}return u}class xr{constructor(e={}){d(this,"id",void 0),d(this,"x",void 0),d(this,"y",void 0),d(this,"width",void 0),d(this,"height",void 0),d(this,"padding",void 0),d(this,"isGeospatial",void 0),d(this,"zoom",void 0),d(this,"focalDistance",void 0),d(this,"position",void 0),d(this,"modelMatrix",void 0),d(this,"distanceScales",void 0),d(this,"scale",void 0),d(this,"center",void 0),d(this,"cameraPosition",void 0),d(this,"projectionMatrix",void 0),d(this,"viewMatrix",void 0),d(this,"viewMatrixUncentered",void 0),d(this,"viewMatrixInverse",void 0),d(this,"viewProjectionMatrix",void 0),d(this,"pixelProjectionMatrix",void 0),d(this,"pixelUnprojectionMatrix",void 0),d(this,"resolution",void 0),d(this,"_frustumPlanes",{}),this.id=e.id||this.constructor.displayName||"viewport",this.x=e.x||0,this.y=e.y||0,this.width=e.width||1,this.height=e.height||1,this.zoom=e.zoom||0,this.padding=e.padding,this.distanceScales=e.distanceScales||iL,this.focalDistance=e.focalDistance||1,this.position=e.position||Sp,this.modelMatrix=e.modelMatrix||null;const{longitude:n,latitude:r}=e;this.isGeospatial=Number.isFinite(r)&&Number.isFinite(n),this._initProps(e),this._initMatrices(e),this.equals=this.equals.bind(this),this.project=this.project.bind(this),this.unproject=this.unproject.bind(this),this.projectPosition=this.projectPosition.bind(this),this.unprojectPosition=this.unprojectPosition.bind(this),this.projectFlat=this.projectFlat.bind(this),this.unprojectFlat=this.unprojectFlat.bind(this)}get subViewports(){return null}get metersPerPixel(){return this.distanceScales.metersPerUnit[2]/this.scale}get projectionMode(){return this.isGeospatial?this.zoom<12?qt.WEB_MERCATOR:qt.WEB_MERCATOR_AUTO_OFFSET:qt.IDENTITY}equals(e){return e instanceof xr?this===e?!0:e.width===this.width&&e.height===this.height&&e.scale===this.scale&&yi(e.projectionMatrix,this.projectionMatrix)&&yi(e.viewMatrix,this.viewMatrix):!1}project(e,{topLeft:n=!0}={}){const r=this.projectPosition(e),i=k_(r,this.pixelProjectionMatrix),[s,o]=i,a=n?o:this.height-o;return e.length===2?[s,a]:[s,a,i[2]]}unproject(e,{topLeft:n=!0,targetZ:r}={}){const[i,s,o]=e,a=n?s:this.height-s,l=r&&r*this.distanceScales.unitsPerMeter[2],u=yl([i,a,o],this.pixelUnprojectionMatrix,l),[c,h,f]=this.unprojectPosition(u);return Number.isFinite(o)?[c,h,f]:Number.isFinite(r)?[c,h,r]:[c,h]}projectPosition(e){const[n,r]=this.projectFlat(e),i=(e[2]||0)*this.distanceScales.unitsPerMeter[2];return[n,r,i]}unprojectPosition(e){const[n,r]=this.unprojectFlat(e),i=(e[2]||0)*this.distanceScales.metersPerUnit[2];return[n,r,i]}projectFlat(e){if(this.isGeospatial){const n=za(e);return n[1]=Me(n[1],-318,830),n}return e}unprojectFlat(e){return this.isGeospatial?vi(e):e}getBounds(e={}){const n={targetZ:e.z||0},r=this.unproject([0,0],n),i=this.unproject([this.width,0],n),s=this.unproject([0,this.height],n),o=this.unproject([this.width,this.height],n);return[Math.min(r[0],i[0],s[0],o[0]),Math.min(r[1],i[1],s[1],o[1]),Math.max(r[0],i[0],s[0],o[0]),Math.max(r[1],i[1],s[1],o[1])]}getDistanceScales(e){return e?Zc({longitude:e[0],latitude:e[1],highPrecision:!0}):this.distanceScales}containsPixel({x:e,y:n,width:r=1,height:i=1}){return e<this.x+this.width&&this.x<e+r&&n<this.y+this.height&&this.y<n+i}getFrustumPlanes(){return this._frustumPlanes.near?this._frustumPlanes:(Object.assign(this._frustumPlanes,eL(this.viewProjectionMatrix)),this._frustumPlanes)}panByPosition(e,n){return null}_initProps(e){const n=e.longitude,r=e.latitude;this.isGeospatial&&(Number.isFinite(e.zoom)||(this.zoom=_C({latitude:r})+Math.log2(this.focalDistance)),this.distanceScales=e.distanceScales||Zc({latitude:r,longitude:n}));const i=Math.pow(2,this.zoom);this.scale=i;const{position:s,modelMatrix:o}=e;let a=Sp;if(s&&(a=o?new Pt(o).transformAsVector(s,[]):s),this.isGeospatial){const l=this.projectPosition([n,r,0]);this.center=new Jt(a).scale(this.distanceScales.unitsPerMeter).add(l)}else this.center=this.projectPosition(a)}_initMatrices(e){const{viewMatrix:n=rL,projectionMatrix:r=null,orthographic:i=!1,fovyRadians:s,fovy:o=75,near:a=.1,far:l=1e3,padding:u=null,focalDistance:c=1}=e;this.viewMatrixUncentered=n,this.viewMatrix=new Pt().multiplyRight(n).translate(new Jt(this.center).negate()),this.projectionMatrix=r||sL({width:this.width,height:this.height,orthographic:i,fovyRadians:s||o*nL,focalDistance:c,padding:u,near:a,far:l});const h=Ji();dr(h,h,this.projectionMatrix),dr(h,h,this.viewMatrix),this.viewProjectionMatrix=h,this.viewMatrixInverse=Wc([],this.viewMatrix)||this.viewMatrix,this.cameraPosition=JC(this.viewMatrixInverse);const f=Ji(),g=Ji();pf(f,f,[this.width/2,-this.height/2,1]),Ua(f,f,[1,-1,0]),dr(g,f,this.viewProjectionMatrix),this.pixelProjectionMatrix=g,this.pixelUnprojectionMatrix=Wc(Ji(),this.pixelProjectionMatrix),this.pixelUnprojectionMatrix||Q.warn("Pixel project matrix not invertible")()}}d(xr,"displayName","Viewport");const oL=512,aL=4003e4,lL=Math.PI/180;function Ap(t){const e=Math.cos(t*lL);return oL/aL/e}class $n extends xr{constructor(e={}){const{latitude:n=0,longitude:r=0,zoom:i=0,pitch:s=0,bearing:o=0,nearZMultiplier:a=.1,farZMultiplier:l=1.01,orthographic:u=!1,projectionMatrix:c,repeat:h=!1,worldOffset:f=0,legacyMeterSizes:g=!1}=e;let{width:w,height:E,altitude:T=1.5}=e;const y=Math.pow(2,i);w=w||1,E=E||1;let m,_=null;c?(T=c[5]/2,m=ja(T)):(e.fovy?(m=e.fovy,T=M_(m)):m=ja(T),_=wC({width:w,height:E,pitch:s,fovy:m,nearZMultiplier:a,farZMultiplier:l}));let S=vC({height:E,pitch:s,bearing:o,scale:y,altitude:T});f&&(S=new Pt().translate([512*f,0,0]).multiplyLeft(S)),super({...e,width:w,height:E,viewMatrix:S,longitude:r,latitude:n,zoom:i,..._,fovy:m,focalDistance:T}),d(this,"longitude",void 0),d(this,"latitude",void 0),d(this,"pitch",void 0),d(this,"bearing",void 0),d(this,"altitude",void 0),d(this,"fovy",void 0),d(this,"orthographic",void 0),d(this,"_subViewports",void 0),d(this,"_pseudoMeters",void 0),this.latitude=n,this.longitude=r,this.zoom=i,this.pitch=s,this.bearing=o,this.altitude=T,this.fovy=m,this.orthographic=u,this._subViewports=h?[]:null,this._pseudoMeters=g,Object.freeze(this)}get subViewports(){if(this._subViewports&&!this._subViewports.length){const e=this.getBounds(),n=Math.floor((e[0]+180)/360),r=Math.ceil((e[2]-180)/360);for(let i=n;i<=r;i++){const s=i?new $n({...this,worldOffset:i}):this;this._subViewports.push(s)}}return this._subViewports}projectPosition(e){if(this._pseudoMeters)return super.projectPosition(e);const[n,r]=this.projectFlat(e),i=(e[2]||0)*Ap(e[1]);return[n,r,i]}unprojectPosition(e){if(this._pseudoMeters)return super.unprojectPosition(e);const[n,r]=this.unprojectFlat(e),i=(e[2]||0)/Ap(r);return[n,r,i]}addMetersToLngLat(e,n){return R_(e,n)}panByPosition(e,n){const r=yl(n,this.pixelUnprojectionMatrix),i=this.projectFlat(e),s=Fa([],i,d_([],r)),o=Fa([],this.center,s),[a,l]=this.unprojectFlat(o);return{longitude:a,latitude:l}}getBounds(e={}){const n=TC(this,e.z||0);return[Math.min(n[0][0],n[1][0],n[2][0],n[3][0]),Math.min(n[0][1],n[1][1],n[2][1],n[3][1]),Math.max(n[0][0],n[1][0],n[2][0],n[3][0]),Math.max(n[0][1],n[1][1],n[2][1],n[3][1])]}fitBounds(e,n={}){const{width:r,height:i}=this,{longitude:s,latitude:o,zoom:a}=I_({width:r,height:i,bounds:e,...n});return new $n({width:r,height:i,longitude:s,latitude:o,zoom:a})}}d($n,"displayName","WebMercatorViewport");function Ru(t,e,n=!1){const r=e.projectPosition(t);if(n&&e instanceof $n){const[i,s,o=0]=t,a=e.getDistanceScales([i,s]);r[2]=o*a.unitsPerMeter[2]}return r}function uL(t){const{viewport:e,modelMatrix:n,coordinateOrigin:r}=t;let{coordinateSystem:i,fromCoordinateSystem:s,fromCoordinateOrigin:o}=t;return i===J.DEFAULT&&(i=e.isGeospatial?J.LNGLAT:J.CARTESIAN),s===void 0&&(s=i),o===void 0&&(o=r),{viewport:e,coordinateSystem:i,coordinateOrigin:r,modelMatrix:n,fromCoordinateSystem:s,fromCoordinateOrigin:o}}function D_(t,{viewport:e,modelMatrix:n,coordinateSystem:r,coordinateOrigin:i,offsetMode:s}){let[o,a,l=0]=t;switch(n&&([o,a,l]=qs([],[o,a,l,1],n)),r){case J.LNGLAT:return Ru([o,a,l],e,s);case J.LNGLAT_OFFSETS:return Ru([o+i[0],a+i[1],l+(i[2]||0)],e,s);case J.METER_OFFSETS:return Ru(R_(i,[o,a,l]),e,s);case J.CARTESIAN:default:return e.isGeospatial?[o+i[0],a+i[1],l+i[2]]:e.projectPosition([o,a,l])}}function F_(t,e){const{viewport:n,coordinateSystem:r,coordinateOrigin:i,modelMatrix:s,fromCoordinateSystem:o,fromCoordinateOrigin:a}=uL(e),{geospatialOrigin:l,shaderCoordinateOrigin:u,offsetMode:c}=C_(n,r,i),h=D_(t,{viewport:n,modelMatrix:s,coordinateSystem:o,coordinateOrigin:a,offsetMode:c});if(c){const f=n.projectPosition(l||u);WP(h,h,f)}return h}const cL=[255,255,255],hL=1,fL=[0,0,1],dL=[0,0,1];let gL=0;class U_{constructor(e={}){d(this,"id",void 0),d(this,"color",void 0),d(this,"intensity",void 0),d(this,"type","point"),d(this,"position",void 0),d(this,"attenuation",void 0),d(this,"projectedLight",void 0);const{color:n=cL}=e,{intensity:r=hL}=e,{position:i=dL}=e;this.id=e.id||"point-".concat(gL++),this.color=n,this.intensity=r,this.type="point",this.position=i,this.attenuation=pL(e),this.projectedLight={...this}}getProjectedLight({layer:e}){const{projectedLight:n}=this,r=e.context.viewport,{coordinateSystem:i,coordinateOrigin:s}=e.props,o=F_(this.position,{viewport:r,coordinateSystem:i,coordinateOrigin:s,fromCoordinateSystem:r.isGeospatial?J.LNGLAT:J.CARTESIAN,fromCoordinateOrigin:[0,0,0]});return n.color=this.color,n.intensity=this.intensity,n.position=o,n}}function pL(t){return t.attenuation?t.attenuation:"intensity"in t?[0,0,t.intensity||0]:fL}const Dr={NO_STATE:"Awaiting state",MATCHED:"Matched. State transferred from previous layer",INITIALIZED:"Initialized",AWAITING_GC:"Discarded. Awaiting garbage collection",AWAITING_FINALIZATION:"No longer matched. Awaiting garbage collection",FINALIZED:"Finalized! Awaiting garbage collection"},Ga=Symbol.for("component"),si=Symbol.for("asyncPropDefaults"),wr=Symbol.for("asyncPropOriginal"),Dn=Symbol.for("asyncPropResolved");function wf(t,e=()=>!0){return Array.isArray(t)?B_(t,e,[]):e(t)?[t]:[]}function B_(t,e,n){let r=-1;for(;++r<t.length;){const i=t[r];Array.isArray(i)?B_(i,e,n):e(i)&&n.push(i)}return n}function mL({target:t,source:e,start:n=0,count:r=1}){const i=e.length,s=r*i;let o=0;for(let a=n;o<i;o++)t[a++]=e[o];for(;o<s;)o<s-o?(t.copyWithin(n+o,n,n+o),o*=2):(t.copyWithin(n+o,n,n+s-o),o=s);return t}class yL{constructor(e,n,r){d(this,"id",void 0),d(this,"context",void 0),d(this,"isLoaded",void 0),d(this,"persistent",void 0),d(this,"_loadCount",0),d(this,"_subscribers",new Set),d(this,"_data",void 0),d(this,"_loader",void 0),d(this,"_error",void 0),d(this,"_content",void 0),this.id=e,this.context=r,this.setData(n)}subscribe(e){this._subscribers.add(e)}unsubscribe(e){this._subscribers.delete(e)}inUse(){return this._subscribers.size>0}delete(){}getData(){return this.isLoaded?this._error?Promise.reject(this._error):this._content:this._loader.then(()=>this.getData())}setData(e,n){if(e===this._data&&!n)return;this._data=e;const r=++this._loadCount;let i=e;typeof e=="string"&&(i=Ia(e)),i instanceof Promise?(this.isLoaded=!1,this._loader=i.then(s=>{this._loadCount===r&&(this.isLoaded=!0,this._error=void 0,this._content=s)}).catch(s=>{this._loadCount===r&&(this.isLoaded=!0,this._error=s||!0)})):(this.isLoaded=!0,this._error=void 0,this._content=e);for(const s of this._subscribers)s.onChange(this.getData())}}class _L{constructor({gl:e,protocol:n}){d(this,"protocol",void 0),d(this,"_context",void 0),d(this,"_resources",void 0),d(this,"_consumers",void 0),d(this,"_pruneRequest",void 0),this.protocol=n||"resource://",this._context={gl:e,resourceManager:this},this._resources={},this._consumers={},this._pruneRequest=null}contains(e){return e.startsWith(this.protocol)?!0:e in this._resources}add({resourceId:e,data:n,forceUpdate:r=!1,persistent:i=!0}){let s=this._resources[e];s?s.setData(n,r):(s=new yL(e,n,this._context),this._resources[e]=s),s.persistent=i}remove(e){const n=this._resources[e];n&&(n.delete(),delete this._resources[e])}unsubscribe({consumerId:e}){const n=this._consumers[e];if(n){for(const r in n){const i=n[r],s=this._resources[i.resourceId];s&&s.unsubscribe(i)}delete this._consumers[e],this.prune()}}subscribe({resourceId:e,onChange:n,consumerId:r,requestId:i="default"}){const{_resources:s,protocol:o}=this;e.startsWith(o)&&(e=e.replace(o,""),s[e]||this.add({resourceId:e,data:null,persistent:!1}));const a=s[e];if(this._track(r,i,a,n),a)return a.getData()}prune(){this._pruneRequest||(this._pruneRequest=setTimeout(()=>this._prune(),0))}finalize(){for(const e in this._resources)this._resources[e].delete()}_track(e,n,r,i){const s=this._consumers,o=s[e]=s[e]||{},a=o[n]||{},l=a.resourceId&&this._resources[a.resourceId];l&&(l.unsubscribe(a),this.prune()),r&&(o[n]=a,a.onChange=i,a.resourceId=r.id,r.subscribe(a))}_prune(){this._pruneRequest=null;for(const e of Object.keys(this._resources)){const n=this._resources[e];!n.persistent&&!n.inUse()&&(n.delete(),delete this._resources[e])}}}const vL="layerManager.setLayers",wL="layerManager.activateViewport";class EL{constructor(e,{deck:n,stats:r,viewport:i,timeline:s}={}){d(this,"layers",void 0),d(this,"context",void 0),d(this,"resourceManager",void 0),d(this,"_lastRenderedLayers",[]),d(this,"_needsRedraw",!1),d(this,"_needsUpdate",!1),d(this,"_nextLayers",null),d(this,"_debug",!1),d(this,"activateViewport",o=>{Ue(wL,this,o),o&&(this.context.viewport=o)}),this.layers=[],this.resourceManager=new _L({gl:e,protocol:"deck://"}),this.context={mousePosition:null,userData:{},layerManager:this,gl:e,deck:n,programManager:e&&FC(e),stats:r||new tf({id:"deck.gl"}),viewport:i||new xr({id:"DEFAULT-INITIAL-VIEWPORT"}),timeline:s||new S_,resourceManager:this.resourceManager,onError:void 0},Object.seal(this)}finalize(){this.resourceManager.finalize();for(const e of this.layers)this._finalizeLayer(e)}needsRedraw(e={clearRedrawFlags:!1}){let n=this._needsRedraw;e.clearRedrawFlags&&(this._needsRedraw=!1);for(const r of this.layers){const i=r.getNeedsRedraw(e);n=n||i}return n}needsUpdate(){return this._nextLayers&&this._nextLayers!==this._lastRenderedLayers?"layers changed":this._needsUpdate}setNeedsRedraw(e){this._needsRedraw=this._needsRedraw||e}setNeedsUpdate(e){this._needsUpdate=this._needsUpdate||e}getLayers({layerIds:e}={}){return e?this.layers.filter(n=>e.find(r=>n.id.indexOf(r)===0)):this.layers}setProps(e){"debug"in e&&(this._debug=e.debug),"userData"in e&&(this.context.userData=e.userData),"layers"in e&&(this._nextLayers=e.layers),"onError"in e&&(this.context.onError=e.onError)}setLayers(e,n){Ue(vL,this,n,e),this._lastRenderedLayers=e;const r=wf(e,Boolean);for(const i of r)i.context=this.context;this._updateLayers(this.layers,r)}updateLayers(){const e=this.needsUpdate();e&&(this.setNeedsRedraw("updating layers: ".concat(e)),this.setLayers(this._nextLayers||this._lastRenderedLayers,e)),this._nextLayers=null}_handleError(e,n,r){r.raiseError(n,"".concat(e," of ").concat(r))}_updateLayers(e,n){const r={};for(const o of e)r[o.id]?Q.warn("Multiple old layers with same id ".concat(o.id))():r[o.id]=o;const i=[];this._updateSublayersRecursively(n,r,i),this._finalizeOldLayers(r);let s=!1;for(const o of i)if(o.hasUniformTransition()){s="Uniform transition in ".concat(o);break}this._needsUpdate=s,this.layers=i}_updateSublayersRecursively(e,n,r){for(const i of e){i.context=this.context;const s=n[i.id];s===null&&Q.warn("Multiple new layers with same id ".concat(i.id))(),n[i.id]=null;let o=null;try{this._debug&&s!==i&&i.validateProps(),s?(this._transferLayerState(s,i),this._updateLayer(i)):this._initializeLayer(i),r.push(i),o=i.isComposite?i.getSubLayers():null}catch(a){this._handleError("matching",a,i)}o&&this._updateSublayersRecursively(o,n,r)}}_finalizeOldLayers(e){for(const n in e){const r=e[n];r&&this._finalizeLayer(r)}}_initializeLayer(e){try{e._initialize(),e.lifecycle=Dr.INITIALIZED}catch(n){this._handleError("initialization",n,e)}}_transferLayerState(e,n){n._transferState(e),n.lifecycle=Dr.MATCHED,n!==e&&(e.lifecycle=Dr.AWAITING_GC)}_updateLayer(e){try{e._update()}catch(n){this._handleError("update",n,e)}}_finalizeLayer(e){this._needsRedraw=this._needsRedraw||"finalized ".concat(e),e.lifecycle=Dr.AWAITING_FINALIZATION;try{e._finalize(),e.lifecycle=Dr.FINALIZED}catch(n){this._handleError("finalization",n,e)}}}function xi(t,e){if(t===e)return!0;if(!t||!e)return!1;for(const n in t){const r=t[n],i=e[n];if(!(r===i||Array.isArray(r)&&Array.isArray(i)&&xi(r,i)))return!1}return!0}class TL{constructor(e){d(this,"width",void 0),d(this,"height",void 0),d(this,"views",void 0),d(this,"viewState",void 0),d(this,"controllers",void 0),d(this,"timeline",void 0),d(this,"_viewports",void 0),d(this,"_viewportMap",void 0),d(this,"_isUpdating",void 0),d(this,"_needsRedraw",void 0),d(this,"_needsUpdate",void 0),d(this,"_eventManager",void 0),d(this,"_eventCallbacks",void 0),this.views=[],this.width=100,this.height=100,this.viewState={},this.controllers={},this.timeline=e.timeline,this._viewports=[],this._viewportMap={},this._isUpdating=!1,this._needsRedraw="First render",this._needsUpdate="Initialize",this._eventManager=e.eventManager,this._eventCallbacks={onViewStateChange:e.onViewStateChange,onInteractionStateChange:e.onInteractionStateChange},Object.seal(this),this.setProps(e)}finalize(){for(const e in this.controllers){const n=this.controllers[e];n&&n.finalize()}this.controllers={}}needsRedraw(e={clearRedrawFlags:!1}){const n=this._needsRedraw;return e.clearRedrawFlags&&(this._needsRedraw=!1),n}setNeedsUpdate(e){this._needsUpdate=this._needsUpdate||e,this._needsRedraw=this._needsRedraw||e}updateViewStates(){for(const e in this.controllers){const n=this.controllers[e];n&&n.updateTransition()}}getViewports(e){return e?this._viewports.filter(n=>n.containsPixel(e)):this._viewports}getViews(){const e={};return this.views.forEach(n=>{e[n.id]=n}),e}getView(e){return this.views.find(n=>n.id===e)}getViewState(e){const n=typeof e=="string"?this.getView(e):e,r=n&&this.viewState[n.getViewStateId()]||this.viewState;return n?n.filterViewState(r):r}getViewport(e){return this._viewportMap[e]}unproject(e,n){const r=this.getViewports(),i={x:e[0],y:e[1]};for(let s=r.length-1;s>=0;--s){const o=r[s];if(o.containsPixel(i)){const a=e.slice();return a[0]-=o.x,a[1]-=o.y,o.unproject(a,n)}}return null}setProps(e){e.views&&this._setViews(e.views),e.viewState&&this._setViewState(e.viewState),("width"in e||"height"in e)&&this._setSize(e.width,e.height),this._isUpdating||this._update()}_update(){this._isUpdating=!0,this._needsUpdate&&(this._needsUpdate=!1,this._rebuildViewports()),this._needsUpdate&&(this._needsUpdate=!1,this._rebuildViewports()),this._isUpdating=!1}_setSize(e,n){(e!==this.width||n!==this.height)&&(this.width=e,this.height=n,this.setNeedsUpdate("Size changed"))}_setViews(e){e=wf(e,Boolean),this._diffViews(e,this.views)&&this.setNeedsUpdate("views changed"),this.views=e}_setViewState(e){e?(!xi(e,this.viewState)&&this.setNeedsUpdate("viewState changed"),this.viewState=e):Q.warn("missing `viewState` or `initialViewState`")()}_onViewStateChange(e,n){this._eventCallbacks.onViewStateChange&&this._eventCallbacks.onViewStateChange({...n,viewId:e})}_createController(e,n){const r=n.type;return new r({timeline:this.timeline,eventManager:this._eventManager,onViewStateChange:this._onViewStateChange.bind(this,n.id),onStateChange:this._eventCallbacks.onInteractionStateChange,makeViewport:s=>{var o;return(o=this.getView(e.id))===null||o===void 0?void 0:o.makeViewport({viewState:s,width:this.width,height:this.height})}})}_updateController(e,n,r,i){const s=e.controller;if(s){const o={...n,...s,id:e.id,x:r.x,y:r.y,width:r.width,height:r.height};return i||(i=this._createController(e,o)),i&&i.setProps(o),i}return null}_rebuildViewports(){const{views:e}=this,n=this.controllers;this._viewports=[],this.controllers={};let r=!1;for(let i=e.length;i--;){const s=e[i],o=this.getViewState(s),a=s.makeViewport({viewState:o,width:this.width,height:this.height});let l=n[s.id];const u=Boolean(s.controller);u&&!l&&(r=!0),(r||!u)&&l&&(l.finalize(),l=null),this.controllers[s.id]=this._updateController(s,o,a,l),this._viewports.unshift(a)}for(const i in n){const s=n[i];s&&!this.controllers[i]&&s.finalize()}this._buildViewportMap()}_buildViewportMap(){this._viewportMap={},this._viewports.forEach(e=>{e.id&&(this._viewportMap[e.id]=this._viewportMap[e.id]||e)})}_diffViews(e,n){return e.length!==n.length?!0:e.some((r,i)=>!e[i].equals(n[i]))}}const bL=/([0-9]+\.?[0-9]*)(%|px)/;function Pn(t){switch(typeof t){case"number":return{position:t,relative:!1};case"string":const e=bL.exec(t);if(e&&e.length>=3){const n=e[2]==="%",r=parseFloat(e[1]);return{position:n?r/100:r,relative:n}}default:throw new Error("Could not parse position string ".concat(t))}}function Cn(t,e){return t.relative?Math.round(t.position*e):t.position}function Re(t,e){if(!t)throw new Error(e||"deck.gl: assertion failed.")}class Er{constructor(e){d(this,"id",void 0),d(this,"viewportInstance",void 0),d(this,"_x",void 0),d(this,"_y",void 0),d(this,"_width",void 0),d(this,"_height",void 0),d(this,"_padding",void 0),d(this,"props",void 0);const{id:n,x:r=0,y:i=0,width:s="100%",height:o="100%",padding:a=null,viewportInstance:l}=e||{};Re(!l||l instanceof xr),this.viewportInstance=l,this.id=n||this.constructor.displayName||"view",this.props={...e,id:this.id},this._x=Pn(r),this._y=Pn(i),this._width=Pn(s),this._height=Pn(o),this._padding=a&&{left:Pn(a.left||0),right:Pn(a.right||0),top:Pn(a.top||0),bottom:Pn(a.bottom||0)},this.equals=this.equals.bind(this),Object.seal(this)}equals(e){return this===e?!0:this.viewportInstance?e.viewportInstance?this.viewportInstance.equals(e.viewportInstance):!1:this.ViewportType===e.ViewportType&&xi(this.props,e.props)}makeViewport({width:e,height:n,viewState:r}){if(this.viewportInstance)return this.viewportInstance;r=this.filterViewState(r);const i=this.getDimensions({width:e,height:n});return new this.ViewportType({...r,...this.props,...i})}getViewStateId(){const{viewState:e}=this.props;return typeof e=="string"?e:e?.id||this.id}filterViewState(e){if(this.props.viewState&&typeof this.props.viewState=="object"){if(!this.props.viewState.id)return this.props.viewState;const n={...e};for(const r in this.props.viewState)r!=="id"&&(n[r]=this.props.viewState[r]);return n}return e}getDimensions({width:e,height:n}){const r={x:Cn(this._x,e),y:Cn(this._y,n),width:Cn(this._width,e),height:Cn(this._height,n)};return this._padding&&(r.padding={left:Cn(this._padding.left,e),top:Cn(this._padding.top,n),right:Cn(this._padding.right,e),bottom:Cn(this._padding.bottom,n)}),r}get controller(){const e=this.props.controller;return e?e===!0?{type:this.ControllerType}:typeof e=="function"?{type:e}:{type:this.ControllerType,...e}:null}}class Ks{constructor(e){d(this,"_inProgress",void 0),d(this,"_handle",void 0),d(this,"_timeline",void 0),d(this,"time",void 0),d(this,"settings",void 0),this._inProgress=!1,this._handle=null,this._timeline=e,this.time=0,this.settings={duration:0}}get inProgress(){return this._inProgress}start(e){var n,r;this.cancel(),this.settings=e,this._inProgress=!0,(n=(r=this.settings).onStart)===null||n===void 0||n.call(r,this)}end(){if(this._inProgress){var e,n;this._timeline.removeChannel(this._handle),this._handle=null,this._inProgress=!1,(e=(n=this.settings).onEnd)===null||e===void 0||e.call(n,this)}}cancel(){if(this._inProgress){var e,n;(e=(n=this.settings).onInterrupt)===null||e===void 0||e.call(n,this),this._timeline.removeChannel(this._handle),this._handle=null,this._inProgress=!1}}update(){var e,n;if(!this._inProgress)return!1;if(this._handle===null){const{_timeline:r,settings:i}=this;this._handle=r.addChannel({delay:r.getTime(),duration:i.duration})}return this.time=this._timeline.getTime(this._handle),this._onUpdate(),(e=(n=this.settings).onUpdate)===null||e===void 0||e.call(n,this),this._timeline.isFinished(this._handle)&&this.end(),!0}_onUpdate(){}}const xp=()=>{},Qc={BREAK:1,SNAP_TO_END:2,IGNORE:3},SL=t=>t,AL=Qc.BREAK;class xL{constructor(e){d(this,"getControllerState",void 0),d(this,"props",void 0),d(this,"propsInTransition",void 0),d(this,"transition",void 0),d(this,"onViewStateChange",void 0),d(this,"onStateChange",void 0),d(this,"_onTransitionUpdate",n=>{const{time:r,settings:{interpolator:i,startProps:s,endProps:o,duration:a,easing:l}}=n,u=l(r/a),c=i.interpolateProps(s,o,u);this.propsInTransition=this.getControllerState({...this.props,...c}).getViewportProps(),this.onViewStateChange({viewState:this.propsInTransition,oldViewState:this.props})}),this.getControllerState=e.getControllerState,this.propsInTransition=null,this.transition=new Ks(e.timeline),this.onViewStateChange=e.onViewStateChange||xp,this.onStateChange=e.onStateChange||xp}finalize(){this.transition.cancel()}getViewportInTransition(){return this.propsInTransition}processViewStateChange(e){let n=!1;const r=this.props;if(this.props=e,!r||this._shouldIgnoreViewportChange(r,e))return!1;if(this._isTransitionEnabled(e)){let i=r;if(this.transition.inProgress){const{interruption:s,endProps:o}=this.transition.settings;i={...r,...s===Qc.SNAP_TO_END?o:this.propsInTransition||r}}this._triggerTransition(i,e),n=!0}else this.transition.cancel();return n}updateTransition(){this.transition.update()}_isTransitionEnabled(e){const{transitionDuration:n,transitionInterpolator:r}=e;return(n>0||n==="auto")&&Boolean(r)}_isUpdateDueToCurrentTransition(e){return this.transition.inProgress&&this.propsInTransition?this.transition.settings.interpolator.arePropsEqual(e,this.propsInTransition):!1}_shouldIgnoreViewportChange(e,n){return this.transition.inProgress?this.transition.settings.interruption===Qc.IGNORE||this._isUpdateDueToCurrentTransition(n):this._isTransitionEnabled(n)?n.transitionInterpolator.arePropsEqual(e,n):!0}_triggerTransition(e,n){const r=this.getControllerState(e),i=this.getControllerState(n).shortestPathFrom(r),s=n.transitionInterpolator,o=s.getDuration?s.getDuration(e,n):n.transitionDuration;if(o===0)return;const a=s.initializeProps(e,i);this.propsInTransition={};const l={duration:o,easing:n.transitionEasing||SL,interpolator:s,interruption:n.transitionInterruption||AL,startProps:a.start,endProps:a.end,onStart:n.onTransitionStart,onUpdate:this._onTransitionUpdate,onInterrupt:this._onTransitionEnd(n.onTransitionInterrupt),onEnd:this._onTransitionEnd(n.onTransitionEnd)};this.transition.start(l),this.onStateChange({inTransition:!0}),this.updateTransition()}_onTransitionEnd(e){return n=>{this.propsInTransition=null,this.onStateChange({inTransition:!1,isZooming:!1,isPanning:!1,isRotating:!1}),e?.(n)}}}class PL{constructor(e){d(this,"_propsToCompare",void 0),d(this,"_propsToExtract",void 0),d(this,"_requiredProps",void 0);const{compare:n,extract:r,required:i}=e;this._propsToCompare=n,this._propsToExtract=r||n,this._requiredProps=i}arePropsEqual(e,n){for(const r of this._propsToCompare)if(!(r in e)||!(r in n)||!yi(e[r],n[r]))return!1;return!0}initializeProps(e,n){const r={},i={};for(const s of this._propsToExtract)(s in e||s in n)&&(r[s]=e[s],i[s]=n[s]);return this._checkRequiredProps(r),this._checkRequiredProps(i),{start:r,end:i}}getDuration(e,n){return n.transitionDuration}_checkRequiredProps(e){this._requiredProps&&this._requiredProps.forEach(n=>{const r=e[n];Re(Number.isFinite(r)||Array.isArray(r),"".concat(n," is required for transition"))})}}const CL=["longitude","latitude","zoom","bearing","pitch"],LL=["longitude","latitude","zoom"];class Ef extends PL{constructor(e={}){const n=Array.isArray(e)?e:e.transitionProps,r=Array.isArray(e)?{}:e;r.transitionProps=Array.isArray(n)?{compare:n,required:n}:n||{compare:CL,required:LL},super(r.transitionProps),d(this,"opts",void 0),this.opts=r}initializeProps(e,n){const r=super.initializeProps(e,n),{makeViewport:i,around:s}=this.opts;if(i&&s){const o=i(e),a=i(n),l=o.unproject(s);r.start.around=s,Object.assign(r.end,{around:a.project(l),aroundPosition:l,width:n.width,height:n.height})}return r}interpolateProps(e,n,r){const i={};for(const s of this._propsToExtract)i[s]=Da(e[s]||0,n[s]||0,r);if(n.aroundPosition&&this.opts.makeViewport){const s=this.opts.makeViewport({...n,...i});Object.assign(i,s.panByPosition(n.aroundPosition,Da(e.around,n.around,r)))}return i}}const Ln={transitionDuration:0},RL=300,Uo=t=>1-(1-t)*(1-t),Or={WHEEL:["wheel"],PAN:["panstart","panmove","panend"],PINCH:["pinchstart","pinchmove","pinchend"],TRIPLE_PAN:["tripanstart","tripanmove","tripanend"],DOUBLE_TAP:["doubletap"],KEYBOARD:["keydown"]},nr={};class V_{constructor(e){d(this,"props",void 0),d(this,"state",{}),d(this,"transitionManager",void 0),d(this,"eventManager",void 0),d(this,"onViewStateChange",void 0),d(this,"onStateChange",void 0),d(this,"makeViewport",void 0),d(this,"_controllerState",void 0),d(this,"_events",{}),d(this,"_interactionState",{isDragging:!1}),d(this,"_customEvents",[]),d(this,"_eventStartBlocked",null),d(this,"_panMove",!1),d(this,"invertPan",!1),d(this,"dragMode","rotate"),d(this,"inertia",0),d(this,"scrollZoom",!0),d(this,"dragPan",!0),d(this,"dragRotate",!0),d(this,"doubleClickZoom",!0),d(this,"touchZoom",!0),d(this,"touchRotate",!1),d(this,"keyboard",!0),this.transitionManager=new xL({...e,getControllerState:n=>new this.ControllerState(n),onViewStateChange:this._onTransition.bind(this),onStateChange:this._setInteractionState.bind(this)}),this.handleEvent=this.handleEvent.bind(this),this.eventManager=e.eventManager,this.onViewStateChange=e.onViewStateChange||(()=>{}),this.onStateChange=e.onStateChange||(()=>{}),this.makeViewport=e.makeViewport}set events(e){this.toggleEvents(this._customEvents,!1),this.toggleEvents(e,!0),this._customEvents=e,this.props&&this.setProps(this.props)}finalize(){for(const n in this._events)if(this._events[n]){var e;(e=this.eventManager)===null||e===void 0||e.off(n,this.handleEvent)}this.transitionManager.finalize()}handleEvent(e){this._controllerState=void 0;const n=this._eventStartBlocked;switch(e.type){case"panstart":return n?!1:this._onPanStart(e);case"panmove":return this._onPan(e);case"panend":return this._onPanEnd(e);case"pinchstart":return n?!1:this._onPinchStart(e);case"pinchmove":return this._onPinch(e);case"pinchend":return this._onPinchEnd(e);case"tripanstart":return n?!1:this._onTriplePanStart(e);case"tripanmove":return this._onTriplePan(e);case"tripanend":return this._onTriplePanEnd(e);case"doubletap":return this._onDoubleTap(e);case"wheel":return this._onWheel(e);case"keydown":return this._onKeyDown(e);default:return!1}}get controllerState(){return this._controllerState=this._controllerState||new this.ControllerState({makeViewport:this.makeViewport,...this.props,...this.state}),this._controllerState}getCenter(e){const{x:n,y:r}=this.props,{offsetCenter:i}=e;return[i.x-n,i.y-r]}isPointInBounds(e,n){const{width:r,height:i}=this.props;if(n&&n.handled)return!1;const s=e[0]>=0&&e[0]<=r&&e[1]>=0&&e[1]<=i;return s&&n&&n.stopPropagation(),s}isFunctionKeyPressed(e){const{srcEvent:n}=e;return Boolean(n.metaKey||n.altKey||n.ctrlKey||n.shiftKey)}isDragging(){return this._interactionState.isDragging||!1}blockEvents(e){const n=setTimeout(()=>{this._eventStartBlocked===n&&(this._eventStartBlocked=null)},e);this._eventStartBlocked=n}setProps(e){e.dragMode&&(this.dragMode=e.dragMode),this.props=e,"transitionInterpolator"in e||(e.transitionInterpolator=this._getTransitionProps().transitionInterpolator),this.transitionManager.processViewStateChange(e);const{inertia:n}=e;this.inertia=Number.isFinite(n)?n:n===!0?RL:0;const{scrollZoom:r=!0,dragPan:i=!0,dragRotate:s=!0,doubleClickZoom:o=!0,touchZoom:a=!0,touchRotate:l=!1,keyboard:u=!0}=e,c=Boolean(this.onViewStateChange);this.toggleEvents(Or.WHEEL,c&&r),this.toggleEvents(Or.PAN,c&&(i||s)),this.toggleEvents(Or.PINCH,c&&(a||l)),this.toggleEvents(Or.TRIPLE_PAN,c&&l),this.toggleEvents(Or.DOUBLE_TAP,c&&o),this.toggleEvents(Or.KEYBOARD,c&&u),this.scrollZoom=r,this.dragPan=i,this.dragRotate=s,this.doubleClickZoom=o,this.touchZoom=a,this.touchRotate=l,this.keyboard=u}updateTransition(){this.transitionManager.updateTransition()}toggleEvents(e,n){this.eventManager&&e.forEach(r=>{this._events[r]!==n&&(this._events[r]=n,n?this.eventManager.on(r,this.handleEvent):this.eventManager.off(r,this.handleEvent))})}updateViewport(e,n=null,r={}){const i={...e.getViewportProps(),...n},s=this.controllerState!==e;if(this.state=e.getState(),this._setInteractionState(r),s){const o=this.controllerState&&this.controllerState.getViewportProps();this.onViewStateChange&&this.onViewStateChange({viewState:i,interactionState:this._interactionState,oldViewState:o})}}_onTransition(e){this.onViewStateChange({...e,interactionState:this._interactionState})}_setInteractionState(e){Object.assign(this._interactionState,e),this.onStateChange(this._interactionState)}_onPanStart(e){const n=this.getCenter(e);if(!this.isPointInBounds(n,e))return!1;let r=this.isFunctionKeyPressed(e)||e.rightButton||!1;(this.invertPan||this.dragMode==="pan")&&(r=!r);const i=this.controllerState[r?"panStart":"rotateStart"]({pos:n});return this._panMove=r,this.updateViewport(i,Ln,{isDragging:!0}),!0}_onPan(e){return this.isDragging()?this._panMove?this._onPanMove(e):this._onPanRotate(e):!1}_onPanEnd(e){return this.isDragging()?this._panMove?this._onPanMoveEnd(e):this._onPanRotateEnd(e):!1}_onPanMove(e){if(!this.dragPan)return!1;const n=this.getCenter(e),r=this.controllerState.pan({pos:n});return this.updateViewport(r,Ln,{isDragging:!0,isPanning:!0}),!0}_onPanMoveEnd(e){const{inertia:n}=this;if(this.dragPan&&n&&e.velocity){const r=this.getCenter(e),i=[r[0]+e.velocityX*n/2,r[1]+e.velocityY*n/2],s=this.controllerState.pan({pos:i}).panEnd();this.updateViewport(s,{...this._getTransitionProps(),transitionDuration:n,transitionEasing:Uo},{isDragging:!1,isPanning:!0})}else{const r=this.controllerState.panEnd();this.updateViewport(r,null,{isDragging:!1,isPanning:!1})}return!0}_onPanRotate(e){if(!this.dragRotate)return!1;const n=this.getCenter(e),r=this.controllerState.rotate({pos:n});return this.updateViewport(r,Ln,{isDragging:!0,isRotating:!0}),!0}_onPanRotateEnd(e){const{inertia:n}=this;if(this.dragRotate&&n&&e.velocity){const r=this.getCenter(e),i=[r[0]+e.velocityX*n/2,r[1]+e.velocityY*n/2],s=this.controllerState.rotate({pos:i}).rotateEnd();this.updateViewport(s,{...this._getTransitionProps(),transitionDuration:n,transitionEasing:Uo},{isDragging:!1,isRotating:!0})}else{const r=this.controllerState.rotateEnd();this.updateViewport(r,null,{isDragging:!1,isRotating:!1})}return!0}_onWheel(e){if(!this.scrollZoom)return!1;e.srcEvent.preventDefault();const n=this.getCenter(e);if(!this.isPointInBounds(n,e))return!1;const{speed:r=.01,smooth:i=!1}=this.scrollZoom===!0?{}:this.scrollZoom,{delta:s}=e;let o=2/(1+Math.exp(-Math.abs(s*r)));s<0&&o!==0&&(o=1/o);const a=this.controllerState.zoom({pos:n,scale:o});return this.updateViewport(a,{...this._getTransitionProps({around:n}),transitionDuration:i?250:1},{isZooming:!0,isPanning:!0}),!0}_onTriplePanStart(e){const n=this.getCenter(e);if(!this.isPointInBounds(n,e))return!1;const r=this.controllerState.rotateStart({pos:n});return this.updateViewport(r,Ln,{isDragging:!0}),!0}_onTriplePan(e){if(!this.touchRotate||!this.isDragging())return!1;const n=this.getCenter(e);n[0]-=e.deltaX;const r=this.controllerState.rotate({pos:n});return this.updateViewport(r,Ln,{isDragging:!0,isRotating:!0}),!0}_onTriplePanEnd(e){if(!this.isDragging())return!1;const{inertia:n}=this;if(this.touchRotate&&n&&e.velocityY){const r=this.getCenter(e),i=[r[0],r[1]+=e.velocityY*n/2],s=this.controllerState.rotate({pos:i});this.updateViewport(s,{...this._getTransitionProps(),transitionDuration:n,transitionEasing:Uo},{isDragging:!1,isRotating:!0}),this.blockEvents(n)}else{const r=this.controllerState.rotateEnd();this.updateViewport(r,null,{isDragging:!1,isRotating:!1})}return!0}_onPinchStart(e){const n=this.getCenter(e);if(!this.isPointInBounds(n,e))return!1;const r=this.controllerState.zoomStart({pos:n}).rotateStart({pos:n});return nr._startPinchRotation=e.rotation,nr._lastPinchEvent=e,this.updateViewport(r,Ln,{isDragging:!0}),!0}_onPinch(e){if(!this.touchZoom&&!this.touchRotate||!this.isDragging())return!1;let n=this.controllerState;if(this.touchZoom){const{scale:r}=e,i=this.getCenter(e);n=n.zoom({pos:i,scale:r})}if(this.touchRotate){const{rotation:r}=e;n=n.rotate({deltaAngleX:nr._startPinchRotation-r})}return this.updateViewport(n,Ln,{isDragging:!0,isPanning:this.touchZoom,isZooming:this.touchZoom,isRotating:this.touchRotate}),nr._lastPinchEvent=e,!0}_onPinchEnd(e){if(!this.isDragging())return!1;const{inertia:n}=this,{_lastPinchEvent:r}=nr;if(this.touchZoom&&n&&r&&e.scale!==r.scale){const i=this.getCenter(e);let s=this.controllerState.rotateEnd();const o=Math.log2(e.scale),a=(o-Math.log2(r.scale))/(e.deltaTime-r.deltaTime),l=Math.pow(2,o+a*n/2);s=s.zoom({pos:i,scale:l}).zoomEnd(),this.updateViewport(s,{...this._getTransitionProps({around:i}),transitionDuration:n,transitionEasing:Uo},{isDragging:!1,isPanning:this.touchZoom,isZooming:this.touchZoom,isRotating:!1}),this.blockEvents(n)}else{const i=this.controllerState.zoomEnd().rotateEnd();this.updateViewport(i,null,{isDragging:!1,isPanning:!1,isZooming:!1,isRotating:!1})}return nr._startPinchRotation=null,nr._lastPinchEvent=null,!0}_onDoubleTap(e){if(!this.doubleClickZoom)return!1;const n=this.getCenter(e);if(!this.isPointInBounds(n,e))return!1;const r=this.isFunctionKeyPressed(e),i=this.controllerState.zoom({pos:n,scale:r?.5:2});return this.updateViewport(i,this._getTransitionProps({around:n}),{isZooming:!0,isPanning:!0}),this.blockEvents(100),!0}_onKeyDown(e){if(!this.keyboard)return!1;const n=this.isFunctionKeyPressed(e),{zoomSpeed:r,moveSpeed:i,rotateSpeedX:s,rotateSpeedY:o}=this.keyboard===!0?{}:this.keyboard,{controllerState:a}=this;let l;const u={};switch(e.srcEvent.code){case"Minus":l=n?a.zoomOut(r).zoomOut(r):a.zoomOut(r),u.isZooming=!0;break;case"Equal":l=n?a.zoomIn(r).zoomIn(r):a.zoomIn(r),u.isZooming=!0;break;case"ArrowLeft":n?(l=a.rotateLeft(s),u.isRotating=!0):(l=a.moveLeft(i),u.isPanning=!0);break;case"ArrowRight":n?(l=a.rotateRight(s),u.isRotating=!0):(l=a.moveRight(i),u.isPanning=!0);break;case"ArrowUp":n?(l=a.rotateUp(o),u.isRotating=!0):(l=a.moveUp(i),u.isPanning=!0);break;case"ArrowDown":n?(l=a.rotateDown(o),u.isRotating=!0):(l=a.moveDown(i),u.isPanning=!0);break;default:return!1}return this.updateViewport(l,this._getTransitionProps(),u),!0}_getTransitionProps(e){const{transition:n}=this;return!n||!n.transitionInterpolator?Ln:e?{...n,transitionInterpolator:new Ef({...e,...n.transitionInterpolator.opts,makeViewport:this.controllerState.makeViewport})}:n}}class z_{constructor(e,n){d(this,"_viewportProps",void 0),d(this,"_state",void 0),this._viewportProps=this.applyConstraints(e),this._state=n}getViewportProps(){return this._viewportProps}getState(){return this._state}}const Pp=5,ML=1.2;class kL extends z_{constructor(e){const{width:n,height:r,latitude:i,longitude:s,zoom:o,bearing:a=0,pitch:l=0,altitude:u=1.5,position:c=[0,0,0],maxZoom:h=20,minZoom:f=0,maxPitch:g=60,minPitch:w=0,startPanLngLat:E,startZoomLngLat:T,startRotatePos:y,startBearing:m,startPitch:_,startZoom:S,normalize:A=!0}=e;Re(Number.isFinite(s)),Re(Number.isFinite(i)),Re(Number.isFinite(o)),super({width:n,height:r,latitude:i,longitude:s,zoom:o,bearing:a,pitch:l,altitude:u,maxZoom:h,minZoom:f,maxPitch:g,minPitch:w,normalize:A,position:c},{startPanLngLat:E,startZoomLngLat:T,startRotatePos:y,startBearing:m,startPitch:_,startZoom:S}),d(this,"makeViewport",void 0),this.makeViewport=e.makeViewport}panStart({pos:e}){return this._getUpdatedState({startPanLngLat:this._unproject(e)})}pan({pos:e,startPos:n}){const r=this.getState().startPanLngLat||this._unproject(n);if(!r)return this;const s=this.makeViewport(this.getViewportProps()).panByPosition(r,e);return this._getUpdatedState(s)}panEnd(){return this._getUpdatedState({startPanLngLat:null})}rotateStart({pos:e}){return this._getUpdatedState({startRotatePos:e,startBearing:this.getViewportProps().bearing,startPitch:this.getViewportProps().pitch})}rotate({pos:e,deltaAngleX:n=0,deltaAngleY:r=0}){const{startRotatePos:i,startBearing:s,startPitch:o}=this.getState();if(!i||s===void 0||o===void 0)return this;let a;return e?a=this._getNewRotation(e,i,o,s):a={bearing:s+n,pitch:o+r},this._getUpdatedState(a)}rotateEnd(){return this._getUpdatedState({startBearing:null,startPitch:null})}zoomStart({pos:e}){return this._getUpdatedState({startZoomLngLat:this._unproject(e),startZoom:this.getViewportProps().zoom})}zoom({pos:e,startPos:n,scale:r}){let{startZoom:i,startZoomLngLat:s}=this.getState();if(s||(i=this.getViewportProps().zoom,s=this._unproject(n)||this._unproject(e)),!s)return this;const{maxZoom:o,minZoom:a}=this.getViewportProps();let l=i+Math.log2(r);l=Me(l,a,o);const u=this.makeViewport({...this.getViewportProps(),zoom:l});return this._getUpdatedState({zoom:l,...u.panByPosition(s,e)})}zoomEnd(){return this._getUpdatedState({startZoomLngLat:null,startZoom:null})}zoomIn(e=2){return this._zoomFromCenter(e)}zoomOut(e=2){return this._zoomFromCenter(1/e)}moveLeft(e=100){return this._panFromCenter([e,0])}moveRight(e=100){return this._panFromCenter([-e,0])}moveUp(e=100){return this._panFromCenter([0,e])}moveDown(e=100){return this._panFromCenter([0,-e])}rotateLeft(e=15){return this._getUpdatedState({bearing:this.getViewportProps().bearing-e})}rotateRight(e=15){return this._getUpdatedState({bearing:this.getViewportProps().bearing+e})}rotateUp(e=10){return this._getUpdatedState({pitch:this.getViewportProps().pitch+e})}rotateDown(e=10){return this._getUpdatedState({pitch:this.getViewportProps().pitch-e})}shortestPathFrom(e){const n=e.getViewportProps(),r={...this.getViewportProps()},{bearing:i,longitude:s}=r;return Math.abs(i-n.bearing)>180&&(r.bearing=i<0?i+360:i-360),Math.abs(s-n.longitude)>180&&(r.longitude=s<0?s+360:s-360),r}applyConstraints(e){const{maxZoom:n,minZoom:r,zoom:i}=e;e.zoom=Me(i,r,n);const{maxPitch:s,minPitch:o,pitch:a}=e;e.pitch=Me(a,o,s);const{normalize:l=!0}=e;return l&&Object.assign(e,bC(e)),e}_zoomFromCenter(e){const{width:n,height:r}=this.getViewportProps();return this.zoom({pos:[n/2,r/2],scale:e})}_panFromCenter(e){const{width:n,height:r}=this.getViewportProps();return this.pan({startPos:[n/2,r/2],pos:[n/2+e[0],r/2+e[1]]})}_getUpdatedState(e){return new this.constructor({makeViewport:this.makeViewport,...this.getViewportProps(),...this.getState(),...e})}_unproject(e){const n=this.makeViewport(this.getViewportProps());return e&&n.unproject(e)}_getNewRotation(e,n,r,i){const s=e[0]-n[0],o=e[1]-n[1],a=e[1],l=n[1],{width:u,height:c}=this.getViewportProps(),h=s/u;let f=0;o>0?Math.abs(c-l)>Pp&&(f=o/(l-c)*ML):o<0&&l>Pp&&(f=1-a/l),f=Me(f,-1,1);const{minPitch:g,maxPitch:w}=this.getViewportProps(),E=i+180*h;let T=r;return f>0?T=r+f*(w-r):f<0&&(T=r-f*(g-r)),{pitch:T,bearing:E}}}class IL extends V_{constructor(...e){super(...e),d(this,"ControllerState",kL),d(this,"transition",{transitionDuration:300,transitionInterpolator:new Ef({transitionProps:{compare:["longitude","latitude","zoom","bearing","pitch","position"],required:["longitude","latitude","zoom"]}})}),d(this,"dragMode","pan")}setProps(e){e.position=e.position||[0,0,0];const n=this.props;super.setProps(e),(!n||n.height!==e.height)&&this.updateViewport(new this.ControllerState({makeViewport:this.makeViewport,...e,...this.state}))}}class j_ extends Er{get ViewportType(){return $n}get ControllerType(){return IL}}d(j_,"displayName","MapView");class OL extends _l{constructor(e,n){super(e,n),d(this,"maskMap",void 0),d(this,"fbo",void 0);const{mapSize:r=2048}=n;this.maskMap=new dt(e,{width:r,height:r,parameters:{[10241]:9729,[10240]:9729,[10242]:33071,[10243]:33071}}),this.fbo=new we(e,{id:"maskmap",width:r,height:r,attachments:{[36064]:this.maskMap}})}render(e){const n=this.gl,r=[!1,!1,!1,!1];return r[e.channel]=!0,St(n,{clearColor:[255,255,255,255],blend:!0,blendFunc:[0,1],blendEquation:32778,colorMask:r,depthTest:!1},()=>super.render({...e,target:this.fbo,pass:"mask"}))}shouldDrawLayer(e){return e.props.operation===Qs.MASK}delete(){this.fbo.delete(),this.maskMap.delete()}}const NL=new Pt().lookAt({eye:[0,0,1]});function DL({width:t,height:e,near:n,far:r,padding:i}){let s=-t/2,o=t/2,a=-e/2,l=e/2;if(i){const{left:u=0,right:c=0,top:h=0,bottom:f=0}=i,g=Me((u+t-c)/2,0,t)-t/2,w=Me((h+e-f)/2,0,e)-e/2;s-=g,o-=g,a+=w,l+=w}return new Pt().ortho({left:s,right:o,bottom:a,top:l,near:n,far:r})}class FL extends xr{constructor(e){const{width:n,height:r,near:i=.1,far:s=1e3,zoom:o=0,target:a=[0,0,0],padding:l=null,flipY:u=!0}=e,c=Array.isArray(o)?o[0]:o,h=Array.isArray(o)?o[1]:o,f=Math.min(c,h),g=Math.pow(2,f);let w;if(c!==h){const E=Math.pow(2,c),T=Math.pow(2,h);w={unitsPerMeter:[E/g,T/g,1],metersPerUnit:[g/E,g/T,1]}}super({...e,longitude:void 0,position:a,viewMatrix:NL.clone().scale([g,g*(u?-1:1),g]),projectionMatrix:DL({width:n||1,height:r||1,padding:l,near:i,far:s}),zoom:f,distanceScales:w})}projectFlat([e,n]){const{unitsPerMeter:r}=this.distanceScales;return[e*r[0],n*r[1]]}unprojectFlat([e,n]){const{metersPerUnit:r}=this.distanceScales;return[e*r[0],n*r[1]]}panByPosition(e,n){const r=yl(n,this.pixelUnprojectionMatrix),i=this.projectFlat(e),s=Fa([],i,d_([],r)),o=Fa([],this.center,s);return{target:this.unprojectFlat(o)}}}class UL extends z_{constructor(e){const{width:n,height:r,rotationX:i=0,rotationOrbit:s=0,target:o=[0,0,0],zoom:a=0,minRotationX:l=-90,maxRotationX:u=90,minZoom:c=-1/0,maxZoom:h=1/0,startPanPosition:f,startRotatePos:g,startRotationX:w,startRotationOrbit:E,startZoomPosition:T,startZoom:y}=e;super({width:n,height:r,rotationX:i,rotationOrbit:s,target:o,zoom:a,minRotationX:l,maxRotationX:u,minZoom:c,maxZoom:h},{startPanPosition:f,startRotatePos:g,startRotationX:w,startRotationOrbit:E,startZoomPosition:T,startZoom:y}),d(this,"makeViewport",void 0),this.makeViewport=e.makeViewport}panStart({pos:e}){return this._getUpdatedState({startPanPosition:this._unproject(e)})}pan({pos:e,startPosition:n}){const r=this.getState().startPanPosition||n;if(!r)return this;const s=this.makeViewport(this.getViewportProps()).panByPosition(r,e);return this._getUpdatedState(s)}panEnd(){return this._getUpdatedState({startPanPosition:null})}rotateStart({pos:e}){return this._getUpdatedState({startRotatePos:e,startRotationX:this.getViewportProps().rotationX,startRotationOrbit:this.getViewportProps().rotationOrbit})}rotate({pos:e,deltaAngleX:n=0,deltaAngleY:r=0}){const{startRotatePos:i,startRotationX:s,startRotationOrbit:o}=this.getState(),{width:a,height:l}=this.getViewportProps();if(!i||s===void 0||o===void 0)return this;let u;if(e){let c=(e[0]-i[0])/a;const h=(e[1]-i[1])/l;(s<-90||s>90)&&(c*=-1),u={rotationX:s+h*180,rotationOrbit:o+c*180}}else u={rotationX:s+r,rotationOrbit:o+n};return this._getUpdatedState(u)}rotateEnd(){return this._getUpdatedState({startRotationX:null,startRotationOrbit:null})}shortestPathFrom(e){const n=e.getViewportProps(),r={...this.getViewportProps()},{rotationOrbit:i}=r;return Math.abs(i-n.rotationOrbit)>180&&(r.rotationOrbit=i<0?i+360:i-360),r}zoomStart({pos:e}){return this._getUpdatedState({startZoomPosition:this._unproject(e),startZoom:this.getViewportProps().zoom})}zoom({pos:e,startPos:n,scale:r}){let{startZoom:i,startZoomPosition:s}=this.getState();if(s||(i=this.getViewportProps().zoom,s=this._unproject(n)||this._unproject(e)),!s)return this;const o=this._calculateNewZoom({scale:r,startZoom:i}),a=this.makeViewport({...this.getViewportProps(),zoom:o});return this._getUpdatedState({zoom:o,...a.panByPosition(s,e)})}zoomEnd(){return this._getUpdatedState({startZoomPosition:null,startZoom:null})}zoomIn(e=2){return this._getUpdatedState({zoom:this._calculateNewZoom({scale:e})})}zoomOut(e=2){return this._getUpdatedState({zoom:this._calculateNewZoom({scale:1/e})})}moveLeft(e=50){return this._panFromCenter([-e,0])}moveRight(e=50){return this._panFromCenter([e,0])}moveUp(e=50){return this._panFromCenter([0,-e])}moveDown(e=50){return this._panFromCenter([0,e])}rotateLeft(e=15){return this._getUpdatedState({rotationOrbit:this.getViewportProps().rotationOrbit-e})}rotateRight(e=15){return this._getUpdatedState({rotationOrbit:this.getViewportProps().rotationOrbit+e})}rotateUp(e=10){return this._getUpdatedState({rotationX:this.getViewportProps().rotationX-e})}rotateDown(e=10){return this._getUpdatedState({rotationX:this.getViewportProps().rotationX+e})}_unproject(e){const n=this.makeViewport(this.getViewportProps());return e&&n.unproject(e)}_calculateNewZoom({scale:e,startZoom:n}){const{maxZoom:r,minZoom:i}=this.getViewportProps();n===void 0&&(n=this.getViewportProps().zoom);const s=n+Math.log2(e);return Me(s,i,r)}_panFromCenter(e){const{width:n,height:r,target:i}=this.getViewportProps();return this.pan({startPosition:i,pos:[n/2+e[0],r/2+e[1]]})}_getUpdatedState(e){return new this.constructor({makeViewport:this.makeViewport,...this.getViewportProps(),...this.getState(),...e})}applyConstraints(e){const{maxZoom:n,minZoom:r,zoom:i,maxRotationX:s,minRotationX:o,rotationOrbit:a}=e;return e.zoom=Array.isArray(i)?[Me(i[0],r,n),Me(i[1],r,n)]:Me(i,r,n),e.rotationX=Me(e.rotationX,o,s),(a<-180||a>180)&&(e.rotationOrbit=KC(a+180,360)-180),e}}class BL extends UL{constructor(e){super(e),d(this,"zoomAxis",void 0),this.zoomAxis=e.zoomAxis||"all"}_calculateNewZoom({scale:e,startZoom:n}){const{maxZoom:r,minZoom:i}=this.getViewportProps();n===void 0&&(n=this.getViewportProps().zoom);let s=Math.log2(e);if(Array.isArray(n)){let[o,a]=n;switch(this.zoomAxis){case"X":o=Me(o+s,i,r);break;case"Y":a=Me(a+s,i,r);break;default:let l=Math.min(o+s,a+s);l<i&&(s+=i-l),l=Math.max(o+s,a+s),l>r&&(s+=r-l),o+=s,a+=s}return[o,a]}return Me(n+s,i,r)}}class VL extends V_{constructor(...e){super(...e),d(this,"ControllerState",BL),d(this,"transition",{transitionDuration:300,transitionInterpolator:new Ef(["target","zoom"])}),d(this,"dragMode","pan")}_onPanRotate(){return!1}}class G_ extends Er{get ViewportType(){return FL}get ControllerType(){return VL}}d(G_,"displayName","OrthographicView");function zL({layers:t,viewport:e}){let n=null;for(const s of t){const o=s.getBounds();o&&(n?(n[0]=Math.min(n[0],o[0][0]),n[1]=Math.min(n[1],o[0][1]),n[2]=Math.max(n[2],o[1][0]),n[3]=Math.max(n[3],o[1][1])):n=[o[0][0],o[0][1],o[1][0],o[1][1]])}const r=e.getBounds();if(!n)return r;const i=GL(r);return n[2]-n[0]<i[2]-i[0]||n[3]-n[1]<i[3]-i[1]||(n[0]=Math.max(n[0],i[0]),n[1]=Math.max(n[1],i[1]),n[2]=Math.min(n[2],i[2]),n[3]=Math.min(n[3],i[3])),n}function jL({bounds:t,viewport:e,width:n,height:r}){if(t[2]<=t[0]||t[3]<=t[1])return null;const i=1;if(n-=i*2,r-=i*2,e instanceof $n){const{longitude:a,latitude:l,zoom:u}=I_({width:n,height:r,bounds:[[t[0],t[1]],[t[2],t[3]]],maxZoom:20});return new $n({longitude:a,latitude:l,zoom:u,x:i,y:i,width:n,height:r})}const s=[(t[0]+t[2])/2,(t[1]+t[3])/2,0],o=Math.min(20,n/(t[2]-t[0]),r/(t[3]-t[1]));return new G_({x:i,y:i}).makeViewport({width:n,height:r,viewState:{target:s,zoom:Math.log2(o)}})}function GL(t){const e={x:t[2]-t[0],y:t[3]-t[1]},n={x:t[0]+.5*e.x,y:t[1]+.5*e.y};return[n.x-e.x,n.y-e.y,n.x+e.x,n.y+e.y]}class HL{constructor(){d(this,"id","mask-effect"),d(this,"props",null),d(this,"useInPicking",!0),d(this,"dummyMaskMap",void 0),d(this,"channels",[]),d(this,"masks",null),d(this,"maskPass",void 0),d(this,"maskMap",void 0),d(this,"lastViewport",void 0)}preRender(e,{layers:n,layerFilter:r,viewports:i,onViewportActive:s,views:o}){this.dummyMaskMap||(this.dummyMaskMap=new dt(e,{width:1,height:1}));const a=n.filter(h=>h.props.visible&&h.props.operation===Qs.MASK);if(a.length===0){this.masks=null,this.channels.length=0;return}this.masks={},this.maskPass||(this.maskPass=new OL(e,{id:"default-mask"}),this.maskMap=this.maskPass.maskMap);const l=this._sortMaskChannels(a),u=i[0],c=!this.lastViewport||!this.lastViewport.equals(u);for(const h in l)this._renderChannel(l[h],{layerFilter:r,onViewportActive:s,views:o,viewport:u,viewportChanged:c})}_renderChannel(e,{layerFilter:n,onViewportActive:r,views:i,viewport:s,viewportChanged:o}){const a=this.channels[e.index];if(!a)return;const l=e===a||a.layers.length!==e.layers.length||e.layerBounds.some((u,c)=>u!==a.layerBounds[c]);if(e.bounds=a.bounds,e.maskBounds=a.maskBounds,this.channels[e.index]=e,(l||o)&&(this.lastViewport=s,e.bounds=zL({layers:e.layers,viewport:s}),l||!yi(e.bounds,a.bounds))){const{maskPass:u,maskMap:c}=this,h=jL({bounds:e.bounds,viewport:s,width:c.width,height:c.height});e.maskBounds=h?h.getBounds():[0,0,1,1],u.render({pass:"mask",channel:e.index,layers:e.layers,layerFilter:n,viewports:h?[h]:[],onViewportActive:r,views:i,moduleParameters:{devicePixelRatio:1}})}this.masks[e.id]={index:e.index,bounds:e.maskBounds,coordinateOrigin:e.coordinateOrigin,coordinateSystem:e.coordinateSystem}}_sortMaskChannels(e){const n={};let r=0;for(const i of e){const{id:s}=i.root;let o=n[s];if(!o){if(++r>4){Q.warn("Too many mask layers. The max supported is 4")();continue}o={id:s,index:this.channels.findIndex(a=>a?.id===s),layers:[],layerBounds:[],coordinateOrigin:i.root.props.coordinateOrigin,coordinateSystem:i.root.props.coordinateSystem},n[s]=o}o.layers.push(i),o.layerBounds.push(i.getBounds())}for(let i=0;i<4;i++){const s=this.channels[i];(!s||!(s.id in n))&&(this.channels[i]=null)}for(const i in n){const s=n[i];s.index<0&&(s.index=this.channels.findIndex(o=>!o),this.channels[s.index]=s)}return n}getModuleParameters(){return{maskMap:this.masks?this.maskMap:this.dummyMaskMap,maskChannels:this.masks}}cleanup(){this.dummyMaskMap&&(this.dummyMaskMap.delete(),this.dummyMaskMap=void 0),this.maskPass&&(this.maskPass.delete(),this.maskPass=void 0,this.maskMap=void 0),this.lastViewport=void 0,this.masks=null,this.channels.length=0}}const WL=new vf;class XL{constructor(){d(this,"effects",void 0),d(this,"_internalEffects",void 0),d(this,"_needsRedraw",void 0),this.effects=[],this._internalEffects=[],this._needsRedraw="Initial render",this.setEffects()}setProps(e){"effects"in e&&(e.effects.length!==this.effects.length||!xi(e.effects,this.effects))&&(this.setEffects(e.effects),this._needsRedraw="effects changed")}needsRedraw(e={clearRedrawFlags:!1}){const n=this._needsRedraw;return e.clearRedrawFlags&&(this._needsRedraw=!1),n}getEffects(){return this._internalEffects}finalize(){this.cleanup()}setEffects(e=[]){this.cleanup(),this.effects=e,this._internalEffects=e.slice(),this._internalEffects.push(new HL),e.some(n=>n instanceof vf)||this._internalEffects.push(WL)}cleanup(){for(const e of this.effects)e.cleanup();for(const e of this._internalEffects)e.cleanup();this.effects.length=0,this._internalEffects.length=0}}class YL extends _l{shouldDrawLayer(e){return e.props.operation===Qs.DRAW}}const Cp={blendFunc:[1,0,32771,0],blendEquation:32774};class H_ extends _l{constructor(...e){super(...e),d(this,"pickZ",void 0),d(this,"_colors",null)}render(e){return e.pickingFBO?this._drawPickingBuffer(e):super.render(e)}_drawPickingBuffer({layers:e,layerFilter:n,views:r,viewports:i,onViewportActive:s,pickingFBO:o,deviceRect:{x:a,y:l,width:u,height:c},cullRect:h,effects:f,pass:g="picking",pickZ:w}){const E=this.gl;this.pickZ=w;const T=w?null:{byLayer:new Map,byAlpha:[]};this._colors=T;const y=St(E,{scissorTest:!0,scissor:[a,l,u,c],clearColor:[0,0,0,0],depthMask:!0,depthTest:!0,depthRange:[0,1],colorMask:[!0,!0,!0,!0],...Cp,blend:!w},()=>super.render({target:o,layers:e,layerFilter:n,views:r,viewports:i,onViewportActive:s,cullRect:h,effects:f?.filter(_=>_.useInPicking),pass:g}));return this._colors=null,{decodePickingColor:T&&qL.bind(null,T),stats:y}}shouldDrawLayer(e){return e.props.pickable&&e.props.operation===Qs.DRAW}getModuleParameters(){return{pickingActive:1,pickingAttribute:this.pickZ,lightSources:{}}}getLayerParameters(e,n,r){const i={...e.props.parameters};return this._colors?(Object.assign(i,Cp),i.blend=!0,i.blendColor=$L(this._colors,e,r)):i.blend=!1,i}}function $L(t,e,n){const{byLayer:r,byAlpha:i}=t;let s,o=r.get(e);return o?(o.viewports.push(n),s=o.a):(s=r.size+1,s<=255?(o={a:s,layer:e,viewports:[n]},r.set(e,o),i[s]=o):(Q.warn("Too many pickable layers, only picking the first 255")(),s=0)),[0,0,0,s/255]}function qL(t,e){const n=t.byAlpha[e[3]];return n&&{pickedLayer:n.layer,pickedViewports:n.viewports,pickedObjectIndex:n.layer.decodePickingColor(e)}}const ZL="deckRenderer.renderLayers";class QL{constructor(e){this.gl=e,this.layerFilter=null,this.drawPickingColors=!1,this.drawLayersPass=new YL(e),this.pickLayersPass=new H_(e),this.renderCount=0,this._needsRedraw="Initial render",this.renderBuffers=[],this.lastPostProcessEffect=null}setProps(e){"layerFilter"in e&&this.layerFilter!==e.layerFilter&&(this.layerFilter=e.layerFilter,this._needsRedraw="layerFilter changed"),"drawPickingColors"in e&&this.drawPickingColors!==e.drawPickingColors&&(this.drawPickingColors=e.drawPickingColors,this._needsRedraw="drawPickingColors changed")}renderLayers(e){const n=this.drawPickingColors?this.pickLayersPass:this.drawLayersPass;e.layerFilter=e.layerFilter||this.layerFilter,e.effects=e.effects||[],e.target=e.target||we.getDefaultFramebuffer(this.gl),this._preRender(e.effects,e);const r=this.lastPostProcessEffect?this.renderBuffers[0]:e.target,i=n.render({...e,target:r});this._postRender(e.effects,e),this.renderCount++,Ue(ZL,this,i,e)}needsRedraw(e={clearRedrawFlags:!1}){const n=this._needsRedraw;return e.clearRedrawFlags&&(this._needsRedraw=!1),n}finalize(){const{renderBuffers:e}=this;for(const n of e)n.delete();e.length=0}_preRender(e,n){let r=null;for(const i of e)i.preRender(this.gl,n),i.postRender&&(r=i);r&&this._resizeRenderBuffers(),this.lastPostProcessEffect=r}_resizeRenderBuffers(){const{renderBuffers:e}=this;e.length===0&&e.push(new we(this.gl),new we(this.gl));for(const n of e)n.resize()}_postRender(e,n){const{renderBuffers:r}=this,i={inputBuffer:r[0],swapBuffer:r[1],target:null};for(const s of e)if(s.postRender){if(s===this.lastPostProcessEffect){i.target=n.target,s.postRender(this.gl,i);break}const o=s.postRender(this.gl,i);i.inputBuffer=o,i.swapBuffer=o===r[0]?r[1]:r[0]}}}const KL={pickedColor:null,pickedObjectIndex:-1};function JL({pickedColors:t,decodePickingColor:e,deviceX:n,deviceY:r,deviceRadius:i,deviceRect:s}){const{x:o,y:a,width:l,height:u}=s;let c=i*i,h=-1,f=0;for(let g=0;g<u;g++){const w=g+a-r,E=w*w;if(E>c)f+=4*l;else for(let T=0;T<l;T++){if(t[f+3]-1>=0){const m=T+o-n,_=m*m+E;_<=c&&(c=_,h=f)}f+=4}}if(h>=0){const g=t.slice(h,h+4),w=e(g);if(w){const E=Math.floor(h/4/l),T=h/4-E*l;return{...w,pickedColor:g,pickedX:o+T,pickedY:a+E}}Q.error("Picked non-existent layer. Is picking buffer corrupt?")()}return KL}function e3({pickedColors:t,decodePickingColor:e}){const n=new Map;if(t){for(let r=0;r<t.length;r+=4)if(t[r+3]-1>=0){const s=t.slice(r,r+4),o=s.join(",");if(!n.has(o)){const a=e(s);a?n.set(o,{...a,color:s}):Q.error("Picked non-existent layer. Is picking buffer corrupt?")()}}}return Array.from(n.values())}function W_({pickInfo:t,viewports:e,pixelRatio:n,x:r,y:i,z:s}){let o=e[0];e.length>1&&(o=n3(t?.pickedViewports||e,{x:r,y:i}));let a;if(o){const l=[r-o.x,i-o.y];s!==void 0&&(l[2]=s),a=o.unproject(l)}return{color:null,layer:null,viewport:o,index:-1,picked:!1,x:r,y:i,pixel:[r,i],coordinate:a,devicePixel:t&&"pickedX"in t?[t.pickedX,t.pickedY]:void 0,pixelRatio:n}}function t3(t){const{pickInfo:e,lastPickedInfo:n,mode:r,layers:i}=t,{pickedColor:s,pickedLayer:o,pickedObjectIndex:a}=e,l=o?[o]:[];if(r==="hover"){const h=n.index,f=n.layerId,g=o?o.props.id:null;if(g!==f||a!==h){if(g!==f){const w=i.find(E=>E.props.id===f);w&&l.unshift(w)}n.layerId=g,n.index=a,n.info=null}}const u=W_(t),c=new Map;return c.set(null,u),l.forEach(h=>{let f={...u};h===o&&(f.color=s,f.index=a,f.picked=!0),f=X_({layer:h,info:f,mode:r});const g=f.layer;h===o&&r==="hover"&&(n.info=f),c.set(g.id,f),r==="hover"&&g.updateAutoHighlight(f)}),c}function X_({layer:t,info:e,mode:n}){for(;t&&e;){const r=e.layer||null;e.sourceLayer=r,e.layer=t,e=t.getPickingInfo({info:e,mode:n,sourceLayer:r}),t=t.parent}return e}function n3(t,e){for(let n=t.length-1;n>=0;n--){const r=t[n];if(r.containsPixel(e))return r}return t[0]}class r3{constructor(e){d(this,"gl",void 0),d(this,"pickingFBO",void 0),d(this,"depthFBO",void 0),d(this,"pickLayersPass",void 0),d(this,"layerFilter",void 0),d(this,"lastPickedInfo",void 0),d(this,"_pickable",!0),this.gl=e,this.pickLayersPass=new H_(e),this.lastPickedInfo={index:-1,layerId:null,info:null}}setProps(e){"layerFilter"in e&&(this.layerFilter=e.layerFilter),"_pickable"in e&&(this._pickable=e._pickable)}finalize(){this.pickingFBO&&this.pickingFBO.delete(),this.depthFBO&&(this.depthFBO.color.delete(),this.depthFBO.delete())}pickObject(e){return this._pickClosestObject(e)}pickObjects(e){return this._pickVisibleObjects(e)}getLastPickedObject({x:e,y:n,layers:r,viewports:i},s=this.lastPickedInfo.info){const o=s&&s.layer&&s.layer.id,a=s&&s.viewport&&s.viewport.id,l=o?r.find(f=>f.id===o):null,u=a&&i.find(f=>f.id===a)||i[0],c=u&&u.unproject([e-u.x,n-u.y]);return{...s,...{x:e,y:n,viewport:u,coordinate:c,layer:l}}}_resizeBuffer(){var e,n;const{gl:r}=this;if(!this.pickingFBO&&(this.pickingFBO=new we(r),we.isSupported(r,{colorBufferFloat:!0}))){const i=new we(r);i.attach({[36064]:new dt(r,{format:Y(r)?34836:6408,type:5126})}),this.depthFBO=i}(e=this.pickingFBO)===null||e===void 0||e.resize({width:r.canvas.width,height:r.canvas.height}),(n=this.depthFBO)===null||n===void 0||n.resize({width:r.canvas.width,height:r.canvas.height})}_getPickable(e){if(this._pickable===!1)return null;const n=e.filter(r=>r.isPickable()&&!r.isComposite);return n.length?n:null}_pickClosestObject({layers:e,views:n,viewports:r,x:i,y:s,radius:o=0,depth:a=1,mode:l="query",unproject3D:u,onViewportActive:c,effects:h}){const f=this._getPickable(e),g=vr(this.gl);if(!f)return{result:[],emptyInfo:W_({viewports:r,x:i,y:s,pixelRatio:g})};this._resizeBuffer();const w=gu(this.gl,[i,s],!0),E=[w.x+Math.floor(w.width/2),w.y+Math.floor(w.height/2)],T=Math.round(o*g),{width:y,height:m}=this.pickingFBO,_=this._getPickingRect({deviceX:E[0],deviceY:E[1],deviceRadius:T,deviceWidth:y,deviceHeight:m}),S={x:i-o,y:s-o,width:o*2+1,height:o*2+1};let A;const P=[],L=new Set;for(let C=0;C<a;C++){let R;if(_){const O=this._drawAndSample({layers:f,views:n,viewports:r,onViewportActive:c,deviceRect:_,cullRect:S,effects:h,pass:"picking:".concat(l)});R=JL({...O,deviceX:E[0],deviceY:E[1],deviceRadius:T,deviceRect:_})}else R={pickedColor:null,pickedObjectIndex:-1};let M;R.pickedLayer&&u&&this.depthFBO&&(M=this._drawAndSample({layers:[R.pickedLayer],views:n,viewports:r,onViewportActive:c,deviceRect:{x:R.pickedX,y:R.pickedY,width:1,height:1},cullRect:S,effects:h,pass:"picking:".concat(l,":z")},!0).pickedColors[0]),R.pickedLayer&&C+1<a&&(L.add(R.pickedLayer),R.pickedLayer.disablePickingIndex(R.pickedObjectIndex)),A=t3({pickInfo:R,lastPickedInfo:this.lastPickedInfo,mode:l,layers:f,viewports:r,x:i,y:s,z:M,pixelRatio:g});for(const O of A.values())O.layer&&P.push(O);if(!R.pickedColor)break}for(const C of L)C.restorePickingColors();return{result:P,emptyInfo:A.get(null)}}_pickVisibleObjects({layers:e,views:n,viewports:r,x:i,y:s,width:o=1,height:a=1,mode:l="query",maxObjects:u=null,onViewportActive:c,effects:h}){const f=this._getPickable(e);if(!f)return[];this._resizeBuffer();const g=vr(this.gl),w=gu(this.gl,[i,s],!0),E=w.x,T=w.y+w.height,y=gu(this.gl,[i+o,s+a],!0),m=y.x+y.width,_=y.y,S={x:E,y:_,width:m-E,height:T-_},A=this._drawAndSample({layers:f,views:n,viewports:r,onViewportActive:c,deviceRect:S,cullRect:{x:i,y:s,width:o,height:a},effects:h,pass:"picking:".concat(l)}),P=e3(A),L=new Map,C=Number.isFinite(u);for(let R=0;R<P.length&&!(C&&u&&L.size>=u);R++){const M=P[R];let O={color:M.pickedColor,layer:null,index:M.pickedObjectIndex,picked:!0,x:i,y:s,pixelRatio:g};O=X_({layer:M.pickedLayer,info:O,mode:l}),L.has(O.object)||L.set(O.object,O)}return Array.from(L.values())}_drawAndSample({layers:e,views:n,viewports:r,onViewportActive:i,deviceRect:s,cullRect:o,effects:a,pass:l},u=!1){const c=u?this.depthFBO:this.pickingFBO,{decodePickingColor:h}=this.pickLayersPass.render({layers:e,layerFilter:this.layerFilter,views:n,viewports:r,onViewportActive:i,pickingFBO:c,deviceRect:s,cullRect:o,effects:a,pass:l,pickZ:u}),{x:f,y:g,width:w,height:E}=s,T=new(u?Float32Array:Uint8Array)(w*E*4);return pl(c,{sourceX:f,sourceY:g,sourceWidth:w,sourceHeight:E,target:T}),{pickedColors:T,decodePickingColor:h}}_getPickingRect({deviceX:e,deviceY:n,deviceRadius:r,deviceWidth:i,deviceHeight:s}){const o=Math.max(0,e-r),a=Math.max(0,n-r),l=Math.min(i,e+r+1)-o,u=Math.min(s,n+r+1)-a;return l<=0||u<=0?null:{x:o,y:a,width:l,height:u}}}const i3={zIndex:"1",position:"absolute",pointerEvents:"none",color:"#a0a7b4",backgroundColor:"#29323c",padding:"10px",top:"0",left:"0",display:"none"};class s3{constructor(e){d(this,"el",null),d(this,"isVisible",!1);const n=e.parentElement;n&&(this.el=document.createElement("div"),this.el.className="deck-tooltip",Object.assign(this.el.style,i3),n.appendChild(this.el))}setTooltip(e,n,r){const i=this.el;if(i){if(typeof e=="string")i.innerText=e;else if(e)e.text&&(i.innerText=e.text),e.html&&(i.innerHTML=e.html),e.className&&(i.className=e.className),Object.assign(i.style,e.style);else{this.isVisible=!1,i.style.display="none";return}this.isVisible=!0,i.style.display="block",i.style.transform="translate(".concat(n,"px, ").concat(r,"px)")}}remove(){this.el&&(this.el.remove(),this.el=null)}}var Tr={},o3={get exports(){return Tr},set exports(t){Tr=t}};/*! Hammer.JS - v2.0.7 - 2016-04-22
 * http://hammerjs.github.io/
 *
 * Copyright (c) 2016 Jorik Tangelder;
 * Licensed under the MIT license */(function(t){(function(e,n,r,i){var s=["","webkit","Moz","MS","ms","o"],o=n.createElement("div"),a="function",l=Math.round,u=Math.abs,c=Date.now;function h(p,v,b){return setTimeout(_(p,b),v)}function f(p,v,b){return Array.isArray(p)?(g(p,b[v],b),!0):!1}function g(p,v,b){var x;if(p)if(p.forEach)p.forEach(v,b);else if(p.length!==i)for(x=0;x<p.length;)v.call(b,p[x],x,p),x++;else for(x in p)p.hasOwnProperty(x)&&v.call(b,p[x],x,p)}function w(p,v,b){var x="DEPRECATED METHOD: "+v+`
`+b+` AT 
`;return function(){var k=new Error("get-stack-trace"),U=k&&k.stack?k.stack.replace(/^[^\(]+?[\n$]/gm,"").replace(/^\s+at\s+/gm,"").replace(/^Object.<anonymous>\s*\(/gm,"{anonymous}()@"):"Unknown Stack Trace",X=e.console&&(e.console.warn||e.console.log);return X&&X.call(e.console,x,U),p.apply(this,arguments)}}var E;typeof Object.assign!="function"?E=function(v){if(v===i||v===null)throw new TypeError("Cannot convert undefined or null to object");for(var b=Object(v),x=1;x<arguments.length;x++){var k=arguments[x];if(k!==i&&k!==null)for(var U in k)k.hasOwnProperty(U)&&(b[U]=k[U])}return b}:E=Object.assign;var T=w(function(v,b,x){for(var k=Object.keys(b),U=0;U<k.length;)(!x||x&&v[k[U]]===i)&&(v[k[U]]=b[k[U]]),U++;return v},"extend","Use `assign`."),y=w(function(v,b){return T(v,b,!0)},"merge","Use `assign`.");function m(p,v,b){var x=v.prototype,k;k=p.prototype=Object.create(x),k.constructor=p,k._super=x,b&&E(k,b)}function _(p,v){return function(){return p.apply(v,arguments)}}function S(p,v){return typeof p==a?p.apply(v&&v[0]||i,v):p}function A(p,v){return p===i?v:p}function P(p,v,b){g(M(v),function(x){p.addEventListener(x,b,!1)})}function L(p,v,b){g(M(v),function(x){p.removeEventListener(x,b,!1)})}function C(p,v){for(;p;){if(p==v)return!0;p=p.parentNode}return!1}function R(p,v){return p.indexOf(v)>-1}function M(p){return p.trim().split(/\s+/g)}function O(p,v,b){if(p.indexOf&&!b)return p.indexOf(v);for(var x=0;x<p.length;){if(b&&p[x][b]==v||!b&&p[x]===v)return x;x++}return-1}function D(p){return Array.prototype.slice.call(p,0)}function G(p,v,b){for(var x=[],k=[],U=0;U<p.length;){var X=v?p[U][v]:p[U];O(k,X)<0&&x.push(p[U]),k[U]=X,U++}return b&&(v?x=x.sort(function(Pe,ze){return Pe[v]>ze[v]}):x=x.sort()),x}function V(p,v){for(var b,x,k=v[0].toUpperCase()+v.slice(1),U=0;U<s.length;){if(b=s[U],x=b?b+k:v,x in p)return x;U++}return i}var K=1;function mt(){return K++}function qe(p){var v=p.ownerDocument||p;return v.defaultView||v.parentWindow||e}var N=/mobile|tablet|ip(ad|hone|od)|android/i,j="ontouchstart"in e,W=V(e,"PointerEvent")!==i,H=j&&N.test(navigator.userAgent),$="touch",ue="pen",Oe="mouse",Ct="kinect",en=25,ye=1,Kn=2,_e=4,Ze=8,eo=1,Pi=2,Ci=4,Li=8,Ri=16,Bt=Pi|Ci,Jn=Li|Ri,kf=Bt|Jn,If=["x","y"],to=["clientX","clientY"];function yt(p,v){var b=this;this.manager=p,this.callback=v,this.element=p.element,this.target=p.options.inputTarget,this.domHandler=function(x){S(p.options.enable,[p])&&b.handler(x)},this.init()}yt.prototype={handler:function(){},init:function(){this.evEl&&P(this.element,this.evEl,this.domHandler),this.evTarget&&P(this.target,this.evTarget,this.domHandler),this.evWin&&P(qe(this.element),this.evWin,this.domHandler)},destroy:function(){this.evEl&&L(this.element,this.evEl,this.domHandler),this.evTarget&&L(this.target,this.evTarget,this.domHandler),this.evWin&&L(qe(this.element),this.evWin,this.domHandler)}};function Cv(p){var v,b=p.options.inputClass;return b?v=b:W?v=Al:H?v=io:j?v=xl:v=ro,new v(p,Lv)}function Lv(p,v,b){var x=b.pointers.length,k=b.changedPointers.length,U=v&ye&&x-k===0,X=v&(_e|Ze)&&x-k===0;b.isFirst=!!U,b.isFinal=!!X,U&&(p.session={}),b.eventType=v,Rv(p,b),p.emit("hammer.input",b),p.recognize(b),p.session.prevInput=b}function Rv(p,v){var b=p.session,x=v.pointers,k=x.length;b.firstInput||(b.firstInput=Of(v)),k>1&&!b.firstMultiple?b.firstMultiple=Of(v):k===1&&(b.firstMultiple=!1);var U=b.firstInput,X=b.firstMultiple,Se=X?X.center:U.center,Pe=v.center=Nf(x);v.timeStamp=c(),v.deltaTime=v.timeStamp-U.timeStamp,v.angle=Sl(Se,Pe),v.distance=no(Se,Pe),Mv(b,v),v.offsetDirection=Ff(v.deltaX,v.deltaY);var ze=Df(v.deltaTime,v.deltaX,v.deltaY);v.overallVelocityX=ze.x,v.overallVelocityY=ze.y,v.overallVelocity=u(ze.x)>u(ze.y)?ze.x:ze.y,v.scale=X?Ov(X.pointers,x):1,v.rotation=X?Iv(X.pointers,x):0,v.maxPointers=b.prevInput?v.pointers.length>b.prevInput.maxPointers?v.pointers.length:b.prevInput.maxPointers:v.pointers.length,kv(b,v);var zt=p.element;C(v.srcEvent.target,zt)&&(zt=v.srcEvent.target),v.target=zt}function Mv(p,v){var b=v.center,x=p.offsetDelta||{},k=p.prevDelta||{},U=p.prevInput||{};(v.eventType===ye||U.eventType===_e)&&(k=p.prevDelta={x:U.deltaX||0,y:U.deltaY||0},x=p.offsetDelta={x:b.x,y:b.y}),v.deltaX=k.x+(b.x-x.x),v.deltaY=k.y+(b.y-x.y)}function kv(p,v){var b=p.lastInterval||v,x=v.timeStamp-b.timeStamp,k,U,X,Se;if(v.eventType!=Ze&&(x>en||b.velocity===i)){var Pe=v.deltaX-b.deltaX,ze=v.deltaY-b.deltaY,zt=Df(x,Pe,ze);U=zt.x,X=zt.y,k=u(zt.x)>u(zt.y)?zt.x:zt.y,Se=Ff(Pe,ze),p.lastInterval=v}else k=b.velocity,U=b.velocityX,X=b.velocityY,Se=b.direction;v.velocity=k,v.velocityX=U,v.velocityY=X,v.direction=Se}function Of(p){for(var v=[],b=0;b<p.pointers.length;)v[b]={clientX:l(p.pointers[b].clientX),clientY:l(p.pointers[b].clientY)},b++;return{timeStamp:c(),pointers:v,center:Nf(v),deltaX:p.deltaX,deltaY:p.deltaY}}function Nf(p){var v=p.length;if(v===1)return{x:l(p[0].clientX),y:l(p[0].clientY)};for(var b=0,x=0,k=0;k<v;)b+=p[k].clientX,x+=p[k].clientY,k++;return{x:l(b/v),y:l(x/v)}}function Df(p,v,b){return{x:v/p||0,y:b/p||0}}function Ff(p,v){return p===v?eo:u(p)>=u(v)?p<0?Pi:Ci:v<0?Li:Ri}function no(p,v,b){b||(b=If);var x=v[b[0]]-p[b[0]],k=v[b[1]]-p[b[1]];return Math.sqrt(x*x+k*k)}function Sl(p,v,b){b||(b=If);var x=v[b[0]]-p[b[0]],k=v[b[1]]-p[b[1]];return Math.atan2(k,x)*180/Math.PI}function Iv(p,v){return Sl(v[1],v[0],to)+Sl(p[1],p[0],to)}function Ov(p,v){return no(v[0],v[1],to)/no(p[0],p[1],to)}var Nv={mousedown:ye,mousemove:Kn,mouseup:_e},Dv="mousedown",Fv="mousemove mouseup";function ro(){this.evEl=Dv,this.evWin=Fv,this.pressed=!1,yt.apply(this,arguments)}m(ro,yt,{handler:function(v){var b=Nv[v.type];b&ye&&v.button===0&&(this.pressed=!0),b&Kn&&v.which!==1&&(b=_e),this.pressed&&(b&_e&&(this.pressed=!1),this.callback(this.manager,b,{pointers:[v],changedPointers:[v],pointerType:Oe,srcEvent:v}))}});var Uv={pointerdown:ye,pointermove:Kn,pointerup:_e,pointercancel:Ze,pointerout:Ze},Bv={2:$,3:ue,4:Oe,5:Ct},Uf="pointerdown",Bf="pointermove pointerup pointercancel";e.MSPointerEvent&&!e.PointerEvent&&(Uf="MSPointerDown",Bf="MSPointerMove MSPointerUp MSPointerCancel");function Al(){this.evEl=Uf,this.evWin=Bf,yt.apply(this,arguments),this.store=this.manager.session.pointerEvents=[]}m(Al,yt,{handler:function(v){var b=this.store,x=!1,k=v.type.toLowerCase().replace("ms",""),U=Uv[k],X=Bv[v.pointerType]||v.pointerType,Se=X==$,Pe=O(b,v.pointerId,"pointerId");U&ye&&(v.button===0||Se)?Pe<0&&(b.push(v),Pe=b.length-1):U&(_e|Ze)&&(x=!0),!(Pe<0)&&(b[Pe]=v,this.callback(this.manager,U,{pointers:b,changedPointers:[v],pointerType:X,srcEvent:v}),x&&b.splice(Pe,1))}});var Vv={touchstart:ye,touchmove:Kn,touchend:_e,touchcancel:Ze},zv="touchstart",jv="touchstart touchmove touchend touchcancel";function Vf(){this.evTarget=zv,this.evWin=jv,this.started=!1,yt.apply(this,arguments)}m(Vf,yt,{handler:function(v){var b=Vv[v.type];if(b===ye&&(this.started=!0),!!this.started){var x=Gv.call(this,v,b);b&(_e|Ze)&&x[0].length-x[1].length===0&&(this.started=!1),this.callback(this.manager,b,{pointers:x[0],changedPointers:x[1],pointerType:$,srcEvent:v})}}});function Gv(p,v){var b=D(p.touches),x=D(p.changedTouches);return v&(_e|Ze)&&(b=G(b.concat(x),"identifier",!0)),[b,x]}var Hv={touchstart:ye,touchmove:Kn,touchend:_e,touchcancel:Ze},Wv="touchstart touchmove touchend touchcancel";function io(){this.evTarget=Wv,this.targetIds={},yt.apply(this,arguments)}m(io,yt,{handler:function(v){var b=Hv[v.type],x=Xv.call(this,v,b);x&&this.callback(this.manager,b,{pointers:x[0],changedPointers:x[1],pointerType:$,srcEvent:v})}});function Xv(p,v){var b=D(p.touches),x=this.targetIds;if(v&(ye|Kn)&&b.length===1)return x[b[0].identifier]=!0,[b,b];var k,U,X=D(p.changedTouches),Se=[],Pe=this.target;if(U=b.filter(function(ze){return C(ze.target,Pe)}),v===ye)for(k=0;k<U.length;)x[U[k].identifier]=!0,k++;for(k=0;k<X.length;)x[X[k].identifier]&&Se.push(X[k]),v&(_e|Ze)&&delete x[X[k].identifier],k++;if(Se.length)return[G(U.concat(Se),"identifier",!0),Se]}var Yv=2500,zf=25;function xl(){yt.apply(this,arguments);var p=_(this.handler,this);this.touch=new io(this.manager,p),this.mouse=new ro(this.manager,p),this.primaryTouch=null,this.lastTouches=[]}m(xl,yt,{handler:function(v,b,x){var k=x.pointerType==$,U=x.pointerType==Oe;if(!(U&&x.sourceCapabilities&&x.sourceCapabilities.firesTouchEvents)){if(k)$v.call(this,b,x);else if(U&&qv.call(this,x))return;this.callback(v,b,x)}},destroy:function(){this.touch.destroy(),this.mouse.destroy()}});function $v(p,v){p&ye?(this.primaryTouch=v.changedPointers[0].identifier,jf.call(this,v)):p&(_e|Ze)&&jf.call(this,v)}function jf(p){var v=p.changedPointers[0];if(v.identifier===this.primaryTouch){var b={x:v.clientX,y:v.clientY};this.lastTouches.push(b);var x=this.lastTouches,k=function(){var U=x.indexOf(b);U>-1&&x.splice(U,1)};setTimeout(k,Yv)}}function qv(p){for(var v=p.srcEvent.clientX,b=p.srcEvent.clientY,x=0;x<this.lastTouches.length;x++){var k=this.lastTouches[x],U=Math.abs(v-k.x),X=Math.abs(b-k.y);if(U<=zf&&X<=zf)return!0}return!1}var Gf=V(o.style,"touchAction"),Hf=Gf!==i,Wf="compute",Xf="auto",Pl="manipulation",er="none",Mi="pan-x",ki="pan-y",so=Qv();function Cl(p,v){this.manager=p,this.set(v)}Cl.prototype={set:function(p){p==Wf&&(p=this.compute()),Hf&&this.manager.element.style&&so[p]&&(this.manager.element.style[Gf]=p),this.actions=p.toLowerCase().trim()},update:function(){this.set(this.manager.options.touchAction)},compute:function(){var p=[];return g(this.manager.recognizers,function(v){S(v.options.enable,[v])&&(p=p.concat(v.getTouchAction()))}),Zv(p.join(" "))},preventDefaults:function(p){var v=p.srcEvent,b=p.offsetDirection;if(this.manager.session.prevented){v.preventDefault();return}var x=this.actions,k=R(x,er)&&!so[er],U=R(x,ki)&&!so[ki],X=R(x,Mi)&&!so[Mi];if(k){var Se=p.pointers.length===1,Pe=p.distance<2,ze=p.deltaTime<250;if(Se&&Pe&&ze)return}if(!(X&&U)&&(k||U&&b&Bt||X&&b&Jn))return this.preventSrc(v)},preventSrc:function(p){this.manager.session.prevented=!0,p.preventDefault()}};function Zv(p){if(R(p,er))return er;var v=R(p,Mi),b=R(p,ki);return v&&b?er:v||b?v?Mi:ki:R(p,Pl)?Pl:Xf}function Qv(){if(!Hf)return!1;var p={},v=e.CSS&&e.CSS.supports;return["auto","manipulation","pan-y","pan-x","pan-x pan-y","none"].forEach(function(b){p[b]=v?e.CSS.supports("touch-action",b):!0}),p}var oo=1,_t=2,Pr=4,bn=8,tn=bn,Ii=16,Vt=32;function nn(p){this.options=E({},this.defaults,p||{}),this.id=mt(),this.manager=null,this.options.enable=A(this.options.enable,!0),this.state=oo,this.simultaneous={},this.requireFail=[]}nn.prototype={defaults:{},set:function(p){return E(this.options,p),this.manager&&this.manager.touchAction.update(),this},recognizeWith:function(p){if(f(p,"recognizeWith",this))return this;var v=this.simultaneous;return p=ao(p,this),v[p.id]||(v[p.id]=p,p.recognizeWith(this)),this},dropRecognizeWith:function(p){return f(p,"dropRecognizeWith",this)?this:(p=ao(p,this),delete this.simultaneous[p.id],this)},requireFailure:function(p){if(f(p,"requireFailure",this))return this;var v=this.requireFail;return p=ao(p,this),O(v,p)===-1&&(v.push(p),p.requireFailure(this)),this},dropRequireFailure:function(p){if(f(p,"dropRequireFailure",this))return this;p=ao(p,this);var v=O(this.requireFail,p);return v>-1&&this.requireFail.splice(v,1),this},hasRequireFailures:function(){return this.requireFail.length>0},canRecognizeWith:function(p){return!!this.simultaneous[p.id]},emit:function(p){var v=this,b=this.state;function x(k){v.manager.emit(k,p)}b<bn&&x(v.options.event+Yf(b)),x(v.options.event),p.additionalEvent&&x(p.additionalEvent),b>=bn&&x(v.options.event+Yf(b))},tryEmit:function(p){if(this.canEmit())return this.emit(p);this.state=Vt},canEmit:function(){for(var p=0;p<this.requireFail.length;){if(!(this.requireFail[p].state&(Vt|oo)))return!1;p++}return!0},recognize:function(p){var v=E({},p);if(!S(this.options.enable,[this,v])){this.reset(),this.state=Vt;return}this.state&(tn|Ii|Vt)&&(this.state=oo),this.state=this.process(v),this.state&(_t|Pr|bn|Ii)&&this.tryEmit(v)},process:function(p){},getTouchAction:function(){},reset:function(){}};function Yf(p){return p&Ii?"cancel":p&bn?"end":p&Pr?"move":p&_t?"start":""}function $f(p){return p==Ri?"down":p==Li?"up":p==Pi?"left":p==Ci?"right":""}function ao(p,v){var b=v.manager;return b?b.get(p):p}function Lt(){nn.apply(this,arguments)}m(Lt,nn,{defaults:{pointers:1},attrTest:function(p){var v=this.options.pointers;return v===0||p.pointers.length===v},process:function(p){var v=this.state,b=p.eventType,x=v&(_t|Pr),k=this.attrTest(p);return x&&(b&Ze||!k)?v|Ii:x||k?b&_e?v|bn:v&_t?v|Pr:_t:Vt}});function lo(){Lt.apply(this,arguments),this.pX=null,this.pY=null}m(lo,Lt,{defaults:{event:"pan",threshold:10,pointers:1,direction:kf},getTouchAction:function(){var p=this.options.direction,v=[];return p&Bt&&v.push(ki),p&Jn&&v.push(Mi),v},directionTest:function(p){var v=this.options,b=!0,x=p.distance,k=p.direction,U=p.deltaX,X=p.deltaY;return k&v.direction||(v.direction&Bt?(k=U===0?eo:U<0?Pi:Ci,b=U!=this.pX,x=Math.abs(p.deltaX)):(k=X===0?eo:X<0?Li:Ri,b=X!=this.pY,x=Math.abs(p.deltaY))),p.direction=k,b&&x>v.threshold&&k&v.direction},attrTest:function(p){return Lt.prototype.attrTest.call(this,p)&&(this.state&_t||!(this.state&_t)&&this.directionTest(p))},emit:function(p){this.pX=p.deltaX,this.pY=p.deltaY;var v=$f(p.direction);v&&(p.additionalEvent=this.options.event+v),this._super.emit.call(this,p)}});function Ll(){Lt.apply(this,arguments)}m(Ll,Lt,{defaults:{event:"pinch",threshold:0,pointers:2},getTouchAction:function(){return[er]},attrTest:function(p){return this._super.attrTest.call(this,p)&&(Math.abs(p.scale-1)>this.options.threshold||this.state&_t)},emit:function(p){if(p.scale!==1){var v=p.scale<1?"in":"out";p.additionalEvent=this.options.event+v}this._super.emit.call(this,p)}});function Rl(){nn.apply(this,arguments),this._timer=null,this._input=null}m(Rl,nn,{defaults:{event:"press",pointers:1,time:251,threshold:9},getTouchAction:function(){return[Xf]},process:function(p){var v=this.options,b=p.pointers.length===v.pointers,x=p.distance<v.threshold,k=p.deltaTime>v.time;if(this._input=p,!x||!b||p.eventType&(_e|Ze)&&!k)this.reset();else if(p.eventType&ye)this.reset(),this._timer=h(function(){this.state=tn,this.tryEmit()},v.time,this);else if(p.eventType&_e)return tn;return Vt},reset:function(){clearTimeout(this._timer)},emit:function(p){this.state===tn&&(p&&p.eventType&_e?this.manager.emit(this.options.event+"up",p):(this._input.timeStamp=c(),this.manager.emit(this.options.event,this._input)))}});function Ml(){Lt.apply(this,arguments)}m(Ml,Lt,{defaults:{event:"rotate",threshold:0,pointers:2},getTouchAction:function(){return[er]},attrTest:function(p){return this._super.attrTest.call(this,p)&&(Math.abs(p.rotation)>this.options.threshold||this.state&_t)}});function kl(){Lt.apply(this,arguments)}m(kl,Lt,{defaults:{event:"swipe",threshold:10,velocity:.3,direction:Bt|Jn,pointers:1},getTouchAction:function(){return lo.prototype.getTouchAction.call(this)},attrTest:function(p){var v=this.options.direction,b;return v&(Bt|Jn)?b=p.overallVelocity:v&Bt?b=p.overallVelocityX:v&Jn&&(b=p.overallVelocityY),this._super.attrTest.call(this,p)&&v&p.offsetDirection&&p.distance>this.options.threshold&&p.maxPointers==this.options.pointers&&u(b)>this.options.velocity&&p.eventType&_e},emit:function(p){var v=$f(p.offsetDirection);v&&this.manager.emit(this.options.event+v,p),this.manager.emit(this.options.event,p)}});function uo(){nn.apply(this,arguments),this.pTime=!1,this.pCenter=!1,this._timer=null,this._input=null,this.count=0}m(uo,nn,{defaults:{event:"tap",pointers:1,taps:1,interval:300,time:250,threshold:9,posThreshold:10},getTouchAction:function(){return[Pl]},process:function(p){var v=this.options,b=p.pointers.length===v.pointers,x=p.distance<v.threshold,k=p.deltaTime<v.time;if(this.reset(),p.eventType&ye&&this.count===0)return this.failTimeout();if(x&&k&&b){if(p.eventType!=_e)return this.failTimeout();var U=this.pTime?p.timeStamp-this.pTime<v.interval:!0,X=!this.pCenter||no(this.pCenter,p.center)<v.posThreshold;this.pTime=p.timeStamp,this.pCenter=p.center,!X||!U?this.count=1:this.count+=1,this._input=p;var Se=this.count%v.taps;if(Se===0)return this.hasRequireFailures()?(this._timer=h(function(){this.state=tn,this.tryEmit()},v.interval,this),_t):tn}return Vt},failTimeout:function(){return this._timer=h(function(){this.state=Vt},this.options.interval,this),Vt},reset:function(){clearTimeout(this._timer)},emit:function(){this.state==tn&&(this._input.tapCount=this.count,this.manager.emit(this.options.event,this._input))}});function rn(p,v){return v=v||{},v.recognizers=A(v.recognizers,rn.defaults.preset),new Il(p,v)}rn.VERSION="2.0.7",rn.defaults={domEvents:!1,touchAction:Wf,enable:!0,inputTarget:null,inputClass:null,preset:[[Ml,{enable:!1}],[Ll,{enable:!1},["rotate"]],[kl,{direction:Bt}],[lo,{direction:Bt},["swipe"]],[uo],[uo,{event:"doubletap",taps:2},["tap"]],[Rl]],cssProps:{userSelect:"none",touchSelect:"none",touchCallout:"none",contentZooming:"none",userDrag:"none",tapHighlightColor:"rgba(0,0,0,0)"}};var Kv=1,qf=2;function Il(p,v){this.options=E({},rn.defaults,v||{}),this.options.inputTarget=this.options.inputTarget||p,this.handlers={},this.session={},this.recognizers=[],this.oldCssProps={},this.element=p,this.input=Cv(this),this.touchAction=new Cl(this,this.options.touchAction),Zf(this,!0),g(this.options.recognizers,function(b){var x=this.add(new b[0](b[1]));b[2]&&x.recognizeWith(b[2]),b[3]&&x.requireFailure(b[3])},this)}Il.prototype={set:function(p){return E(this.options,p),p.touchAction&&this.touchAction.update(),p.inputTarget&&(this.input.destroy(),this.input.target=p.inputTarget,this.input.init()),this},stop:function(p){this.session.stopped=p?qf:Kv},recognize:function(p){var v=this.session;if(!v.stopped){this.touchAction.preventDefaults(p);var b,x=this.recognizers,k=v.curRecognizer;(!k||k&&k.state&tn)&&(k=v.curRecognizer=null);for(var U=0;U<x.length;)b=x[U],v.stopped!==qf&&(!k||b==k||b.canRecognizeWith(k))?b.recognize(p):b.reset(),!k&&b.state&(_t|Pr|bn)&&(k=v.curRecognizer=b),U++}},get:function(p){if(p instanceof nn)return p;for(var v=this.recognizers,b=0;b<v.length;b++)if(v[b].options.event==p)return v[b];return null},add:function(p){if(f(p,"add",this))return this;var v=this.get(p.options.event);return v&&this.remove(v),this.recognizers.push(p),p.manager=this,this.touchAction.update(),p},remove:function(p){if(f(p,"remove",this))return this;if(p=this.get(p),p){var v=this.recognizers,b=O(v,p);b!==-1&&(v.splice(b,1),this.touchAction.update())}return this},on:function(p,v){if(p!==i&&v!==i){var b=this.handlers;return g(M(p),function(x){b[x]=b[x]||[],b[x].push(v)}),this}},off:function(p,v){if(p!==i){var b=this.handlers;return g(M(p),function(x){v?b[x]&&b[x].splice(O(b[x],v),1):delete b[x]}),this}},emit:function(p,v){this.options.domEvents&&Jv(p,v);var b=this.handlers[p]&&this.handlers[p].slice();if(!(!b||!b.length)){v.type=p,v.preventDefault=function(){v.srcEvent.preventDefault()};for(var x=0;x<b.length;)b[x](v),x++}},destroy:function(){this.element&&Zf(this,!1),this.handlers={},this.session={},this.input.destroy(),this.element=null}};function Zf(p,v){var b=p.element;if(b.style){var x;g(p.options.cssProps,function(k,U){x=V(b.style,U),v?(p.oldCssProps[x]=b.style[x],b.style[x]=k):b.style[x]=p.oldCssProps[x]||""}),v||(p.oldCssProps={})}}function Jv(p,v){var b=n.createEvent("Event");b.initEvent(p,!0,!0),b.gesture=v,v.target.dispatchEvent(b)}E(rn,{INPUT_START:ye,INPUT_MOVE:Kn,INPUT_END:_e,INPUT_CANCEL:Ze,STATE_POSSIBLE:oo,STATE_BEGAN:_t,STATE_CHANGED:Pr,STATE_ENDED:bn,STATE_RECOGNIZED:tn,STATE_CANCELLED:Ii,STATE_FAILED:Vt,DIRECTION_NONE:eo,DIRECTION_LEFT:Pi,DIRECTION_RIGHT:Ci,DIRECTION_UP:Li,DIRECTION_DOWN:Ri,DIRECTION_HORIZONTAL:Bt,DIRECTION_VERTICAL:Jn,DIRECTION_ALL:kf,Manager:Il,Input:yt,TouchAction:Cl,TouchInput:io,MouseInput:ro,PointerEventInput:Al,TouchMouseInput:xl,SingleTouchInput:Vf,Recognizer:nn,AttrRecognizer:Lt,Tap:uo,Pan:lo,Swipe:kl,Pinch:Ll,Rotate:Ml,Press:Rl,on:P,off:L,each:g,merge:y,extend:T,assign:E,inherit:m,bindFn:_,prefixed:V});var e1=typeof e<"u"?e:typeof self<"u"?self:{};e1.Hammer=rn,typeof i=="function"&&i.amd?i(function(){return rn}):t.exports?t.exports=rn:e[r]=rn})(window,document,"Hammer")})(o3);const a3=Tr,Ht=t1({__proto__:null,default:a3},[Tr]),Y_=1,$_=2,Kc=4,l3={mousedown:Y_,mousemove:$_,mouseup:Kc};function u3(t,e){for(let n=0;n<t.length;n++)if(e(t[n]))return!0;return!1}function c3(t){const e=t.prototype.handler;t.prototype.handler=function(r){const i=this.store;r.button>0&&r.type==="pointerdown"&&(u3(i,s=>s.pointerId===r.pointerId)||i.push(r)),e.call(this,r)}}function h3(t){t.prototype.handler=function(n){let r=l3[n.type];r&Y_&&n.button>=0&&(this.pressed=!0),r&$_&&n.which===0&&(r=Kc),this.pressed&&(r&Kc&&(this.pressed=!1),this.callback(this.manager,r,{pointers:[n],changedPointers:[n],pointerType:"mouse",srcEvent:n}))}}c3(Tr.PointerEventInput);h3(Tr.MouseInput);const f3=Tr.Manager;class vl{constructor(e,n,r){this.element=e,this.callback=n,this.options={enable:!0,...r}}}const d3=Ht?[[Ht.Pan,{event:"tripan",pointers:3,threshold:0,enable:!1}],[Ht.Rotate,{enable:!1}],[Ht.Pinch,{enable:!1}],[Ht.Swipe,{enable:!1}],[Ht.Pan,{threshold:0,enable:!1}],[Ht.Press,{enable:!1}],[Ht.Tap,{event:"doubletap",taps:2,enable:!1}],[Ht.Tap,{event:"anytap",enable:!1}],[Ht.Tap,{enable:!1}]]:null,Lp={tripan:["rotate","pinch","pan"],rotate:["pinch"],pinch:["pan"],pan:["press","doubletap","anytap","tap"],doubletap:["anytap"],anytap:["tap"]},g3={doubletap:["tap"]},p3={pointerdown:"pointerdown",pointermove:"pointermove",pointerup:"pointerup",touchstart:"pointerdown",touchmove:"pointermove",touchend:"pointerup",mousedown:"pointerdown",mousemove:"pointermove",mouseup:"pointerup"},Tf={KEY_EVENTS:["keydown","keyup"],MOUSE_EVENTS:["mousedown","mousemove","mouseup","mouseover","mouseout","mouseleave"],WHEEL_EVENTS:["wheel","mousewheel"]},m3={tap:"tap",anytap:"anytap",doubletap:"doubletap",press:"press",pinch:"pinch",pinchin:"pinch",pinchout:"pinch",pinchstart:"pinch",pinchmove:"pinch",pinchend:"pinch",pinchcancel:"pinch",rotate:"rotate",rotatestart:"rotate",rotatemove:"rotate",rotateend:"rotate",rotatecancel:"rotate",tripan:"tripan",tripanstart:"tripan",tripanmove:"tripan",tripanup:"tripan",tripandown:"tripan",tripanleft:"tripan",tripanright:"tripan",tripanend:"tripan",tripancancel:"tripan",pan:"pan",panstart:"pan",panmove:"pan",panup:"pan",pandown:"pan",panleft:"pan",panright:"pan",panend:"pan",pancancel:"pan",swipe:"swipe",swipeleft:"swipe",swiperight:"swipe",swipeup:"swipe",swipedown:"swipe"},Rp={click:"tap",anyclick:"anytap",dblclick:"doubletap",mousedown:"pointerdown",mousemove:"pointermove",mouseup:"pointerup",mouseover:"pointerover",mouseout:"pointerout",mouseleave:"pointerleave"},y3=typeof navigator<"u"&&navigator.userAgent?navigator.userAgent.toLowerCase():"",Qr=typeof window<"u"?window:global;let Jc=!1;try{const t={get passive(){return Jc=!0,!0}};Qr.addEventListener("test",null,t),Qr.removeEventListener("test",null)}catch{Jc=!1}const _3=y3.indexOf("firefox")!==-1,{WHEEL_EVENTS:v3}=Tf,Mp="wheel",kp=4.000244140625,w3=40,E3=.25;class T3 extends vl{constructor(e,n,r){super(e,n,r),this.handleEvent=i=>{if(!this.options.enable)return;let s=i.deltaY;Qr.WheelEvent&&(_3&&i.deltaMode===Qr.WheelEvent.DOM_DELTA_PIXEL&&(s/=Qr.devicePixelRatio),i.deltaMode===Qr.WheelEvent.DOM_DELTA_LINE&&(s*=w3)),s!==0&&s%kp===0&&(s=Math.floor(s/kp)),i.shiftKey&&s&&(s=s*E3),this.callback({type:Mp,center:{x:i.clientX,y:i.clientY},delta:-s,srcEvent:i,pointerType:"mouse",target:i.target})},this.events=(this.options.events||[]).concat(v3),this.events.forEach(i=>e.addEventListener(i,this.handleEvent,Jc?{passive:!1}:!1))}destroy(){this.events.forEach(e=>this.element.removeEventListener(e,this.handleEvent))}enableEventType(e,n){e===Mp&&(this.options.enable=n)}}const{MOUSE_EVENTS:b3}=Tf,Ip="pointermove",Op="pointerover",Np="pointerout",Dp="pointerenter",Fp="pointerleave";class S3 extends vl{constructor(e,n,r){super(e,n,r),this.handleEvent=s=>{this.handleOverEvent(s),this.handleOutEvent(s),this.handleEnterEvent(s),this.handleLeaveEvent(s),this.handleMoveEvent(s)},this.pressed=!1;const{enable:i}=this.options;this.enableMoveEvent=i,this.enableLeaveEvent=i,this.enableEnterEvent=i,this.enableOutEvent=i,this.enableOverEvent=i,this.events=(this.options.events||[]).concat(b3),this.events.forEach(s=>e.addEventListener(s,this.handleEvent))}destroy(){this.events.forEach(e=>this.element.removeEventListener(e,this.handleEvent))}enableEventType(e,n){e===Ip&&(this.enableMoveEvent=n),e===Op&&(this.enableOverEvent=n),e===Np&&(this.enableOutEvent=n),e===Dp&&(this.enableEnterEvent=n),e===Fp&&(this.enableLeaveEvent=n)}handleOverEvent(e){this.enableOverEvent&&e.type==="mouseover"&&this._emit(Op,e)}handleOutEvent(e){this.enableOutEvent&&e.type==="mouseout"&&this._emit(Np,e)}handleEnterEvent(e){this.enableEnterEvent&&e.type==="mouseenter"&&this._emit(Dp,e)}handleLeaveEvent(e){this.enableLeaveEvent&&e.type==="mouseleave"&&this._emit(Fp,e)}handleMoveEvent(e){if(this.enableMoveEvent)switch(e.type){case"mousedown":e.button>=0&&(this.pressed=!0);break;case"mousemove":e.which===0&&(this.pressed=!1),this.pressed||this._emit(Ip,e);break;case"mouseup":this.pressed=!1;break}}_emit(e,n){this.callback({type:e,center:{x:n.clientX,y:n.clientY},srcEvent:n,pointerType:"mouse",target:n.target})}}const{KEY_EVENTS:A3}=Tf,Up="keydown",Bp="keyup";class x3 extends vl{constructor(e,n,r){super(e,n,r),this.handleEvent=i=>{const s=i.target||i.srcElement;s.tagName==="INPUT"&&s.type==="text"||s.tagName==="TEXTAREA"||(this.enableDownEvent&&i.type==="keydown"&&this.callback({type:Up,srcEvent:i,key:i.key,target:i.target}),this.enableUpEvent&&i.type==="keyup"&&this.callback({type:Bp,srcEvent:i,key:i.key,target:i.target}))},this.enableDownEvent=this.options.enable,this.enableUpEvent=this.options.enable,this.events=(this.options.events||[]).concat(A3),e.tabIndex=this.options.tabIndex||0,e.style.outline="none",this.events.forEach(i=>e.addEventListener(i,this.handleEvent))}destroy(){this.events.forEach(e=>this.element.removeEventListener(e,this.handleEvent))}enableEventType(e,n){e===Up&&(this.enableDownEvent=n),e===Bp&&(this.enableUpEvent=n)}}const Vp="contextmenu";class P3 extends vl{constructor(e,n,r){super(e,n,r),this.handleEvent=i=>{this.options.enable&&this.callback({type:Vp,center:{x:i.clientX,y:i.clientY},srcEvent:i,pointerType:"mouse",target:i.target})},e.addEventListener("contextmenu",this.handleEvent)}destroy(){this.element.removeEventListener("contextmenu",this.handleEvent)}enableEventType(e,n){e===Vp&&(this.options.enable=n)}}const eh=1,Ha=2,th=4,C3={pointerdown:eh,pointermove:Ha,pointerup:th,mousedown:eh,mousemove:Ha,mouseup:th},L3=1,R3=2,M3=3,k3=0,I3=1,O3=2,N3=1,D3=2,F3=4;function U3(t){const e=C3[t.srcEvent.type];if(!e)return null;const{buttons:n,button:r,which:i}=t.srcEvent;let s=!1,o=!1,a=!1;return e===th||e===Ha&&!Number.isFinite(n)?(s=i===L3,o=i===R3,a=i===M3):e===Ha?(s=Boolean(n&N3),o=Boolean(n&F3),a=Boolean(n&D3)):e===eh&&(s=r===k3,o=r===I3,a=r===O3),{leftButton:s,middleButton:o,rightButton:a}}function B3(t,e){const n=t.center;if(!n)return null;const r=e.getBoundingClientRect(),i=r.width/e.offsetWidth||1,s=r.height/e.offsetHeight||1,o={x:(n.x-r.left-e.clientLeft)/i,y:(n.y-r.top-e.clientTop)/s};return{center:n,offsetCenter:o}}const Mu={srcElement:"root",priority:0};class V3{constructor(e){this.handleEvent=n=>{if(this.isEmpty())return;const r=this._normalizeEvent(n);let i=n.srcEvent.target;for(;i&&i!==r.rootElement;){if(this._emit(r,i),r.handled)return;i=i.parentNode}this._emit(r,"root")},this.eventManager=e,this.handlers=[],this.handlersByElement=new Map,this._active=!1}isEmpty(){return!this._active}add(e,n,r,i=!1,s=!1){const{handlers:o,handlersByElement:a}=this;let l=Mu;typeof r=="string"||r&&r.addEventListener?l={...Mu,srcElement:r}:r&&(l={...Mu,...r});let u=a.get(l.srcElement);u||(u=[],a.set(l.srcElement,u));const c={type:e,handler:n,srcElement:l.srcElement,priority:l.priority};i&&(c.once=!0),s&&(c.passive=!0),o.push(c),this._active=this._active||!c.passive;let h=u.length-1;for(;h>=0&&!(u[h].priority>=c.priority);)h--;u.splice(h+1,0,c)}remove(e,n){const{handlers:r,handlersByElement:i}=this;for(let s=r.length-1;s>=0;s--){const o=r[s];if(o.type===e&&o.handler===n){r.splice(s,1);const a=i.get(o.srcElement);a.splice(a.indexOf(o),1),a.length===0&&i.delete(o.srcElement)}}this._active=r.some(s=>!s.passive)}_emit(e,n){const r=this.handlersByElement.get(n);if(r){let i=!1;const s=()=>{e.handled=!0},o=()=>{e.handled=!0,i=!0},a=[];for(let l=0;l<r.length;l++){const{type:u,handler:c,once:h}=r[l];if(c({...e,type:u,stopPropagation:s,stopImmediatePropagation:o}),h&&a.push(r[l]),i)break}for(let l=0;l<a.length;l++){const{type:u,handler:c}=a[l];this.remove(u,c)}}}_normalizeEvent(e){const n=this.eventManager.getElement();return{...e,...U3(e),...B3(e,n),preventDefault:()=>{e.srcEvent.preventDefault()},stopImmediatePropagation:null,stopPropagation:null,handled:!1,rootElement:n}}}const z3={events:null,recognizers:null,recognizerOptions:{},Manager:f3,touchAction:"none",tabIndex:0};class j3{constructor(e=null,n){this._onBasicInput=i=>{const{srcEvent:s}=i,o=p3[s.type];o&&this.manager.emit(o,i)},this._onOtherEvent=i=>{this.manager.emit(i.type,i)},this.options={...z3,...n},this.events=new Map,this.setElement(e);const{events:r}=this.options;r&&this.on(r)}getElement(){return this.element}setElement(e){if(this.element&&this.destroy(),this.element=e,!e)return;const{options:n}=this,r=n.Manager;this.manager=new r(e,{touchAction:n.touchAction,recognizers:n.recognizers||d3}).on("hammer.input",this._onBasicInput),n.recognizers||Object.keys(Lp).forEach(i=>{const s=this.manager.get(i);s&&Lp[i].forEach(o=>{s.recognizeWith(o)})});for(const i in n.recognizerOptions){const s=this.manager.get(i);if(s){const o=n.recognizerOptions[i];delete o.enable,s.set(o)}}this.wheelInput=new T3(e,this._onOtherEvent,{enable:!1}),this.moveInput=new S3(e,this._onOtherEvent,{enable:!1}),this.keyInput=new x3(e,this._onOtherEvent,{enable:!1,tabIndex:n.tabIndex}),this.contextmenuInput=new P3(e,this._onOtherEvent,{enable:!1});for(const[i,s]of this.events)s.isEmpty()||(this._toggleRecognizer(s.recognizerName,!0),this.manager.on(i,s.handleEvent))}destroy(){this.element&&(this.wheelInput.destroy(),this.moveInput.destroy(),this.keyInput.destroy(),this.contextmenuInput.destroy(),this.manager.destroy(),this.wheelInput=null,this.moveInput=null,this.keyInput=null,this.contextmenuInput=null,this.manager=null,this.element=null)}on(e,n,r){this._addEventHandler(e,n,r,!1)}once(e,n,r){this._addEventHandler(e,n,r,!0)}watch(e,n,r){this._addEventHandler(e,n,r,!1,!0)}off(e,n){this._removeEventHandler(e,n)}_toggleRecognizer(e,n){const{manager:r}=this;if(!r)return;const i=r.get(e);if(i&&i.options.enable!==n){i.set({enable:n});const s=g3[e];s&&!this.options.recognizers&&s.forEach(o=>{const a=r.get(o);n?(a.requireFailure(e),i.dropRequireFailure(o)):a.dropRequireFailure(e)})}this.wheelInput.enableEventType(e,n),this.moveInput.enableEventType(e,n),this.keyInput.enableEventType(e,n),this.contextmenuInput.enableEventType(e,n)}_addEventHandler(e,n,r,i,s){if(typeof e!="string"){r=n;for(const c in e)this._addEventHandler(c,e[c],r,i,s);return}const{manager:o,events:a}=this,l=Rp[e]||e;let u=a.get(l);u||(u=new V3(this),a.set(l,u),u.recognizerName=m3[l]||l,o&&o.on(l,u.handleEvent)),u.add(e,n,r,i,s),u.isEmpty()||this._toggleRecognizer(u.recognizerName,!0)}_removeEventHandler(e,n){if(typeof e!="string"){for(const o in e)this._removeEventHandler(o,e[o]);return}const{events:r}=this,i=Rp[e]||e,s=r.get(i);if(s&&(s.remove(e,n),s.isEmpty())){const{recognizerName:o}=s;let a=!1;for(const l of r.values())if(l.recognizerName===o&&!l.isEmpty()){a=!0;break}a||this._toggleRecognizer(o,!1)}}}function rr(){}const G3=({isDragging:t})=>t?"grabbing":"grab",q_={id:"",width:"100%",height:"100%",style:null,viewState:null,initialViewState:null,pickingRadius:0,layerFilter:null,glOptions:{},parameters:{},parent:null,gl:null,canvas:null,layers:[],effects:[],views:null,controller:null,useDevicePixels:!0,touchAction:"none",eventRecognizerOptions:{},_framebuffer:null,_animate:!1,_pickable:!0,_typedArrayManagerProps:{},_customRender:null,onWebGLInitialized:rr,onResize:rr,onViewStateChange:rr,onInteractionStateChange:rr,onBeforeRender:rr,onAfterRender:rr,onLoad:rr,onError:t=>Q.error(t.message)(),onHover:null,onClick:null,onDragStart:null,onDrag:null,onDragEnd:null,_onMetrics:null,getCursor:G3,getTooltip:null,debug:!1,drawPickingColors:!1};class wl{constructor(e){d(this,"props",void 0),d(this,"width",0),d(this,"height",0),d(this,"userData",{}),d(this,"canvas",null),d(this,"viewManager",null),d(this,"layerManager",null),d(this,"effectManager",null),d(this,"deckRenderer",null),d(this,"deckPicker",null),d(this,"eventManager",null),d(this,"tooltip",null),d(this,"metrics",void 0),d(this,"animationLoop",void 0),d(this,"stats",void 0),d(this,"viewState",void 0),d(this,"cursorState",void 0),d(this,"_needsRedraw",void 0),d(this,"_pickRequest",void 0),d(this,"_lastPointerDownInfo",null),d(this,"_metricsCounter",void 0),d(this,"_onPointerMove",n=>{const{_pickRequest:r}=this;if(n.type==="pointerleave")r.x=-1,r.y=-1,r.radius=0;else{if(n.leftButton||n.rightButton)return;{const i=n.offsetCenter;if(!i)return;r.x=i.x,r.y=i.y,r.radius=this.props.pickingRadius}}this.layerManager&&(this.layerManager.context.mousePosition={x:r.x,y:r.y}),r.event=n}),d(this,"_onEvent",n=>{const r=pp[n.type],i=n.offsetCenter;if(!r||!i||!this.layerManager)return;const s=this.layerManager.getLayers(),o=this.deckPicker.getLastPickedObject({x:i.x,y:i.y,layers:s,viewports:this.getViewports(i)},this._lastPointerDownInfo),{layer:a}=o,l=a&&(a[r.handler]||a.props[r.handler]),u=this.props[r.handler];let c=!1;l&&(c=l.call(a,o,n)),!c&&u&&u(o,n)}),d(this,"_onPointerDown",n=>{const r=n.offsetCenter,i=this._pick("pickObject","pickObject Time",{x:r.x,y:r.y,radius:this.props.pickingRadius});this._lastPointerDownInfo=i.result[0]||i.emptyInfo}),this.props={...q_,...e},e=this.props,this._needsRedraw="Initial render",this._pickRequest={mode:"hover",x:-1,y:-1,radius:0,event:null},this.cursorState={isHovering:!1,isDragging:!1},e.viewState&&e.initialViewState&&Q.warn("View state tracking is disabled. Use either `initialViewState` for auto update or `viewState` for manual update.")(),by()==="IE"&&Q.warn("IE 11 is not supported")(),this.viewState=e.initialViewState,e.gl||typeof document<"u"&&(this.canvas=this._createCanvas(e)),this.animationLoop=this._createAnimationLoop(e),this.stats=new tf({id:"deck.gl"}),this.metrics={fps:0,setPropsTime:0,updateAttributesTime:0,framesRedrawn:0,pickTime:0,pickCount:0,gpuTime:0,gpuTimePerFrame:0,cpuTime:0,cpuTimePerFrame:0,bufferMemory:0,textureMemory:0,renderbufferMemory:0,gpuMemory:0},this._metricsCounter=0,this.setProps(e),e._typedArrayManagerProps&&Ns.setOptions(e._typedArrayManagerProps),this.animationLoop.start()}finalize(){var e,n,r,i,s,o,a;if(this.animationLoop.stop(),this.animationLoop=null,this._lastPointerDownInfo=null,(e=this.layerManager)===null||e===void 0||e.finalize(),this.layerManager=null,(n=this.viewManager)===null||n===void 0||n.finalize(),this.viewManager=null,(r=this.effectManager)===null||r===void 0||r.finalize(),this.effectManager=null,(i=this.deckRenderer)===null||i===void 0||i.finalize(),this.deckRenderer=null,(s=this.deckPicker)===null||s===void 0||s.finalize(),this.deckPicker=null,(o=this.eventManager)===null||o===void 0||o.destroy(),this.eventManager=null,(a=this.tooltip)===null||a===void 0||a.remove(),this.tooltip=null,!this.props.canvas&&!this.props.gl&&this.canvas){var l;(l=this.canvas.parentElement)===null||l===void 0||l.removeChild(this.canvas),this.canvas=null}}setProps(e){this.stats.get("setProps Time").timeStart(),"onLayerHover"in e&&Q.removed("onLayerHover","onHover")(),"onLayerClick"in e&&Q.removed("onLayerClick","onClick")(),e.initialViewState&&!xi(this.props.initialViewState,e.initialViewState)&&(this.viewState=e.initialViewState),Object.assign(this.props,e),this._setCanvasSize(this.props);const n=Object.create(this.props);Object.assign(n,{views:this._getViews(),width:this.width,height:this.height,viewState:this._getViewState()}),this.animationLoop.setProps(n),this.layerManager&&(this.viewManager.setProps(n),this.layerManager.activateViewport(this.getViewports()[0]),this.layerManager.setProps(n),this.effectManager.setProps(n),this.deckRenderer.setProps(n),this.deckPicker.setProps(n)),this.stats.get("setProps Time").timeEnd()}needsRedraw(e={clearRedrawFlags:!1}){if(!this.layerManager)return!1;if(this.props._animate)return"Deck._animate";let n=this._needsRedraw;e.clearRedrawFlags&&(this._needsRedraw=!1);const r=this.viewManager.needsRedraw(e),i=this.layerManager.needsRedraw(e),s=this.effectManager.needsRedraw(e),o=this.deckRenderer.needsRedraw(e);return n=n||r||i||s||o,n}redraw(e){if(!this.layerManager)return;let n=this.needsRedraw({clearRedrawFlags:!0});n=e||n,n&&(this.stats.get("Redraw Count").incrementCount(),this.props._customRender?this.props._customRender(n):this._drawLayers(n))}get isInitialized(){return this.viewManager!==null}getViews(){return Re(this.viewManager),this.viewManager.views}getViewports(e){return Re(this.viewManager),this.viewManager.getViewports(e)}pickObject(e){const n=this._pick("pickObject","pickObject Time",e).result;return n.length?n[0]:null}pickMultipleObjects(e){return e.depth=e.depth||10,this._pick("pickObject","pickMultipleObjects Time",e).result}pickObjects(e){return this._pick("pickObjects","pickObjects Time",e)}_addResources(e,n=!1){for(const r in e)this.layerManager.resourceManager.add({resourceId:r,data:e[r],forceUpdate:n})}_removeResources(e){for(const n of e)this.layerManager.resourceManager.remove(n)}_pick(e,n,r){Re(this.deckPicker);const{stats:i}=this;i.get("Pick Count").incrementCount(),i.get(n).timeStart();const s=this.deckPicker[e]({layers:this.layerManager.getLayers(r),views:this.viewManager.getViews(),viewports:this.getViewports(r),onViewportActive:this.layerManager.activateViewport,effects:this.effectManager.getEffects(),...r});return i.get(n).timeEnd(),s}_createCanvas(e){let n=e.canvas;return typeof n=="string"&&(n=document.getElementById(n),Re(n)),n||(n=document.createElement("canvas"),n.id=e.id||"deckgl-overlay",(e.parent||document.body).appendChild(n)),Object.assign(n.style,e.style),n}_setCanvasSize(e){if(!this.canvas)return;const{width:n,height:r}=e;if(n||n===0){const s=Number.isFinite(n)?"".concat(n,"px"):n;this.canvas.style.width=s}if(r||r===0){var i;const s=Number.isFinite(r)?"".concat(r,"px"):r;this.canvas.style.position=((i=e.style)===null||i===void 0?void 0:i.position)||"absolute",this.canvas.style.height=s}}_updateCanvasSize(){const{canvas:e}=this;if(!e)return;const n=e.clientWidth||e.width,r=e.clientHeight||e.height;if(n!==this.width||r!==this.height){var i;this.width=n,this.height=r,(i=this.viewManager)===null||i===void 0||i.setProps({width:n,height:r}),this.props.onResize({width:n,height:r})}}_createAnimationLoop(e){const{width:n,height:r,gl:i,glOptions:s,debug:o,onError:a,onBeforeRender:l,onAfterRender:u,useDevicePixels:c}=e;return new Mx({width:n,height:r,useDevicePixels:c,autoResizeViewport:!1,gl:i,onCreateContext:h=>jy({...s,...h,canvas:this.canvas,debug:o,onContextLost:()=>this._onContextLost()}),onInitialize:h=>this._setGLContext(h.gl),onRender:this._onRenderFrame.bind(this),onBeforeRender:l,onAfterRender:u,onError:a})}_getViewState(){return this.props.viewState||this.viewState}_getViews(){let e=this.props.views||[new j_({id:"default-view"})];return e=Array.isArray(e)?e:[e],e.length&&this.props.controller&&(e[0].props.controller=this.props.controller),e}_onContextLost(){const{onError:e}=this.props;this.animationLoop&&e&&e(new Error("WebGL context is lost"))}_pickAndCallback(){const{_pickRequest:e}=this;if(e.event){const{result:r,emptyInfo:i}=this._pick("pickObject","pickObject Time",e);this.cursorState.isHovering=r.length>0;let s=i,o=!1;for(const a of r){var n;s=a,o=((n=a.layer)===null||n===void 0?void 0:n.onHover(a,e.event))||o}if(!o&&this.props.onHover&&this.props.onHover(s,e.event),this.props.getTooltip&&this.tooltip){const a=this.props.getTooltip(s);this.tooltip.setTooltip(a,s.x,s.y)}e.event=null}}_updateCursor(){const e=this.props.parent||this.canvas;e&&(e.style.cursor=this.props.getCursor(this.cursorState))}_setGLContext(e){if(this.layerManager)return;this.canvas||(this.canvas=e.canvas,uf(e,{enable:!0,copyState:!0})),this.tooltip=new s3(this.canvas),yn(e,{blend:!0,blendFunc:[770,771,1,771],polygonOffsetFill:!0,depthTest:!0,depthFunc:515}),this.props.onWebGLInitialized(e);const n=new S_;n.play(),this.animationLoop.attachTimeline(n),this.eventManager=new j3(this.props.parent||e.canvas,{touchAction:this.props.touchAction,recognizerOptions:this.props.eventRecognizerOptions,events:{pointerdown:this._onPointerDown,pointermove:this._onPointerMove,pointerleave:this._onPointerMove}});for(const i in pp)this.eventManager.on(i,this._onEvent);this.viewManager=new TL({timeline:n,eventManager:this.eventManager,onViewStateChange:this._onViewStateChange.bind(this),onInteractionStateChange:this._onInteractionStateChange.bind(this),views:this._getViews(),viewState:this._getViewState(),width:this.width,height:this.height});const r=this.viewManager.getViewports()[0];this.layerManager=new EL(e,{deck:this,stats:this.stats,viewport:r,timeline:n}),this.effectManager=new XL,this.deckRenderer=new QL(e),this.deckPicker=new r3(e),this.setProps(this.props),this._updateCanvasSize(),this.props.onLoad()}_drawLayers(e,n){const{gl:r}=this.layerManager.context;yn(r,this.props.parameters),this.props.onBeforeRender({gl:r}),this.deckRenderer.renderLayers({target:this.props._framebuffer,layers:this.layerManager.getLayers(),viewports:this.viewManager.getViewports(),onViewportActive:this.layerManager.activateViewport,views:this.viewManager.getViews(),pass:"screen",redrawReason:e,effects:this.effectManager.getEffects(),...n}),this.props.onAfterRender({gl:r})}_onRenderFrame(e){this._getFrameStats(),this._metricsCounter++%60===0&&(this._getMetrics(),this.stats.reset(),Q.table(4,this.metrics)(),this.props._onMetrics&&this.props._onMetrics(this.metrics)),this._updateCanvasSize(),this._updateCursor(),this.tooltip.isVisible&&this.viewManager.needsRedraw()&&this.tooltip.setTooltip(null),this.layerManager.updateLayers(),this._pickAndCallback(),this.redraw(),this.viewManager&&this.viewManager.updateViewStates()}_onViewStateChange(e){const n=this.props.onViewStateChange(e)||e.viewState;this.viewState&&(this.viewState={...this.viewState,[e.viewId]:n},this.props.viewState||this.viewManager&&this.viewManager.setProps({viewState:this.viewState}))}_onInteractionStateChange(e){this.cursorState.isDragging=e.isDragging||!1,this.props.onInteractionStateChange(e)}_getFrameStats(){const{stats:e}=this;e.get("frameRate").timeEnd(),e.get("frameRate").timeStart();const n=this.animationLoop.stats;e.get("GPU Time").addTime(n.get("GPU Time").lastTiming),e.get("CPU Time").addTime(n.get("CPU Time").lastTiming)}_getMetrics(){const{metrics:e,stats:n}=this;e.fps=n.get("frameRate").getHz(),e.setPropsTime=n.get("setProps Time").time,e.updateAttributesTime=n.get("Update Attributes").time,e.framesRedrawn=n.get("Redraw Count").count,e.pickTime=n.get("pickObject Time").time+n.get("pickMultipleObjects Time").time+n.get("pickObjects Time").time,e.pickCount=n.get("Pick Count").count,e.gpuTime=n.get("GPU Time").time,e.cpuTime=n.get("CPU Time").time,e.gpuTimePerFrame=n.get("GPU Time").getAverageTime(),e.cpuTimePerFrame=n.get("CPU Time").getAverageTime();const r=cr.get("Memory Usage");e.bufferMemory=r.get("Buffer Memory").count,e.textureMemory=r.get("Texture Memory").count,e.renderbufferMemory=r.get("Renderbuffer Memory").count,e.gpuMemory=r.get("GPU Memory").count}}d(wl,"defaultProps",q_);d(wl,"VERSION",Fb.VERSION);class ku{constructor(e,n){d(this,"opts",void 0),d(this,"source",void 0),this.opts=n,this.source=e}get value(){return this.source.value}getValue(){const e=this.source.getBuffer(),n=this.getAccessor();if(e)return[e,n];const{value:r}=this.source,{size:i}=n;let s=r;if(r&&r.length!==i){s=new Float32Array(i);const o=n.elementOffset||0;for(let a=0;a<i;++a)s[a]=r[o+a]}return s}getAccessor(){return{...this.source.getAccessor(),...this.opts}}}function H3(t){switch(t){case 5126:return Float32Array;case 5130:return Float64Array;case 5123:case 33635:case 32819:case 32820:return Uint16Array;case 5125:return Uint32Array;case 5121:return Uint8ClampedArray;case 5120:return Int8Array;case 5122:return Int16Array;case 5124:return Int32Array;default:throw new Error("Unknown GL type")}}function ra(t){return t.stride||t.size*t.bytesPerElement}function Z_(t,e){e.offset&&Q.removed("shaderAttribute.offset","vertexOffset, elementOffset")();const n=ra(t),r=e.vertexOffset!==void 0?e.vertexOffset:t.vertexOffset||0,i=e.elementOffset||0,s=r*n+i*t.bytesPerElement+(t.offset||0);return{...e,offset:s,stride:n}}function W3(t,e){const n=Z_(t,e);return{high:n,low:{...n,offset:n.offset+t.size*4}}}class X3{constructor(e,n,r){d(this,"gl",void 0),d(this,"id",void 0),d(this,"size",void 0),d(this,"settings",void 0),d(this,"value",void 0),d(this,"doublePrecision",void 0),d(this,"_buffer",void 0),d(this,"state",void 0),this.gl=e,this.id=n.id||"",this.size=n.size||1;const i=n.logicalType||n.type,s=i===5130;let{defaultValue:o}=n;o=Number.isFinite(o)?[o]:o||new Array(this.size).fill(0);let a;s?a=5126:!i&&n.isIndexed?a=e&&Zy(e,ae.ELEMENT_INDEX_UINT32)?5125:5123:a=i||5126;let l=H3(i||a||5126);this.doublePrecision=s,s&&n.fp64===!1&&(l=Float32Array),this.value=null,this.settings={...n,defaultType:l,defaultValue:o,logicalType:i,type:a,size:this.size,bytesPerElement:l.BYTES_PER_ELEMENT},this.state={...r,externalBuffer:null,bufferAccessor:this.settings,allocatedValue:null,numInstances:0,bounds:null,constant:!1},this._buffer=null}get isConstant(){return this.state.constant}get buffer(){if(!this._buffer){const{isIndexed:e,type:n}=this.settings;this._buffer=new te(this.gl,{id:this.id,target:e?34963:34962,accessor:{type:n}})}return this._buffer}get byteOffset(){const e=this.getAccessor();return e.vertexOffset?e.vertexOffset*ra(e):0}get numInstances(){return this.state.numInstances}set numInstances(e){this.state.numInstances=e}delete(){this._buffer&&(this._buffer.delete(),this._buffer=null),Ns.release(this.state.allocatedValue)}getShaderAttributes(e,n){if(this.doublePrecision){const r={},i=this.value instanceof Float64Array,s=W3(this.getAccessor(),n||{});return r[e]=new ku(this,s.high),r["".concat(e,"64Low")]=i?new ku(this,s.low):new Float32Array(this.size),r}if(n){const r=Z_(this.getAccessor(),n);return{[e]:new ku(this,r)}}return{[e]:this}}getBuffer(){return this.state.constant?null:this.state.externalBuffer||this._buffer}getValue(){return this.state.constant?this.value:[this.getBuffer(),this.getAccessor()]}getAccessor(){return this.state.bufferAccessor}getBounds(){if(this.state.bounds)return this.state.bounds;let e=null;if(this.state.constant&&this.value){const n=Array.from(this.value);e=[n,n]}else{const{value:n,numInstances:r,size:i}=this,s=r*i;if(n&&s&&n.length>=s){const o=new Array(i).fill(1/0),a=new Array(i).fill(-1/0);for(let l=0;l<s;)for(let u=0;u<i;u++){const c=n[l++];c<o[u]&&(o[u]=c),c>a[u]&&(a[u]=c)}e=[o,a]}}return this.state.bounds=e,e}setData(e){const{state:n}=this;let r;ArrayBuffer.isView(e)?r={value:e}:e instanceof te?r={buffer:e}:r=e;const i={...this.settings,...r};if(n.bufferAccessor=i,n.bounds=null,r.constant){let s=r.value;if(s=this._normalizeValue(s,[],0),this.settings.normalized&&(s=this.normalizeConstant(s)),!(!n.constant||!this._areValuesEqual(s,this.value)))return!1;n.externalBuffer=null,n.constant=!0,this.value=s}else if(r.buffer){const s=r.buffer;n.externalBuffer=s,n.constant=!1,this.value=r.value||null;const o=r.value instanceof Float64Array;i.type=r.type||s.accessor.type,i.bytesPerElement=s.accessor.BYTES_PER_ELEMENT*(o?2:1),i.stride=ra(i)}else if(r.value){this._checkExternalBuffer(r);let s=r.value;n.externalBuffer=null,n.constant=!1,this.value=s,i.bytesPerElement=s.BYTES_PER_ELEMENT,i.stride=ra(i);const{buffer:o,byteOffset:a}=this;this.doublePrecision&&s instanceof Float64Array&&(s=Lu(s,i));const l=s.byteLength+a+i.stride*2;o.byteLength<l&&o.reallocate(l),o.setAccessor(null),o.subData({data:s,offset:a}),i.type=r.type||o.accessor.type}return!0}updateSubBuffer(e={}){this.state.bounds=null;const n=this.value,{startOffset:r=0,endOffset:i}=e;this.buffer.subData({data:this.doublePrecision&&n instanceof Float64Array?Lu(n,{size:this.size,startIndex:r,endIndex:i}):n.subarray(r,i),offset:r*n.BYTES_PER_ELEMENT+this.byteOffset})}allocate(e,n=!1){const{state:r}=this,i=r.allocatedValue,s=Ns.allocate(i,e+1,{size:this.size,type:this.settings.defaultType,copy:n});this.value=s;const{buffer:o,byteOffset:a}=this;return o.byteLength<s.byteLength+a&&(o.reallocate(s.byteLength+a),n&&i&&o.subData({data:i instanceof Float64Array?Lu(i,this):i,offset:a})),r.allocatedValue=s,r.constant=!1,r.externalBuffer=null,r.bufferAccessor=this.settings,!0}_checkExternalBuffer(e){const{value:n}=e;if(!ArrayBuffer.isView(n))throw new Error("Attribute ".concat(this.id," value is not TypedArray"));const r=this.settings.defaultType;let i=!1;if(this.doublePrecision&&(i=n.BYTES_PER_ELEMENT<4),i)throw new Error("Attribute ".concat(this.id," does not support ").concat(n.constructor.name));!(n instanceof r)&&this.settings.normalized&&!("normalized"in e)&&Q.warn("Attribute ".concat(this.id," is normalized"))()}normalizeConstant(e){switch(this.settings.type){case 5120:return new Float32Array(e).map(n=>(n+128)/255*2-1);case 5122:return new Float32Array(e).map(n=>(n+32768)/65535*2-1);case 5121:return new Float32Array(e).map(n=>n/255);case 5123:return new Float32Array(e).map(n=>n/65535);default:return e}}_normalizeValue(e,n,r){const{defaultValue:i,size:s}=this.settings;if(Number.isFinite(e))return n[r]=e,n;if(!e)return n[r]=i[0],n;switch(s){case 4:n[r+3]=Number.isFinite(e[3])?e[3]:i[3];case 3:n[r+2]=Number.isFinite(e[2])?e[2]:i[2];case 2:n[r+1]=Number.isFinite(e[1])?e[1]:i[1];case 1:n[r+0]=Number.isFinite(e[0])?e[0]:i[0];break;default:let o=s;for(;--o>=0;)n[r+o]=Number.isFinite(e[o])?e[o]:i[o]}return n}_areValuesEqual(e,n){if(!e||!n)return!1;const{size:r}=this;for(let i=0;i<r;i++)if(e[i]!==n[i])return!1;return!0}}const zp=[],jp=[];function Q_(t,e=0,n=1/0){let r=zp;const i={index:-1,data:t,target:[]};return t?typeof t[Symbol.iterator]=="function"?r=t:t.length>0&&(jp.length=t.length,r=jp):r=zp,(e>0||Number.isFinite(n))&&(r=(Array.isArray(r)?r:Array.from(r)).slice(e,n),i.index=e-1),{iterable:r,objectInfo:i}}function K_(t){return t&&t[Symbol.asyncIterator]}function Y3(t,e){const{size:n,stride:r,offset:i,startIndices:s,nested:o}=e,a=t.BYTES_PER_ELEMENT,l=r?r/a:n,u=i?i/a:0,c=Math.floor((t.length-u)/l);return(h,{index:f,target:g})=>{if(!s){const y=f*l+u;for(let m=0;m<n;m++)g[m]=t[y+m];return g}const w=s[f],E=s[f+1]||c;let T;if(o){T=new Array(E-w);for(let y=w;y<E;y++){const m=y*l+u;g=new Array(n);for(let _=0;_<n;_++)g[_]=t[m+_];T[y-w]=g}}else if(l===n)T=t.subarray(w*n+u,E*n+u);else{T=new t.constructor((E-w)*n);let y=0;for(let m=w;m<E;m++){const _=m*l+u;for(let S=0;S<n;S++)T[y++]=t[_+S]}}return T}}const $3=[],ia=[[0,1/0]];function q3(t,e){if(t===ia||(e[0]<0&&(e[0]=0),e[0]>=e[1]))return t;const n=[],r=t.length;let i=0;for(let s=0;s<r;s++){const o=t[s];o[1]<e[0]?(n.push(o),i=s+1):o[0]>e[1]?n.push(o):e=[Math.min(o[0],e[0]),Math.max(o[1],e[1])]}return n.splice(i,0,e),n}function Iu(t){const{source:e,target:n,start:r=0,size:i,getData:s}=t,o=t.end||n.length,a=e.length,l=o-r;if(a>l){n.set(e.subarray(0,l),r);return}if(n.set(e,r),!s)return;let u=a;for(;u<l;){const c=s(u,e);for(let h=0;h<i;h++)n[r+u]=c[h]||0,u++}}function Z3({source:t,target:e,size:n,getData:r,sourceStartIndices:i,targetStartIndices:s}){if(!Array.isArray(s))return Iu({source:t,target:e,size:n,getData:r}),e;let o=0,a=0;const l=r&&((c,h)=>r(c+a,h)),u=Math.min(i.length,s.length);for(let c=1;c<u;c++){const h=i[c]*n,f=s[c]*n;Iu({source:t.subarray(o,h),target:e,start:a,end:f,size:n,getData:l}),o=h,a=f}return a<e.length&&Iu({source:[],target:e,start:a,size:n,getData:l}),e}const Q3={interpolation:{duration:0,easing:t=>t},spring:{stiffness:.05,damping:.5}};function J_(t,e){if(!t)return null;Number.isFinite(t)&&(t={type:"interpolation",duration:t});const n=t.type||"interpolation";return{...Q3[n],...e,...t,type:n}}function ev(t,e){const n=e.getBuffer();return n?[n,{divisor:0,size:e.size,normalized:e.settings.normalized}]:e.value}function tv(t){switch(t){case 1:return"float";case 2:return"vec2";case 3:return"vec3";case 4:return"vec4";default:throw new Error('No defined attribute type for size "'.concat(t,'"'))}}function nv(t){t.push(t.shift())}function bf(t,e){const{doublePrecision:n,settings:r,value:i,size:s}=t,o=n&&i instanceof Float64Array?2:1;return(r.noAlloc?i.length:e*s)*o}function rv({buffer:t,numInstances:e,attribute:n,fromLength:r,fromStartIndices:i,getData:s=o=>o}){const o=n.doublePrecision&&n.value instanceof Float64Array?2:1,a=n.size*o,l=n.byteOffset,u=n.startIndices,c=i&&u,h=bf(n,e),f=n.isConstant;if(!c&&r>=h)return;const g=f?n.value:n.getBuffer().getData({srcByteOffset:l});if(n.settings.normalized&&!f){const y=s;s=(m,_)=>n.normalizeConstant(y(m,_))}const w=f?(y,m)=>s(g,m):(y,m)=>s(g.subarray(y,y+a),m),E=t.getData({length:r}),T=new Float32Array(h);Z3({source:E,target:T,sourceStartIndices:i,targetStartIndices:u,size:a,getData:w}),t.byteLength<T.byteLength+l&&t.reallocate(T.byteLength+l),t.subData({data:T,offset:l})}class Sf extends X3{constructor(e,n){super(e,n,{startIndices:null,lastExternalBuffer:null,binaryValue:null,binaryAccessor:null,needsUpdate:!0,needsRedraw:!1,updateRanges:ia}),d(this,"constant",!1),this.settings.update=n.update||(n.accessor?this._autoUpdater:void 0),Object.seal(this.settings),Object.seal(this.state),this._validateAttributeUpdaters()}get startIndices(){return this.state.startIndices}set startIndices(e){this.state.startIndices=e}needsUpdate(){return this.state.needsUpdate}needsRedraw({clearChangedFlags:e=!1}={}){const n=this.state.needsRedraw;return this.state.needsRedraw=n&&!e,n}getUpdateTriggers(){const{accessor:e}=this.settings;return[this.id].concat(typeof e!="function"&&e||[])}supportsTransition(){return Boolean(this.settings.transition)}getTransitionSetting(e){if(!e||!this.supportsTransition())return null;const{accessor:n}=this.settings,r=this.settings.transition,i=Array.isArray(n)?e[n.find(s=>e[s])]:e[n];return J_(i,r)}setNeedsUpdate(e=this.id,n){if(this.state.needsUpdate=this.state.needsUpdate||e,this.setNeedsRedraw(e),n){const{startRow:r=0,endRow:i=1/0}=n;this.state.updateRanges=q3(this.state.updateRanges,[r,i])}else this.state.updateRanges=ia}clearNeedsUpdate(){this.state.needsUpdate=!1,this.state.updateRanges=$3}setNeedsRedraw(e=this.id){this.state.needsRedraw=this.state.needsRedraw||e}allocate(e){const{state:n,settings:r}=this;return r.noAlloc?!1:r.update?(super.allocate(e,n.updateRanges!==ia),!0):!1}updateBuffer({numInstances:e,data:n,props:r,context:i}){if(!this.needsUpdate())return!1;const{state:{updateRanges:s},settings:{update:o,noAlloc:a}}=this;let l=!0;if(o){for(const[u,c]of s)o.call(i,this,{data:n,startRow:u,endRow:c,props:r,numInstances:e});if(this.value)if(this.constant||this.buffer.byteLength<this.value.byteLength+this.byteOffset)this.setData({value:this.value,constant:this.constant}),this.constant=!1;else for(const[u,c]of s){const h=Number.isFinite(u)?this.getVertexOffset(u):0,f=Number.isFinite(c)?this.getVertexOffset(c):a||!Number.isFinite(e)?this.value.length:e*this.size;super.updateSubBuffer({startOffset:h,endOffset:f})}this._checkAttributeArray()}else l=!1;return this.clearNeedsUpdate(),this.setNeedsRedraw(),l}setConstantValue(e){return e===void 0||typeof e=="function"?!1:(this.setData({constant:!0,value:e})&&this.setNeedsRedraw(),this.clearNeedsUpdate(),!0)}setExternalBuffer(e){const{state:n}=this;return e?(this.clearNeedsUpdate(),n.lastExternalBuffer===e||(n.lastExternalBuffer=e,this.setNeedsRedraw(),this.setData(e)),!0):(n.lastExternalBuffer=null,!1)}setBinaryValue(e,n=null){const{state:r,settings:i}=this;if(!e)return r.binaryValue=null,r.binaryAccessor=null,!1;if(i.noAlloc)return!1;if(r.binaryValue===e)return this.clearNeedsUpdate(),!0;if(r.binaryValue=e,this.setNeedsRedraw(),i.transform||n!==this.startIndices){ArrayBuffer.isView(e)&&(e={value:e});const o=e;Re(ArrayBuffer.isView(o.value),"invalid ".concat(i.accessor));const a=Boolean(o.size)&&o.size!==this.size;return r.binaryAccessor=Y3(o.value,{size:o.size||this.size,stride:o.stride,offset:o.offset,startIndices:n,nested:a}),!1}return this.clearNeedsUpdate(),this.setData(e),!0}getVertexOffset(e){const{startIndices:n}=this;return(n?e<n.length?n[e]:this.numInstances:e)*this.size}getShaderAttributes(){const e=this.settings.shaderAttributes||{[this.id]:null},n={};for(const r in e)Object.assign(n,super.getShaderAttributes(r,e[r]));return n}_autoUpdater(e,{data:n,startRow:r,endRow:i,props:s,numInstances:o}){if(e.constant)return;const{settings:a,state:l,value:u,size:c,startIndices:h}=e,{accessor:f,transform:g}=a,w=l.binaryAccessor||(typeof f=="function"?f:s[f]);Re(typeof w=="function",'accessor "'.concat(f,'" is not a function'));let E=e.getVertexOffset(r);const{iterable:T,objectInfo:y}=Q_(n,r,i);for(const m of T){y.index++;let _=w(m,y);if(g&&(_=g.call(this,_)),h){const S=(y.index<h.length-1?h[y.index+1]:o)-h[y.index];if(_&&Array.isArray(_[0])){let A=E;for(const P of _)e._normalizeValue(P,u,A),A+=c}else _&&_.length>c?u.set(_,E):(e._normalizeValue(_,y.target,0),mL({target:u,source:y.target,start:E,count:S}));E+=S*c}else e._normalizeValue(_,u,E),E+=c}}_validateAttributeUpdaters(){const{settings:e}=this;if(!(e.noAlloc||typeof e.update=="function"))throw new Error("Attribute ".concat(this.id," missing update or accessor"))}_checkAttributeArray(){const{value:e}=this,n=Math.min(4,this.size);if(e&&e.length>=n){let r=!0;switch(n){case 4:r=r&&Number.isFinite(e[3]);case 3:r=r&&Number.isFinite(e[2]);case 2:r=r&&Number.isFinite(e[1]);case 1:r=r&&Number.isFinite(e[0]);break;default:r=!1}if(!r)throw new Error("Illegal attribute generated for ".concat(this.id))}}}class K3{constructor({gl:e,attribute:n,timeline:r}){d(this,"gl",void 0),d(this,"type","interpolation"),d(this,"attributeInTransition",void 0),d(this,"settings",void 0),d(this,"attribute",void 0),d(this,"transition",void 0),d(this,"currentStartIndices",void 0),d(this,"currentLength",void 0),d(this,"transform",void 0),d(this,"buffers",void 0),this.gl=e,this.transition=new Ks(r),this.attribute=n,this.attributeInTransition=new Sf(e,n.settings),this.currentStartIndices=n.startIndices,this.currentLength=0,this.transform=eR(e,n);const i={byteLength:0,usage:35050};this.buffers=[new te(e,i),new te(e,i)]}get inProgress(){return this.transition.inProgress}start(e,n){if(e.duration<=0){this.transition.cancel();return}this.settings=e;const{gl:r,buffers:i,attribute:s}=this;nv(i);const o={numInstances:n,attribute:s,fromLength:this.currentLength,fromStartIndices:this.currentStartIndices,getData:e.enter};for(const a of i)rv({buffer:a,...o});this.currentStartIndices=s.startIndices,this.currentLength=bf(s,n),this.attributeInTransition.setData({buffer:i[1],value:s.value}),this.transition.start(e),this.transform.update({elementCount:Math.floor(this.currentLength/s.size),sourceBuffers:{aFrom:i[0],aTo:ev(r,s)},feedbackBuffers:{vCurrent:i[1]}})}update(){const e=this.transition.update();if(e){const{duration:n,easing:r}=this.settings,{time:i}=this.transition;let s=i/n;r&&(s=r(s)),this.transform.run({uniforms:{time:s}})}return e}cancel(){this.transition.cancel(),this.transform.delete();for(const e of this.buffers)e.delete();this.buffers.length=0}}const J3=`
#define SHADER_NAME interpolation-transition-vertex-shader

uniform float time;
attribute ATTRIBUTE_TYPE aFrom;
attribute ATTRIBUTE_TYPE aTo;
varying ATTRIBUTE_TYPE vCurrent;

void main(void) {
  vCurrent = mix(aFrom, aTo, time);
  gl_Position = vec4(0.0);
}
`;function eR(t,e){const n=tv(e.size);return new mf(t,{vs:J3,defines:{ATTRIBUTE_TYPE:n},varyings:["vCurrent"]})}class tR{constructor({gl:e,attribute:n,timeline:r}){d(this,"gl",void 0),d(this,"type","spring"),d(this,"attributeInTransition",void 0),d(this,"settings",void 0),d(this,"attribute",void 0),d(this,"transition",void 0),d(this,"currentStartIndices",void 0),d(this,"currentLength",void 0),d(this,"texture",void 0),d(this,"framebuffer",void 0),d(this,"transform",void 0),d(this,"buffers",void 0),this.gl=e,this.type="spring",this.transition=new Ks(r),this.attribute=n,this.attributeInTransition=new Sf(e,{...n.settings,normalized:!1}),this.currentStartIndices=n.startIndices,this.currentLength=0,this.texture=rR(e),this.framebuffer=iR(e,this.texture),this.transform=nR(e,n,this.framebuffer);const i={byteLength:0,usage:35050};this.buffers=[new te(e,i),new te(e,i),new te(e,i)]}get inProgress(){return this.transition.inProgress}start(e,n){const{gl:r,buffers:i,attribute:s}=this,o={numInstances:n,attribute:s,fromLength:this.currentLength,fromStartIndices:this.currentStartIndices,getData:e.enter};for(const a of i)rv({buffer:a,...o});this.settings=e,this.currentStartIndices=s.startIndices,this.currentLength=bf(s,n),this.attributeInTransition.setData({buffer:i[1],value:s.value}),this.transition.start({...e,duration:1/0}),this.transform.update({elementCount:Math.floor(this.currentLength/s.size),sourceBuffers:{aTo:ev(r,s)}})}update(){const{buffers:e,transform:n,framebuffer:r,transition:i}=this;if(!i.update())return!1;const o=this.settings;return n.update({sourceBuffers:{aPrev:e[0],aCur:e[1]},feedbackBuffers:{vNext:e[2]}}),n.run({framebuffer:r,discard:!1,clearRenderTarget:!0,uniforms:{stiffness:o.stiffness,damping:o.damping},parameters:{depthTest:!1,blend:!0,viewport:[0,0,1,1],blendFunc:[1,1],blendEquation:[32776,32776]}}),nv(e),this.attributeInTransition.setData({buffer:e[1],value:this.attribute.value}),pl(r)[0]>0||i.end(),!0}cancel(){this.transition.cancel(),this.transform.delete();for(const e of this.buffers)e.delete();this.buffers.length=0,this.texture.delete(),this.framebuffer.delete()}}function nR(t,e,n){const r=tv(e.size);return new mf(t,{framebuffer:n,vs:`
#define SHADER_NAME spring-transition-vertex-shader

#define EPSILON 0.00001

uniform float stiffness;
uniform float damping;
attribute ATTRIBUTE_TYPE aPrev;
attribute ATTRIBUTE_TYPE aCur;
attribute ATTRIBUTE_TYPE aTo;
varying ATTRIBUTE_TYPE vNext;
varying float vIsTransitioningFlag;

ATTRIBUTE_TYPE getNextValue(ATTRIBUTE_TYPE cur, ATTRIBUTE_TYPE prev, ATTRIBUTE_TYPE dest) {
  ATTRIBUTE_TYPE velocity = cur - prev;
  ATTRIBUTE_TYPE delta = dest - cur;
  ATTRIBUTE_TYPE spring = delta * stiffness;
  ATTRIBUTE_TYPE damper = velocity * -1.0 * damping;
  return spring + damper + velocity + cur;
}

void main(void) {
  bool isTransitioning = length(aCur - aPrev) > EPSILON || length(aTo - aCur) > EPSILON;
  vIsTransitioningFlag = isTransitioning ? 1.0 : 0.0;

  vNext = getNextValue(aCur, aPrev, aTo);
  gl_Position = vec4(0, 0, 0, 1);
  gl_PointSize = 100.0;
}
`,fs:`
#define SHADER_NAME spring-transition-is-transitioning-fragment-shader

varying float vIsTransitioningFlag;

void main(void) {
  if (vIsTransitioningFlag == 0.0) {
    discard;
  }
  gl_FragColor = vec4(1.0);
}`,defines:{ATTRIBUTE_TYPE:r},varyings:["vNext"]})}function rR(t){return new dt(t,{data:new Uint8Array(4),format:6408,type:5121,border:0,mipmaps:!1,dataFormat:6408,width:1,height:1})}function iR(t,e){return new we(t,{id:"spring-transition-is-transitioning-framebuffer",width:1,height:1,attachments:{[36064]:e}})}const sR={interpolation:K3,spring:tR};class oR{constructor(e,{id:n,timeline:r}){d(this,"id",void 0),d(this,"isSupported",void 0),d(this,"gl",void 0),d(this,"timeline",void 0),d(this,"transitions",void 0),d(this,"needsRedraw",void 0),d(this,"numInstances",void 0),this.id=n,this.gl=e,this.timeline=r,this.transitions={},this.needsRedraw=!1,this.numInstances=1,this.isSupported=mf.isSupported(e)}finalize(){for(const e in this.transitions)this._removeTransition(e)}update({attributes:e,transitions:n,numInstances:r}){this.numInstances=r||1;for(const i in e){const s=e[i],o=s.getTransitionSetting(n);o&&this._updateAttribute(i,s,o)}for(const i in this.transitions){const s=e[i];(!s||!s.getTransitionSetting(n))&&this._removeTransition(i)}}hasAttribute(e){const n=this.transitions[e];return n&&n.inProgress}getAttributes(){const e={};for(const n in this.transitions){const r=this.transitions[n];r.inProgress&&(e[n]=r.attributeInTransition)}return e}run(){if(!this.isSupported||this.numInstances===0)return!1;for(const n in this.transitions)this.transitions[n].update()&&(this.needsRedraw=!0);const e=this.needsRedraw;return this.needsRedraw=!1,e}_removeTransition(e){this.transitions[e].cancel(),delete this.transitions[e]}_updateAttribute(e,n,r){const i=this.transitions[e];let s=!i||i.type!==r.type;if(s){if(!this.isSupported){Q.warn("WebGL2 not supported by this browser. Transition for ".concat(e," is disabled."))();return}i&&this._removeTransition(e);const o=sR[r.type];o?this.transitions[e]=new o({attribute:n,timeline:this.timeline,gl:this.gl}):(Q.error("unsupported transition type '".concat(r.type,"'"))(),s=!1)}(s||n.needsRedraw())&&(this.needsRedraw=!0,this.transitions[e].start(r,this.numInstances))}}const Gp="attributeManager.invalidate",aR="attributeManager.updateStart",lR="attributeManager.updateEnd",uR="attribute.updateStart",cR="attribute.allocate",hR="attribute.updateEnd";class iv{constructor(e,{id:n="attribute-manager",stats:r,timeline:i}={}){d(this,"id",void 0),d(this,"gl",void 0),d(this,"attributes",void 0),d(this,"updateTriggers",void 0),d(this,"needsRedraw",void 0),d(this,"userData",void 0),d(this,"stats",void 0),d(this,"attributeTransitionManager",void 0),this.id=n,this.gl=e,this.attributes={},this.updateTriggers={},this.needsRedraw=!0,this.userData={},this.stats=r,this.attributeTransitionManager=new oR(e,{id:"".concat(n,"-transitions"),timeline:i}),Object.seal(this)}finalize(){for(const e in this.attributes)this.attributes[e].delete();this.attributeTransitionManager.finalize()}getNeedsRedraw(e={clearRedrawFlags:!1}){const n=this.needsRedraw;return this.needsRedraw=this.needsRedraw&&!e.clearRedrawFlags,n&&this.id}setNeedsRedraw(){this.needsRedraw=!0}add(e){this._add(e)}addInstanced(e){this._add(e,{instanced:1})}remove(e){for(const n of e)this.attributes[n]!==void 0&&(this.attributes[n].delete(),delete this.attributes[n])}invalidate(e,n){const r=this._invalidateTrigger(e,n);Ue(Gp,this,e,r)}invalidateAll(e){for(const n in this.attributes)this.attributes[n].setNeedsUpdate(n,e);Ue(Gp,this,"all")}update({data:e,numInstances:n,startIndices:r=null,transitions:i,props:s={},buffers:o={},context:a={}}){let l=!1;Ue(aR,this),this.stats&&this.stats.get("Update Attributes").timeStart();for(const u in this.attributes){const c=this.attributes[u],h=c.settings.accessor;c.startIndices=r,c.numInstances=n,s[u]&&Q.removed("props.".concat(u),"data.attributes.".concat(u))(),c.setExternalBuffer(o[u])||c.setBinaryValue(typeof h=="string"?o[h]:void 0,e.startIndices)||typeof h=="string"&&!o[h]&&c.setConstantValue(s[h])||c.needsUpdate()&&(l=!0,this._updateAttribute({attribute:c,numInstances:n,data:e,props:s,context:a})),this.needsRedraw=this.needsRedraw||c.needsRedraw()}l&&Ue(lR,this,n),this.stats&&this.stats.get("Update Attributes").timeEnd(),this.attributeTransitionManager.update({attributes:this.attributes,numInstances:n,transitions:i})}updateTransition(){const{attributeTransitionManager:e}=this,n=e.run();return this.needsRedraw=this.needsRedraw||n,n}getAttributes(){return this.attributes}getChangedAttributes(e={clearChangedFlags:!1}){const{attributes:n,attributeTransitionManager:r}=this,i={...r.getAttributes()};for(const s in n){const o=n[s];o.needsRedraw(e)&&!r.hasAttribute(s)&&(i[s]=o)}return i}getShaderAttributes(e,n={}){e||(e=this.getAttributes());const r={};for(const i in e)n[i]||Object.assign(r,e[i].getShaderAttributes());return r}_add(e,n={}){for(const r in e){const i=e[r];this.attributes[r]=this._createAttribute(r,i,n)}this._mapUpdateTriggersToAttributes()}_createAttribute(e,n,r){const i={...n,id:e,size:n.isIndexed&&1||n.size||1,divisor:r.instanced?1:n.divisor||0};return new Sf(this.gl,i)}_mapUpdateTriggersToAttributes(){const e={};for(const n in this.attributes)this.attributes[n].getUpdateTriggers().forEach(i=>{e[i]||(e[i]=[]),e[i].push(n)});this.updateTriggers=e}_invalidateTrigger(e,n){const{attributes:r,updateTriggers:i}=this,s=i[e];return s&&s.forEach(o=>{const a=r[o];a&&a.setNeedsUpdate(a.id,n)}),s}_updateAttribute(e){const{attribute:n,numInstances:r}=e;if(Ue(uR,n),n.constant){n.setConstantValue(n.value);return}n.allocate(r)&&Ue(cR,n,r),n.updateBuffer(e)&&(this.needsRedraw=!0,Ue(hR,n,r))}}class fR extends Ks{get value(){return this._value}_onUpdate(){const{time:e,settings:{fromValue:n,toValue:r,duration:i,easing:s}}=this,o=s(e/i);this._value=Da(n,r,o)}}const Hp=1e-5;function Wp(t,e,n,r,i){const s=e-t,a=(n-e)*i,l=-s*r;return a+l+s+e}function dR(t,e,n,r,i){if(Array.isArray(n)){const s=[];for(let o=0;o<n.length;o++)s[o]=Wp(t[o],e[o],n[o],r,i);return s}return Wp(t,e,n,r,i)}function Xp(t,e){if(Array.isArray(t)){let n=0;for(let r=0;r<t.length;r++){const i=t[r]-e[r];n+=i*i}return Math.sqrt(n)}return Math.abs(t-e)}class gR extends Ks{get value(){return this._currValue}_onUpdate(){const{fromValue:e,toValue:n,damping:r,stiffness:i}=this.settings,{_prevValue:s=e,_currValue:o=e}=this;let a=dR(s,o,n,r,i);const l=Xp(a,n),u=Xp(a,o);l<Hp&&u<Hp&&(a=n,this.end()),this._prevValue=o,this._currValue=a}}const pR={interpolation:fR,spring:gR};class mR{constructor(e){this.transitions=new Map,this.timeline=e}get active(){return this.transitions.size>0}add(e,n,r,i){const{transitions:s}=this;if(s.has(e)){const l=s.get(e),{value:u=l.settings.fromValue}=l;n=u,this.remove(e)}if(i=J_(i),!i)return;const o=pR[i.type];if(!o){Q.error("unsupported transition type '".concat(i.type,"'"))();return}const a=new o(this.timeline);a.start({...i,fromValue:n,toValue:r}),s.set(e,a)}remove(e){const{transitions:n}=this;n.has(e)&&(n.get(e).cancel(),n.delete(e))}update(){const e={};for(const[n,r]of this.transitions)r.update(),e[n]=r.value,r.inProgress||this.remove(n);return e}clear(){for(const e of this.transitions.keys())this.remove(e)}}function yR(t){const e=xf(t);for(const n in e){const r=e[n],{validate:i}=r;if(i&&!i(t[n],r))throw new Error("Invalid prop ".concat(n,": ").concat(t[n]))}}function _R(t,e){const n=Af({newProps:t,oldProps:e,propTypes:xf(t),ignoreProps:{data:null,updateTriggers:null,extensions:null,transitions:null}}),r=wR(t,e);let i=!1;return r||(i=ER(t,e)),{dataChanged:r,propsChanged:n,updateTriggersChanged:i,extensionsChanged:TR(t,e),transitionsChanged:vR(t,e)}}function vR(t,e){if(!t.transitions)return!1;const n={},r=xf(t);let i=!1;for(const s in t.transitions){const o=r[s],a=o&&o.type;(a==="number"||a==="color"||a==="array")&&nh(t[s],e[s],o)&&(n[s]=!0,i=!0)}return i?n:!1}function Af({newProps:t,oldProps:e,ignoreProps:n={},propTypes:r={},triggerName:i="props"}){if(e===t)return!1;if(typeof t!="object"||t===null||typeof e!="object"||e===null)return"".concat(i," changed shallowly");for(const s of Object.keys(t))if(!(s in n)){if(!(s in e))return"".concat(i,".").concat(s," added");const o=nh(t[s],e[s],r[s]);if(o)return"".concat(i,".").concat(s," ").concat(o)}for(const s of Object.keys(e))if(!(s in n)){if(!(s in t))return"".concat(i,".").concat(s," dropped");if(!Object.hasOwnProperty.call(t,s)){const o=nh(t[s],e[s],r[s]);if(o)return"".concat(i,".").concat(s," ").concat(o)}}return!1}function nh(t,e,n){let r=n&&n.equal;return r&&!r(t,e,n)||!r&&(r=t&&e&&t.equals,r&&!r.call(t,e))?"changed deeply":!r&&e!==t?"changed shallowly":null}function wR(t,e){if(e===null)return"oldProps is null, initial diff";let n=!1;const{dataComparator:r,_dataDiff:i}=t;return r?r(t.data,e.data)||(n="Data comparator detected a change"):t.data!==e.data&&(n="A new data container was supplied"),n&&i&&(n=i(t.data,e.data)||n),n}function ER(t,e){if(e===null)return{all:!0};if("all"in t.updateTriggers&&Yp(t,e,"all"))return{all:!0};const n={};let r=!1;for(const i in t.updateTriggers)i!=="all"&&Yp(t,e,i)&&(n[i]=!0,r=!0);return r?n:!1}function TR(t,e){if(e===null)return!0;const n=e.extensions,{extensions:r}=t;if(r===n)return!1;if(!n||!r||r.length!==n.length)return!0;for(let i=0;i<r.length;i++)if(!r[i].equals(n[i]))return!0;return!1}function Yp(t,e,n){let r=t.updateTriggers[n];r=r??{};let i=e.updateTriggers[n];return i=i??{},Af({oldProps:i,newProps:r,triggerName:n})}function xf(t){const e=t[Ga],n=e&&e.constructor;return n?n._propTypes:{}}const bR="count(): argument not an object",SR="count(): argument not a container";function AR(t){if(!PR(t))throw new Error(bR);if(typeof t.count=="function")return t.count();if(Number.isFinite(t.size))return t.size;if(Number.isFinite(t.length))return t.length;if(xR(t))return Object.keys(t).length;throw new Error(SR)}function xR(t){return t!==null&&typeof t=="object"&&t.constructor===Object}function PR(t){return t!==null&&typeof t=="object"}function CR(t,e){if(!e)return t;const n={...t,...e};if("defines"in e&&(n.defines={...t.defines,...e.defines}),"modules"in e&&(n.modules=(t.modules||[]).concat(e.modules),e.modules.some(r=>r.name==="project64"))){const r=n.modules.findIndex(i=>i.name==="project32");r>=0&&n.modules.splice(r,1)}if("inject"in e)if(!t.inject)n.inject=e.inject;else{const r={...t.inject};for(const i in e.inject)r[i]=(r[i]||"")+e.inject[i];n.inject=r}return n}const LR={[10241]:9987,[10240]:9729,[10242]:33071,[10243]:33071},rh={};function RR(t,e){const n=t.context&&t.context.gl;if(!n||!e)return null;if(e instanceof dt)return e;e.constructor&&e.constructor.name!=="Object"&&(e={data:e});let r=null;e.compressed&&(r={[10241]:e.data.length>1?9985:9729});const i=new dt(n,{...e,parameters:{...LR,...r,...t.props.textureParameters}});return rh[i.id]=!0,i}function MR(t){!t||!(t instanceof dt)||rh[t.id]&&(t.delete(),delete rh[t.id])}const kR={boolean:{validate(t,e){return!0},equal(t,e,n){return Boolean(t)===Boolean(e)}},number:{validate(t,e){return Number.isFinite(t)&&(!("max"in e)||t<=e.max)&&(!("min"in e)||t>=e.min)}},color:{validate(t,e){return e.optional&&!t||Ds(t)&&(t.length===3||t.length===4)},equal(t,e,n){return Ou(t,e)}},accessor:{validate(t,e){const n=Wa(t);return n==="function"||n===Wa(e.value)},equal(t,e,n){return typeof e=="function"?!0:Ou(t,e)}},array:{validate(t,e){return e.optional&&!t||Ds(t)},equal(t,e,n){return n.compare?Ou(t,e):t===e}},object:{equal(t,e,n){return n.compare?xi(t,e):t===e}},function:{validate(t,e){return e.optional&&!t||typeof t=="function"},equal(t,e,n){return!n.compare||t===e}},data:{transform:(t,e,n)=>{const{dataTransform:r}=n.props;return r&&t?r(t):t}},image:{transform:(t,e,n)=>RR(n,t),release:t=>{MR(t)}}};function Ou(t,e){if(t===e)return!0;if(!Ds(t)||!Ds(e))return!1;const n=t.length;if(n!==e.length)return!1;for(let r=0;r<n;r++)if(t[r]!==e[r])return!1;return!0}function IR(t){const e={},n={},r={};for(const[i,s]of Object.entries(t)){const o=s?.deprecatedFor;if(o)r[i]=Array.isArray(o)?o:[o];else{const a=OR(i,s);e[i]=a,n[i]=a.value}}return{propTypes:e,defaultProps:n,deprecatedProps:r}}function OR(t,e){switch(Wa(e)){case"object":return Yi(t,e);case"array":return Yi(t,{type:"array",value:e,compare:!1});case"boolean":return Yi(t,{type:"boolean",value:e});case"number":return Yi(t,{type:"number",value:e});case"function":return Yi(t,{type:"function",value:e,compare:!0});default:return{name:t,type:"unknown",value:e}}}function Yi(t,e){return"type"in e?{name:t,...kR[e.type],...e}:"value"in e?{name:t,type:Wa(e.value),...e}:{name:t,type:"object",value:e}}function Ds(t){return Array.isArray(t)||ArrayBuffer.isView(t)}function Wa(t){return Ds(t)?"array":t===null?"null":typeof t}function NR(t,e){const n=sv(t.constructor),r=Object.create(n);r[Ga]=t,r[wr]={},r[Dn]={};for(let i=0;i<e.length;++i){const s=e[i];for(const o in s)r[o]=s[o]}return Object.freeze(r),r}function sv(t){const e=Xa(t,"_mergedDefaultProps");return e||(DR(t),t._mergedDefaultProps)}function DR(t){if(!t.prototype)return;const n=Object.getPrototypeOf(t),r=sv(n),i=Xa(t,"defaultProps")||{},s=IR(i),o=FR(s.defaultProps,r,t),a={...n._propTypes,...s.propTypes};BR(o,a);const l={...n._deprecatedProps,...s.deprecatedProps};UR(o,l),t._mergedDefaultProps=o,t._propTypes=a,t._deprecatedProps=l}function FR(t,e,n){const r=Object.create(null);Object.assign(r,e,t);const i=zR(n);return delete t.id,Object.defineProperties(r,{id:{writable:!0,value:i}}),r}function UR(t,e){for(const n in e)Object.defineProperty(t,n,{enumerable:!1,set(r){const i="".concat(this.id,": ").concat(n);for(const s of e[n])ov(this,s)||(this[s]=r);Q.deprecated(i,e[n].join("/"))()}})}function BR(t,e){const n={},r={};for(const i in e){const s=e[i],{name:o,value:a}=s;s.async&&(n[o]=a,r[o]=VR(o))}t[si]=n,t[wr]={},Object.defineProperties(t,r)}function VR(t){return{enumerable:!0,set(e){typeof e=="string"||e instanceof Promise||K_(e)?this[wr][t]=e:this[Dn][t]=e},get(){if(this[Dn]){if(t in this[Dn])return this[Dn][t]||this[si][t];if(t in this[wr]){const e=this[Ga]&&this[Ga].internalState;if(e&&e.hasAsyncProp(t))return e.getAsyncProp(t)||this[si][t]}}return this[si][t]}}}function ov(t,e){return Object.prototype.hasOwnProperty.call(t,e)}function Xa(t,e){return ov(t,e)&&t[e]}function zR(t){const e=Xa(t,"layerName")||Xa(t,"componentName");return e||Q.once(0,"".concat(t.name,".componentName not specified"))(),e||t.name}let jR=0;class Pf{constructor(...e){d(this,"id",void 0),d(this,"props",void 0),d(this,"count",void 0),this.props=NR(this,e),this.id=this.props.id,this.count=jR++}clone(e){const{props:n}=this,r={};for(const i in n[si])i in n[Dn]?r[i]=n[Dn][i]:i in n[wr]&&(r[i]=n[wr][i]);return new this.constructor({...n,...r,...e})}}d(Pf,"componentName","Component");d(Pf,"defaultProps",{});const GR=Object.freeze({});class HR{constructor(e){d(this,"component",void 0),d(this,"onAsyncPropUpdated",void 0),d(this,"asyncProps",void 0),d(this,"oldProps",void 0),d(this,"oldAsyncProps",void 0),this.component=e,this.asyncProps={},this.onAsyncPropUpdated=()=>{},this.oldProps=null,this.oldAsyncProps=null}finalize(){for(const e in this.asyncProps){const n=this.asyncProps[e];n&&n.type&&n.type.release&&n.type.release(n.resolvedValue,n.type,this.component)}}getOldProps(){return this.oldAsyncProps||this.oldProps||GR}resetOldProps(){this.oldAsyncProps=null,this.oldProps=this.component.props}hasAsyncProp(e){return e in this.asyncProps}getAsyncProp(e){const n=this.asyncProps[e];return n&&n.resolvedValue}isAsyncPropLoading(e){if(e){const n=this.asyncProps[e];return Boolean(n&&n.pendingLoadCount>0&&n.pendingLoadCount!==n.resolvedLoadCount)}for(const n in this.asyncProps)if(this.isAsyncPropLoading(n))return!0;return!1}reloadAsyncProp(e,n){this._watchPromise(e,Promise.resolve(n))}setAsyncProps(e){const n=e[Dn]||{},r=e[wr]||e,i=e[si]||{};for(const s in n){const o=n[s];this._createAsyncPropData(s,i[s]),this._updateAsyncProp(s,o),n[s]=this.getAsyncProp(s)}for(const s in r){const o=r[s];this._createAsyncPropData(s,i[s]),this._updateAsyncProp(s,o)}}_fetch(e,n){return null}_onResolve(e,n){}_onError(e,n){}_updateAsyncProp(e,n){if(this._didAsyncInputValueChange(e,n)){if(typeof n=="string"&&(n=this._fetch(e,n)),n instanceof Promise){this._watchPromise(e,n);return}if(K_(n)){this._resolveAsyncIterable(e,n);return}this._setPropValue(e,n)}}_freezeAsyncOldProps(){if(!this.oldAsyncProps&&this.oldProps){this.oldAsyncProps=Object.create(this.oldProps);for(const e in this.asyncProps)Object.defineProperty(this.oldAsyncProps,e,{enumerable:!0,value:this.oldProps[e]})}}_didAsyncInputValueChange(e,n){const r=this.asyncProps[e];return n===r.resolvedValue||n===r.lastValue?!1:(r.lastValue=n,!0)}_setPropValue(e,n){this._freezeAsyncOldProps();const r=this.asyncProps[e];r&&(n=this._postProcessValue(r,n),r.resolvedValue=n,r.pendingLoadCount++,r.resolvedLoadCount=r.pendingLoadCount)}_setAsyncPropValue(e,n,r){const i=this.asyncProps[e];i&&r>=i.resolvedLoadCount&&n!==void 0&&(this._freezeAsyncOldProps(),i.resolvedValue=n,i.resolvedLoadCount=r,this.onAsyncPropUpdated(e,n))}_watchPromise(e,n){const r=this.asyncProps[e];if(r){r.pendingLoadCount++;const i=r.pendingLoadCount;n.then(s=>{s=this._postProcessValue(r,s),this._setAsyncPropValue(e,s,i),this._onResolve(e,s)}).catch(s=>{this._onError(e,s)})}}async _resolveAsyncIterable(e,n){if(e!=="data"){this._setPropValue(e,n);return}const r=this.asyncProps[e];if(!r)return;r.pendingLoadCount++;const i=r.pendingLoadCount;let s=[],o=0;for await(const a of n){const{dataTransform:l}=this.component.props;l?s=l(a,s):s=s.concat(a),Object.defineProperty(s,"__diff",{enumerable:!1,value:[{startRow:o,endRow:s.length}]}),o=s.length,this._setAsyncPropValue(e,s,i)}this._onResolve(e,s)}_postProcessValue(e,n){const r=e.type;return r&&(r.release&&r.release(e.resolvedValue,r,this.component),r.transform)?r.transform(n,r,this.component):n}_createAsyncPropData(e,n){if(!this.asyncProps[e]){const i=this.component&&this.component.constructor._propTypes;this.asyncProps[e]={type:i&&i[e],lastValue:null,resolvedValue:n,pendingLoadCount:0,resolvedLoadCount:0}}}}class WR extends HR{constructor({attributeManager:e,layer:n}){super(n),d(this,"attributeManager",void 0),d(this,"needsRedraw",void 0),d(this,"needsUpdate",void 0),d(this,"subLayers",void 0),d(this,"usesPickingColorCache",void 0),d(this,"changeFlags",void 0),d(this,"viewport",void 0),d(this,"uniformTransitions",void 0),d(this,"propsInTransition",void 0),this.attributeManager=e,this.needsRedraw=!0,this.needsUpdate=!0,this.subLayers=null,this.usesPickingColorCache=!1}get layer(){return this.component}set layer(e){this.component=e}_fetch(e,n){const r=this.component.props.fetch;return r?r(n,{propName:e,layer:this.layer}):super._fetch(e,n)}_onResolve(e,n){const r=this.component.props.onDataLoad;e==="data"&&r&&r(n,{propName:e,layer:this.layer})}_onError(e,n){this.layer.raiseError(n,"loading ".concat(e," of ").concat(this.layer))}}const XR="layer.changeFlag",YR="layer.initialize",$R="layer.update",qR="layer.finalize",ZR="layer.matched",$p=2**24-1,QR=Object.freeze([]),KR=ml(({oldViewport:t,viewport:e})=>t.equals(e));let Wt=new Uint8ClampedArray(0);const JR={data:{type:"data",value:QR,async:!0},dataComparator:{type:"function",value:null,compare:!1,optional:!0},_dataDiff:{type:"function",value:t=>t&&t.__diff,compare:!1,optional:!0},dataTransform:{type:"function",value:null,compare:!1,optional:!0},onDataLoad:{type:"function",value:null,compare:!1,optional:!0},onError:{type:"function",value:null,compare:!1,optional:!0},fetch:{type:"function",value:(t,{propName:e,layer:n,loaders:r,loadOptions:i,signal:s})=>{const{resourceManager:o}=n.context;if(i=i||n.getLoadOptions(),r=r||n.props.loaders,s){var a;i={...i,fetch:{...(a=i)===null||a===void 0?void 0:a.fetch,signal:s}}}let l=o.contains(t);return!l&&!i&&(o.add({resourceId:t,data:Ia(t,r),persistent:!1}),l=!0),l?o.subscribe({resourceId:t,onChange:u=>{var c;return(c=n.internalState)===null||c===void 0?void 0:c.reloadAsyncProp(e,u)},consumerId:n.id,requestId:e}):Ia(t,r,i)},compare:!1},updateTriggers:{},visible:!0,pickable:!1,opacity:{type:"number",min:0,max:1,value:1},operation:Qs.DRAW,onHover:{type:"function",value:null,compare:!1,optional:!0},onClick:{type:"function",value:null,compare:!1,optional:!0},onDragStart:{type:"function",value:null,compare:!1,optional:!0},onDrag:{type:"function",value:null,compare:!1,optional:!0},onDragEnd:{type:"function",value:null,compare:!1,optional:!0},coordinateSystem:J.DEFAULT,coordinateOrigin:{type:"array",value:[0,0,0],compare:!0},modelMatrix:{type:"array",value:null,compare:!0,optional:!0},wrapLongitude:!1,positionFormat:"XYZ",colorFormat:"RGBA",parameters:{type:"object",value:{},optional:!0,compare:!0},transitions:null,extensions:[],loaders:{type:"array",value:[],optional:!0,compare:!0},getPolygonOffset:{type:"function",value:({layerIndex:t})=>[0,-t*100],compare:!1},highlightedObjectIndex:null,autoHighlight:!1,highlightColor:{type:"accessor",value:[0,0,128,128]}};class Js extends Pf{constructor(...e){super(...e),d(this,"internalState",null),d(this,"lifecycle",Dr.NO_STATE),d(this,"context",void 0),d(this,"state",void 0),d(this,"parent",null)}get root(){let e=this;for(;e.parent;)e=e.parent;return e}toString(){const e=this.constructor.layerName||this.constructor.name;return"".concat(e,"({id: '").concat(this.props.id,"'})")}project(e){Re(this.internalState);const n=this.internalState.viewport||this.context.viewport,r=D_(e,{viewport:n,modelMatrix:this.props.modelMatrix,coordinateOrigin:this.props.coordinateOrigin,coordinateSystem:this.props.coordinateSystem}),[i,s,o]=k_(r,n.pixelProjectionMatrix);return e.length===2?[i,s]:[i,s,o]}unproject(e){return Re(this.internalState),(this.internalState.viewport||this.context.viewport).unproject(e)}projectPosition(e,n){Re(this.internalState);const r=this.internalState.viewport||this.context.viewport;return F_(e,{viewport:r,modelMatrix:this.props.modelMatrix,coordinateOrigin:this.props.coordinateOrigin,coordinateSystem:this.props.coordinateSystem,...n})}get isComposite(){return!1}setState(e){this.setChangeFlags({stateChanged:!0}),Object.assign(this.state,e),this.setNeedsRedraw()}setNeedsRedraw(){this.internalState&&(this.internalState.needsRedraw=!0)}setNeedsUpdate(){this.internalState&&(this.context.layerManager.setNeedsUpdate(String(this)),this.internalState.needsUpdate=!0)}get isLoaded(){return this.internalState?!this.internalState.isAsyncPropLoading():!1}get wrapLongitude(){return this.props.wrapLongitude}isPickable(){return this.props.pickable&&this.props.visible}getModels(){return this.state&&(this.state.models||this.state.model&&[this.state.model])||[]}setModuleParameters(e){for(const n of this.getModels())n.updateModuleSettings(e)}getAttributeManager(){return this.internalState&&this.internalState.attributeManager}getCurrentLayer(){return this.internalState&&this.internalState.layer}getLoadOptions(){return this.props.loadOptions}use64bitPositions(){const{coordinateSystem:e}=this.props;return e===J.DEFAULT||e===J.LNGLAT||e===J.CARTESIAN}onHover(e,n){return this.props.onHover&&this.props.onHover(e,n)||!1}onClick(e,n){return this.props.onClick&&this.props.onClick(e,n)||!1}nullPickingColor(){return[0,0,0]}encodePickingColor(e,n=[]){return n[0]=e+1&255,n[1]=e+1>>8&255,n[2]=e+1>>8>>8&255,n}decodePickingColor(e){Re(e instanceof Uint8Array);const[n,r,i]=e;return n+r*256+i*65536-1}getNumInstances(){return Number.isFinite(this.props.numInstances)?this.props.numInstances:this.state&&this.state.numInstances!==void 0?this.state.numInstances:AR(this.props.data)}getStartIndices(){return this.props.startIndices?this.props.startIndices:this.state&&this.state.startIndices?this.state.startIndices:null}getBounds(){var e;const n=this.getAttributeManager();if(!n)return null;const{positions:r,instancePositions:i}=n.attributes;return(e=r||i)===null||e===void 0?void 0:e.getBounds()}getShaders(e){for(const n of this.props.extensions)e=CR(e,n.getShaders.call(this,n));return e}shouldUpdateState(e){return e.changeFlags.propsOrDataChanged}updateState(e){const n=this.getAttributeManager(),{dataChanged:r}=e.changeFlags;if(r&&n)if(Array.isArray(r))for(const l of r)n.invalidateAll(l);else n.invalidateAll();const{props:i,oldProps:s}=e,o=Number.isInteger(s.highlightedObjectIndex)||s.pickable,a=Number.isInteger(i.highlightedObjectIndex)||i.pickable;if(o!==a&&n){const{pickingColors:l,instancePickingColors:u}=n.attributes,c=l||u;c&&(a&&c.constant&&(c.constant=!1,n.invalidate(c.id)),!c.value&&!a&&(c.constant=!0,c.value=[0,0,0]))}}finalizeState(e){for(const r of this.getModels())r.delete();const n=this.getAttributeManager();n&&n.finalize(),this.context&&this.context.resourceManager.unsubscribe({consumerId:this.id}),this.internalState&&(this.internalState.uniformTransitions.clear(),this.internalState.finalize())}draw(e){for(const n of this.getModels())n.draw(e)}getPickingInfo({info:e,mode:n,sourceLayer:r}){const{index:i}=e;return i>=0&&Array.isArray(this.props.data)&&(e.object=this.props.data[i]),e}raiseError(e,n){var r,i;if(n&&(e.message="".concat(n,": ").concat(e.message)),!((r=(i=this.props).onError)!==null&&r!==void 0&&r.call(i,e))){var s,o;(s=this.context)===null||s===void 0||(o=s.onError)===null||o===void 0||o.call(s,e,this)}}getNeedsRedraw(e={clearRedrawFlags:!1}){return this._getNeedsRedraw(e)}needsUpdate(){return this.internalState?this.internalState.needsUpdate||this.hasUniformTransition()||this.shouldUpdateState(this._getUpdateParams()):!1}hasUniformTransition(){var e;return((e=this.internalState)===null||e===void 0?void 0:e.uniformTransitions.active)||!1}activateViewport(e){if(!this.internalState)return;const n=this.internalState.viewport;this.internalState.viewport=e,(!n||!KR({oldViewport:n,viewport:e}))&&(this.setChangeFlags({viewportChanged:!0}),this.isComposite?this.needsUpdate()&&this.setNeedsUpdate():this._update())}invalidateAttribute(e="all"){const n=this.getAttributeManager();n&&(e==="all"?n.invalidateAll():n.invalidate(e))}updateAttributes(e){for(const n of this.getModels())this._setModelAttributes(n,e)}_updateAttributes(){const e=this.getAttributeManager();if(!e)return;const n=this.props,r=this.getNumInstances(),i=this.getStartIndices();e.update({data:n.data,numInstances:r,startIndices:i,props:n,transitions:n.transitions,buffers:n.data.attributes,context:this});const s=e.getChangedAttributes({clearChangedFlags:!0});this.updateAttributes(s)}_updateAttributeTransition(){const e=this.getAttributeManager();e&&e.updateTransition()}_updateUniformTransition(){const{uniformTransitions:e}=this.internalState;if(e.active){const n=e.update(),r=Object.create(this.props);for(const i in n)Object.defineProperty(r,i,{value:n[i]});return r}return this.props}calculateInstancePickingColors(e,{numInstances:n}){if(e.constant)return;const r=Math.floor(Wt.length/3);if(this.internalState.usesPickingColorCache=!0,r<n){n>$p&&Q.warn("Layer has too many data objects. Picking might not be able to distinguish all objects.")(),Wt=Ns.allocate(Wt,n,{size:3,copy:!0,maxCount:Math.max(n,$p)});const i=Math.floor(Wt.length/3),s=[];for(let o=r;o<i;o++)this.encodePickingColor(o,s),Wt[o*3+0]=s[0],Wt[o*3+1]=s[1],Wt[o*3+2]=s[2]}e.value=Wt.subarray(0,n*3)}_setModelAttributes(e,n){const r=this.getAttributeManager(),i=e.userData.excludeAttributes||{},s=r.getShaderAttributes(n,i);e.setAttributes(s)}disablePickingIndex(e){this._disablePickingIndex(e)}_disablePickingIndex(e){const{pickingColors:n,instancePickingColors:r}=this.getAttributeManager().attributes,i=n||r;if(!i)return;const s=i.getVertexOffset(e),o=i.getVertexOffset(e+1);i.buffer.subData({data:new Uint8Array(o-s),offset:s})}restorePickingColors(){const{pickingColors:e,instancePickingColors:n}=this.getAttributeManager().attributes,r=e||n;r&&(this.internalState.usesPickingColorCache&&r.value.buffer!==Wt.buffer&&(r.value=Wt.subarray(0,r.value.length)),r.updateSubBuffer({startOffset:0}))}_initialize(){Re(!this.internalState),Re(Number.isFinite(this.props.coordinateSystem)),Ue(YR,this);const e=this._getAttributeManager();e&&e.addInstanced({instancePickingColors:{type:5121,size:3,noAlloc:!0,update:this.calculateInstancePickingColors}}),this.internalState=new WR({attributeManager:e,layer:this}),this._clearChangeFlags(),this.state={},Object.defineProperty(this.state,"attributeManager",{get:()=>(Q.deprecated("layer.state.attributeManager","layer.getAttributeManager()")(),e)}),this.internalState.layer=this,this.internalState.uniformTransitions=new mR(this.context.timeline),this.internalState.onAsyncPropUpdated=this._onAsyncPropUpdated.bind(this),this.internalState.setAsyncProps(this.props),this.initializeState(this.context);for(const n of this.props.extensions)n.initializeState.call(this,this.context,n);this.setChangeFlags({dataChanged:"init",propsChanged:"init",viewportChanged:!0,extensionsChanged:!0}),this._update()}_transferState(e){Ue(ZR,this,this===e);const{state:n,internalState:r}=e;this!==e&&(this.internalState=r,this.internalState.layer=this,this.state=n,this.internalState.setAsyncProps(this.props),this._diffProps(this.props,this.internalState.getOldProps()))}_update(){const e=this.needsUpdate();if(Ue($R,this,e),!e)return;const n=this.props,r=this.context,i=this.internalState,s=r.viewport,o=this._updateUniformTransition();i.propsInTransition=o,r.viewport=i.viewport||s,this.props=o;try{const a=this._getUpdateParams(),l=this.getModels();if(r.gl)this.updateState(a);else try{this.updateState(a)}catch{}for(const c of this.props.extensions)c.updateState.call(this,a,c);const u=this.getModels()[0]!==l[0];this._postUpdate(a,u)}finally{r.viewport=s,this.props=n,this._clearChangeFlags(),i.needsUpdate=!1,i.resetOldProps()}}_finalize(){Ue(qR,this),this.finalizeState(this.context);for(const e of this.props.extensions)e.finalizeState.call(this,e)}_drawLayer({moduleParameters:e=null,uniforms:n={},parameters:r={}}){this._updateAttributeTransition();const i=this.props,s=this.context;this.props=this.internalState.propsInTransition||i;const o=this.props.opacity;n.opacity=Math.pow(o,1/2.2);try{e&&this.setModuleParameters(e);const{getPolygonOffset:a}=this.props,l=a&&a(n)||[0,0];yn(s.gl,{polygonOffset:l}),St(s.gl,r,()=>{const u={moduleParameters:e,uniforms:n,parameters:r,context:s};for(const c of this.props.extensions)c.draw.call(this,u,c);this.draw(u)})}finally{this.props=i}}getChangeFlags(){var e;return(e=this.internalState)===null||e===void 0?void 0:e.changeFlags}setChangeFlags(e){if(!this.internalState)return;const{changeFlags:n}=this.internalState;for(const i in e)if(e[i]){let s=!1;switch(i){case"dataChanged":const o=e[i],a=n[i];o&&Array.isArray(a)&&(n.dataChanged=Array.isArray(o)?a.concat(o):o,s=!0);default:n[i]||(n[i]=e[i],s=!0)}s&&Ue(XR,this,i,e)}const r=Boolean(n.dataChanged||n.updateTriggersChanged||n.propsChanged||n.extensionsChanged);n.propsOrDataChanged=r,n.somethingChanged=r||n.viewportChanged||n.stateChanged}_clearChangeFlags(){this.internalState.changeFlags={dataChanged:!1,propsChanged:!1,updateTriggersChanged:!1,viewportChanged:!1,stateChanged:!1,extensionsChanged:!1,propsOrDataChanged:!1,somethingChanged:!1}}_diffProps(e,n){const r=_R(e,n);if(r.updateTriggersChanged)for(const s in r.updateTriggersChanged)r.updateTriggersChanged[s]&&this.invalidateAttribute(s);if(r.transitionsChanged)for(const s in r.transitionsChanged){var i;this.internalState.uniformTransitions.add(s,n[s],e[s],(i=e.transitions)===null||i===void 0?void 0:i[s])}return this.setChangeFlags(r)}validateProps(){yR(this.props)}updateAutoHighlight(e){this.props.autoHighlight&&!Number.isInteger(this.props.highlightedObjectIndex)&&this._updateAutoHighlight(e)}_updateAutoHighlight(e){const n={pickingSelectedColor:e.picked?e.color:null},{highlightColor:r}=this.props;e.picked&&typeof r=="function"&&(n.pickingHighlightColor=r(e)),this.setModuleParameters(n),this.setNeedsRedraw()}_getAttributeManager(){const e=this.context;return new iv(e.gl,{id:this.props.id,stats:e.stats,timeline:e.timeline})}_postUpdate(e,n){const{props:r,oldProps:i}=e;this.setNeedsRedraw(),this._updateAttributes();const{model:s}=this.state;s?.setInstanceCount(this.getNumInstances());const{autoHighlight:o,highlightedObjectIndex:a,highlightColor:l}=r;if(n||i.autoHighlight!==o||i.highlightedObjectIndex!==a||i.highlightColor!==l){const u={};o||(u.pickingSelectedColor=null),Array.isArray(l)&&(u.pickingHighlightColor=l),(n||a!==i.highlightedObjectIndex)&&(u.pickingSelectedColor=Number.isFinite(a)&&a>=0?this.encodePickingColor(a):null),this.setModuleParameters(u)}}_getUpdateParams(){return{props:this.props,oldProps:this.internalState.getOldProps(),context:this.context,changeFlags:this.internalState.changeFlags}}_getNeedsRedraw(e){if(!this.internalState)return!1;let n=!1;n=n||this.internalState.needsRedraw&&this.id,this.internalState.needsRedraw=this.internalState.needsRedraw&&!e.clearRedrawFlags;const r=this.getAttributeManager(),i=r?r.getNeedsRedraw(e):!1;return n=n||i,n}_onAsyncPropUpdated(){this._diffProps(this.props,this.internalState.getOldProps()),this.setNeedsUpdate()}}d(Js,"defaultProps",JR);d(Js,"layerName","Layer");const eM="compositeLayer.renderLayers";class av extends Js{get isComposite(){return!0}get isLoaded(){return super.isLoaded&&this.getSubLayers().every(e=>e.isLoaded)}getSubLayers(){return this.internalState&&this.internalState.subLayers||[]}initializeState(e){}setState(e){super.setState(e),this.setNeedsUpdate()}getPickingInfo({info:e}){const{object:n}=e;return n&&n.__source&&n.__source.parent&&n.__source.parent.id===this.id&&(e.object=n.__source.object,e.index=n.__source.index),e}filterSubLayer(e){return!0}shouldRenderSubLayer(e,n){return n&&n.length}getSubLayerClass(e,n){const{_subLayerProps:r}=this.props;return r&&r[e]&&r[e].type||n}getSubLayerRow(e,n,r){return e.__source={parent:this,object:n,index:r},e}getSubLayerAccessor(e){if(typeof e=="function"){const n={index:-1,data:this.props.data,target:[]};return(r,i)=>r&&r.__source?(n.index=r.__source.index,e(r.__source.object,n)):e(r,i)}return e}getSubLayerProps(e={}){var n;const{opacity:r,pickable:i,visible:s,parameters:o,getPolygonOffset:a,highlightedObjectIndex:l,autoHighlight:u,highlightColor:c,coordinateSystem:h,coordinateOrigin:f,wrapLongitude:g,positionFormat:w,modelMatrix:E,extensions:T,fetch:y,operation:m,_subLayerProps:_}=this.props,S={id:"",updateTriggers:{},opacity:r,pickable:i,visible:s,parameters:o,getPolygonOffset:a,highlightedObjectIndex:l,autoHighlight:u,highlightColor:c,coordinateSystem:h,coordinateOrigin:f,wrapLongitude:g,positionFormat:w,modelMatrix:E,extensions:T,fetch:y,operation:m},A=_&&e.id&&_[e.id],P=A&&A.updateTriggers,L=e.id||"sublayer";if(A){const C=this.constructor._propTypes,R=e.type?e.type._propTypes:{};for(const M in A){const O=R[M]||C[M];O&&O.type==="accessor"&&(A[M]=this.getSubLayerAccessor(A[M]))}}Object.assign(S,e,A),S.id="".concat(this.props.id,"-").concat(L),S.updateTriggers={all:(n=this.props.updateTriggers)===null||n===void 0?void 0:n.all,...e.updateTriggers,...P};for(const C of T){const R=C.getSubLayerProps.call(this,C);R&&Object.assign(S,R,{updateTriggers:Object.assign(S.updateTriggers,R.updateTriggers)})}return S}_updateAutoHighlight(e){for(const n of this.getSubLayers())n.updateAutoHighlight(e)}_getAttributeManager(){return null}_postUpdate(e,n){let r=this.internalState.subLayers;const i=!r||this.needsUpdate();if(i){const s=this.renderLayers();r=wf(s,Boolean),this.internalState.subLayers=r}Ue(eM,this,i,r);for(const s of r)s.parent=this}}d(av,"layerName","CompositeLayer");const Nr={SUM:1,MEAN:2,MIN:3,MAX:4};function lv(t,e){return t+e}function tM(t,e){return e>t?e:t}function nM(t,e){return e<t?e:t}function rM(t,e){if(Number.isFinite(e))return t.length?e:null;const n=t.map(e).filter(Number.isFinite);return n.length?n.reduce(lv,0)/n.length:null}function iM(t,e){if(Number.isFinite(e))return t.length?t.length*e:null;const n=t.map(e).filter(Number.isFinite);return n.length?n.reduce(lv,0):null}function sM(t,e){if(Number.isFinite(e))return t.length?e:null;const n=t.map(e).filter(Number.isFinite);return n.length?n.reduce(tM,-1/0):null}function oM(t,e){if(Number.isFinite(e))return t.length?e:null;const n=t.map(e).filter(Number.isFinite);return n.length?n.reduce(nM,1/0):null}function aM(t,e,n){const r=Nr[t]||Nr.SUM;switch(e=lM(e,n),r){case Nr.MIN:return i=>oM(i,e);case Nr.SUM:return i=>iM(i,e);case Nr.MEAN:return i=>rM(i,e);case Nr.MAX:return i=>sM(i,e);default:return null}}function lM(t,e={}){return Number.isFinite(t)?t:n=>(e.index=n.index,t(n.source,e))}function uM(t,e={}){return n=>(e.indices=n.map(r=>r.index),t(n.map(r=>r.source),e))}const cM=[[255,255,178],[254,217,118],[254,178,76],[253,141,60],[240,59,32],[189,0,38]];function hM(t,e){const n={};for(const r in t)e.includes(r)||(n[r]=t[r]);return n}class uv extends av{constructor(...e){super(...e),d(this,"state",void 0)}initializeAggregationLayer(e){super.initializeState(this.context),this.setState({ignoreProps:hM(this.constructor._propTypes,e.data.props),dimensions:e})}updateState(e){super.updateState(e);const{changeFlags:n}=e;if(n.extensionsChanged){const r=this.getShaders({});r&&r.defines&&(r.defines.NON_INSTANCED_MODEL=1),this.updateShaders(r)}this._updateAttributes()}updateAttributes(e){this.setState({changedAttributes:e})}getAttributes(){return this.getAttributeManager().getShaderAttributes()}getModuleSettings(){const{viewport:e,mousePosition:n,gl:r}=this.context;return Object.assign(Object.create(this.props),{viewport:e,mousePosition:n,pickingActive:0,devicePixelRatio:vr(r)})}updateShaders(e){}isAggregationDirty(e,n={}){const{props:r,oldProps:i,changeFlags:s}=e,{compareAll:o=!1,dimension:a}=n,{ignoreProps:l}=this.state,{props:u,accessors:c=[]}=a,{updateTriggersChanged:h}=s;if(s.dataChanged)return!0;if(h){if(h.all)return!0;for(const f of c)if(h[f])return!0}if(o)return s.extensionsChanged?!0:Af({oldProps:i,newProps:r,ignoreProps:l,propTypes:this.constructor._propTypes});for(const f of u)if(r[f]!==i[f])return!0;return!1}isAttributeChanged(e){const{changedAttributes:n}=this.state;return e?n&&n[e]!==void 0:!fM(n)}_getAttributeManager(){return new iv(this.context.gl,{id:this.props.id,stats:this.context.stats})}}d(uv,"layerName","AggregationLayer");function fM(t){let e=!0;for(const n in t){e=!1;break}return e}function El(t,e,n){const r=n;return r.domain=()=>t,r.range=()=>e,r}function qp(t,e){return El(t,e,r=>wM(t,e,r))}function dM(t,e){return El(t,e,r=>EM(t,e,r))}function gM(t,e){const n=t.sort(cv);let r=0;const i=Math.max(1,e.length),s=new Array(i-1);for(;++r<i;)s[r-1]=pM(n,r/i);const o=a=>yM(s,e,a);return o.thresholds=()=>s,El(t,e,o)}function cv(t,e){return t-e}function pM(t,e){const n=t.length;if(e<=0||n<2)return t[0];if(e>=1)return t[n-1];const r=(n-1)*e,i=Math.floor(r),s=t[i],o=t[i+1];return s+(o-s)*(r-i)}function mM(t,e){let n=0,r=t.length;for(;n<r;){const i=n+r>>>1;cv(t[i],e)>0?r=i:n=i+1}return n}function yM(t,e,n){return e[mM(t,n)]}function _M(t,e,n,r){const i="".concat(r);let s=e.get(i);return s===void 0&&(s=t.push(r),e.set(i,s)),n[(s-1)%n.length]}function vM(t,e){const n=new Map,r=[];for(const s of t){const o="".concat(s);n.has(o)||n.set(o,r.push(s))}return El(t,e,s=>_M(r,n,e,s))}function wM(t,e,n){const r=t[1]-t[0];if(r<=0)return Q.warn("quantizeScale: invalid domain, returning range[0]")(),e[0];const i=r/e.length,s=Math.floor((n-t[0])/i),o=Math.max(Math.min(s,e.length-1),0);return e[o]}function EM(t,e,n){return(n-t[0])/(t[1]-t[0])*(e[1]-e[0])+e[0]}function hv(t){return t!=null}function TM(t){const e=[];return t.forEach(n=>{!e.includes(n)&&hv(n)&&e.push(n)}),e}function fv(t,e){return(typeof e=="function"?t.map(e):t).filter(hv)}function bM(t,e){return fv(t,e)}function SM(t,e){return TM(fv(t,e))}function AM(t,e,n){return Math.max(e,Math.min(n,t))}function xM(t){switch(t){case"quantize":return qp;case"linear":return dM;case"quantile":return gM;case"ordinal":return vM;default:return qp}}const dv=t=>t.length,PM=3402823466e29,gv=t=>t.points,pv=t=>t.index,Zp=(t,e)=>t<e?-1:t>e?1:t>=e?0:NaN,CM={getValue:dv,getPoints:gv,getIndex:pv,filterData:null};class LM{constructor(e=[],n=CM){d(this,"maxCount",void 0),d(this,"maxValue",void 0),d(this,"minValue",void 0),d(this,"totalCount",void 0),d(this,"aggregatedBins",void 0),d(this,"sortedBins",void 0),d(this,"binMap",void 0),this.aggregatedBins=this.getAggregatedBins(e,n),this._updateMinMaxValues(),this.binMap=this.getBinMap()}getAggregatedBins(e,n){const{getValue:r=dv,getPoints:i=gv,getIndex:s=pv,filterData:o}=n,a=typeof o=="function",l=e.length,u=[];let c=0;for(let h=0;h<l;h++){const f=e[h],g=i(f),w=s(f),E=a?g.filter(o):g;f.filteredPoints=a?E:null;const T=E.length?r(E):null;T!=null&&(u[c]={i:Number.isFinite(w)?w:h,value:T,counts:E.length},c++)}return u}_percentileToIndex(e){const n=this.sortedBins.length;if(n<2)return[0,0];const[r,i]=e.map(a=>AM(a,0,100)),s=Math.ceil(r/100*(n-1)),o=Math.floor(i/100*(n-1));return[s,o]}getBinMap(){const e={};for(const n of this.aggregatedBins)e[n.i]=n;return e}_updateMinMaxValues(){let e=0,n=0,r=PM,i=0;for(const s of this.aggregatedBins)e=e>s.counts?e:s.counts,n=n>s.value?n:s.value,r=r<s.value?r:s.value,i+=s.counts;this.maxCount=e,this.maxValue=n,this.minValue=r,this.totalCount=i}getValueRange(e){if(this.sortedBins||(this.sortedBins=this.aggregatedBins.sort((i,s)=>Zp(i.value,s.value))),!this.sortedBins.length)return[];let n=0,r=this.sortedBins.length-1;if(Array.isArray(e)){const i=this._percentileToIndex(e);n=i[0],r=i[1]}return[this.sortedBins[n].value,this.sortedBins[r].value]}getValueDomainByScale(e,[n=0,r=100]=[]){if(this.sortedBins||(this.sortedBins=this.aggregatedBins.sort((s,o)=>Zp(s.value,o.value))),!this.sortedBins.length)return[];const i=this._percentileToIndex([n,r]);return this._getScaleDomain(e,i)}_getScaleDomain(e,[n,r]){const i=this.sortedBins;switch(e){case"quantize":case"linear":return[i[n].value,i[r].value];case"quantile":return bM(i.slice(n,r+1),s=>s.value);case"ordinal":return SM(i,s=>s.value);default:return[i[n].value,i[r].value]}}}const RM={CLOCKWISE:1,COUNTER_CLOCKWISE:-1};function MM(t,e,n={}){return kM(t,n)!==e?(OM(t,n),!0):!1}function kM(t,e={}){return Math.sign(IM(t,e))}function IM(t,e={}){const{start:n=0,end:r=t.length}=e,i=e.size||2;let s=0;for(let o=n,a=r-i;o<r;o+=i)s+=(t[o]-t[a])*(t[o+1]+t[a+1]),a=o;return s/2}function OM(t,e){const{start:n=0,end:r=t.length,size:i=2}=e,s=(r-n)/i,o=Math.floor(s/2);for(let a=0;a<o;++a){const l=n+a*i,u=n+(s-1-a)*i;for(let c=0;c<i;++c){const h=t[l+c];t[l+c]=t[u+c],t[u+c]=h}}}class NM extends Y2{constructor(e){const{id:n=_n("column-geometry")}=e,{indices:r,attributes:i}=DM(e);super({...e,id:n,indices:r,attributes:i})}}function DM(t){const{radius:e,height:n=1,nradial:r=10}=t;let{vertices:i}=t;i&&(Q.assert(i.length>=r),i=i.flatMap(g=>[g[0],g[1]]),MM(i,RM.COUNTER_CLOCKWISE));const s=n>0,o=r+1,a=s?o*3+1:r,l=Math.PI*2/r,u=new Uint16Array(s?r*3*2:0),c=new Float32Array(a*3),h=new Float32Array(a*3);let f=0;if(s){for(let g=0;g<o;g++){const w=g*l,E=g%r,T=Math.sin(w),y=Math.cos(w);for(let m=0;m<2;m++)c[f+0]=i?i[E*2]:y*e,c[f+1]=i?i[E*2+1]:T*e,c[f+2]=(1/2-m)*n,h[f+0]=i?i[E*2]:y,h[f+1]=i?i[E*2+1]:T,f+=3}c[f+0]=c[f-3],c[f+1]=c[f-2],c[f+2]=c[f-1],f+=3}for(let g=s?0:1;g<o;g++){const w=Math.floor(g/2)*Math.sign(.5-g%2),E=w*l,T=(w+r)%r,y=Math.sin(E),m=Math.cos(E);c[f+0]=i?i[T*2]:m*e,c[f+1]=i?i[T*2+1]:y*e,c[f+2]=n/2,h[f+2]=1,f+=3}if(s){let g=0;for(let w=0;w<r;w++)u[g++]=w*2+0,u[g++]=w*2+2,u[g++]=w*2+0,u[g++]=w*2+1,u[g++]=w*2+1,u[g++]=w*2+3}return{indices:u,attributes:{POSITION:{size:3,value:c},NORMAL:{size:3,value:h}}}}const FM=`#version 300 es

#define SHADER_NAME column-layer-vertex-shader

in vec3 positions;
in vec3 normals;

in vec3 instancePositions;
in float instanceElevations;
in vec3 instancePositions64Low;
in vec4 instanceFillColors;
in vec4 instanceLineColors;
in float instanceStrokeWidths;

in vec3 instancePickingColors;

// Custom uniforms
uniform float opacity;
uniform float radius;
uniform float angle;
uniform vec2 offset;
uniform bool extruded;
uniform bool stroked;
uniform bool isStroke;
uniform float coverage;
uniform float elevationScale;
uniform float edgeDistance;
uniform float widthScale;
uniform float widthMinPixels;
uniform float widthMaxPixels;
uniform int radiusUnits;
uniform int widthUnits;

// Result
out vec4 vColor;
#ifdef FLAT_SHADING
out vec4 position_commonspace;
#endif

void main(void) {
  geometry.worldPosition = instancePositions;

  vec4 color = isStroke ? instanceLineColors : instanceFillColors;
  // rotate primitive position and normal
  mat2 rotationMatrix = mat2(cos(angle), sin(angle), -sin(angle), cos(angle));

  // calculate elevation, if 3d not enabled set to 0
  // cylindar gemoetry height are between -1.0 to 1.0, transform it to between 0, 1
  float elevation = 0.0;
  // calculate stroke offset
  float strokeOffsetRatio = 1.0;

  if (extruded) {
    elevation = instanceElevations * (positions.z + 1.0) / 2.0 * elevationScale;
  } else if (stroked) {
    float widthPixels = clamp(
      project_size_to_pixel(instanceStrokeWidths * widthScale, widthUnits),
      widthMinPixels, widthMaxPixels) / 2.0;
    float halfOffset = project_pixel_size(widthPixels) / project_size(edgeDistance * coverage * radius);
    if (isStroke) {
      strokeOffsetRatio -= sign(positions.z) * halfOffset;
    } else {
      strokeOffsetRatio -= halfOffset;
    }
  }

  // if alpha == 0.0 or z < 0.0, do not render element
  float shouldRender = float(color.a > 0.0 && instanceElevations >= 0.0);
  float dotRadius = radius * coverage * shouldRender;

  geometry.pickingColor = instancePickingColors;

  // project center of column
  vec3 centroidPosition = vec3(instancePositions.xy, instancePositions.z + elevation);
  vec3 centroidPosition64Low = instancePositions64Low;
  vec2 offset = (rotationMatrix * positions.xy * strokeOffsetRatio + offset) * dotRadius;
  if (radiusUnits == UNIT_METERS) {
    offset = project_size(offset);
  }
  vec3 pos = vec3(offset, 0.);
  DECKGL_FILTER_SIZE(pos, geometry);

  gl_Position = project_position_to_clipspace(centroidPosition, centroidPosition64Low, pos, geometry.position);
  geometry.normal = project_normal(vec3(rotationMatrix * normals.xy, normals.z));
  DECKGL_FILTER_GL_POSITION(gl_Position, geometry);

  // Light calculations
  if (extruded && !isStroke) {
#ifdef FLAT_SHADING
    position_commonspace = geometry.position;
    vColor = vec4(color.rgb, color.a * opacity);
#else
    vec3 lightColor = lighting_getLightColor(color.rgb, project_uCameraPosition, geometry.position.xyz, geometry.normal);
    vColor = vec4(lightColor, color.a * opacity);
#endif
  } else {
    vColor = vec4(color.rgb, color.a * opacity);
  }
  DECKGL_FILTER_COLOR(vColor, geometry);
}
`,UM=`#version 300 es
#define SHADER_NAME column-layer-fragment-shader

precision highp float;

uniform vec3 project_uCameraPosition;
uniform bool extruded;
uniform bool isStroke;

out vec4 fragColor;

in vec4 vColor;
#ifdef FLAT_SHADING
in vec4 position_commonspace;
#endif

void main(void) {
  fragColor = vColor;
#ifdef FLAT_SHADING
  if (extruded && !isStroke && !picking_uActive) {
    vec3 normal = normalize(cross(dFdx(position_commonspace.xyz), dFdy(position_commonspace.xyz)));
    fragColor.rgb = lighting_getLightColor(vColor.rgb, project_uCameraPosition, position_commonspace.xyz, normal);
  }
#endif
  DECKGL_FILTER_COLOR(fragColor, geometry);
}
`,Ya=[0,0,0,255],BM={diskResolution:{type:"number",min:4,value:20},vertices:null,radius:{type:"number",min:0,value:1e3},angle:{type:"number",value:0},offset:{type:"array",value:[0,0]},coverage:{type:"number",min:0,max:1,value:1},elevationScale:{type:"number",min:0,value:1},radiusUnits:"meters",lineWidthUnits:"meters",lineWidthScale:1,lineWidthMinPixels:0,lineWidthMaxPixels:Number.MAX_SAFE_INTEGER,extruded:!0,wireframe:!1,filled:!0,stroked:!1,getPosition:{type:"accessor",value:t=>t.position},getFillColor:{type:"accessor",value:Ya},getLineColor:{type:"accessor",value:Ya},getLineWidth:{type:"accessor",value:1},getElevation:{type:"accessor",value:1e3},material:!0,getColor:{deprecatedFor:["getFillColor","getLineColor"]}};class Cf extends Js{getShaders(){const{gl:e}=this.context,n=!Y(e),r={},i=this.props.flatShading&&Zy(e,ae.GLSL_DERIVATIVES);return i&&(r.FLAT_SHADING=1),super.getShaders({vs:FM,fs:UM,defines:r,transpileToGLSL100:n,modules:[dC,i?S2:b2,OC]})}initializeState(){this.getAttributeManager().addInstanced({instancePositions:{size:3,type:5130,fp64:this.use64bitPositions(),transition:!0,accessor:"getPosition"},instanceElevations:{size:1,transition:!0,accessor:"getElevation"},instanceFillColors:{size:this.props.colorFormat.length,type:5121,normalized:!0,transition:!0,accessor:"getFillColor",defaultValue:Ya},instanceLineColors:{size:this.props.colorFormat.length,type:5121,normalized:!0,transition:!0,accessor:"getLineColor",defaultValue:Ya},instanceStrokeWidths:{size:1,accessor:"getLineWidth",transition:!0}})}updateState(e){super.updateState(e);const{props:n,oldProps:r,changeFlags:i}=e,s=i.extensionsChanged||n.flatShading!==r.flatShading;if(s){var o;const{gl:a}=this.context;(o=this.state.model)===null||o===void 0||o.delete(),this.state.model=this._getModel(a),this.getAttributeManager().invalidateAll()}(s||n.diskResolution!==r.diskResolution||n.vertices!==r.vertices||(n.extruded||n.stroked)!==(r.extruded||r.stroked))&&this._updateGeometry(n)}getGeometry(e,n,r){const i=new NM({radius:1,height:r?2:0,vertices:n,nradial:e});let s=0;if(n)for(let o=0;o<e;o++){const a=n[o],l=Math.sqrt(a[0]*a[0]+a[1]*a[1]);s+=l/e}else s=1;return this.setState({edgeDistance:Math.cos(Math.PI/e)*s}),i}_getModel(e){return new b_(e,{...this.getShaders(),id:this.props.id,isInstanced:!0})}_updateGeometry({diskResolution:e,vertices:n,extruded:r,stroked:i}){const s=this.getGeometry(e,n,r||i);this.setState({fillVertexCount:s.attributes.POSITION.value.length/3,wireframeVertexCount:s.indices.value.length}),this.state.model.setProps({geometry:s})}draw({uniforms:e}){const{lineWidthUnits:n,lineWidthScale:r,lineWidthMinPixels:i,lineWidthMaxPixels:s,radiusUnits:o,elevationScale:a,extruded:l,filled:u,stroked:c,wireframe:h,offset:f,coverage:g,radius:w,angle:E}=this.props,{model:T,fillVertexCount:y,wireframeVertexCount:m,edgeDistance:_}=this.state;T.setUniforms(e).setUniforms({radius:w,angle:E/180*Math.PI,offset:f,extruded:l,stroked:c,coverage:g,elevationScale:a,edgeDistance:_,radiusUnits:Va[o],widthUnits:Va[n],widthScale:r,widthMinPixels:i,widthMaxPixels:s}),l&&h&&(T.setProps({isIndexed:!0}),T.setVertexCount(m).setDrawMode(1).setUniforms({isStroke:!0}).draw()),u&&(T.setProps({isIndexed:!1}),T.setVertexCount(y).setDrawMode(5).setUniforms({isStroke:!1}).draw()),!l&&c&&(T.setProps({isIndexed:!1}),T.setVertexCount(y*2/3).setDrawMode(5).setUniforms({isStroke:!0}).draw())}}d(Cf,"layerName","ColumnLayer");d(Cf,"defaultProps",BM);function Qp(){}const Kp=["getBins","getDomain","getScaleFunc"],Jp=[{key:"fillColor",accessor:"getFillColor",pickingInfo:"colorValue",getBins:{triggers:{value:{prop:"getColorValue",updateTrigger:"getColorValue"},weight:{prop:"getColorWeight",updateTrigger:"getColorWeight"},aggregation:{prop:"colorAggregation"},filterData:{prop:"_filterData",updateTrigger:"_filterData"}}},getDomain:{triggers:{lowerPercentile:{prop:"lowerPercentile"},upperPercentile:{prop:"upperPercentile"},scaleType:{prop:"colorScaleType"}}},getScaleFunc:{triggers:{domain:{prop:"colorDomain"},range:{prop:"colorRange"}},onSet:{props:"onSetColorDomain"}},nullValue:[0,0,0,0]},{key:"elevation",accessor:"getElevation",pickingInfo:"elevationValue",getBins:{triggers:{value:{prop:"getElevationValue",updateTrigger:"getElevationValue"},weight:{prop:"getElevationWeight",updateTrigger:"getElevationWeight"},aggregation:{prop:"elevationAggregation"},filterData:{prop:"_filterData",updateTrigger:"_filterData"}}},getDomain:{triggers:{lowerPercentile:{prop:"elevationLowerPercentile"},upperPercentile:{prop:"elevationUpperPercentile"},scaleType:{prop:"elevationScaleType"}}},getScaleFunc:{triggers:{domain:{prop:"elevationDomain"},range:{prop:"elevationRange"}},onSet:{props:"onSetElevationDomain"}},nullValue:-1}],VM=t=>t.cellSize;class zM{constructor(e){this.state={layerData:{},dimensions:{}},this.changeFlags={},this.dimensionUpdaters={},this._getCellSize=e.getCellSize||VM,this._getAggregator=e.getAggregator,this._addDimension(e.dimensions||Jp)}static defaultDimensions(){return Jp}updateState(e,n){const{oldProps:r,props:i,changeFlags:s}=e;this.updateGetValueFuncs(r,i,s);const o=this.needsReProjectPoints(r,i,s);let a=!1;return s.dataChanged||o?(this.getAggregatedData(i,n),a=!0):((this.getDimensionChanges(r,i,s)||[]).forEach(u=>typeof u=="function"&&u()),a=!0),this.setState({aggregationDirty:a}),this.state}setState(e){this.state={...this.state,...e}}setDimensionState(e,n){this.setState({dimensions:{...this.state.dimensions,[e]:{...this.state.dimensions[e],...n}}})}normalizeResult(e={}){return e.hexagons?{data:e.hexagons,...e}:e.layerData?{data:e.layerData,...e}:e}getAggregatedData(e,n){const i=this._getAggregator(e)(e,n);this.setState({layerData:this.normalizeResult(i)}),this.changeFlags={layerData:!0},this.getSortedBins(e)}updateGetValueFuncs(e,n,r){for(const i in this.dimensionUpdaters){const{value:s,weight:o,aggregation:a}=this.dimensionUpdaters[i].getBins.triggers;let l=n[s.prop];this.needUpdateDimensionStep(this.dimensionUpdaters[i].getBins,e,n,r)&&(l?l=uM(l,{data:n.data}):l=aM(n[a.prop],n[o.prop],{data:n.data})),l&&this.setDimensionState(i,{getValue:l})}}needsReProjectPoints(e,n,r){return this._getCellSize(e)!==this._getCellSize(n)||this._getAggregator(e)!==this._getAggregator(n)||r.updateTriggersChanged&&(r.updateTriggersChanged.all||r.updateTriggersChanged.getPosition)}addDimension(e){this._addDimension(e)}_addDimension(e=[]){e.forEach(n=>{const{key:r}=n;this.dimensionUpdaters[r]=this.getDimensionUpdaters(n),this.state.dimensions[r]={getValue:null,domain:null,sortedBins:null,scaleFunc:Qp}})}getDimensionUpdaters({key:e,accessor:n,pickingInfo:r,getBins:i,getDomain:s,getScaleFunc:o,nullValue:a}){return{key:e,accessor:n,pickingInfo:r,getBins:{updater:this.getDimensionSortedBins,...i},getDomain:{updater:this.getDimensionValueDomain,...s},getScaleFunc:{updater:this.getDimensionScale,...o},attributeAccessor:this.getSubLayerDimensionAttribute(e,a)}}needUpdateDimensionStep(e,n,r,i){return Object.values(e.triggers).some(s=>s.updateTrigger?i.dataChanged||i.updateTriggersChanged&&(i.updateTriggersChanged.all||i.updateTriggersChanged[s.updateTrigger]):n[s.prop]!==r[s.prop])}getDimensionChanges(e,n,r){const i=[];for(const s in this.dimensionUpdaters){const o=Kp.find(a=>this.needUpdateDimensionStep(this.dimensionUpdaters[s][a],e,n,r));o&&i.push(this.dimensionUpdaters[s][o].updater.bind(this,n,this.dimensionUpdaters[s]))}return i.length?i:null}getUpdateTriggers(e){const n=e.updateTriggers||{},r={};for(const i in this.dimensionUpdaters){const{accessor:s}=this.dimensionUpdaters[i];r[s]={},Kp.forEach(o=>{Object.values(this.dimensionUpdaters[i][o].triggers).forEach(({prop:a,updateTrigger:l})=>{if(l){const u=n[l];typeof u=="object"&&!Array.isArray(u)?Object.assign(r[s],u):u!==void 0&&(r[s][a]=u)}else r[s][a]=e[a]})})}return r}getSortedBins(e){for(const n in this.dimensionUpdaters)this.getDimensionSortedBins(e,this.dimensionUpdaters[n])}getDimensionSortedBins(e,n){const{key:r}=n,{getValue:i}=this.state.dimensions[r],s=new LM(this.state.layerData.data||[],{getValue:i,filterData:e._filterData});this.setDimensionState(r,{sortedBins:s}),this.getDimensionValueDomain(e,n)}getDimensionValueDomain(e,n){const{getDomain:r,key:i}=n,{triggers:{lowerPercentile:s,upperPercentile:o,scaleType:a}}=r,l=this.state.dimensions[i].sortedBins.getValueDomainByScale(e[a.prop],[e[s.prop],e[o.prop]]);this.setDimensionState(i,{valueDomain:l}),this.getDimensionScale(e,n)}getDimensionScale(e,n){const{key:r,getScaleFunc:i,getDomain:s}=n,{domain:o,range:a}=i.triggers,{scaleType:l}=s.triggers,{onSet:u}=i,c=e[a.prop],h=e[o.prop]||this.state.dimensions[r].valueDomain,g=xM(l&&e[l.prop])(h,c);typeof u=="object"&&typeof e[u.props]=="function"&&e[u.props](g.domain()),this.setDimensionState(r,{scaleFunc:g})}getSubLayerDimensionAttribute(e,n){return r=>{const{sortedBins:i,scaleFunc:s}=this.state.dimensions[e],o=i.binMap[r.index];if(o&&o.counts===0)return n;const a=o&&o.value,l=s.domain();return a>=l[0]&&a<=l[l.length-1]?s(a):n}}getSubLayerAccessors(e){const n={};for(const r in this.dimensionUpdaters){const{accessor:i}=this.dimensionUpdaters[r];n[i]=this.getSubLayerDimensionAttribute(e,r)}return n}getPickingInfo({info:e}){const n=e.picked&&e.index>-1;let r=null;if(n){const i=this.state.layerData.data[e.index],s={};for(const o in this.dimensionUpdaters){const{pickingInfo:a}=this.dimensionUpdaters[o],{sortedBins:l}=this.state.dimensions[o],u=l.binMap[i.index]&&l.binMap[i.index].value;s[a]=u}r=Object.assign(s,i,{points:i.filteredPoints||i.points})}return e.picked=Boolean(r),e.object=r,e}getAccessor(e){return this.dimensionUpdaters.hasOwnProperty(e)?this.dimensionUpdaters[e].attributeAccessor:Qp}}var Fr=Math.PI/3,jM=[0,Fr,2*Fr,3*Fr,4*Fr,5*Fr];function GM(t){return t[0]}function HM(t){return t[1]}function WM(){var t=0,e=0,n=1,r=1,i=GM,s=HM,o,a,l;function u(h){var f={},g=[],w,E=h.length;for(w=0;w<E;++w)if(!(isNaN(y=+i.call(null,T=h[w],w,h))||isNaN(m=+s.call(null,T,w,h)))){var T,y,m,_=Math.round(m=m/l),S=Math.round(y=y/a-(_&1)/2),A=m-_;if(Math.abs(A)*3>1){var P=y-S,L=S+(y<S?-1:1)/2,C=_+(m<_?-1:1),R=y-L,M=m-C;P*P+A*A>R*R+M*M&&(S=L+(_&1?1:-1)/2,_=C)}var O=S+"-"+_,D=f[O];D?D.push(T):(g.push(D=f[O]=[T]),D.x=(S+(_&1)/2)*a,D.y=_*l)}return g}function c(h){var f=0,g=0;return jM.map(function(w){var E=Math.sin(w)*h,T=-Math.cos(w)*h,y=E-f,m=T-g;return f=E,g=T,[y,m]})}return u.hexagon=function(h){return"m"+c(h==null?o:+h).join("l")+"z"},u.centers=function(){for(var h=[],f=Math.round(e/l),g=Math.round(t/a),w=f*l;w<r+o;w+=l,++f)for(var E=g*a+(f&1)*a/2;E<n+a/2;E+=a)h.push([E,w]);return h},u.mesh=function(){var h=c(o).slice(0,4).join("l");return u.centers().map(function(f){return"M"+f+"m"+h}).join("")},u.x=function(h){return arguments.length?(i=h,u):i},u.y=function(h){return arguments.length?(s=h,u):s},u.radius=function(h){return arguments.length?(o=+h,a=o*2*Math.sin(Fr),l=o*1.5,u):o},u.size=function(h){return arguments.length?(t=e=0,n=+h[0],r=+h[1],u):[n-t,r-e]},u.extent=function(h){return arguments.length?(t=+h[0][0],e=+h[0][1],n=+h[1][0],r=+h[1][1],u):[[t,e],[n,r]]},u.radius(1)}function XM(t,e){const{data:n,radius:r}=t,{viewport:i,attributes:s}=e,o=n.length?YM(n,e):null,a=$M(r,i,o),l=[],{iterable:u,objectInfo:c}=Q_(n),h=s.positions.value,{size:f}=s.positions.getAccessor();for(const E of u){c.index++;const T=c.index*f,y=[h[T],h[T+1]];Number.isFinite(y[0])&&Number.isFinite(y[1])?l.push({screenCoord:i.projectFlat(y),source:E,index:c.index}):Q.warn("HexagonLayer: invalid position")()}return{hexagons:WM().radius(a).x(E=>E.screenCoord[0]).y(E=>E.screenCoord[1])(l).map((E,T)=>({position:i.unprojectFlat([E.x,E.y]),points:E,index:T})),radiusCommon:a}}function YM(t,e){const{attributes:n}=e,r=n.positions.value,{size:i}=n.positions.getAccessor();let s=1/0,o=1/0,a=-1/0,l=-1/0,u;for(u=0;u<i*t.length;u+=i){const c=r[u],h=r[u+1];Number.isFinite(c)&&Number.isFinite(h)&&(s=Math.min(c,s),a=Math.max(c,a),o=Math.min(h,o),l=Math.max(h,l))}return[s,o,a,l].every(Number.isFinite)?[(s+a)/2,(o+l)/2]:null}function $M(t,e,n){const{unitsPerMeter:r}=e.getDistanceScales(n);return t*r[0]}function em(){}const qM={colorDomain:null,colorRange:cM,getColorValue:{type:"accessor",value:null},getColorWeight:{type:"accessor",value:1},colorAggregation:"SUM",lowerPercentile:{type:"number",value:0,min:0,max:100},upperPercentile:{type:"number",value:100,min:0,max:100},colorScaleType:"quantize",onSetColorDomain:em,elevationDomain:null,elevationRange:[0,1e3],getElevationValue:{type:"accessor",value:null},getElevationWeight:{type:"accessor",value:1},elevationAggregation:"SUM",elevationLowerPercentile:{type:"number",value:0,min:0,max:100},elevationUpperPercentile:{type:"number",value:100,min:0,max:100},elevationScale:{type:"number",min:0,value:1},elevationScaleType:"linear",onSetElevationDomain:em,radius:{type:"number",value:1e3,min:1},coverage:{type:"number",min:0,max:1,value:1},extruded:!1,hexagonAggregator:XM,getPosition:{type:"accessor",value:t=>t.position},material:!0,_filterData:{type:"function",value:null,optional:!0}};class Lf extends uv{constructor(...e){super(...e),d(this,"state",void 0)}initializeState(){const e=new zM({getAggregator:r=>r.hexagonAggregator,getCellSize:r=>r.radius});this.state={cpuAggregator:e,aggregatorState:e.state,vertices:null},this.getAttributeManager().add({positions:{size:3,type:5130,accessor:"getPosition"}})}updateState(e){if(super.updateState(e),e.changeFlags.propsOrDataChanged){const n=this.state.cpuAggregator.updateState(e,{viewport:this.context.viewport,attributes:this.getAttributes()});if(this.state.aggregatorState.layerData!==n.layerData){const{hexagonVertices:r}=n.layerData||{};this.setState({vertices:r&&this.convertLatLngToMeterOffset(r)})}this.setState({aggregatorState:n})}}convertLatLngToMeterOffset(e){const{viewport:n}=this.context;if(Array.isArray(e)&&e.length===6){const r=e[0],i=e[3],s=[(r[0]+i[0])/2,(r[1]+i[1])/2],o=n.projectFlat(s),{metersPerUnit:a}=n.getDistanceScales(s);return e.map(u=>{const c=n.projectFlat(u);return[(c[0]-o[0])*a[0],(c[1]-o[1])*a[1]]})}return Q.error("HexagonLayer: hexagonVertices needs to be an array of 6 points")(),null}getPickingInfo({info:e}){return this.state.cpuAggregator.getPickingInfo({info:e})}_onGetSublayerColor(e){return this.state.cpuAggregator.getAccessor("fillColor")(e)}_onGetSublayerElevation(e){return this.state.cpuAggregator.getAccessor("elevation")(e)}_getSublayerUpdateTriggers(){return this.state.cpuAggregator.getUpdateTriggers(this.props)}renderLayers(){const{elevationScale:e,extruded:n,coverage:r,material:i,transitions:s}=this.props,{aggregatorState:o,vertices:a}=this.state,l=this.getSubLayerClass("hexagon-cell",Cf),u=this._getSublayerUpdateTriggers(),c=a?{vertices:a,radius:1}:{radius:o.layerData.radiusCommon||1,radiusUnits:"common",angle:90};return new l({...c,diskResolution:6,elevationScale:e,extruded:n,coverage:r,material:i,getFillColor:this._onGetSublayerColor.bind(this),getElevation:this._onGetSublayerElevation.bind(this),transitions:s&&{getFillColor:s.getColorValue||s.getColorWeight,getElevation:s.getElevationValue||s.getElevationWeight}},this.getSubLayerProps({id:"hexagon-cell",updateTriggers:u}),{data:o.layerData.data})}}d(Lf,"layerName","HexagonLayer");d(Lf,"defaultProps",qM);const ZM=typeof window<"u"?re.useLayoutEffect:re.useEffect,QM=ZM;function $a(t,e){for(;t;){if(t===e)return!0;t=Object.getPrototypeOf(t)}return!1}const KM={position:"absolute",zIndex:-1};function mv(t,e){if(typeof t=="function")return t(e);if(Array.isArray(t))return t.map(n=>mv(n,e));if(Tl(t)){if(JM(t))return e.style=KM,re.cloneElement(t,e);if(ek(t))return re.cloneElement(t,e)}return t}function Tl(t){return t&&typeof t=="object"&&"type"in t||!1}function JM(t){const e=t.type,n=e&&e.defaultProps;return n&&n.mapStyle}function ek(t){const e=t.type;return e&&e.deckGLViewProps}function ih(t){if(typeof t=="function")return re.createElement(Er,{},t);if(Array.isArray(t))return t.map(ih);if(Tl(t)){if(t.type===re.Fragment)return ih(t.props.children);if($a(t.type,Er))return t}return t}function tk({children:t,layers:e=[],views:n=null}){const r=[],i=[],s={};return re.Children.forEach(ih(t),o=>{if(Tl(o)){const a=o.type;if($a(a,Js)){const l=nk(a,o.props);i.push(l)}else r.push(o);if($a(a,Er)&&a!==Er&&o.props.id){const l=new a(o.props);s[l.id]=l}}else o&&r.push(o)}),Object.keys(s).length>0&&(Array.isArray(n)?n.forEach(o=>{s[o.id]=o}):n&&(s[n.id]=n),n=Object.values(s)),e=i.length>0?[...i,...e]:e,{layers:e,children:r,views:n}}function nk(t,e){const n={},r=t.defaultProps||{};for(const i in e)r[i]!==e[i]&&(n[i]=e[i]);return new t(n)}function rk({children:t,deck:e,ContextProvider:n}){const{viewManager:r}=e||{};if(!r||!r.views.length)return[];const i={},s=r.views[0].id;for(const o of t){let a=s,l=o;Tl(o)&&$a(o.type,Er)&&(a=o.props.id||s,l=o.props.children);const u=r.getViewport(a),c=r.getViewState(a);if(u){c.padding=u.padding;const{x:h,y:f,width:g,height:w}=u;l=mv(l,{x:h,y:f,width:g,height:w,viewport:u,viewState:c}),i[a]||(i[a]={viewport:u,children:[]}),i[a].children.push(l)}}return Object.keys(i).map(o=>{const{viewport:a,children:l}=i[o],{x:u,y:c,width:h,height:f}=a,g={position:"absolute",left:u,top:c,width:h,height:f},w="view-".concat(o),E=re.createElement("div",{key:w,id:w,style:g},...l);if(n){const T={viewport:a,container:e.canvas.offsetParent,eventManager:e.eventManager,onViewStateChange:y=>{y.viewId=o,e._onViewStateChange(y)}};return re.createElement(n,{key:w,value:T},E)}return E})}const ik={mixBlendMode:null};function sk({width:t,height:e,style:n}){const r={position:"absolute",zIndex:0,left:0,top:0,width:t,height:e},i={left:0,top:0};if(n)for(const s in n)s in ik?i[s]=n[s]:r[s]=n[s];return{containerStyle:r,canvasStyle:i}}function ok(t){return{get deck(){return t.deck},pickObject:e=>t.deck.pickObject(e),pickMultipleObjects:e=>t.deck.pickMultipleObjects(e),pickObjects:e=>t.deck.pickObjects(e)}}function yv(t){t.redrawReason&&(t.deck._drawLayers(t.redrawReason),t.redrawReason=null)}function ak(t,e,n){const r=new e({...n,_customRender:i=>{t.redrawReason=i;const s=r.getViewports();t.lastRenderedViewports!==s?t.forceUpdate():yv(t)}});return r}const _v=re.forwardRef((t,e)=>{const[n,r]=re.useState(0),s=re.useRef({control:null,version:n,forceUpdate:()=>r(A=>A+1)}).current,o=re.useRef(null),a=re.useRef(null),l=re.useMemo(()=>tk(t),[t.layers,t.views,t.children]);let u=!0;const c=A=>{var P;return u&&t.viewState?(s.viewStateUpdateRequested=A,null):(s.viewStateUpdateRequested=null,(P=t.onViewStateChange)===null||P===void 0?void 0:P.call(t,A))},h=A=>{if(u)s.interactionStateUpdateRequested=A;else{var P;s.interactionStateUpdateRequested=null,(P=t.onInteractionStateChange)===null||P===void 0||P.call(t,A)}},f=re.useMemo(()=>{const A={...t,style:null,width:"100%",height:"100%",parent:o.current,canvas:a.current,layers:l.layers,views:l.views,onViewStateChange:c,onInteractionStateChange:h};return delete A._customRender,s.deck&&s.deck.setProps(A),A},[t]);re.useEffect(()=>{const A=t.Deck||wl;return s.deck=ak(s,A,{...f,parent:o.current,canvas:a.current}),()=>{var P;return(P=s.deck)===null||P===void 0?void 0:P.finalize()}},[]),QM(()=>{yv(s);const{viewStateUpdateRequested:A,interactionStateUpdateRequested:P}=s;A&&c(A),P&&h(P)}),re.useImperativeHandle(e,()=>ok(s),[]);const g=s.deck&&s.deck.isInitialized?s.deck.getViewports():void 0,{ContextProvider:w,width:E,height:T,id:y,style:m}=t,{containerStyle:_,canvasStyle:S}=re.useMemo(()=>sk({width:E,height:T,style:m}),[E,T,m]);if(!s.viewStateUpdateRequested&&s.lastRenderedViewports===g||s.version!==n){s.lastRenderedViewports=g,s.version=n;const A=rk({children:l.children,deck:s.deck,ContextProvider:w}),P=re.createElement("canvas",{key:"canvas",id:y||"deckgl-overlay",ref:a,style:S});s.control=re.createElement("div",{id:"".concat(y||"deckgl","-wrapper"),ref:o,style:_},[P,A])}return u=!1,s.control});_v.defaultProps=wl.defaultProps;const lk=_v,tm=100;let uk=class{constructor(e,n){if(d(this,"schema",void 0),d(this,"options",void 0),d(this,"length",0),d(this,"rows",null),d(this,"cursor",0),d(this,"_headers",[]),this.options=n,this.schema=e,!Array.isArray(e)){this._headers=[];for(const r in e)this._headers[e[r].index]=e[r].name}}rowCount(){return this.length}addArrayRow(e,n){Number.isFinite(n)&&(this.cursor=n),this.rows=this.rows||new Array(tm),this.rows[this.length]=e,this.length++}addObjectRow(e,n){Number.isFinite(n)&&(this.cursor=n),this.rows=this.rows||new Array(tm),this.rows[this.length]=e,this.length++}getBatch(){let e=this.rows;return e?(e=e.slice(0,this.length),this.rows=null,{shape:this.options.shape,batchType:"data",data:e,length:this.length,schema:this.schema,cursor:this.cursor}):null}};function vv(t,e){if(!t)throw new Error("null row");if(!e)throw new Error("no headers");const n={};for(let r=0;r<e.length;r++)n[e[r]]=t[r];return n}function wv(t,e){if(!t)throw new Error("null row");if(!e)throw new Error("no headers");const n=new Array(e.length);for(let r=0;r<e.length;r++)n[r]=t[e[r]];return n}const nm=100;class ck{constructor(e,n){if(d(this,"schema",void 0),d(this,"options",void 0),d(this,"length",0),d(this,"objectRows",null),d(this,"arrayRows",null),d(this,"cursor",0),d(this,"_headers",[]),this.options=n,this.schema=e,!Array.isArray(e)){this._headers=[];for(const r in e)this._headers[e[r].index]=e[r].name}}rowCount(){return this.length}addArrayRow(e,n){switch(Number.isFinite(n)&&(this.cursor=n),this.options.shape){case"object-row-table":const r=vv(e,this._headers);this.addObjectRow(r,n);break;case"array-row-table":this.arrayRows=this.arrayRows||new Array(nm),this.arrayRows[this.length]=e,this.length++;break}}addObjectRow(e,n){switch(Number.isFinite(n)&&(this.cursor=n),this.options.shape){case"array-row-table":const r=wv(e,this._headers);this.addArrayRow(r,n);break;case"object-row-table":this.objectRows=this.objectRows||new Array(nm),this.objectRows[this.length]=e,this.length++;break}}getBatch(){let e=this.arrayRows||this.objectRows;return e?(e=e.slice(0,this.length),this.arrayRows=null,this.objectRows=null,{shape:this.options.shape,batchType:"data",data:e,length:this.length,schema:this.schema,cursor:this.cursor}):null}}const hk=100;class fk{constructor(e,n){d(this,"schema",void 0),d(this,"length",0),d(this,"allocated",0),d(this,"columns",{}),this.schema=e,this._reallocateColumns()}rowCount(){return this.length}addArrayRow(e){this._reallocateColumns();let n=0;for(const r in this.columns)this.columns[r][this.length]=e[n++];this.length++}addObjectRow(e){this._reallocateColumns();for(const n in e)this.columns[n][this.length]=e[n];this.length++}getBatch(){this._pruneColumns();const e=Array.isArray(this.schema)?this.columns:{};if(!Array.isArray(this.schema))for(const r in this.schema){const i=this.schema[r];e[i.name]=this.columns[i.index]}return this.columns={},{shape:"columnar-table",batchType:"data",data:e,schema:this.schema,length:this.length}}_reallocateColumns(){if(!(this.length<this.allocated)){this.allocated=this.allocated>0?this.allocated*=2:hk,this.columns={};for(const e in this.schema){const n=this.schema[e],r=n.type||Float32Array,i=this.columns[n.index];if(i&&ArrayBuffer.isView(i)){const s=new r(this.allocated);s.set(i),this.columns[n.index]=s}else i?(i.length=this.allocated,this.columns[n.index]=i):this.columns[n.index]=new r(this.allocated)}}}_pruneColumns(){for(const[e,n]of Object.entries(this.columns))this.columns[e]=n.slice(0,this.length)}}const dk={shape:"array-row-table",batchSize:"auto",batchDebounceMs:0,limit:0,_limitMB:0},rm="TableBatchBuilder";class Fs{constructor(e,n){d(this,"schema",void 0),d(this,"options",void 0),d(this,"aggregator",null),d(this,"batchCount",0),d(this,"bytesUsed",0),d(this,"isChunkComplete",!1),d(this,"lastBatchEmittedMs",Date.now()),d(this,"totalLength",0),d(this,"totalBytes",0),d(this,"rowBytes",0),this.schema=e,this.options={...dk,...n}}limitReached(){var e,n;return!!(Boolean((e=this.options)===null||e===void 0?void 0:e.limit)&&this.totalLength>=this.options.limit||Boolean((n=this.options)===null||n===void 0?void 0:n._limitMB)&&this.totalBytes/1e6>=this.options._limitMB)}addRow(e){this.limitReached()||(this.totalLength++,this.rowBytes=this.rowBytes||this._estimateRowMB(e),this.totalBytes+=this.rowBytes,Array.isArray(e)?this.addArrayRow(e):this.addObjectRow(e))}addArrayRow(e){if(!this.aggregator){const n=this._getTableBatchType();this.aggregator=new n(this.schema,this.options)}this.aggregator.addArrayRow(e)}addObjectRow(e){if(!this.aggregator){const n=this._getTableBatchType();this.aggregator=new n(this.schema,this.options)}this.aggregator.addObjectRow(e)}chunkComplete(e){e instanceof ArrayBuffer&&(this.bytesUsed+=e.byteLength),typeof e=="string"&&(this.bytesUsed+=e.length),this.isChunkComplete=!0}getFullBatch(e){return this._isFull()?this._getBatch(e):null}getFinalBatch(e){return this._getBatch(e)}_estimateRowMB(e){return Array.isArray(e)?e.length*8:Object.keys(e).length*8}_isFull(){if(!this.aggregator||this.aggregator.rowCount()===0)return!1;if(this.options.batchSize==="auto"){if(!this.isChunkComplete)return!1}else if(this.options.batchSize>this.aggregator.rowCount())return!1;return this.options.batchDebounceMs>Date.now()-this.lastBatchEmittedMs?!1:(this.isChunkComplete=!1,this.lastBatchEmittedMs=Date.now(),!0)}_getBatch(e){if(!this.aggregator)return null;e!=null&&e.bytesUsed&&(this.bytesUsed=e.bytesUsed);const n=this.aggregator.getBatch();return n.count=this.batchCount,n.bytesUsed=this.bytesUsed,Object.assign(n,e),this.batchCount++,this.aggregator=null,n}_getTableBatchType(){switch(this.options.shape){case"row-table":return uk;case"array-row-table":case"object-row-table":return ck;case"columnar-table":return fk;case"arrow-table":if(!Fs.ArrowBatch)throw new Error(rm);return Fs.ArrowBatch;default:throw new Error(rm)}}}d(Fs,"ArrowBatch",void 0);let Ev;class im extends Array{enqueue(e){return this.push(e)}dequeue(){return this.shift()}}Ev=Symbol.asyncIterator;class gk{constructor(){d(this,"_values",void 0),d(this,"_settlers",void 0),d(this,"_closed",void 0),this._values=new im,this._settlers=new im,this._closed=!1}close(){for(;this._settlers.length>0;)this._settlers.dequeue().resolve({done:!0});this._closed=!0}[Ev](){return this}enqueue(e){if(this._closed)throw new Error("Closed");if(this._settlers.length>0){if(this._values.length>0)throw new Error("Illegal internal state");const n=this._settlers.dequeue();e instanceof Error?n.reject(e):n.resolve({value:e})}else this._values.enqueue(e)}next(){if(this._values.length>0){const e=this._values.dequeue();return e instanceof Error?Promise.reject(e):Promise.resolve({value:e})}if(this._closed){if(this._settlers.length>0)throw new Error("Illegal internal state");return Promise.resolve({done:!0})}return new Promise((e,n)=>{this._settlers.enqueue({resolve:e,reject:n})})}}/* @license
Papa Parse
v5.0.0-beta.0
https://github.com/mholt/PapaParse
License: MIT
*/const sm="\uFEFF",Zt={parse:pk,unparse:mk,RECORD_SEP:String.fromCharCode(30),UNIT_SEP:String.fromCharCode(31),BYTE_ORDER_MARK:sm,BAD_DELIMITERS:["\r",`
`,'"',sm],WORKERS_SUPPORTED:!1,NODE_STREAM_INPUT:1,LocalChunkSize:1024*1024*10,RemoteChunkSize:1024*1024*5,DefaultDelimiter:",",Parser:sh,ParserHandle:bv,ChunkStreamer:Tv,StringStreamer:wi},bl=Zt;function pk(t,e,n){e=e||{};var r=e.dynamicTyping||!1;if(He(r)&&(e.dynamicTypingFunction=r,r={}),e.dynamicTyping=r,e.transform=He(e.transform)?e.transform:!1,e.worker&&Zt.WORKERS_SUPPORTED){var i=newWorker();i.userStep=e.step,i.userChunk=e.chunk,i.userComplete=e.complete,i.userError=e.error,e.step=He(e.step),e.chunk=He(e.chunk),e.complete=He(e.complete),e.error=He(e.error),delete e.worker,i.postMessage({input:t,config:e,workerId:i.id});return}var s=null;return typeof t=="string"&&(s=new wi(e)),s||(s=new n(e)),s.stream(t)}function mk(t,e){var n=!1,r=!0,i=",",s=`\r
`,o='"',a=o+o,l=!1,u=null;h();var c=new RegExp(Us(o),"g");if(typeof t=="string"&&(t=JSON.parse(t)),Array.isArray(t)){if(!t.length||Array.isArray(t[0]))return g(null,t,l);if(typeof t[0]=="object")return g(u||f(t[0]),t,l)}else if(typeof t=="object")return typeof t.data=="string"&&(t.data=JSON.parse(t.data)),Array.isArray(t.data)&&(t.fields||(t.fields=t.meta&&t.meta.fields),t.fields||(t.fields=Array.isArray(t.data[0])?t.fields:f(t.data[0])),!Array.isArray(t.data[0])&&typeof t.data[0]!="object"&&(t.data=[t.data])),g(t.fields||[],t.data||[],l);throw new Error("Unable to serialize unrecognized input");function h(){if(typeof e=="object"){if(typeof e.delimiter=="string"&&!Zt.BAD_DELIMITERS.filter(function(T){return e.delimiter.indexOf(T)!==-1}).length&&(i=e.delimiter),(typeof e.quotes=="boolean"||Array.isArray(e.quotes))&&(n=e.quotes),(typeof e.skipEmptyLines=="boolean"||typeof e.skipEmptyLines=="string")&&(l=e.skipEmptyLines),typeof e.newline=="string"&&(s=e.newline),typeof e.quoteChar=="string"&&(o=e.quoteChar),typeof e.header=="boolean"&&(r=e.header),Array.isArray(e.columns)){if(e.columns.length===0)throw new Error("Option columns is empty");u=e.columns}e.escapeChar!==void 0&&(a=e.escapeChar+o)}}function f(T){if(typeof T!="object")return[];var y=[];for(var m in T)y.push(m);return y}function g(T,y,m){var _="";typeof T=="string"&&(T=JSON.parse(T)),typeof y=="string"&&(y=JSON.parse(y));var S=Array.isArray(T)&&T.length>0,A=!Array.isArray(y[0]);if(S&&r){for(var P=0;P<T.length;P++)P>0&&(_+=i),_+=w(T[P],P);y.length>0&&(_+=s)}for(var L=0;L<y.length;L++){var C=S?T.length:y[L].length,R=!1,M=S?Object.keys(y[L]).length===0:y[L].length===0;if(m&&!S&&(R=m==="greedy"?y[L].join("").trim()==="":y[L].length===1&&y[L][0].length===0),m==="greedy"&&S){for(var O=[],D=0;D<C;D++){var G=A?T[D]:D;O.push(y[L][G])}R=O.join("").trim()===""}if(!R){for(var V=0;V<C;V++){V>0&&!M&&(_+=i);var K=S&&A?T[V]:V;_+=w(y[L][K],V)}L<y.length-1&&(!m||C>0&&!M)&&(_+=s)}}return _}function w(T,y){if(typeof T>"u"||T===null)return"";if(T.constructor===Date)return JSON.stringify(T).slice(1,25);T=T.toString().replace(c,a);var m=typeof n=="boolean"&&n||Array.isArray(n)&&n[y]||E(T,Zt.BAD_DELIMITERS)||T.indexOf(i)>-1||T.charAt(0)===" "||T.charAt(T.length-1)===" ";return m?o+T+o:T}function E(T,y){for(var m=0;m<y.length;m++)if(T.indexOf(y[m])>-1)return!0;return!1}}function Tv(t){this._handle=null,this._finished=!1,this._completed=!1,this._input=null,this._baseIndex=0,this._partialLine="",this._rowCount=0,this._start=0,this._nextChunk=null,this.isFirstChunk=!0,this._completeResults={data:[],errors:[],meta:{}},e.call(this,t),this.parseChunk=function(n,r){if(this.isFirstChunk&&He(this._config.beforeFirstChunk)){var i=this._config.beforeFirstChunk(n);i!==void 0&&(n=i)}this.isFirstChunk=!1;var s=this._partialLine+n;this._partialLine="";var o=this._handle.parse(s,this._baseIndex,!this._finished);if(!(this._handle.paused()||this._handle.aborted())){var a=o.meta.cursor;this._finished||(this._partialLine=s.substring(a-this._baseIndex),this._baseIndex=a),o&&o.data&&(this._rowCount+=o.data.length);var l=this._finished||this._config.preview&&this._rowCount>=this._config.preview;if(He(this._config.chunk)&&!r){if(this._config.chunk(o,this._handle),this._handle.paused()||this._handle.aborted())return;o=void 0,this._completeResults=void 0}return!this._config.step&&!this._config.chunk&&(this._completeResults.data=this._completeResults.data.concat(o.data),this._completeResults.errors=this._completeResults.errors.concat(o.errors),this._completeResults.meta=o.meta),!this._completed&&l&&He(this._config.complete)&&(!o||!o.meta.aborted)&&(this._config.complete(this._completeResults,this._input),this._completed=!0),!l&&(!o||!o.meta.paused)&&this._nextChunk(),o}},this._sendError=function(n){He(this._config.error)&&this._config.error(n)};function e(n){var r=Rf(n);r.chunkSize=parseInt(r.chunkSize),!n.step&&!n.chunk&&(r.chunkSize=null),this._handle=new bv(r),this._handle.streamer=this,this._config=r}}function wi(t){t=t||{},Tv.call(this,t);var e;this.stream=function(n){return e=n,this._nextChunk()},this._nextChunk=function(){if(!this._finished){var n=this._config.chunkSize,r=n?e.substr(0,n):e;return e=n?e.substr(n):"",this._finished=!e,this.parseChunk(r)}}}wi.prototype=Object.create(wi.prototype);wi.prototype.constructor=wi;function bv(t){var e=/^\s*-?(\d*\.?\d+|\d+\.?\d*)(e[-+]?\d+)?\s*$/i,n=/(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\d\.\d+([+-][0-2]\d:[0-5]\d|Z))|(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\d([+-][0-2]\d:[0-5]\d|Z))|(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d([+-][0-2]\d:[0-5]\d|Z))/,r=this,i=0,s=0,o,a,l=!1,u=!1,c,h=[],f={data:[],errors:[],meta:{}};if(He(t.step)){var g=t.step;t.step=function(C){if(f=C,T())E();else{if(E(),!f.data||f.data.length===0)return;i+=C.data.length,t.preview&&i>t.preview?a.abort():g(f,r)}}}this.parse=function(C,R,M){var O=t.quoteChar||'"';if(t.newline||(t.newline=P(C,O)),c=!1,t.delimiter)He(t.delimiter)&&(t.delimiter=t.delimiter(C),f.meta.delimiter=t.delimiter);else{var D=A(C,t.newline,t.skipEmptyLines,t.comments,t.delimitersToGuess);D.successful?t.delimiter=D.bestDelimiter:(c=!0,t.delimiter=Zt.DefaultDelimiter),f.meta.delimiter=t.delimiter}var G=Rf(t);return t.preview&&t.header&&G.preview++,o=C,a=new sh(G),f=a.parse(o,R,M),E(),l?{meta:{paused:!0}}:f||{meta:{paused:!1}}},this.paused=function(){return l},this.pause=function(){l=!0,a.abort(),o=o.substr(a.getCharIndex())},this.resume=function(){l=!1,r.streamer.parseChunk(o,!0)},this.aborted=function(){return u},this.abort=function(){u=!0,a.abort(),f.meta.aborted=!0,He(t.complete)&&t.complete(f),o=""};function w(C){return t.skipEmptyLines==="greedy"?C.join("").trim()==="":C.length===1&&C[0].length===0}function E(){if(f&&c&&(L("Delimiter","UndetectableDelimiter","Unable to auto-detect delimiting character; defaulted to '"+Zt.DefaultDelimiter+"'"),c=!1),t.skipEmptyLines)for(var C=0;C<f.data.length;C++)w(f.data[C])&&f.data.splice(C--,1);return T()&&y(),S()}function T(){return t.header&&h.length===0}function y(){if(!f)return;function C(M){He(t.transformHeader)&&(M=t.transformHeader(M)),h.push(M)}if(Array.isArray(f.data[0])){for(var R=0;T()&&R<f.data.length;R++)f.data[R].forEach(C);f.data.splice(0,1)}else f.data.forEach(C)}function m(C){return t.dynamicTypingFunction&&t.dynamicTyping[C]===void 0&&(t.dynamicTyping[C]=t.dynamicTypingFunction(C)),(t.dynamicTyping[C]||t.dynamicTyping)===!0}function _(C,R){return m(C)?R==="true"||R==="TRUE"?!0:R==="false"||R==="FALSE"?!1:e.test(R)?parseFloat(R):n.test(R)?new Date(R):R===""?null:R:R}function S(){if(!f||!f.data||!t.header&&!t.dynamicTyping&&!t.transform)return f;function C(M,O){var D=t.header?{}:[],G;for(G=0;G<M.length;G++){var V=G,K=M[G];t.header&&(V=G>=h.length?"__parsed_extra":h[G]),t.transform&&(K=t.transform(K,V)),K=_(V,K),V==="__parsed_extra"?(D[V]=D[V]||[],D[V].push(K)):D[V]=K}return t.header&&(G>h.length?L("FieldMismatch","TooManyFields","Too many fields: expected "+h.length+" fields but parsed "+G,s+O):G<h.length&&L("FieldMismatch","TooFewFields","Too few fields: expected "+h.length+" fields but parsed "+G,s+O)),D}var R=1;return!f.data[0]||Array.isArray(f.data[0])?(f.data=f.data.map(C),R=f.data.length):f.data=C(f.data,0),t.header&&f.meta&&(f.meta.fields=h),s+=R,f}function A(C,R,M,O,D){var G,V,K;D=D||[",","	","|",";",Zt.RECORD_SEP,Zt.UNIT_SEP];for(var mt=0;mt<D.length;mt++){var qe=D[mt],N=0,j=0,W=0;K=void 0;for(var H=new sh({comments:O,delimiter:qe,newline:R,preview:10}).parse(C),$=0;$<H.data.length;$++){if(M&&w(H.data[$])){W++;continue}var ue=H.data[$].length;if(j+=ue,typeof K>"u"){K=0;continue}else ue>1&&(N+=Math.abs(ue-K),K=ue)}H.data.length>0&&(j/=H.data.length-W),(typeof V>"u"||N>V)&&j>1.99&&(V=N,G=qe)}return t.delimiter=G,{successful:!!G,bestDelimiter:G}}function P(C,R){C=C.substr(0,1024*1024);var M=new RegExp(Us(R)+"([^]*?)"+Us(R),"gm");C=C.replace(M,"");var O=C.split("\r"),D=C.split(`
`),G=D.length>1&&D[0].length<O[0].length;if(O.length===1||G)return`
`;for(var V=0,K=0;K<O.length;K++)O[K][0]===`
`&&V++;return V>=O.length/2?`\r
`:"\r"}function L(C,R,M,O){f.errors.push({type:C,code:R,message:M,row:O})}}function Us(t){return t.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function sh(t){t=t||{};var e=t.delimiter,n=t.newline,r=t.comments,i=t.step,s=t.preview,o=t.fastMode,a;t.quoteChar===void 0?a='"':a=t.quoteChar;var l=a;if(t.escapeChar!==void 0&&(l=t.escapeChar),(typeof e!="string"||Zt.BAD_DELIMITERS.indexOf(e)>-1)&&(e=","),r===e)throw new Error("Comment character same as delimiter");r===!0?r="#":(typeof r!="string"||Zt.BAD_DELIMITERS.indexOf(r)>-1)&&(r=!1),n!==`
`&&n!=="\r"&&n!==`\r
`&&(n=`
`);var u=0,c=!1;this.parse=function(h,f,g){if(typeof h!="string")throw new Error("Input must be a string");var w=h.length,E=e.length,T=n.length,y=r.length,m=He(i);u=0;var _=[],S=[],A=[],P=0;if(!h)return H();if(o||o!==!1&&h.indexOf(a)===-1){for(var L=h.split(n),C=0;C<L.length;C++){if(A=L[C],u+=A.length,C!==L.length-1)u+=n.length;else if(g)return H();if(!(r&&A.substr(0,y)===r)){if(m){if(_=[],qe(A.split(e)),$(),c)return H()}else qe(A.split(e));if(s&&C>=s)return _=_.slice(0,s),H(!0)}}return H()}for(var R=h.indexOf(e,u),M=h.indexOf(n,u),O=new RegExp(Us(l)+Us(a),"g"),D;;){if(h[u]===a){for(D=u,u++;;){if(D=h.indexOf(a,D+1),D===-1)return g||S.push({type:"Quotes",code:"MissingQuotes",message:"Quoted field unterminated",row:_.length,index:u}),j();if(D===w-1){var G=h.substring(u,D).replace(O,a);return j(G)}if(a===l&&h[D+1]===l){D++;continue}if(!(a!==l&&D!==0&&h[D-1]===l)){var V=M===-1?R:Math.min(R,M),K=N(V);if(h[D+1+K]===e){if(A.push(h.substring(u,D).replace(O,a)),u=D+1+K+E,R=h.indexOf(e,u),M=h.indexOf(n,u),m&&($(),c))return H();if(s&&_.length>=s)return H(!0);break}var mt=N(M);if(h.substr(D+1+mt,T)===n){if(A.push(h.substring(u,D).replace(O,a)),W(D+1+mt+T),R=h.indexOf(e,u),m&&($(),c))return H();if(s&&_.length>=s)return H(!0);break}S.push({type:"Quotes",code:"InvalidQuotes",message:"Trailing quote on quoted field is malformed",row:_.length,index:u}),D++}}if(m&&($(),c))return H();if(s&&_.length>=s)return H(!0);continue}if(r&&A.length===0&&h.substr(u,y)===r){if(M===-1)return H();u=M+T,M=h.indexOf(n,u),R=h.indexOf(e,u);continue}if(R!==-1&&(R<M||M===-1)){A.push(h.substring(u,R)),u=R+E,R=h.indexOf(e,u);continue}if(M!==-1){if(A.push(h.substring(u,M)),W(M+T),m&&($(),c))return H();if(s&&_.length>=s)return H(!0);continue}break}return j();function qe(ue){_.push(ue),P=u}function N(ue){var Oe=0;if(ue!==-1){var Ct=h.substring(D+1,ue);Ct&&Ct.trim()===""&&(Oe=Ct.length)}return Oe}function j(ue){return g||(typeof ue>"u"&&(ue=h.substr(u)),A.push(ue),u=w,qe(A),m&&$()),H()}function W(ue){u=ue,qe(A),A=[],M=h.indexOf(n,u)}function H(ue,Oe){var Ct=Oe||!1;return{data:Ct?_[0]:_,errors:S,meta:{delimiter:e,linebreak:n,aborted:c,truncated:!!ue,cursor:P+(f||0)}}}function $(){i(H(void 0,!0)),_=[],S=[]}},this.abort=function(){c=!0},this.getCharIndex=function(){return u}}function Rf(t){if(typeof t!="object"||t===null)return t;var e=Array.isArray(t)?[]:{};for(var n in t)e[n]=Rf(t[n]);return e}function He(t){return typeof t=="function"}const{ChunkStreamer:Sv}=bl;function qa(t){t=t||{},Sv.call(this,t),this.textDecoder=new TextDecoder(this._config.encoding),this.stream=async function(e){this._input=e;try{for await(const n of e)this.parseChunk(this.getStringChunk(n));this._finished=!0,this.parseChunk("")}catch(n){this._sendError(n)}},this._nextChunk=function(){},this.getStringChunk=function(e){return typeof e=="string"?e:this.textDecoder.decode(e,{stream:!0})}}qa.prototype=Object.create(Sv.prototype);qa.prototype.constructor=qa;const yk="3.2.13",Mf={csv:{shape:"object-row-table",optimizeMemoryUsage:!1,header:"auto",columnPrefix:"column",quoteChar:'"',escapeChar:'"',dynamicTyping:!0,comments:!1,skipEmptyLines:!0,delimitersToGuess:[",","	","|",";"]}},_k={id:"csv",module:"csv",name:"CSV",version:yk,extensions:["csv","tsv","dsv"],mimeTypes:["text/csv","text/tab-separated-values","text/dsv"],category:"table",parse:async(t,e)=>om(new TextDecoder().decode(t),e),parseText:(t,e)=>om(t,e),parseInBatches:vk,options:Mf};async function om(t,e){const n={...Mf.csv,...e?.csv},r=wk(t),s=n.header==="auto"?Av(r):Boolean(n.header),o={...n,header:s,download:!1,transformHeader:s?xv():void 0,error:c=>{throw new Error(c)}},a=bl.parse(t,o);let{data:l}=a;const u=a.meta.fields||Pv(n.columnPrefix,r.length);switch(n.shape){case"object-row-table":l=l.map(c=>Array.isArray(c)?vv(c,u):c);break;case"array-row-table":l=l.map(c=>Array.isArray(c)?c:wv(c,u));break}return l}function vk(t,e){var n;e={...e},e.batchSize==="auto"&&(e.batchSize=4e3);const r={...Mf.csv,...(n=e)===null||n===void 0?void 0:n.csv},i=new gk;let s=!0,o=null,a=null,l=null;const u={...r,header:!1,download:!1,chunkSize:1024*1024*5,skipEmptyLines:!1,step(c){let h=c.data;if(r.skipEmptyLines&&h.flat().join("").trim()==="")return;const f=c.meta.cursor;if(s&&!o&&(r.header==="auto"?Av(h):Boolean(r.header))){o=h.map(xv());return}s&&(s=!1,o||(o=Pv(r.columnPrefix,h.length)),l=Ek(h,o)),r.optimizeMemoryUsage&&(h=JSON.parse(JSON.stringify(h))),a=a||new Fs(l,{shape:r.shape||"array-row-table",...e});try{a.addRow(h);const g=a&&a.getFullBatch({bytesUsed:f});g&&i.enqueue(g)}catch(g){i.enqueue(g)}},complete(c){try{const h=c.meta.cursor,f=a&&a.getFinalBatch({bytesUsed:h});f&&i.enqueue(f)}catch(h){i.enqueue(h)}i.close()}};return bl.parse(t,u,qa),i}function Av(t){return t&&t.every(e=>typeof e=="string")}function wk(t){return bl.parse(t,{download:!1,dynamicTyping:!0,preview:1}).data[0]}function xv(){const t=new Set;return e=>{let n=e,r=1;for(;t.has(n);)n="".concat(e,".").concat(r),r++;return t.add(n),n}}function Pv(t,e=0){const n=[];for(let r=0;r<e;r++)n.push("".concat(t).concat(r+1));return n}function Ek(t,e){const n=e?{}:[];for(let r=0;r<t.length;r++){const i=e&&e[r]||r;switch(typeof t[r]){case"number":case"boolean":n[i]={name:String(i),index:r,type:Float32Array};break;case"string":default:n[i]={name:String(i),index:r,type:Array}}}return n}const Tk="https://raw.githubusercontent.com/visgl/deck.gl-data/master/examples/3d-heatmap/heatmap-data.csv",bk=await Ia(Tk,_k),Nu=bk.map(t=>[t.lng,t.lat]),Sk=new O_({color:[255,255,255],intensity:1}),Ak=new U_({color:[255,255,255],intensity:.8,position:[-.144528,49.739968,8e4]}),xk=new U_({color:[255,255,255],intensity:.8,position:[-3.807751,54.104682,8e3]}),Pk=new vf({ambientLight:Sk,pointLight1:Ak,pointLight2:xk}),Ck={longitude:-1.415727,latitude:52.232395,zoom:6.6,minZoom:5,maxZoom:15,pitch:40.5,bearing:-27},Lk=[[1,152,189],[73,227,206],[216,254,181],[254,237,177],[254,173,84],[209,55,78]],Rk={ambient:.64,diffuse:.6,shininess:32,specularColor:[51,51,51]};function Mk(){const t=[new Lf({id:"heatmap",colorRange:Lk,coverage:1,data:Nu,elevationRange:[0,3e3],elevationScale:Nu&&Nu.length?50:0,extruded:!0,getPosition:e=>e,pickable:!0,radius:1e3,upperPercentile:100,material:Rk,transitions:{elevationScale:3e3}})];return sa("div",{className:"App",children:sa(lk,{layers:t,effects:[Pk],initialViewState:Ck,controller:!0})})}Fu.createRoot(document.getElementById("root")).render(sa(w1.StrictMode,{children:sa(Mk,{})}));
